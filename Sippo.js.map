{"version":3,"sources":["webpack://Sippo/webpack/universalModuleDefinition","webpack://Sippo/webpack/bootstrap","webpack://Sippo/./node_modules/tslib/tslib.es6.js","webpack://Sippo/./node_modules/eventemitter2/lib/eventemitter2.js","webpack://Sippo/./node_modules/stanza/module.js","webpack://Sippo/./node_modules/js-logger/src/logger.js","webpack://Sippo/./node_modules/nanoid/index.browser.js","webpack://Sippo/./node_modules/sdp/sdp.js","webpack://Sippo/./node_modules/lodash-es/_root.js","webpack://Sippo/(webpack)/buildin/global.js","webpack://Sippo/./node_modules/bowser/src/bowser.js","webpack://Sippo/./node_modules/node-libs-browser/node_modules/punycode/punycode.js","webpack://Sippo/./node_modules/eventemitter3/index.js","webpack://Sippo/./node_modules/buffer/index.js","webpack://Sippo/./node_modules/lodash-es/_nodeUtil.js","webpack://Sippo/./node_modules/process/browser.js","webpack://Sippo/./node_modules/debug/src/browser.js","webpack://Sippo/./node_modules/events/events.js","webpack://Sippo/./node_modules/query-string/index.js","webpack://Sippo/./node_modules/lodash-es/isBuffer.js","webpack://Sippo/./node_modules/readable-stream/readable-browser.js","webpack://Sippo/./node_modules/readable-stream/lib/_stream_duplex.js","webpack://Sippo/./node_modules/component-emitter/index.js","webpack://Sippo/./node_modules/engine.io-client/node_modules/engine.io-parser/lib/browser.js","webpack://Sippo/./node_modules/core-util-is/lib/util.js","webpack://Sippo/./node_modules/inherits/inherits_browser.js","webpack://Sippo/./node_modules/process-nextick-args/index.js","webpack://Sippo/./node_modules/parseqs/index.js","webpack://Sippo/./node_modules/component-inherit/index.js","webpack://Sippo/./node_modules/lodash-es/_freeGlobal.js","webpack://Sippo/./node_modules/socket.io-client/lib/index.js","webpack://Sippo/./node_modules/reconnecting-websocket/dist/index.js","webpack://Sippo/./node_modules/async/dist/async.mjs","webpack://Sippo/./node_modules/readable-stream/node_modules/safe-buffer/index.js","webpack://Sippo/(webpack)/buildin/harmony-module.js","webpack://Sippo/./node_modules/socket.io-parser/index.js","webpack://Sippo/./node_modules/engine.io-client/lib/xmlhttprequest.js","webpack://Sippo/./node_modules/engine.io-client/lib/transport.js","webpack://Sippo/./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","webpack://Sippo/./node_modules/semaphore-async-await/dist/index.js","webpack://Sippo/./node_modules/readable-stream/lib/_stream_readable.js","webpack://Sippo/./node_modules/readable-stream/lib/internal/streams/stream-browser.js","webpack://Sippo/./node_modules/readable-stream/lib/internal/streams/destroy.js","webpack://Sippo/./node_modules/readable-stream/lib/_stream_writable.js","webpack://Sippo/./node_modules/string_decoder/lib/string_decoder.js","webpack://Sippo/./node_modules/readable-stream/lib/_stream_transform.js","webpack://Sippo/./node_modules/parseuri/index.js","webpack://Sippo/./node_modules/socket.io-parser/node_modules/isarray/index.js","webpack://Sippo/./node_modules/socket.io-parser/is-buffer.js","webpack://Sippo/./node_modules/socket.io-client/lib/manager.js","webpack://Sippo/./node_modules/engine.io-client/lib/transports/index.js","webpack://Sippo/./node_modules/engine.io-client/lib/transports/polling.js","webpack://Sippo/./node_modules/has-binary2/index.js","webpack://Sippo/./node_modules/yeast/index.js","webpack://Sippo/./node_modules/indexof/index.js","webpack://Sippo/./node_modules/socket.io-client/lib/socket.js","webpack://Sippo/./node_modules/socket.io-client/lib/on.js","webpack://Sippo/./node_modules/component-bind/index.js","webpack://Sippo/./node_modules/semaphore-async-await/dist/Semaphore.js","webpack://Sippo/./node_modules/exif-js/exif.js","webpack://Sippo/./node_modules/nanoid/generate.js","webpack://Sippo/./node_modules/stanza/Utils.js","webpack://Sippo/./node_modules/jshashes/hashes.js","webpack://Sippo/./node_modules/lodash-es/stubFalse.js","webpack://Sippo/./node_modules/lodash-es/_cloneBuffer.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/socketFactory.js","webpack://Sippo/./node_modules/lite-url/dist/lite-url.min.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/nanoid/index.browser.js","webpack://Sippo/./node_modules/@quobis/socket.io-file-client/socket.io-file-client.js","webpack://Sippo/./node_modules/strict-uri-encode/index.js","webpack://Sippo/./node_modules/object-assign/index.js","webpack://Sippo/./node_modules/base64-js/index.js","webpack://Sippo/./node_modules/ieee754/index.js","webpack://Sippo/./node_modules/buffer/node_modules/isarray/index.js","webpack://Sippo/(webpack)/buildin/module.js","webpack://Sippo/./node_modules/readable-stream/node_modules/isarray/index.js","webpack://Sippo/./node_modules/readable-stream/lib/internal/streams/BufferList.js","webpack://Sippo/./node_modules/timers-browserify/main.js","webpack://Sippo/./node_modules/setimmediate/setImmediate.js","webpack://Sippo/./node_modules/util-deprecate/browser.js","webpack://Sippo/./node_modules/string_decoder/node_modules/safe-buffer/index.js","webpack://Sippo/./node_modules/readable-stream/lib/_stream_passthrough.js","webpack://Sippo/./node_modules/nanoid/random.browser.js","webpack://Sippo/./node_modules/nanoid/format.browser.js","webpack://Sippo/./node_modules/stanza-shims/dist/index.browser-module.js","webpack://Sippo/(webpack)/buildin/amd-define.js","webpack://Sippo/./node_modules/socket.io-client/lib/url.js","webpack://Sippo/./node_modules/debug/src/common.js","webpack://Sippo/./node_modules/debug/node_modules/ms/index.js","webpack://Sippo/./node_modules/socket.io-parser/node_modules/debug/src/browser.js","webpack://Sippo/./node_modules/socket.io-parser/node_modules/debug/src/debug.js","webpack://Sippo/./node_modules/ms/index.js","webpack://Sippo/./node_modules/socket.io-parser/binary.js","webpack://Sippo/./node_modules/engine.io-client/lib/index.js","webpack://Sippo/./node_modules/engine.io-client/lib/socket.js","webpack://Sippo/./node_modules/has-cors/index.js","webpack://Sippo/./node_modules/engine.io-client/lib/transports/polling-xhr.js","webpack://Sippo/./node_modules/engine.io-client/node_modules/engine.io-parser/lib/keys.js","webpack://Sippo/./node_modules/has-binary2/node_modules/isarray/index.js","webpack://Sippo/./node_modules/arraybuffer.slice/index.js","webpack://Sippo/./node_modules/after/index.js","webpack://Sippo/./node_modules/engine.io-client/node_modules/engine.io-parser/lib/utf8.js","webpack://Sippo/./node_modules/blob/index.js","webpack://Sippo/./node_modules/engine.io-client/lib/transports/polling-jsonp.js","webpack://Sippo/./node_modules/engine.io-client/lib/transports/websocket.js","webpack://Sippo/./node_modules/to-array/index.js","webpack://Sippo/./node_modules/backo2/index.js","webpack://Sippo/./node_modules/semaphore-async-await/dist/Lock.js","webpack://Sippo/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://Sippo/./version.js","webpack://Sippo/./src/utils/PromiseQueue.js","webpack://Sippo/./src/utils/bindMethods.js","webpack://Sippo/./src/utils/Enum.js","webpack://Sippo/./src/utils/isDevice.js","webpack://Sippo/./src/utils/getDeviceId.js","webpack://Sippo/./src/utils/scaleImg.js","webpack://Sippo/./src/utils/cropImage.js","webpack://Sippo/./src/utils/Storage.js","webpack://Sippo/./src/session/SessionStatus.js","webpack://Sippo/./node_modules/es6-error/es6/index.js","webpack://Sippo/./src/session/SessionError.js","webpack://Sippo/./src/wac-proxy/errors.js","webpack://Sippo/./node_modules/immutable/dist/immutable.es.js","webpack://Sippo/./src/Logs.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isFunction.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/config.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/hostReportError.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/Observer.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isArray.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isObject.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/Subscription.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/Subscriber.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/symbol/observable.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/noop.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/pipe.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/Observable.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/toSubscriber.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/canReportError.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/SubjectSubscription.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/Subject.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/BehaviorSubject.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isScheduler.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/OuterSubscriber.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/InnerSubscriber.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeToArray.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/symbol/iterator.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeTo.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isArrayLike.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/isPromise.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/util/subscribeToResult.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/observable/fromArray.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/scheduled/scheduleArray.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/observable/combineLatest.js","webpack://Sippo/./node_modules/rxjs/_esm5/internal/operators/map.js","webpack://Sippo/./src/file-sharing/FileUploadStatus.js","webpack://Sippo/./src/chat/ChatMessageFile.js","webpack://Sippo/./src/chat/ChatMessageDirection.js","webpack://Sippo/./src/chat/ChatMessageStatus.js","webpack://Sippo/./src/chat/ChatMessageType.js","webpack://Sippo/./src/chat/ChatMessage.js","webpack://Sippo/./src/chat/ChatType.js","webpack://Sippo/./src/chat/ChatParticipantRole.js","webpack://Sippo/./src/chat/ChatParticipantState.js","webpack://Sippo/./src/chat/AckCounter.js","webpack://Sippo/./src/chat/Chat.js","webpack://Sippo/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://Sippo/./src/wac-proxy/wac-stack/ChatService.js","webpack://Sippo/./src/chat/ChatManager.js","webpack://Sippo/./src/contacts/PresenceActivity.js","webpack://Sippo/./src/contacts/PresenceMood.js","webpack://Sippo/./src/contacts/Presence.js","webpack://Sippo/./src/contacts/OwnPresence.js","webpack://Sippo/./src/utils/Queue.js","webpack://Sippo/./src/users/ResolveQueue.js","webpack://Sippo/./src/users/UserCollection.js","webpack://Sippo/./src/users/UserManager.js","webpack://Sippo/./src/contacts/BaseContact.js","webpack://Sippo/./src/contacts/utils.js","webpack://Sippo/./src/contacts/Contact.js","webpack://Sippo/./src/contacts/W3cContacts.js","webpack://Sippo/./src/contacts/ContactRetriever.js","webpack://Sippo/./src/contacts/ContactCache.js","webpack://Sippo/./node_modules/lodash-es/_listCacheClear.js","webpack://Sippo/./node_modules/lodash-es/eq.js","webpack://Sippo/./node_modules/lodash-es/_assocIndexOf.js","webpack://Sippo/./node_modules/lodash-es/_listCacheDelete.js","webpack://Sippo/./node_modules/lodash-es/_listCacheGet.js","webpack://Sippo/./node_modules/lodash-es/_listCacheHas.js","webpack://Sippo/./node_modules/lodash-es/_listCacheSet.js","webpack://Sippo/./node_modules/lodash-es/_ListCache.js","webpack://Sippo/./node_modules/lodash-es/_stackClear.js","webpack://Sippo/./node_modules/lodash-es/_stackDelete.js","webpack://Sippo/./node_modules/lodash-es/_stackGet.js","webpack://Sippo/./node_modules/lodash-es/_stackHas.js","webpack://Sippo/./node_modules/lodash-es/_Symbol.js","webpack://Sippo/./node_modules/lodash-es/_getRawTag.js","webpack://Sippo/./node_modules/lodash-es/_objectToString.js","webpack://Sippo/./node_modules/lodash-es/_baseGetTag.js","webpack://Sippo/./node_modules/lodash-es/isObject.js","webpack://Sippo/./node_modules/lodash-es/isFunction.js","webpack://Sippo/./node_modules/lodash-es/_isMasked.js","webpack://Sippo/./node_modules/lodash-es/_coreJsData.js","webpack://Sippo/./node_modules/lodash-es/_toSource.js","webpack://Sippo/./node_modules/lodash-es/_baseIsNative.js","webpack://Sippo/./node_modules/lodash-es/_getValue.js","webpack://Sippo/./node_modules/lodash-es/_getNative.js","webpack://Sippo/./node_modules/lodash-es/_Map.js","webpack://Sippo/./node_modules/lodash-es/_nativeCreate.js","webpack://Sippo/./node_modules/lodash-es/_hashClear.js","webpack://Sippo/./node_modules/lodash-es/_hashDelete.js","webpack://Sippo/./node_modules/lodash-es/_hashGet.js","webpack://Sippo/./node_modules/lodash-es/_hashHas.js","webpack://Sippo/./node_modules/lodash-es/_hashSet.js","webpack://Sippo/./node_modules/lodash-es/_Hash.js","webpack://Sippo/./node_modules/lodash-es/_mapCacheClear.js","webpack://Sippo/./node_modules/lodash-es/_isKeyable.js","webpack://Sippo/./node_modules/lodash-es/_getMapData.js","webpack://Sippo/./node_modules/lodash-es/_mapCacheDelete.js","webpack://Sippo/./node_modules/lodash-es/_mapCacheGet.js","webpack://Sippo/./node_modules/lodash-es/_mapCacheHas.js","webpack://Sippo/./node_modules/lodash-es/_mapCacheSet.js","webpack://Sippo/./node_modules/lodash-es/_MapCache.js","webpack://Sippo/./node_modules/lodash-es/_stackSet.js","webpack://Sippo/./node_modules/lodash-es/_Stack.js","webpack://Sippo/./node_modules/lodash-es/_setCacheAdd.js","webpack://Sippo/./node_modules/lodash-es/_setCacheHas.js","webpack://Sippo/./node_modules/lodash-es/_SetCache.js","webpack://Sippo/./node_modules/lodash-es/_arraySome.js","webpack://Sippo/./node_modules/lodash-es/_cacheHas.js","webpack://Sippo/./node_modules/lodash-es/_equalArrays.js","webpack://Sippo/./node_modules/lodash-es/_Uint8Array.js","webpack://Sippo/./node_modules/lodash-es/_mapToArray.js","webpack://Sippo/./node_modules/lodash-es/_setToArray.js","webpack://Sippo/./node_modules/lodash-es/_equalByTag.js","webpack://Sippo/./node_modules/lodash-es/_arrayPush.js","webpack://Sippo/./node_modules/lodash-es/isArray.js","webpack://Sippo/./node_modules/lodash-es/_baseGetAllKeys.js","webpack://Sippo/./node_modules/lodash-es/_arrayFilter.js","webpack://Sippo/./node_modules/lodash-es/stubArray.js","webpack://Sippo/./node_modules/lodash-es/_getSymbols.js","webpack://Sippo/./node_modules/lodash-es/_baseTimes.js","webpack://Sippo/./node_modules/lodash-es/isObjectLike.js","webpack://Sippo/./node_modules/lodash-es/_baseIsArguments.js","webpack://Sippo/./node_modules/lodash-es/isArguments.js","webpack://Sippo/./node_modules/lodash-es/_isIndex.js","webpack://Sippo/./node_modules/lodash-es/isLength.js","webpack://Sippo/./node_modules/lodash-es/_baseIsTypedArray.js","webpack://Sippo/./node_modules/lodash-es/_baseUnary.js","webpack://Sippo/./node_modules/lodash-es/isTypedArray.js","webpack://Sippo/./node_modules/lodash-es/_arrayLikeKeys.js","webpack://Sippo/./node_modules/lodash-es/_isPrototype.js","webpack://Sippo/./node_modules/lodash-es/_overArg.js","webpack://Sippo/./node_modules/lodash-es/_nativeKeys.js","webpack://Sippo/./node_modules/lodash-es/_baseKeys.js","webpack://Sippo/./node_modules/lodash-es/isArrayLike.js","webpack://Sippo/./node_modules/lodash-es/keys.js","webpack://Sippo/./node_modules/lodash-es/_getAllKeys.js","webpack://Sippo/./node_modules/lodash-es/_equalObjects.js","webpack://Sippo/./node_modules/lodash-es/_DataView.js","webpack://Sippo/./node_modules/lodash-es/_Promise.js","webpack://Sippo/./node_modules/lodash-es/_Set.js","webpack://Sippo/./node_modules/lodash-es/_WeakMap.js","webpack://Sippo/./node_modules/lodash-es/_getTag.js","webpack://Sippo/./node_modules/lodash-es/_baseIsEqualDeep.js","webpack://Sippo/./node_modules/lodash-es/_baseIsEqual.js","webpack://Sippo/./node_modules/lodash-es/isEqual.js","webpack://Sippo/./src/contacts/ContactSynchronizer.js","webpack://Sippo/./src/contacts/GroupContact.js","webpack://Sippo/./src/contacts/FavoriteContact.js","webpack://Sippo/./src/contacts/ContactManager.js","webpack://Sippo/./src/contacts/ContactFactory.js","webpack://Sippo/./src/file-sharing/FileUpload.js","webpack://Sippo/./src/file-sharing/FileUploadManager.js","webpack://Sippo/./src/file-sharing/FileManager.js","webpack://Sippo/./node_modules/lodash-es/_arrayEach.js","webpack://Sippo/./node_modules/lodash-es/_defineProperty.js","webpack://Sippo/./node_modules/lodash-es/_baseAssignValue.js","webpack://Sippo/./node_modules/lodash-es/_assignValue.js","webpack://Sippo/./node_modules/lodash-es/_copyObject.js","webpack://Sippo/./node_modules/lodash-es/_baseAssign.js","webpack://Sippo/./node_modules/lodash-es/_nativeKeysIn.js","webpack://Sippo/./node_modules/lodash-es/_baseKeysIn.js","webpack://Sippo/./node_modules/lodash-es/keysIn.js","webpack://Sippo/./node_modules/lodash-es/_baseAssignIn.js","webpack://Sippo/./node_modules/lodash-es/_copyArray.js","webpack://Sippo/./node_modules/lodash-es/_copySymbols.js","webpack://Sippo/./node_modules/lodash-es/_getPrototype.js","webpack://Sippo/./node_modules/lodash-es/_getSymbolsIn.js","webpack://Sippo/./node_modules/lodash-es/_copySymbolsIn.js","webpack://Sippo/./node_modules/lodash-es/_getAllKeysIn.js","webpack://Sippo/./node_modules/lodash-es/_initCloneArray.js","webpack://Sippo/./node_modules/lodash-es/_cloneArrayBuffer.js","webpack://Sippo/./node_modules/lodash-es/_cloneDataView.js","webpack://Sippo/./node_modules/lodash-es/_cloneRegExp.js","webpack://Sippo/./node_modules/lodash-es/_cloneSymbol.js","webpack://Sippo/./node_modules/lodash-es/_cloneTypedArray.js","webpack://Sippo/./node_modules/lodash-es/_initCloneByTag.js","webpack://Sippo/./node_modules/lodash-es/_baseCreate.js","webpack://Sippo/./node_modules/lodash-es/_initCloneObject.js","webpack://Sippo/./node_modules/lodash-es/_baseIsMap.js","webpack://Sippo/./node_modules/lodash-es/isMap.js","webpack://Sippo/./node_modules/lodash-es/_baseIsSet.js","webpack://Sippo/./node_modules/lodash-es/isSet.js","webpack://Sippo/./node_modules/lodash-es/_baseClone.js","webpack://Sippo/./node_modules/lodash-es/cloneDeep.js","webpack://Sippo/./node_modules/lodash-es/isSymbol.js","webpack://Sippo/./node_modules/lodash-es/_isKey.js","webpack://Sippo/./node_modules/lodash-es/memoize.js","webpack://Sippo/./node_modules/lodash-es/_memoizeCapped.js","webpack://Sippo/./node_modules/lodash-es/_stringToPath.js","webpack://Sippo/./node_modules/lodash-es/_arrayMap.js","webpack://Sippo/./node_modules/lodash-es/_baseToString.js","webpack://Sippo/./node_modules/lodash-es/toString.js","webpack://Sippo/./node_modules/lodash-es/_castPath.js","webpack://Sippo/./node_modules/lodash-es/_toKey.js","webpack://Sippo/./node_modules/lodash-es/_baseGet.js","webpack://Sippo/./node_modules/lodash-es/_baseSet.js","webpack://Sippo/./node_modules/lodash-es/_basePickBy.js","webpack://Sippo/./node_modules/lodash-es/_baseHasIn.js","webpack://Sippo/./node_modules/lodash-es/_hasPath.js","webpack://Sippo/./node_modules/lodash-es/hasIn.js","webpack://Sippo/./node_modules/lodash-es/_basePick.js","webpack://Sippo/./node_modules/lodash-es/_isFlattenable.js","webpack://Sippo/./node_modules/lodash-es/_baseFlatten.js","webpack://Sippo/./node_modules/lodash-es/flatten.js","webpack://Sippo/./node_modules/lodash-es/_apply.js","webpack://Sippo/./node_modules/lodash-es/_overRest.js","webpack://Sippo/./node_modules/lodash-es/constant.js","webpack://Sippo/./node_modules/lodash-es/identity.js","webpack://Sippo/./node_modules/lodash-es/_baseSetToString.js","webpack://Sippo/./node_modules/lodash-es/_shortOut.js","webpack://Sippo/./node_modules/lodash-es/_setToString.js","webpack://Sippo/./node_modules/lodash-es/_flatRest.js","webpack://Sippo/./node_modules/lodash-es/pick.js","webpack://Sippo/./node_modules/image-capture/src/imagecapture.js","webpack://Sippo/./src/media/StreamRecorderStatus.js","webpack://Sippo/./src/media/StreamRecorder.js","webpack://Sippo/./src/media/ManagedStream.ts","webpack://Sippo/./node_modules/lodash-es/clone.js","webpack://Sippo/./src/media/LocalMediaHandler.ts","webpack://Sippo/./src/calls/CallDirection.js","webpack://Sippo/./src/calls/CallEndReason.js","webpack://Sippo/./src/calls/CallStatus.js","webpack://Sippo/./src/calls/CallRemoteRecorder.js","webpack://Sippo/./src/calls/Call.js","webpack://Sippo/./src/session/RemoteSession.js","webpack://Sippo/./src/calls/RemoteCall.js","webpack://Sippo/./src/calls/CallLogEntry.js","webpack://Sippo/./src/calls/CallLog.js","webpack://Sippo/./src/calls/CallManager.js","webpack://Sippo/./src/conferences/ConferenceEndReason.js","webpack://Sippo/./src/conferences/ConferenceStatus.js","webpack://Sippo/./src/conferences/Invitation.js","webpack://Sippo/./src/wac-proxy/stacks/ConferenceEvents.js","webpack://Sippo/./src/conferences/ConferenceInvite.ts","webpack://Sippo/./src/conferences/Conference.js","webpack://Sippo/./src/conferences/ConferenceLogEntry.js","webpack://Sippo/./src/conferences/ConferenceLog.js","webpack://Sippo/./src/conferences/ConferenceManager.js","webpack://Sippo/./src/groups/Group.js","webpack://Sippo/./src/groups/GroupManager.js","webpack://Sippo/./src/instant-messages/InstantMessageType.js","webpack://Sippo/./src/instant-messages/InstantMessage.js","webpack://Sippo/./src/meetings/Meeting.js","webpack://Sippo/./src/meetings/MeetingManager.js","webpack://Sippo/./src/datapipe/DataPipeStatus.js","webpack://Sippo/./src/datapipe/DataPipe.js","webpack://Sippo/./src/utils/randomHash.js","webpack://Sippo/./src/datapipe/DataPipeType.js","webpack://Sippo/./src/datapipe/WacDataPipe.js","webpack://Sippo/./src/datapipe/DataChannelDataPipe.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/Constants.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/conference-media/ConferenceMediaStream.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/conference-media/ConferenceMediaFeed.js","webpack://Sippo/./node_modules/lodash-es/_baseFindIndex.js","webpack://Sippo/./node_modules/lodash-es/_baseIsNaN.js","webpack://Sippo/./node_modules/lodash-es/_strictIndexOf.js","webpack://Sippo/./node_modules/lodash-es/_baseIndexOf.js","webpack://Sippo/./node_modules/lodash-es/_arrayIncludes.js","webpack://Sippo/./node_modules/lodash-es/_arrayIncludesWith.js","webpack://Sippo/./node_modules/lodash-es/_baseDifference.js","webpack://Sippo/./node_modules/lodash-es/_baseRest.js","webpack://Sippo/./node_modules/lodash-es/isArrayLikeObject.js","webpack://Sippo/./node_modules/lodash-es/without.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/utils.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/conference-media/ConferenceMediaList.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/conference-media/DefaultConferenceStreamHandler.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/hold/HoldableConferenceMediaList.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/api/HoldAPI.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/janus-feeds/JanusEvents.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/janus-feeds/BaseJanusFeedEventHandler.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/api/LoginAPI.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/api/MediaAPI.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/api/UserAPI.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/ServerAddress.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isFunction.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/config.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/hostReportError.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/Observer.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isArray.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isObject.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/UnsubscriptionError.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/Subscription.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/symbol/rxSubscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/Subscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/symbol/observable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/noop.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/pipe.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/Observable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/toSubscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/canReportError.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isPromise.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isArrayLike.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/symbol/iterator.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeToArray.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/fromArray.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeToPromise.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeToIterable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeToObservable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeTo.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/from.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isInteropObservable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/fromObservable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/fromPromise.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isIterable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/fromIterable.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/empty.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/defer.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/operators/map.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/fromEvent.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/isScheduler.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/InnerSubscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/OuterSubscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/operators/mergeMap.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/subscribeToResult.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/identity.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/operators/mergeAll.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/ArgumentOutOfRangeError.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/operators/take.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/SocketIoClient.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/observable/merge.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/operators/filter.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/util/ObjectUnsubscribedError.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/SubjectSubscription.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/node_modules/rxjs/_esm5/internal/Subject.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/WebSocketConnection.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/WebSocketWrapperApi.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/WebSocketClient.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/ClientFactory.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/connection/Client.js","webpack://Sippo/./node_modules/lodash-es/isString.js","webpack://Sippo/./node_modules/lodash-es/_baseProperty.js","webpack://Sippo/./node_modules/lodash-es/_asciiSize.js","webpack://Sippo/./node_modules/lodash-es/_hasUnicode.js","webpack://Sippo/./node_modules/lodash-es/_unicodeSize.js","webpack://Sippo/./node_modules/lodash-es/_stringSize.js","webpack://Sippo/./node_modules/lodash-es/size.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/RTCPeerConnectionAdapter.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/publishers/Publisher.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/publishers/Publishers.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/subscribers/Subscriber.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/subscribers/Subscribers.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/Room.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/JanusHoldableRoom.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/hold/HoldState.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/hold/HeldSubscriptionsState.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/hold/HeldParticipantsState.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/janus-feeds/HoldableJanusFeedEventHandler.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/hold/HoldableRoom.js","webpack://Sippo/./node_modules/@quobis/wrapper-stack/lib/RoomInterface.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/errors.js","webpack://Sippo/./src/wac-proxy/stacks/Media.ts","webpack://Sippo/./src/wac-proxy/stacks/Janus/Conference.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/Conferences.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/Emitter.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/ServerAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/InvitesAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/InviteRequestAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/RegisterAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/CallTransferAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/RoomsAPI.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/signaling/Client.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/Session.js","webpack://Sippo/./src/wac-proxy/stacks/Janus/index.js","webpack://Sippo/./src/wac-proxy/stacks/EventClass.js","webpack://Sippo/./node_modules/lodash-es/difference.js","webpack://Sippo/./node_modules/@quobis/wapi-client/lib/WapiState.js","webpack://Sippo/./node_modules/lodash-es/_baseIsMatch.js","webpack://Sippo/./node_modules/lodash-es/_isStrictComparable.js","webpack://Sippo/./node_modules/lodash-es/_getMatchData.js","webpack://Sippo/./node_modules/lodash-es/_matchesStrictComparable.js","webpack://Sippo/./node_modules/lodash-es/_baseMatches.js","webpack://Sippo/./node_modules/lodash-es/get.js","webpack://Sippo/./node_modules/lodash-es/_baseMatchesProperty.js","webpack://Sippo/./node_modules/lodash-es/_basePropertyDeep.js","webpack://Sippo/./node_modules/lodash-es/property.js","webpack://Sippo/./node_modules/lodash-es/_baseIteratee.js","webpack://Sippo/./node_modules/lodash-es/pickBy.js","webpack://Sippo/./node_modules/@quobis/wapi-client/lib/messages.js","webpack://Sippo/./node_modules/@quobis/wapi-client/lib/options.js","webpack://Sippo/./node_modules/@quobis/wapi-client/lib/RequestMap.js","webpack://Sippo/./node_modules/@quobis/wapi-client/lib/WapiClient.js","webpack://Sippo/./src/wac-proxy/wac-stack/WacRequest.js","webpack://Sippo/./src/wac-proxy/wac-stack/SapiClient.js","webpack://Sippo/./src/wac-proxy/wac-stack/XmppClient.js","webpack://Sippo/./src/wac-proxy/wac-stack/CallAttemptService.js","webpack://Sippo/./src/wac-proxy/wac-stack/CallService.js","webpack://Sippo/./node_modules/lodash-es/noop.js","webpack://Sippo/./node_modules/lodash-es/_createSet.js","webpack://Sippo/./node_modules/lodash-es/_baseUniq.js","webpack://Sippo/./node_modules/lodash-es/union.js","webpack://Sippo/./src/wac-proxy/wac-stack/CapabilitiesService.js","webpack://Sippo/./src/wac-proxy/wac-stack/ConferenceLogService.js","webpack://Sippo/./src/wac-proxy/wac-stack/DatapipeService.js","webpack://Sippo/./src/wac-proxy/wac-stack/FileSharingService.js","webpack://Sippo/./src/wac-proxy/wac-stack/GroupService.js","webpack://Sippo/./src/wac-proxy/wac-stack/MeetingService.js","webpack://Sippo/./src/wac-proxy/wac-stack/PhonebookService.js","webpack://Sippo/./src/wac-proxy/wac-stack/PushNotificationsService.js","webpack://Sippo/./src/wac-proxy/wac-stack/Resolver.js","webpack://Sippo/./src/wac-proxy/wac-stack/call-stats/CallStats.js","webpack://Sippo/./src/wac-proxy/wac-stack/contact/Contact.js","webpack://Sippo/./src/wac-proxy/wac-stack/Thread.js","webpack://Sippo/./src/wac-proxy/wac-stack/credentials/CredentialsThread.js","webpack://Sippo/./src/wac-proxy/wac-stack/credentials/Credentials.js","webpack://Sippo/./src/wac-proxy/wac-stack/EventInterval.ts","webpack://Sippo/./src/wac-proxy/wac-stack/sessions/SessionsThread.ts","webpack://Sippo/./src/wac-proxy/wac-stack/sessions/Sessions.js","webpack://Sippo/./src/wac-proxy/wac-stack/login/Login.js","webpack://Sippo/./src/wac-proxy/wac-stack/presence/Presence.js","webpack://Sippo/./src/wac-proxy/wac-stack/recording/Recording.js","webpack://Sippo/./src/wac-proxy/wac-stack/remote-log/RemoteLog.js","webpack://Sippo/./src/wac-proxy/wac-stack/settings/Settings.js","webpack://Sippo/./src/wac-proxy/wac-stack/user/User.js","webpack://Sippo/./src/wac-proxy/wac-stack/WacStack.js","webpack://Sippo/./src/wac-proxy/CapabilitiesManager.js","webpack://Sippo/./src/wac-proxy/WacProxy.js","webpack://Sippo/./src/contacts/PresenceQueue.js","webpack://Sippo/./src/contacts/PresenceCollection.js","webpack://Sippo/./src/contacts/PresenceManager.js","webpack://Sippo/./src/misc/Selfie.js","webpack://Sippo/./src/session/User.js","webpack://Sippo/./node_modules/d3-selection/src/selector.js","webpack://Sippo/./node_modules/d3-selection/src/selectorAll.js","webpack://Sippo/./node_modules/d3-selection/src/selection/sparse.js","webpack://Sippo/./node_modules/d3-selection/src/selection/enter.js","webpack://Sippo/./node_modules/d3-selection/src/selection/data.js","webpack://Sippo/./node_modules/d3-selection/src/selection/sort.js","webpack://Sippo/./node_modules/d3-selection/src/selection/call.js","webpack://Sippo/./node_modules/d3-selection/src/namespaces.js","webpack://Sippo/./node_modules/d3-selection/src/namespace.js","webpack://Sippo/./node_modules/d3-selection/src/selection/attr.js","webpack://Sippo/./node_modules/d3-selection/src/window.js","webpack://Sippo/./node_modules/d3-selection/src/selection/style.js","webpack://Sippo/./node_modules/d3-selection/src/selection/property.js","webpack://Sippo/./node_modules/d3-selection/src/selection/classed.js","webpack://Sippo/./node_modules/d3-selection/src/selection/text.js","webpack://Sippo/./node_modules/d3-selection/src/selection/html.js","webpack://Sippo/./node_modules/d3-selection/src/selection/raise.js","webpack://Sippo/./node_modules/d3-selection/src/selection/lower.js","webpack://Sippo/./node_modules/d3-selection/src/creator.js","webpack://Sippo/./node_modules/d3-selection/src/selection/insert.js","webpack://Sippo/./node_modules/d3-selection/src/selection/remove.js","webpack://Sippo/./node_modules/d3-selection/src/selection/clone.js","webpack://Sippo/./node_modules/d3-selection/src/selection/on.js","webpack://Sippo/./node_modules/d3-selection/src/selection/dispatch.js","webpack://Sippo/./node_modules/d3-selection/src/selection/index.js","webpack://Sippo/./node_modules/d3-selection/src/selection/select.js","webpack://Sippo/./node_modules/d3-selection/src/selection/selectAll.js","webpack://Sippo/./node_modules/d3-selection/src/selection/filter.js","webpack://Sippo/./node_modules/d3-selection/src/matcher.js","webpack://Sippo/./node_modules/d3-selection/src/constant.js","webpack://Sippo/./node_modules/d3-selection/src/selection/exit.js","webpack://Sippo/./node_modules/d3-selection/src/selection/join.js","webpack://Sippo/./node_modules/d3-selection/src/selection/merge.js","webpack://Sippo/./node_modules/d3-selection/src/selection/order.js","webpack://Sippo/./node_modules/d3-selection/src/selection/nodes.js","webpack://Sippo/./node_modules/d3-selection/src/selection/node.js","webpack://Sippo/./node_modules/d3-selection/src/selection/size.js","webpack://Sippo/./node_modules/d3-selection/src/selection/empty.js","webpack://Sippo/./node_modules/d3-selection/src/selection/each.js","webpack://Sippo/./node_modules/d3-selection/src/selection/append.js","webpack://Sippo/./node_modules/d3-selection/src/selection/datum.js","webpack://Sippo/./node_modules/d3-selection/src/select.js","webpack://Sippo/./node_modules/d3-selection/src/sourceEvent.js","webpack://Sippo/./node_modules/d3-selection/src/point.js","webpack://Sippo/./node_modules/d3-selection/src/mouse.js","webpack://Sippo/./node_modules/d3-dispatch/src/dispatch.js","webpack://Sippo/./node_modules/d3-selection/src/touch.js","webpack://Sippo/./node_modules/d3-drag/src/noevent.js","webpack://Sippo/./node_modules/d3-drag/src/nodrag.js","webpack://Sippo/./node_modules/d3-drag/src/constant.js","webpack://Sippo/./node_modules/d3-drag/src/event.js","webpack://Sippo/./node_modules/d3-drag/src/drag.js","webpack://Sippo/./node_modules/d3-path/src/path.js","webpack://Sippo/./node_modules/d3-shape/src/constant.js","webpack://Sippo/./node_modules/d3-shape/src/curve/linear.js","webpack://Sippo/./node_modules/d3-shape/src/point.js","webpack://Sippo/./src/whiteboard/WhiteboardHistory.js","webpack://Sippo/./src/whiteboard/Whiteboard.js","webpack://Sippo/./node_modules/d3-shape/src/line.js","webpack://Sippo/./node_modules/uuid/dist/esm-browser/rng.js","webpack://Sippo/./node_modules/uuid/dist/esm-browser/bytesToUuid.js","webpack://Sippo/./node_modules/uuid/dist/esm-browser/v4.js","webpack://Sippo/./src/support/SupportService.ts","webpack://Sippo/./src/session/Session.js","webpack://Sippo/./src/datapipe/DataPipeFactory.js","webpack://Sippo/./src/Sippo.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","extendStatics","b","setPrototypeOf","__proto__","Array","__extends","__","this","constructor","__rest","e","indexOf","getOwnPropertySymbols","length","propertyIsEnumerable","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","result","done","then","apply","undefined","isArray","obj","toString","init","_events","_conf","configure","conf","delimiter","_maxListeners","maxListeners","wildcard","newListener","_newListener","removeListener","_removeListener","verboseMemoryLeak","listenerTree","logPossibleMemoryLeak","count","eventName","errorMsg","process","emitWarning","Error","emitter","console","error","trace","EventEmitter","searchListenerTree","handlers","type","tree","leaf","len","branch","xTree","xxTree","isolatedBranch","endReached","listeners","typeLength","currentType","nextType","_listeners","push","concat","growListenerTree","listener","split","slice","shift","warned","EventEmitter2","setMaxListeners","event","once","fn","_once","prependOnceListener","prepend","_many","many","ttl","prependMany","self","off","arguments","_origin","_on","emit","args","j","handler","al","_all","emitAsync","promises","all","on","prependListener","onAny","_onAny","prependAny","addListener","unshift","leafs","iLeaf","position","splice","recursivelyGarbageCollect","keys","Function","offAny","fns","removeAllListeners","eventNames","listenerCount","listenersAny","TABLE_DATA","Table","points","singles","Set","ranges","mappings","Map","data","map","parseInt","start","end","point","mapping","mappedPoints","codePoint","has","left","right","pivot","Math","floor","range","contains","String","fromCodePoint","toLowerCase","codePointAt","A1","B1","B2","C11","C12","C21","C22","C3","C4","C5","C6","C7","C8","C9","D1","D2","prepare","profile","allowUnassigned","input","inputCodePoints","ucs2","decode","mappedCodePoints","unassigned","hasMapping","mappingTable","mappedPoint","normalizedCodePoints","normalize","normalizedString","encode","hasRandALCat","hasLCat","prohibited","bidirectional","NamePrepProfile","NodePrepProhibited","NodePrepProfile","ResourcePrepProfile","opts","localPart","local","escaped","escapeLocal","prep","prepared","prepare$1","domain","resource","bareJID","str","nodeprep","resourceprep","nameprep","toUnicode","join","parse","jid","resourceStart","localEnd","prepped","bare","full","unescapeLocal","allowedResponders","jid1","jid2","allowed","add","split1","split2","equalBare","parsed1","parsed2","isFull","getDomain","getResource","toBare","val","replace","JXTErrorCondition","JID","freeze","equal","isBare","getLocal","parseURI","parsed","URL","protocol","identity","hostname","username","decodeURIComponent","pathname","substr","hasParameters","search","parameterString","action","params","token","existing","parameters","toURI","parts","pushJID","allowResource","res","encodeURIComponent","values","entries","JXTError","super","text","isJXTError","condition","NotWellFormed","RestrictedXML","AlreadyClosed","UnknownRoot","ESCAPE_XML_CHAR","UNESCAPE_XML_CHAR","ESCAPE_SEQUENCE","NEED_ESCAPING","NEED_ESCAPING_TEXT","escapeXMLReplaceChar","match","escapeXML","unescapeXML","hex","startsWith","code","substring","restrictedXML","unescapeXMLReplaceChar","escapeXMLText","basicLanguageResolver","available","accept","current","avail","a","acceptLang","lastIndexOf","XMLElement","attrs","children","attributes","optionalNamespaces","child","xmlChild","parent","prefix","findNamespaceForPrefix","namespaces","getNamespaceContext","attr","xmlns","getDefaultNamespace","namespace","parentRoot","getNamespaceRoot","getChildren","getName","getNamespace","force","setAttribute","toJSON","filter","output","openTag","closeTag","allowSelfClose","ALLOWED_ELEMENTS","style","ALLOWED_ATTRIBUTES","CSS_RULES","sanitizeURL","url","sanitizeNumber","num","ATTRIBUTE_SANITIZERS","alt","height","href","src","css","declarations","_","x","fromCharCode","rules","declaration","sanitizer","width","sanitizeRoot","sanitized","sanitizeInterior","results","stripElement","isPrintable","isWhitespace","parse$1","Parser","element","appendChild","notWellFormed","write","allowComments","endTag","recordStart","state","haveDeclaration","pos","remainder","remainderPos","charCodeAt","endRecording","unescaped","err","lookBehindMatch","commentLookAhead","lookAheadMatch","waitForData","cdataLookAhead","xmlLookAhead","tagName","handleTagOpening","selfClosing","attributeName","attributeQuote","recorded","lowercase","needed","lookahead","createElement","parentNamespace","useNamespace","el","getLang","xml","lang","getAttribute","getTargetLang","context","availableLanguages","targetLanguage","resolveLanguage","acceptLanguages","findAll","parentLang","findOrCreate","created","createAttributeField","rawValue","parseValue","dynamicDefault","staticDefault","writeValue","emitEmpty","createAttributeType","parser","createOpts","defaultValue","assign","createNamespacedAttributeType","createChildAttributeField","converter","attributeNamespace","getChild","importer","exporter","createChildAttributeType","createTextField","getText","createChildTextField","matchLanguage","stringParser","v","integerParser","floatParser","parseFloat","boolParser","dateParser","Date","toISOString","jsonParser","JSON","stringify","bufferParser","encoding","Buffer","from","trim","tzOffsetParser","sign","charAt","formatted","hours","minutes","attribute","booleanAttribute","integerAttribute","dateAttribute","namespacedAttribute","namespacedBooleanAttribute","childAttribute","childBooleanAttribute","childIntegerAttribute","childDateAttribute","textJSON","textBuffer","languageAttribute","childText","childTextBuffer","childDate","childInteger","childFloat","childJSON","childTimezoneOffset","childBoolean","deepChildExpoter","path","node","deepChildText","deepChildInteger","deepChildBoolean","childEnum","elements","elementNames","valueNames","set","childDoubleEnum","parentElements","childElements","parentNames","childNames","multipleChildText","multipleChildAttribute","childAttr","multipleChildIntegerAttribute","childAlternateLanguageText","seenLanuages","langText","size","entry","multipleChildEnum","splicePath","multiple","grandChild","registry","getImportKey","imported","import","export","skipChild","staticValue","childLanguageRawElement","sanitizers","rawElement","childAlternateLanguageRawElement","parameterMap","keyName","valueName","keyImporter","valueImporter","param","keyExporter","valueExporter","paramEl","Translator","parents","placeholder","typeField","defaultType","languageField","typeValues","typeOrders","importers","exporters","childrenIndex","implicitChildren","contexts","translator","selector","implicit","existingChild","xid","updateDefinition","exporterOrdering","importerOrdering","fieldOrders","fields","exportType","field","implied","impliedType","fieldName","fieldImporter","order","fieldExporter","newContext","xid2","typeOrder","imp","exp","replacement","parentContext","typeValue","pathSelector","impliedTypeValue","importFields","sort","preChildren","postChildren","importField","childName","childOutput","resolveCollision","addOptionalNamespace","langExporter","key1","key2","childTranslator","items","item","existingData","newData","Registry","languageResolver","translators","resolver","hasTranslator","xhtmlim","getOrCreateTranslator","nextTranslator","walkToTranslator","defs","def","definition","aliases","includes","alias","aLen","indexTranslator","importOrder","exportOrder","childrenExportOrder","link","contextField","replaceWith","contextType","contextImpliedType","linkedTranslator","finalKey","pop","addContext","addChild","vivify","NS_BIND","NS_CLIENT","NS_SASL","NS_SESSION","NS_STANZAS","NS_STREAM","NS_STREAMS","NS_STARTTLS","NS_FRAMING","NS_DATAFORM","NS_PRIVACY","NS_DISCO_INFO","NS_DISCO_ITEMS","NS_ADDRESS","NS_MUC","NS_MUC_ADMIN","NS_MUC_OWNER","NS_MUC_USER","NS_IBB","NS_ADHOC_COMMANDS","NS_RSM","NS_PUBSUB","NS_PUBSUB_ERRORS","NS_PUBSUB_EVENT","NS_PUBSUB_OWNER","NS_SOCKS5","NS_OOB","NS_XHTML","NS_XHTML_IM","NS_GEOLOC","NS_AVATAR_DATA","NS_AVATAR_METADATA","NS_CHAT_STATES","NS_MOOD","NS_ACTIVITY","NS_TUNE","NS_DATAFORM_VALIDATION","NS_BOSH","NS_SHIM","NS_COMPRESSION","NS_DATAFORM_LAYOUT","NS_ROSTER_EXCHANGE","NS_PEP_NOTIFY","NS_JINGLE_1","NS_JINGLE_RTP_1","NS_JINGLE_RTP_INFO_1","NS_NICK","NS_JINGLE_ICE_UDP_1","NS_JINGLE_RAW_UDP_1","NS_SMACKS_3","NS_DELAY","NS_BOB","NS_JINGLE_FILE_TRANSFER_5","NS_JINGLE_XML_0","NS_JINGLE_SOCKS5_1","NS_JINGLE_IBB_1","NS_CARBONS_2","NS_JINGLE_RTP_RTCP_FB_0","NS_JINGLE_RTP_HDREXT_0","NS_FORWARD_0","NS_HASHES_2","NS_HASH_NAME","NS_RTT_0","NS_MAM_2","NS_HATS_0","NS_CHAT_MARKERS_0","NS_HINTS","NS_JSON_0","NS_JINGLE_RTP_SSMA_0","NS_PUSH_0","NS_HTTP_UPLOAD_0","NS_JINGLE_ICE_0","NS_OMEMO_AXOLOTL","NS_XRD","JIDAttribute","childJIDAttribute","addAlias","extendMessage","extendPresence","extendIQ","extendStreamFeatures","extendStanzaError","StreamParser","objectMode","closedStream","wrappedStream","rootImportKey","rootKey","destroy","destroyed","alreadyClosed","rootElement","unknownRoot","kind","stanza","currentElement","chunk","Hash","blockSize","finalSize","endian","_block","alloc","_finalSize","_blockSize","_bigEndian","_len","callback","update","digest","enc","block","accum","offset","assigned","min","_update","rem","fill","bits","writeUInt32BE","writeUInt32LE","lowBits","highBits","hash","_hash","rotl","fnF","k","fnG","fnH","fnI","K","rotl5","rotl30","ft","Sha1","_a","_b","_c","_d","_e","_w","M","W","readInt32BE","H","allocUnsafe","writeInt32BE","K$1","ch","y","z","maj","sigma0","sigma1","gamma0","Sha256","_f","_g","_h","f","g","h","T1","T2","K$2","Ch","maj$1","sigma0$1","xl","sigma1$1","Gamma0","Gamma0l","Gamma1","Gamma1l","getCarry","Sha512","_ah","_bh","_ch","_dh","_eh","_fh","_gh","_hh","_al","_bl","_cl","_dl","_el","_fl","_gl","_hl","Wih","Wil","ah","bh","dh","eh","fh","gh","hh","bl","cl","dl","fl","gl","hl","xh","gamma0l","gamma1","gamma1l","Wi7h","Wi7l","Wi16h","Wi16l","majh","majl","sigma0h","sigma0l","sigma1h","sigma1l","Kih","Kil","chh","chl","t1l","t1h","t2l","t2h","writeInt64BE","HASH_IMPLEMENTATIONS","_m","B","readInt32LE","writeInt32LE","createHash","alg","HashImp","ZEROS","Hmac","blocksize","_alg","_ipad","_opad","_final","inputEnc","outputEnc","outData","randomBytes","rawBytes","Uint8Array","crypto","msCrypto","getRandomValues","buffer","global","nativeFetch","fetch","nativeWS","WebSocket","SimpleMech","authenticated","mutuallyAuthenticated","challenge","success","processChallenge","Factory","mechanisms","priority","toUpperCase","mechName","mech","names","availableNames","knownMech","availableMechName","XOR","HMAC","msg","createHmac","createClientNonce","parse$2","directives","tokens","directive","exec","ANONYMOUS","optional","required","credentials","EXTERNAL","authzid","PLAIN","password","OAUTH","DIGEST","providesMutualAuthentication","rspauth","realm","nonce","charset","uri","serviceType","host","serviceName","cnonce","clientNonce","nc","base","ha1","dha1","dha2","SCRAM","useChannelBinding","endsWith","algorithm","cache","initialResponse","challengeResponse","salt","iterationCount","verifier","serverSignature","escapeUsername","cbindHeader","tlsUnique","gs2Header","clientFirstMessageBare","CLIENT_KEY","SERVER_KEY","cbindData","clientFinalMessageWithoutProof","saltedPassword","clientKey","serverKey","cached","compare","iterations","ui1","ui","Hi","storedKey","separator","authMessage","clientProof","curr","Account","client","getAccountInfo","sendIQ","account","to","updateAccount","deleteAccount","remove","getPrivateData","privateStorage","setPrivateData","getVCard","vcard","format","publishVCard","enableNotifications","fieldList","form","disableNotifications","Avatar","disco","addFeature","pubsub","info","published","content","avatars","versions","source","pres","vcardAvatar","id","publishAvatar","publish","itemType","useAvatars","pointers","getAvatar","getItem","Bind","registerFeature","features","cb","resp","config","negotiated","canStartSession","legacySession","sessionStarted","session","boundJID","Command","addItem","getCommands","getDiscoItems","bth","timeoutPromise","target","delay","rejectValue","timeoutRef","race","setTimeout","clearTimeout","sleep","time","octetCompare","str1","str2","b1","b2","uuid","buf","ISO_DT","Utils","reviveData","test","sendCSI","clientStateIndication","send","Connection","iq","sendIQResult","disableKeepAlive","streamManagement","markActive","markInactive","ping","enableKeepAlive","interval","timeout","_keepAliveInterval","setInterval","sm","started","request","checkConnection","transport","hasStream","disconnect","clearInterval","smacks","useStreamManagement","smHandler","enabled","resumed","failed","allowResume","resume","enable","escape","encodeFields","sortedFields","rawValues","generate","hashName","S","append","identities","category","encoded","encodeIdentities","feature","encodeFeatures","extensions","forms","types","encodeForms","version","padding","Disco","capsAlgorithms","caps","algorithms","delete","hashedNode","addIdentity","addExtension","Disco$1","server","legacyCapabilities","getDiscoInfo","updateCaps","capsNode","getCurrentCaps","getCaps","getNodeInfo","StreamType","Bosh","Client","Component","Server","SASLFailureCondition","AccountDisabled","CredentialsExpired","EncryptionRequired","IncorrectEncoding","InvalidAuthzid","InvalidMechanism","MalformedRequest","MechanismTooWeak","NotAuthorized","TemporaryAuthFailure","StreamErrorCondition","BadFormat","BadNamespacePrefix","Conflict","ConnectionTimeout","HostGone","HostUnknown","ImproperAddressing","InternalServerError","InvalidFrom","InvalidId","InvalidNamespace","InvalidXML","PolicyViolation","RemoteConnectionFailed","Reset","ResourceConstraint","SeeOtherHost","SystemShutdown","UndefinedCondition","UnsupportedEncoding","UnsupportedStanzaType","UnsupportedVersion","StanzaErrorCondition","BadRequest","FeatureNotImplemented","Forbidden","Gone","ItemNotFound","JIDMalformed","NotAcceptable","NotAllowed","RecipientUnavailable","Redirect","RegistrationRequired","RemoteServerNotFound","RemoteServerTimeout","ServiceUnavailable","SubscriptionRequired","UnexpectedRequest","DataFormFieldType","Boolean","Fixed","Hidden","JIDMultiple","List","ListMultiple","Password","Text","TextMultiple","TextPrivate","MUCStatusCode","AffiliationChanged","AffiliationLost","Banned","Kicked","LoggingDisabled","LoggingEnabled","MembershipLost","NickChanged","NickChangedByService","NonAnonymous","NonAnonymousRoom","NonPrivacyConfigurationChange","RoomCreated","SelfPresence","SemiAnonymous","Shutdown","UnavailableMembersListed","UnavailableMembersNotListed","PubsubErrorCondition","ClosedNode","ConfigurationRequired","InvalidJID","InvalidOptions","InvalidPayload","InvalidSubscriptionId","ItemForbidden","ItemRequired","JIDRequired","MaxItemsExceeded","MaxNodesExceeded","NodeIdRequired","NotInRosterGroup","NotSubscribed","PayloadRequired","PayloadTooBig","PendingSubscription","PresenceSubscriptionRequired","SubscriptionIdRequired","TooManySubscriptions","Unsupported","UnsupportedAccessModel","ChatState","Active","Composing","Inactive","Paused","JingleSessionRole","Initiator","Responder","JingleApplicationDirection","Receive","Send","SendReceive","JingleContentSenders","Both","None","JingleAction","ContentAccept","ContentAdd","ContentModify","ContentReject","ContentRemove","DescriptionInfo","SecurityInfo","SessionAccept","SessionInfo","SessionInitiate","SessionTerminate","TransportAccept","TransportInfo","TransportReject","TransportReplace","JingleErrorCondition","OutOfOrder","TieBreak","UnknownContent","UnknownSession","UnsupportedInfo","JingleReasonCondition","AlternativeSession","Busy","Cancel","ConnectivityError","Decline","Expired","FailedApplication","FailedTransport","GeneralError","IncompatibleParameters","MediaError","SecurityError","Success","Timeout","UnsupportedApplications","UnsupportedTransports","USER_MOODS","USER_ACTIVITY_GENERAL","USER_ACTIVITY_SPECIFIC","JINGLE_INFO","JINGLE_INFO_MUTE","JINGLE_INFO_UNMUTE","JINGLE_INFO_HOLD","JINGLE_INFO_UNHOLD","JINGLE_INFO_ACTIVE","JINGLE_INFO_RINGING","JINGLE_INFO_CHECKSUM_5","toList","sendersToDirection","role","senders","isInitiator","directionToSenders","direction","Entity","softwareVersion","tzo","getTimezoneOffset","utc","getSoftwareVersion","getTime","getLastActivity","lastActivity","Features","series","command","message","cmd","restart","getHostMeta","json","ssl","xrd","scheme","errors","promiseAny","ok","HostMeta","stanzas","discoverBindings","bosh","websocket","links","rel","importFromSDP","sdp","mediaSections","sessionPart","groups","media","groupLine","semantics","mids","mediaSection","isRejected$1","mLine","mid","iceParameters","dtlsParameters","setup","rtpParameters","rtpEncodingParameters","rtcpParameters","msid","streams","sctp","candidates","exportToSDP","sessionId","sessionVersion","iceLite","group","isRejected","mline","stream","track","cname","ssrc","rtx","candidate","convertIntermediateToApplication","rtp","rtcp","encodingParameters","hasSSRC","application","applicationType","codecs","headerExtensions","rtcpMux","mux","rtcpReducedSize","reducedSize","sourceGroups","sources","ext","codec","payload","channels","clockRate","payloadType","maxptime","rtcpFeedback","ptime","convertIntermediateToCandidate","component","foundation","generation","ip","network","port","relatedAddress","relatedPort","tcpType","convertIntermediateToTransport","transportType","ice","dtls","usernameFragment","fingerprints","fingerprint","convertIntermediateToRequest","contents","creator","convertContentToIntermediate","isRTP","fecMechanisms","fb","parameter","numChannels","convertRequestToIntermediate","jingle","badRequest","unsupportedInfo","jingleError","JingleSession","sid","peerID","initiator","_sessionState","_connectionState","pendingApplicationTypes","applicationTypes","pendingAction","processingQueue","task","_log","changes","onContentAccept","onContentAdd","onContentModify","onContentReject","onContentRemove","onDescriptionInfo","onSecurityInfo","onSessionAccept","onSessionInfo","onSessionInitiate","onSessionTerminate","onTransportAccept","onTransportInfo","onTransportReject","onTransportReplace","signal","reason","silent","kill","forgetSession","level","ICESession","pc","RTCPeerConnection","iceServers","constraints","addEventListener","onIceStateChange","onIceCandidate","onIceEndOfCandidates","restrictRelayBandwidth","bitrateLimit","maxRelayBandwidth","candidateBuffer","restartingIce","close","_maybeRestartingIce","processLocal","offer","createOffer","iceRestart","setLocalDescription","maximumBitrate","currentBitrate","RTCRtpSender","sender","getSenders","find","browser","navigator","mozGetUserMedia","webkitGetUserMedia","getParameters","encodings","maxBitrate","setParameters","signalingState","localDescription","setRemoteDescription","remoteDescription","processBufferedCandidates","answer","createAnswer","gatheringComplete","addIceCandidate","remoteJSON","currentUsernameFragment","remoteUsernameFragment","forEach","idx","sdpMid","address","convertCandidateToIntermediate","sdpMLineIndex","remoteSDP","peerRole","convertIntermediateToTransportInfo","firstMedia","iceConnectionState","connectionState","maybeRestartIce","restartIce","_firstTimeConnected","stats","getStats","activeCandidatePair","report","selectedCandidatePairId","selected","isRelay","remoteCandidateId","remoteCandidate","candidateType","localCandidateId","localCandidate","setMaximumBitrate","Sender","chunkSize","file","channel","binaryType","fileReader","FileReader","pendingRead","byteLength","bufferedAmount","bufferedAmountLowThreshold","sliceFile","readAsArrayBuffer","onbufferedamountlow","Receiver","receiveBuffer","received","metadata","onmessage","actualhash","Blob","FileTransferSession","receiver","sent","meta","hashes","infoType","contentName","createDataChannel","ordered","onopen","offerToReceiveAudio","offerToReceiveVideo","date","lastModified","hashesUsed","desc","receivedFile","_maybeReceivedFile","receive","applyStreamsCompatibility","MediaSession","_ringing","onAddTrack","getTracks","addTrack","getRemoteStreams","offerOptions","getReceivers","onRemoveTrack","ringing","addStream","removeTrack","SessionManager","selfID","sessions","peers","urls","prepareSession","performTieBreak","sess","req","appType","debug","peerConnectionConfig","bundlePolicy","iceTransportPolicy","rtcpMuxPolicy","sdpSemantics","peerConnectionConstraints","DtlsSrtpKeyAgreement","RtpDataChannels","peer","addSession","endPeerSessions","rid","isTieBreak","transportTypes","_sendError","_createIncomingSession","root$1","Jingle","cap","mappedEvents","sendIQError","getServices","services","externalServices","getServiceCredentials","externalServiceCredentials","discoverICEServers","discovered","service","baseUrl","credential","addICEServer","MAM","getHistorySearchForm","archive","searchHistory","jidOrOpts","queryid","nextId","queryId","defaultFields","with","original","updated","merged","mappedUpdates","usedUpdates","mergeFields","collector","getHistoryPreferences","setHistoryPreferences","ACK_TYPES","ALLOWED_CHAT_STATE_TYPES","isMarkable","marker","chatMarkers","toggleCarbons","carbons","sendMarker","sendMessage","body","Messaging","enableCarbons","disableCarbons","markReceived","markDisplayed","markAcknowledged","getAttention","requestingAttention","carbon","forwardedMessage","forward","timestamp","now","isReceivedCarbon","isSentCarbon","isFormsMessage","rtt","hasRTT","isCorrection","chatState","isChatState","receipt","isReceiptMessage","sendReceipts","MUC","rejoinRooms","oldJoiningRooms","joiningRooms","room","nick","joinRoom","oldJoinedRooms","joinedRooms","hasSubject","topic","subject","muc","invite","legacyMUC","thread","decline","isMUCPresence","isSelf","statusCodes","newRoom","sendPresence","leaveRoom","ban","occupantRealJID","setRoomAffiliation","kick","setRoomRole","directInvite","declineInvite","changeNick","setSubject","getReservedNick","requestRoomVoice","affiliation","users","getRoomMembers","getRoomConfig","configureRoom","destroyRoom","getUniqueRoomName","mucHost","getBookmarks","rooms","setBookmarks","bookmarks","addBookmark","bookmark","mucs","updatedExisting","removeBookmark","PEP","publishActivity","publishGeoLoc","publishMood","mood","publishNick","publishTune","tune","activity","geoloc","PubSub","affiliations","isPubsubAffiliation","isPubsubMessage","isPubsubPublish","retracted","isPubsubRetract","eventType","isPubsubPurge","isPubsubDelete","isPubsubSubscription","isPubsubConfiguration","subscribeToNode","subscribe","useBareJID","options","subscriptionOptions","sub","subscription","unsubscribeFromNode","unsubscribe","subid","getItems","max","paging","retract","notify","purgeNode","purge","deleteNode","redirect","createNode","getSubscriptions","subscriptions","getAffiliations","getNodeSubscribers","updateNodeSubscriptions","delta","getNodeAffiliations","updateNodeAffiliations","getNodeConfig","getDefaultNodeConfig","defaultConfiguration","configureNode","getDefaultSubscriptionOptions","defaultSubscriptionOptions","Roster","toggleBlock","blockList","jids","getRoster","roster","rosterVer","updateRosterItem","removeRosterItem","acceptSubscription","denySubscription","getBlocked","unblock","goInvisible","probe","visiblity","goVisible","SASL","sasl","createMechanism","saslHandler","getCredentials","createResponse","cacheable","getCacheableCredentials","mechanism","Sharing","getUploadParameters","maxSize","some","sizeField","getBits","cid","getUploadService","domainParameters","itemParameters","getUploadSlot","uploadService","uploadRequest","httpUpload","core","use","Plugins","Protocol","_Stream","_StreamFeatures","_StreamError","alternateLanguageText","seeOtherHost","_StanzaError","streamNS","by","gone","baseIQFields","_IQ","_Message","_Presence","Protocol$1","Protocol$2","rosterPreApproval","rosterVersioning","alternateLanguageBodies","alternateLanguageSubjects","parentThread","alternateLanguageStatuses","show","status","pending","preApproved","Protocol$3","seeOtherURI","Protocol$4","instructions","reported","title","xdv","description","label","fieldType","singleValue","outputData","rawData","listMax","listMin","method","rangeMax","rangeMin","regex","Protocol$5","seconds","Protocol$6","activeList","defaultList","incomingPresence","messages","outgoingPresence","Protocol$7","Protocol$8","addresses","alternateLanguageDescriptions","delivered","Protocol$9","maxCharacters","maxStanzas","since","actor","continue","legacyReason","out","confElement","Protocol$a","ack","seq","Protocol$b","autoJoin","Protocol$c","Protocol$d","commandError","complete","execute","prev","vcardField","Protocol$e","fullName","additional","family","given","suffix","preferred","units","city","country","pobox","region","street","street2","lines","mediaType","Protocol$f","email","familyName","givenName","Protocol$g","after","before","first","firstIndex","index","last","SubscriptionFields","configurable","configurationRequired","NodeOnlyField","Protocol$h","publishOptions","pubsubError","pubsubUnsupportedFeature","publisher","expires","Protocol$i","activate","candidateUsed","udpSuccess","Protocol$j","Protocol$k","Protocol$l","inbandRegistration","locality","misc","phone","postalCode","registered","Protocol$m","accuracy","altitude","altitudeAccuracy","area","building","countryCode","datum","heading","latitude","longitude","speed","Protocol$n","bytes","XEP0085","Protocol$o","os","Protocol$p","Protocol$q","Protocol$r","Protocol$s","legacy","Protocol$t","artist","rating","Protocol$u","typeImporter","subtypeImporter","typeExporter","subtypeExporter","path$1","Protocol$19","acceptMediaTypes","authId","characterSets","maxClientRequests","maxHoldOpen","maxInactivityTime","maxSessionPause","maxWaitTime","minPollingInterval","newKey","pauseSession","route","xmppRestart","xmppRestartLogic","xmppVersion","headers","methods","rosterExchange","photo","captcha","responder","disposition","alternativeSession","encryption","rtcpf","rtph","cryptoSuite","keyParameters","sessionParameters","tag","blocked","handled","allowResumption","previousSession","restricuted","maxAge","activated","candidateError","proxyError","duration","stable","default","hats","idleSince","processingHints","found","noCopy","noPermanentStore","noStore","store","originId","httpUploadError","httpUploadMaxFileSize","httpUploadRetry","download","iv","preKey","devices","identityKey","preKeys","signedPreKeySignature","MAX_SEQ","pow","mod","StreamManagement","lastAck","windowSize","unacked","pendingAck","inboundStarted","outboundStarted","cacheHandler","_reset","_cache","resend","numAcked","resendUnacked","needAck","BOSHConnection","maxRequests","sendBuffer","requests","lastResponseTime","pollingInterval","longPoll","maxRetries","ceil","random","wait","clear","dataOrName","canReceive","canSend","payloads","respBody","allowedRetries","attempt","retryRequest","streamError","closing","idleTimeout","WSConnection","sendQueue","conn","readyState","stanzaObj","onerror","preventDefault","onclose","startHeader","wsMsg","closeHeader","_initConfig","register","transports","handle","iqType","iqEvent","isChat","isMarker","presType","pluginInit","_getConfiguredCredentials","transportPref","endpoints","connect","respEvent","reply","creds","requestedJID","currConfig","createClient","logHandler","Logger","VERSION","contextualLoggersByNameMap","scope","func","merge","defineLogLevel","TRACE","DEBUG","INFO","TIME","WARN","ERROR","OFF","ContextualLogger","defaultContext","setLevel","filterLevel","log","newLevel","getLevel","enabledFor","lvl","invoke","warn","timeEnd","msgArgs","L","globalLogger","setHandler","createDefaultHandler","formatter","timerStartTimeByLabelMap","invokeConsoleMethod","hdlr","timerLabel","useDefaults","defaultLevel","SDPUtils","localCName","generateIdentifier","splitLines","blob","line","splitSections","part","getDescription","sections","getMediaSections","matchPrefix","parseCandidate","ufrag","writeCandidate","parseIceOptions","parseRtpMap","writeRtpMap","pt","preferredPayloadType","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","parseSsrcGroup","ssrcs","getMid","parseFingerprint","getDtlsParameters","sessionpart","writeDtlsParameters","setupType","fp","getIceParameters","writeIceParameters","parseRtpParameters","rtpmapline","fmtps","writeRtpDescription","extension","parseRtpEncodingParameters","secondarySsrc","hasRed","hasUlpfec","primarySsrc","flows","apt","encParam","codecPayloadType","fec","bandwidth","parseRtcpParameters","remoteSsrc","rsize","compound","parseMsid","spec","planB","msidParts","parseSctpDescription","maxMessageSize","parseMLine","maxSizeLine","isNaN","sctpPort","fmt","writeSctpDescription","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","writeMediaSection","transceiver","iceGatherer","getLocalParameters","dtlsTransport","rtpSender","rtpReceiver","sendEncodingParameters","getDirection","getKind","parseOLine","netType","addressType","isValidSDP","freeSelf","detect","ua","getFirstMatch","getSecondMatch","iosdevice","android","nexusMobile","nexusTablet","chromeos","silk","sailfish","tizen","webos","windowsphone","windows","mac","linux","edgeVersion","versionIdentifier","tablet","mobile","xbox","opera","samsungBrowser","whale","mzbrowser","coast","focus","yandexbrowser","ucbrowser","maxthon","epiphany","puffin","sleipnir","kMeleon","osname","msedge","msie","chromeBook","chrome","vivaldi","seamonkey","firefox","firefoxos","phantom","slimer","blackberry","touchpad","bada","qupzilla","chromium","safari","googlebot","blink","webkit","gecko","ios","osVersion","getWindowsVersion","osversion","osMajorVersion","compareVersions","bowser","userAgent","getVersionPrecision","arr","iterator","precision","chunks","reverse","isUnsupportedBrowser","minVersions","strictMode","_bowser","browserList","browserItem","check","_detect","nodeType","freeGlobal","punycode","maxInt","regexPunycode","regexNonASCII","regexSeparators","stringFromCharCode","RangeError","array","mapDomain","string","ucs2decode","extra","counter","ucs2encode","digitToBasic","digit","flag","adapt","numPoints","firstTime","baseMinusTMin","basic","oldi","w","baseMinusT","inputLength","bias","handledCPCount","basicLength","q","currentValue","handledCPCountPlusOne","qMinusT","Events","EE","TypeError","evt","_eventsCount","clearEvent","events","ee","a1","a2","a3","a4","a5","prefixed","base64","ieee754","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","arg","encodingOrOffset","ArrayBuffer","byteOffset","fromArrayLike","fromArrayBuffer","isEncoding","actual","fromString","isBuffer","checked","copy","fromObject","assertSize","isView","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","dir","arrayIndexOf","indexSize","arrLength","valLength","read","readUInt16BE","foundIndex","hexWrite","Number","remaining","strLen","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","hi","lo","utf16leToBytes","fromByteArray","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","INSPECT_MAX_BYTES","foo","subarray","typedArraySupport","poolSize","_augment","species","allocUnsafeSlow","_isBuffer","list","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","isFinite","_arr","ret","toHex","checkOffset","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","readIntBE","readInt8","readInt16LE","readInt16BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeIntLE","limit","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","stringtrim","base64clean","dst","freeExports","freeModule","freeProcess","nodeUtil","require","binding","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","run","runClearTimeout","Item","noop","nextTick","env","argv","cwd","chdir","umask","formatArgs","useColors","humanize","diff","color","lastC","save","storage","setItem","removeItem","load","__nwjs","document","documentElement","WebkitAppearance","firebug","exception","table","RegExp","$1","localStorage","localstorage","colors","formatters","ReflectOwnKeys","R","Reflect","ReflectApply","ownKeys","getOwnPropertyNames","NumberIsNaN","defaultMaxListeners","checkListener","_getMaxListeners","_addListener","warning","onceWrapper","fired","wrapFn","_onceWrap","wrapped","unwrap","evlistener","unwrapListeners","arrayClone","getPrototypeOf","getMaxListeners","doError","er","originalListener","spliceOne","rawListeners","strictUriEncode","objectAssign","strict","extract","arrayFormat","accumulator","parserForArrayFormat","reduce","keysSorter","encoderForArrayFormat","val2","Stream","Readable","Writable","Duplex","Transform","PassThrough","pna","objectKeys","util","inherits","readable","writable","allowHalfOpen","onend","_writableState","ended","onEndNT","highWaterMark","_readableState","_destroy","Emitter","mixin","_callbacks","removeEventListener","callbacks","hasListeners","base64encoder","hasBinary","sliceBuffer","utf8","isAndroid","isPhantomJS","dontSendBlobs","packets","open","pong","upgrade","packetslist","ary","each","eachWithIndex","encodePacket","packet","supportsBinary","utf8encode","encodeBase64Packet","contentArray","resultBuffer","encodeArrayBuffer","fr","onload","encodeBlobAsArrayBuffer","encodeBlob","encodeBase64Object","b64data","b64","readAsDataURL","typed","btoa","decodePacket","utf8decode","decodeBase64Packet","tryDecode","rest","encodePayload","isBinary","encodePayloadAsBlob","encodePayloadAsArrayBuffer","doneCallback","setLengthHeader","decodePayload","decodePayloadAsBinary","chr","encodedPackets","totalLength","acc","resultArray","bufferIndex","isString","ab","view","lenStr","binaryIdentifier","lengthAry","bufferTail","buffers","tailArray","msgLength","total","objectToString","isBoolean","isNull","isNullOrUndefined","isNumber","isSymbol","isUndefined","isRegExp","re","isObject","isDate","isError","isFunction","isPrimitive","ctor","superCtor","super_","TempCtor","arg1","arg2","arg3","qs","qry","pairs","pair","Manager","lookup","managers","io","sameNamespace","nsps","forceNew","multiplex","query","socket","Socket","isWebSocket","CLOSING","bypassProperty","initReconnectionDelay","minReconnectionDelay","LEVEL_0_EVENTS","ReconnectingWebsocket","protocols","ws","connectingTimeout","_this","reconnectDelay","retriesCount","shouldRetry","savedOnClose","maxReconnectionDelay","reconnectionDelayGrowFactor","connectionTimeout","_i","emitError","handleClose","previousDelay","newDelay","updateReconnectionDelay","oldWs","wsUrl","reassignEventListeners","keepClosed","fastClose","fakeCloseEvent_1","wasClean","initialParams","hasSetImmediate","setImmediate","hasNextTick","fallback","wrap","defer","setImmediate$1","asyncify","isAsync","handlePromise","promise","invokeCallback","wrapAsync","asyncFn","awaitify","arity","awaitable","cbArgs","applyEach","eachfn","callArgs","_asyncMap","iteratee","_iteratee","iterCb","isArrayLike","breakLoop","wrapper","callFn","createIterator","coll","createArrayIterator","okeys","getIterator","createES2015Iterator","onlyOnce","asyncEachOfLimit","canceled","awaiting","running","replenish","iterDone","iterateeCallback","catch","handleError","eachOfLimit","asyncIterator","isAsyncIterable","nextElem","looping","elem","eachOfLimit$2","eachOfArrayLike","completed","iteratorCallback","eachOfGeneric","eachOf$1","map$1","eachOfSeries$1","mapSeries$1","DLL","head","tail","newNode","insertBefore","setInitial","insertAfter","removeLink","cur","testFn","dll","worker","concurrency","_worker","numRunning","workersList","drain","saturated","unsaturated","empty","ev","trigger","processingScheduled","_insert","insertAtFront","rejectOnError","rej","promiseCallback","_tasks","_createCB","tasks","idle","_maybeDrain","eventMethod","handleAndRemove","isProcessing","paused","defineProperties","memo","mapLimit$1","concatLimit$1","mapResults","_createTester","getResult","testResult","testPassed","bool","consoleFunc","resultArgs","_fn","_test","truth","_withoutIndex","eachLimit$2","eachSeries$1","ensureAsync","sync","innerArgs","filterArray","truthValues","filterGeneric","_filter","errback","newObj","taskCb","queue$1","Heap","heap","pushCount","MIN_SAFE_INTEGER","smaller","percUp","top","percDown","priorityQueue","criteria","comparator","taskIndex","nextTask","copyProps","SafeBuffer","originalModule","webpackPolyfill","binary","isBuf","Encoder","CONNECT","DISCONNECT","EVENT","ACK","BINARY_EVENT","BINARY_ACK","Decoder","ERROR_PACKET","encodeAsString","attachments","nsp","tryStringify","reconstructor","BinaryReconstructor","reconPack","removeBlobs","bloblessData","deconstruction","deconstructPacket","pack","encodeAsBinary","tryParse","decodeString","takeBinaryData","finishedReconstruction","binData","reconstructPacket","hasCORS","xdomain","xscheme","enablesXDR","XMLHttpRequest","XDomainRequest","Transport","secure","timestampParam","timestampRequests","agent","withCredentials","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","forceNode","isReactNative","extraHeaders","localAddress","onError","doOpen","doClose","onClose","onOpen","onData","onPacket","chars","arraybuffer","encoded1","encoded2","encoded3","encoded4","bufferLength","Semaphore_1","__export","ReadableState","EElistenerCount","OurUint8Array","debugUtil","debuglog","StringDecoder","BufferList","destroyImpl","kProxyEvents","isDuplex","readableObjectMode","hwm","readableHwm","readableHighWaterMark","defaultHwm","pipes","pipesCount","flowing","endEmitted","reading","needReadable","emittedReadable","readableListening","resumeScheduled","defaultEncoding","awaitDrain","readingMore","decoder","_read","readableAddChunk","addToFront","skipChunkCheck","emitReadable","onEofChunk","chunkInvalid","_uint8ArrayToBuffer","addChunk","maybeReadMore","needMoreData","_undestroy","undestroy","isPaused","setEncoding","howMuchToRead","computeNewHighWaterMark","emitReadable_","flow","maybeReadMore_","nReadingNextTick","resume_","fromList","hasStrings","nb","copyFromBufferString","copyFromBuffer","fromListPartial","endReadable","endReadableNT","xs","nOrig","doRead","pipe","dest","pipeOpts","endFn","stdout","stderr","unpipe","onunpipe","unpipeInfo","hasUnpiped","onfinish","ondrain","ondata","cleanedUp","needDrain","pipeOnDrain","increasedAwaitDrain","pause","dests","_fromList","emitErrorNT","readableDestroyed","writableDestroyed","errorEmitted","ending","finished","CorkedRequest","finish","corkReq","pendingcb","corkedRequestsFree","onCorkedFinish","asyncWrite","WritableState","internalUtil","deprecate","realHasInstance","nop","writableObjectMode","writableHwm","writableHighWaterMark","finalCalled","noDecode","decodeStrings","writing","corked","bufferProcessing","onwrite","writecb","writelen","onwriteStateUpdate","finishMaybe","onwriteError","needFinish","bufferedRequest","clearBuffer","afterWrite","lastBufferedRequest","prefinished","bufferedRequestCount","_write","writev","_writev","final","doWrite","onwriteDrain","holder","allBuffers","callFinal","need","prefinish","getBuffer","hasInstance","writeAfterEnd","valid","validChunk","newChunk","decodeChunk","writeOrBuffer","cork","uncork","setDefaultEncoding","endWritable","nenc","retried","_normalizeEncoding","normalizeEncoding","utf16Text","utf16End","fillLast","utf8FillLast","base64Text","base64End","simpleWrite","simpleEnd","lastNeed","lastTotal","lastChar","utf8CheckByte","byte","utf8CheckExtraBytes","utf8CheckIncomplete","afterTransform","ts","_transformState","transforming","writechunk","rs","needTransform","writeencoding","transform","_transform","flush","_flush","_this2","err2","authority","ipv6uri","withNativeBuffer","withNativeArrayBuffer","eio","Backoff","subs","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","jitter","connecting","lastPing","packetBuffer","_parser","encoder","autoConnect","emitAll","updateSocketIds","generateId","engine","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","skipReconnect","openSub","errorSub","cleanup","timer","onping","onpong","ondecoded","onConnecting","processPacketQueue","subsLength","reset","onreconnect","XHR","JSONP","polling","xd","jsonp","location","isSSL","forceJSONP","parseqs","inherit","yeast","Polling","hasXHR2","responseType","forceBase64","poll","onPause","doPoll","callbackfn","schema","withNativeBlob","withNativeFile","File","alphabet","seed","decoded","toArray","hasBin","connect_error","connect_timeout","reconnect_attempt","reconnect_failed","reconnect_error","ids","acks","connected","disconnected","flags","subEvents","compress","onpacket","rootNamespaceError","onconnect","onevent","onack","ondisconnect","emitBuffered","__generator","trys","ops","verb","op","Semaphore","permits","promiseResolverQueue","getPermits","acquire","waitFor","milliseconds","tryAcquire","drainPermits","permitCount","nextResolver","release","EXIF","EXIFwrapped","ExifTags","Tags","TiffTags","GPSTags","0","IFD1Tags","StringValues","ExposureProgram","1","2","3","4","5","6","7","8","MeteringMode","255","LightSource","9","10","11","12","13","14","15","17","18","19","20","21","22","23","24","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","getImageData","handleBinaryFile","binFile","findEXIFinJPEG","exifdata","iptcdata","dataView","DataView","getUint8","isFieldSegmentStart","nameHeaderLength","startOffset","sectionLength","getUint16","readIPTCData","findIPTCinJPEG","isXmpEnabled","xmpdata","dom","DOMParser","getStringFromDB","xmpString","xmpEndIndex","indexOfXmp","xml2Object","parseFromString","findXMPinJPEG","contentType","atob","base64ToArrayBuffer","http","response","objectURLToBlob","readEXIFData","IptcFieldMap","fieldValue","dataSize","segmentType","segmentStartPos","getInt16","readTags","tiffStart","dirStart","strings","bigEnd","entryOffset","tags","readTagValue","vals","numerator","denominator","numValues","getUint32","valueOffset","getInt32","outstr","exifData","gpsData","tiffOffset","firstIFDOffset","ExifIFDPointer","GPSInfoIFDPointer","IFD1OffsetPointer","getNextIFDOffset","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","readThumbnailImage","xml2json","nodeName","nodeValue","hasChildNodes","childNodes","old","itemAtt","dataKey","dataValue","textContent","enableXmp","disableXmp","getData","Image","HTMLImageElement","getTag","getIptcTag","getAllTags","getAllIptcTags","pretty","strPretty","readFromBinaryFile","stanza_shims_1","async","Hashes","utf8Encode","safe_add","lsw","bit_rol","cnt","rstr2hex","hexcase","hex_tab","binb2rstr","binl2rstr","rstr2binl","rstr2binb","rstr2any","ld","quotient","dividend","full_length","divisor","remainders","rstr2b64","b64pad","triplet","Base64","tab","pad","o1","o2","o3","h3","h4","ac","dec","c1","c2","c3","utf8Decode","setPad","setTab","setUTF8","CRC32","iTop","crc","MD5","uppercase","rstr","binl","rstr_hmac","bkey","ipad","opad","olda","oldb","oldc","oldd","md5_ff","md5_gg","md5_hh","md5_ii","md5_cmn","any","raw","hex_hmac","b64_hmac","any_hmac","vm_test","setUpperCase","SHA1","binb","olde","sha1_ft","sha1_kt","SHA256","sha256_K","sha256_S","X","sha256_R","sha256_Ch","sha256_Maj","sha256_Sigma0256","sha256_Sigma1256","sha256_Gamma0256","HASH","SHA512","sha512_k","int64","s0","s1","Maj","r1","r2","r3","int64copy","int64rrot","int64revrrot","int64shr","int64add4","int64add5","int64add","w0","w1","w2","w3","RMD160","pa","rmd160_r1","rmd160_r2","rmd160_s1","rmd160_s2","T","C1","E1","A2","C2","E2","h0","h1","h2","rmd160_f","rmd160_K1","rmd160_K2","isDeep","socketIO","origin","NODE_TLS_REJECT_UNAUTHORIZED","onSuccess","changeQueryParser","liteURL","instanceId","_upload","uploadId","transmissionDelay","uploadTo","fileInfo","onloadstart","onprogress","progress","loaded","onloadend","accepts","maxFileSize","uploadingFiles","sendChunk","aborted","wrote","SocketIOFileClient","isDestroyed","settings","getUploadId","upload","fileEl","files","uploadIds","evName","evList","abort","getUploadInfo","propIsEnumerable","toObject","test1","test2","test3","letter","shouldUseNative","symbols","lens","getLens","validLen","placeHoldersLen","tmp","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","abs","LN2","paths","instance","Constructor","_classCallCheck","custom","clearFn","_id","_clearFn","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","clearImmediate","registerImmediate","html","messagePrefix","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","canUsePostMessage","MessageChannel","port1","port2","script","onreadystatechange","removeChild","attachEvent","mask","getHashes","parseuri","loc","selectColor","createDebug","prevTime","ms","coerce","extend","instances","newDebug","toNamespace","regexp","stack","disable","skips","plural","msAbs","isPlural","round","long","fmtLong","fmtShort","logFn","packetData","_deconstructPacket","_placeholder","_reconstructPacket","pendingBlobs","_removeBlobs","curKey","containingObject","transportOptions","writeBuffer","prevBufferLen","policyPort","rememberUpgrade","onlyBinaryUpgrades","perMessageDeflate","threshold","product","upgrades","pingInterval","pingTimeout","pingIntervalTimer","pingTimeoutTimer","priorWebsocketSuccess","createTransport","clone","EIO","requestTimeout","setTransport","onDrain","onTransportOpen","upgradeLosesBinary","upgrading","freezeTransport","onTransportClose","onupgrade","onHandshake","setPing","filterUpgrades","onHeartbeat","sendPacket","waitForUpgrade","cleanupAndClose","filteredUpgrades","Request","sendXhr","pollXhr","xhr","setDisableHeaderCheck","setRequestHeader","hasXDR","onLoad","responseText","getResponseHeader","requestsCount","fromError","unloadHandler","terminationEvent","abv","ii","err_cb","bail","proxy","byteCount","byteIndex","checkScalarValue","createByte","encodeCodePoint","symbol","readContinuationByte","continuationByte","decodeSymbol","byte1","byteString","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","getBlob","mapArrayBufferViews","BlobBuilderConstructor","bb","BlobConstructor","JSONPPolling","rNewline","rEscapedNewline","glob","___eio","parentNode","iframe","insertAt","getElementsByTagName","iframeId","className","initIframe","submit","BrowserWebSocket","NodeWebSocket","MozWebSocket","WebSocketImpl","WS","usingBrowserWebSocket","supports","addEventListeners","factor","rand","deviation","Lock","_super","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","PromiseQueue","executionQueue","executing","executionPromise","_addToExecutionQueue","_startExecution","executionData","_decideKeepExecuting","_executeNextFunction","_endExecution","functionToExecute","sameTypePromises","_getSameTypePromises","_cleanExecutionQueue","resolvePromises","rejectPromises","_rejectDifferentTypePromises","bindMethods","appendEmitter","Enum","isDevice","cordova","device","getDeviceId","REGULAR_EXPRESSION_BASE64","scaleImg","isBase64","Orientation","orientation","srcBase64","srcOrientation","canvas","ctx","getContext","drawImage","base64Url","toDataURL","imageUrl","widthScalated","heightScalated","image","sx","sy","sWidth","sHeight","dWidth","dHeight","cropImage","PREFIX","SessionStatus","_possibleConstructorReturn","ReferenceError","_extendableBuiltin2","ExtendableError","captureStackTrace","subClass","superClass","_inherits","cls","ExtendableBuiltin","_extendableBuiltin","SessionError","LoginError","StackRegisterError","StackUnregisterError","WacInternalError","AlreadyLoggedError","NOT_SET","SetRef","OwnerID","ensureSize","iter","__iterate","returnTrue","wrapIndex","uint32Index","wholeSlice","begin","isNeg","resolveBegin","resolveIndex","resolveEnd","defaultIndex","isCollection","maybeCollection","isKeyed","maybeKeyed","isIndexed","maybeIndexed","isAssociative","maybeAssociative","Collection","Seq","KeyedCollection","KeyedSeq","IndexedCollection","IndexedSeq","SetCollection","SetSeq","Keyed","Indexed","isSeq","maybeSeq","isRecord","maybeRecord","isImmutable","maybeImmutable","IS_ORDERED_SYMBOL","isOrdered","maybeOrdered","REAL_ITERATOR_SYMBOL","ITERATOR_SYMBOL","Iterator","iteratorValue","iteratorResult","iteratorDone","hasIterator","maybeIterable","getIteratorFn","isIterator","maybeIterator","iterable","iteratorFn","KEYS","VALUES","ENTRIES","toSource","isInteger","Collection$$1","emptySequence","toSeq","maybeIndexedSeqFromValue","ObjectSeq","seqFromValue","__toString","cacheResult","__iterateUncached","entrySeq","__iterator","__iteratorUncached","toKeyedSeq","fromEntrySeq","keyedSeqFromValue","toIndexedSeq","indexedSeqFromValue","of","toSetSeq","ArraySeq","_array","notSetValue","_object","_keys","EMPTY_SEQ","CollectionSeq","collection","_collection","isMap","maybeMap","isOrderedMap","maybeOrderedMap","isValueObject","maybeValue","hashCode","is","valueA","valueB","valueOf","imul","smi","i32","defaultValueOf","hashNumber","STRING_HASH_CACHE_MIN_STRLEN","hashed","stringHashCache","hashString","STRING_HASH_CACHE_SIZE","STRING_HASH_CACHE_MAX_SIZE","cachedHashString","usingWeakMap","weakMap","UID_HASH_KEY","canDefineProperty","uniqueID","getIENodeHash","objHashUID","isExtensible","hashJSObj","WeakMap","ToKeyedSequence","KeyedSeq$$1","indexed","useKeys","_iter","_useKeys","valueSeq","this$1","reversedSequence","reverseFactory","mapper","mappedSequence","mapFactory","ToIndexedSequence","IndexedSeq$$1","ToSetSequence","SetSeq$$1","FromEntriesSequence","validateEntry","indexedCollection","flipFactory","flipSequence","makeSequence","flip","cacheResultThrough","filterFactory","predicate","filterSequence","sliceFactory","originalSize","resolvedBegin","resolvedEnd","sliceSize","resolvedSize","sliceSeq","skipped","isSkipping","skipWhileFactory","skipSequence","skipping","concatFactory","isKeyedCollection","iters","singleton","concatSeq","flatten","sum","flattenFactory","depth","flatSequence","stopped","flatDeep","currentDepth","sortFactory","defaultComparator","maxFactory","maxCompare","comp","zipWithFactory","keyIter","zipper","zipAll","zipSequence","sizes","iterators","isDone","steps","every","reify","collectionClass","arrCopy","newArr","invariant","assertNotInfinite","coerceKeyPath","keyPath","isPlainObj","isDataStructure","quoteString","_ignoreError","shallowCopy","collectionCopy","updateIn","updater","updatedValue","updateInDeeply","inImmutable","wasNotSet","existingValue","newValue","nextExisting","nextUpdated","emptyMap","setIn","setIn$1","removeIn","deleteIn","update$1","updateIn$1","mergeIntoKeyedWith","mergeWith","merger","collections","collection$1","__ownerID","withMutations","mergeIntoCollection","oldVal","mergeDeepWithSources","mergeWithSources","deepMerger","oldValue","deepMergerWith","mergeItem","hasVal","nextVal","mergeDeep$1","mergeDeepWith$1","mergeIn","mergeDeepIn","mutable","asMutable","wasAltered","__ensureOwner","asImmutable","__altered","KeyedCollection$$1","keyValues","_root","updateMap","deleteAll","__hash","OrderedMap","sortBy","MapIterator","iterate","ownerID","makeMap","MapPrototype","removeAll","mergeDeep","mergeDeepWith","ArrayMapNode","keyHash","didChangeSize","didAlter","removed","exists","MAX_ARRAY_MAP_SIZE","ValueNode","createNodes","isEditable","newEntries","BitmapIndexedNode","bitmap","nodes","bit","SIZE","popCount","keyHashFrag","updateNode","MAX_BITMAP_INDEXED_SIZE","including","expandedNodes","HashArrayMapNode","expandNodes","isLeafNode","newBitmap","newNodes","setAt","canEdit","newLen","newArray","spliceOut","spliceIn","newCount","MIN_HASH_ARRAY_MAP_SIZE","excluding","packedII","packedNodes","packNodes","HashCollisionNode","mergeIntoNode","keyMatch","maxIndex","EMPTY_MAP","Iterator$$1","_type","_reverse","_stack","mapIteratorFrame","mapIteratorValue","subNode","__prev","hash$$1","newRoot","newSize","idx1","idx2","isList","maybeList","IndexedCollection$$1","emptyList","makeList","VNode","setSize","listNodeFor","setListBounds","newTail","_tail","getTailOffset","_capacity","updateVNode","_level","updateList","insert","oldSize","arguments$1","seqs","argument","iterateList","DONE","ListPrototype","removeBefore","originIndex","newChild","removingFirst","oldChild","editable","editableVNode","removeAfter","sizeIndex","EMPTY_LIST","tailPos","iterateNodeOrLeaf","iterateLeaf","iterateNode","capacity","nodeHas","lowerNode","newLowerNode","rawIndex","owner","oldOrigin","oldCapacity","newOrigin","newCapacity","offsetShift","oldTailOffset","newTailOffset","oldTail","beginIndex","EMPTY_ORDERED_MAP","Map$$1","emptyOrderedMap","_map","_list","updateOrderedMap","newMap","newList","makeOrderedMap","omap","toMap","isStack","maybeStack","Stack","emptyStack","pushAll","_head","peek","makeStack","EMPTY_STACK","StackPrototype","unshiftAll","isSet","maybeSet","isOrderedSet","maybeOrderedSet","deepEqual","notAssociative","flipped","allEqual","bSize","keyCopier","toJS","result$1","SetCollection$$1","emptySet","fromKeys","keySeq","intersect","sets","SetPrototype","union","updateSet","removes","adds","mapped","toRemove","subtract","OrderedSet","__make","__empty","EMPTY_SET","makeSet","EMPTY_RANGE","Range","_start","_end","_step","searchValue","possibleIndex","offsetValue","other","getIn","searchKeyPath","getIn$1","hasIn","isIterable","useTuples","toOrderedMap","toOrderedSet","toSet","toStack","__toStringMapper","returnValue","findEntry","sideEffect","joined","isFirst","reducer","initialReduction","reduceRight","not","butLast","isEmpty","countBy","grouper","countByFactory","entriesSequence","entryMapper","filterNot","findKey","findLast","findLastEntry","findLastKey","flatMap","flatMapFactory","searchKey","groupBy","isKeyedIter","groupByFactory","isSubset","isSuperset","keyOf","keyMapper","lastKeyOf","maxBy","neg","defaultNegComparator","minBy","skip","amount","skipLast","skipWhile","skipUntil","take","takeLast","takeWhile","takeSequence","iterating","takeWhileFactory","takeUntil","keyed","murmurHashOfSize","hashMerge","hashCollection","CollectionPrototype","chain","mapEntries","mapKeys","KeyedCollectionPrototype","findIndex","removeNum","numArgs","spliced","findLastIndex","interpose","interposedSequence","interposeFactory","interleave","zipped","interleaved","zip","defaultZipper","zipWith","IndexedCollectionPrototype","reduction","useFirst","Set$$1","emptyOrderedSet","EMPTY_ORDERED_SET","OrderedSetPrototype","makeOrderedSet","Record","defaultValues","hasInitialized","RecordType","indices","RecordTypePrototype","_indices","_name","_defaultValues","propName","recordName","setProp","_values","RecordPrototype","displayName","recordSeq","newValues","makeRecord","getDescriptiveName","likeRecord","record","singletonEnforcer","Logs","enforcer","_handlers","addHandler","_formatter","getLevelFromLocalStorage","sippodebug","LEVELS","getLogger","logger","removeHandler","toTimeString","_enable_super_gross_mode_that_will_cause_bad_things","hostReportError","closed","useDeprecatedSynchronousErrorHandling","UnsubscriptionError","UnsubscriptionErrorImpl","Subscription","_parentOrParents","_subscriptions","_unsubscribe","flattenUnsubscriptionErrors","teardown","EMPTY","subscriptionIndex","errs","rxSubscriber","Subscriber","destinationOrNext","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","destination","subscriber","_error","_complete","_unsubscribeAndRecycle","SafeSubscriber","_parentSubscriber","observerOrNext","_context","__tryOrSetError","__tryOrUnsub","wrappedComplete","observable","pipeFromArray","Observable","_isScalar","_subscribe","lift","operator","sink","nextOrObserver","toSubscriber","_trySubscribe","observer","closed_1","canReportError","promiseCtor","getPromiseCtor","operations","toPromise","ObjectUnsubscribedError","ObjectUnsubscribedErrorImpl","SubjectSubscription","observers","subscriberIndex","SubjectSubscriber","Subject","hasError","thrownError","asObservable","AnonymousSubject","BehaviorSubject","_value","getValue","isScheduler","schedule","OuterSubscriber","notifyNext","outerValue","innerValue","outerIndex","innerIndex","innerSub","notifyError","notifyComplete","InnerSubscriber","subscribeToArray","getSymbolIterator","subscribeTo","obs","isPromise","return","subscribeToResult","outerSubscriber","innerSubscriber","fromArray","scheduler","scheduleArray","NONE","CombineLatestOperator","resultSelector","CombineLatestSubscriber","observables","toRespond","unused","_tryResultSelector","MapOperator","project","MapSubscriber","FileUploadStatus","ChatMessageFile","getUrl","getType","ChatMessageDirection","ChatMessageStatus","ChatMessageType","ChatMessage","composer","INCOMING","TEXT","SENDING","getId","getComposer","getTimestamp","getProgress","getStatus","hasStatus","ChatType","INDIVIDUAL","GROUP","ChatParticipantRole","MEMBER","ADMIN","ChatParticipantState","ACTIVE","INACTIVE","GONE","COMPOSING","PAUSED","AckCounter","lastAckedBy","olderAcked","setLimit","isAdded","hasElement","appendAck","user","keyAcked","prependAck","prevValue","isOlderAcked","getLastAckedBy","Chat","chatService","fileManager","participants","ownAddress","getAddress","mutableMap","remoteParticipants","pendingMessages","messagesSubject","fileMessages","uploads","firstUnreadMessageSubject","lastInvitationTimestamp","lastRecoveredMessageId","oldestMessageRecovered","receivedMarkCounter","displayedMarkCounter","ownMessageCache","bindEventListeners","onReceived","onDisplayed","onState","onMessage","onMessageSent","onMucPresence","onMucConfig","unbindEventListeners","displayed","FILE","OUTGOING","SENT","appendMessage","updateMessages","untilId","lastIndex","lastId","RECEIVED","firstUnreadMessage","changed","fileMessage","updateFirstUnreadMessage","DISPLAYED","updateRemoteParticipant","updateParticipant","minimum","fetchMessages","history","nextMessage","lastReceivedMessageId","lastDisplayedMessageId","oldFirstUnreadMessage","lastReadMessageIndex","isOldestMessageRecovered","lastMessage","setName","setRoomName","getSubject","setRoomSubject","getRole","getParticipants","getRemoteParticipants","addParticipant","participant","expelParticipant","expel","setParticipantRole","leave","deleteIndividualChat","setState","sendText","pendingMsg","resetUnreadMessageCount","sendFile","fileUploadManager","getFileUploadManager","fileUploadId","updatePendingMessage","fileUpload","getFileUploads","waitForEnd","COMPLETED","newMessage","cancelPendingMessage","getLastMessageTimestamp","getMessages","getPendingMessages","getMessages$","getFileMessages","getFirstUnreadMessage$","getFirstUnreadMessage","getUnreadMessageCount","getUnreadMessageCount$","combineLatest","_defineProperty","SERVER_CHAT_INVITE_REASONS","CHAT_INVITE_REASONS","castServerReason","ChatService","wacRequest","xmppClient","pushUri","onIndividualChatChanges","onMarkerReceived","onMarkerDisplayed","onMucInvite","onMucLeave","onMucTopic","onMucOther","onChat","onChatState","onPresence","onMessageError","stop","suspend","chat","chatId","conferenceChat","getRoomInfo","getIndividualChats","chats","addIndividualChat","put","createRoom","lastForwardedMessage","processMamMessages","syncMucInvitations","lastXmppTimestamp","registerUri","unregisterUri","createSupportChat","post","sortByTimestamp","chatA","chatB","lastA","lastB","ChatManager","sessionToken","individualChats","groupChats","conferenceChats","supportChats","bindEventHandlers","fetchIndividualChats","deleteOutdatedChats","onIndividualChatAdded","fetchGroupChats","newGroupChat","onMucEnd","immutableMap","validIds","remotelyDeletedIds","uninit","unbindEventHandlers","onIndividualChatDeleted","onFile","newIndividualChat","newInstance","promoteChat","getIndividualChat","setPushConfig","pushConfig","enablePushNotifications","disablePushNotifications","createChat","getGroupChat","getChats","getConferenceChats","onSupportChat","PresenceActivity","PresenceMood","Presence","presenceManager","_presenceManager","_online","_activity","unknown","_mood","_note","_avatar","_displayName","_initializing","_address","unsubscribeFromPresence","onPresenceUpdated","online","note","avatar","subscribeToPresence","presence","waitUntilSynced","OwnPresence","_sendUpdate","setDisplayName","updatePresence","Queue","_pending","_timer","_observer","addToQueue","commit","ResolveQueue","_queue","isSubscribedTo","getResolver","resolveUsers","resolved","addUser","updateSubscribed","subscribed","USER_ADDRESS_PATTERN","UserCollection","userDomain","_usersById","_usersByCompleteUsername","_usersByAlias","_usersByLandLineNumber","_usersByMobilePhone","_usersByGatewayUsername","_userDomain","_subscribed","landLineNumber","gatewayUsername","mobilePhone","updateUsers","newUsers","UserManager","wacProxy","_init","_resolveQueue","onResolveUpdated","getResolvedUsers","getCurrentSession","userId","getUserId","isAddress","getOwnAddress","isOwnAddress","resolveUser","getUsername","ignoreErrors","localUser","getUserByGatewayUsername","getGatewayUsername","getGatewayUsernameByUser","getGatewayUsernames","usernames","BaseContact","favorite","getSource","isFavorite","setFavorite","setSource","setId","updateContact","removeContact","Contact","userManager","favoriteManager","_userManager","_favoriteManager","_base","_phones","phones","_unnormalizedPhones","unnormalizedPhones","_emails","emails","_presence","_deviceId","deviceId","_contactDeviceId","contactDeviceId","_user","_updateUser","UserManagerEvents","isWacUser","defaultEmail","_remove","saveFavorite","removeFavorite","getWacUserAddress","contact","emitUpdate","photos","W3cContacts","ContactFindOptions","existDeviceId","w3cContactToWacContact","rawEmails","phoneNumbers","parseName","avatarW3cContactToWacContact","getW3cContacts","contactFindOptions","hasPhoneNumber","desiredFields","contacts","getAvatarW3cContacts","allowedContacts","getCapabilities","getContacts","getAvatarContacts","ContactRetriever","_w3cContacts","getContactsWac","getContactsDevice","getAvatarDeviceContacts","avatarsContacts","avatarElem","doHash","getDeviceWacContacts","setDeviceWacContacts","deviceWacContacts","setWacContacts","wacContacts","getWacContacts","setDeviceContacts","deviceContacts","validateCache","invalidateCache","updateFavoriteContacts","favorites","emptyAllContactData","__data__","ListCache","objectProto","nativeObjectToString","symToStringTag","isOwn","unmasked","uid","maskSrcKey","IE_PROTO","funcToString","reIsHostCtor","reIsNative","MapCache","LARGE_ARRAY_SIZE","SetCache","bitmask","customizer","equalFunc","isPartial","othLength","stacked","seen","arrValue","othValue","compared","othIndex","symbolProto","symbolValueOf","convert","keysFunc","symbolsFunc","resIndex","nativeGetSymbols","reIsUint","typedArrayTags","nodeIsTypedArray","isTypedArray","inherited","isArr","isArg","isBuff","isType","skipIndexes","Ctor","objProps","objLength","skipCtor","objValue","objCtor","othCtor","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ctorString","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","baseIsEqual","_onErrorSyncContacts","ContactSynchronizer","favoriteContact","_retriever","_favoriteContacts","syncContacts","_isAllowDeviceContacts","_invalidateAndSyncContacts","launchSynchronize","devSync","ContactCache","deviceContactsStored","contactsToDelete","_getContactsToDeleted","contactsToUpdate","contactsToInsert","_getContactsToSynchronize","_uploadAllContactsAgain","_sendUpdatesToWac","launchSynchronizeAvatars","oldListContacts","newListContacts","mapOldDeviceContacts","oContactStored","isEqual","objContact","_getContactToCompare","oldContact","newContact","mapNewListContacts","updateContactsWithFavoriteFlag","_removeContacts","_addContacts","_updateContacts","invalidateContacts","_uploadContacts","contactList","insertMany","addContact","contactsList","GroupContact","_participants","isValidParticipants","FavoriteContact","getFavoriteContacts","CODE_ERRORS_CORDOVA","ContactManager","_contacts","ownPresence","_favorite","_synchronizer","Synchronizer","_contactFactory","ContactFactory","_initCallbacks","savedContacts","validCache","_updateAvatarOfContacts","_addContact","_insertWACContact","_onSyncProcessError","finally","_unInitCallbacks","createContact","contactData","createGroupContact","getContactByWacId","wacId","getContactByAddress","getPresenceByWacId","getContactByEmail","getPresenceByAddress","getFakeContact","errorGettingDeviceContacts","clearContactsDataFromPersistentStorage","invalidatingErr","onLocalContactRemove","_rmContact","onContactAddMany","_emptyContactList","savedWacContacts","_isFromThisDevice","onContactAdd","onContactUpdate","contactToUpdate","deviceContact","onUpdateListContacts","onContactRemove","contactDeleted","onUpdateAvatarsContacts","avatarMap","_isFromDevice","FileUpload","bytesSent","getSize","statuses","getBytesSent","FileUploadManager","fileSharingService","fileSharingManager","initialize","fileUploads","onStart","onStream","onComplete","onAbort","ABORTED","createSharedFile","onEnd","endPromise","abortPromise","errorPromise","LOADING","FileManager","_fileUploadManager","props","isNew","isProto","arrayBuffer","reFlags","typedArray","objectCreate","proto","nodeIsMap","nodeIsSet","cloneableTags","baseClone","isFlat","isFunc","subValue","keysIn","reIsDeepProp","reIsPlainProp","memoize","memoized","Cache","rePropName","reEscapeChar","number","quote","subString","symbolToString","baseToString","nested","hasFunc","spreadableSymbol","isConcatSpreadable","baseFlatten","isStrict","nativeMax","otherArgs","nativeNow","lastCalled","stamp","ImageCapture","videoStreamTrack","DOMException","_videoStreamTrack","_previewStream","MediaStream","videoElement","videoElementPlaying","HTMLMediaElement","srcObject","createObjectURL","muted","play","canvasElement","canvas2dContext","MediaSettingsRange","exposureCompensation","exposureMode","fillLightMode","focusMode","imageHeight","imageWidth","iso","redEyeReduction","whiteBalanceMode","zoom","photoSettings","videoWidth","videoHeight","toBlob","createImageBitmap","StreamRecorderStatus","StreamRecorder","mediaStream","_mediaStream","_mediaRecorder","_chunks","_status","isAudioRecordingEnabled","isVideoRecordingEnabled","getAudioTracks","getVideoTracks","MediaRecorder","onstart","RECORDING","_recordingStartTime","onstop","startTime","endTime","ondataavailable","onpause","onresume","ManagedStream","nanoid","isLocal","isRemote","getMediaStream","getCameraTracks","getScreenTracks","hasAudioTracks","hasVideoTracks","hasCameraTracks","hasScreenTracks","isAudioMuted","isVideoMuted","isScreenMuted","muteAudio","mute","muteVideo","muteScreen","takePhotos","captureDevice","takePhoto","createStreamRecorder","LocalMediaHandler","mediaConstraints","audio","video","updateMedia","screen","cloneDeep","getMediaTypes","mediaTypes","setMediaTypes","getCurrentMediaConstraints","getMediaConstraints","setMediaConstraints","getVideoStream","videoStream","audioOnlyStream","setVideoStream","audioMuted","videoMuted","setAudioOnlyStream","hasAudioTrack","hasVideoTrack","canToggleVideo","availableVideoInputDevices","toggleVideo","toggleScreen","beforeShareScreenVideo","addVideo","getAvailableAudioInputDevices","availableAudioInputDevices","setAvailableAudioInputDevices","setActiveAudioInputDevice","audioInputDevice","exact","getAvailableVideoInputDevices","setAvailableVideoInputDevices","setActiveVideoInputDevice","videoInputDevice","activeVideoInputDevice","facingMode","getAvailableAudioOutputDevices","availableAudioOutputDevices","canToggleCamera","toggleCamera","getNextVideoInputDevice","initializeDevices","mediaDevices","enumerateDevices","getActiveVideoInputDeviceFromLocalStreams","videoTracks","getSettings","activeDeviceIds","activeDevice","activeEl","CallDirection","CallEndReason","getEndReasonFromWacValue","wacEndReason","NOT_FOUND","UNSPECIFIED","NORMAL_CLEARING","BROWSER_CLOSED","USER_BUSY","NO_ANSWER","MEDIA_ACCESS_ERROR","ORIGINATOR_CANCEL","BAD_REQUEST","SERVER_ERROR","CallStatus","CallRemoteRecorder","idCall","_wacproxy","_callId","filename","startRecording","stopRecording","getRecordings","callIdWAC","Call","gatewayCaller","gatewayCallee","remoteUser","pollingCall","pullFrom","callService","getCallService","callAttemptService","getCallAttemptService","originalGatewayCallee","TRYING","UNCONNECTED","endReason","localOnlyStreams","localMediaHandler","remoteStreams","onRinging","onEstablished","onLocalStream","onRemoteStream","onEndCall","onHoldReceived","onResumeReceived","onTransferred","onCallAttemptRejected","userid","isPolling","hasCapability","callid","updateCallControl","setStatus","CONNECTED","clearLocalOnlyStreams","mS","managedStream","clearRemoteStreams","hasRehydration","NETWORK_ERROR","sendStats","DISCONNECTED","REMOTE_HOLD","createCallControl","caller","getCurrentCredential","callee","anonymousSessionId","updateCallMedia","getLocalMediaHandler","getRemoteUser","getRemoteGatewayUser","waitForStatus","statusList","onStatus","newStatus","getEndReason","getLocalOnlyStreams","oldStreams","hasLocalOnlyVideo","hasRemoteAudio","hasRemoteVideo","setContext","createCallRecorder","connectOutgoing","connectIncoming","initializeLocalMedia","waitWhileQueued","pullCallFromSession","pick","connectPollingCall","CONNECTING","getUserMedia","oldLocalOnlyStreams","QUEUED","onCallUpdated","pollingCallPromise","onPollingCallUpdate","gatewayCallPromise","callId","hangup","hold","unbind","HOLD","transfer","gwUsername","sendDtmf","insertDTMF","RemoteSession","RemoteCall","_session","CallLogEntry","getCallee","getCaller","getTarget","getFrom","getTo","getOrigin","getDuration","getRemoteAddress","isEnded","FINISHED","isIncoming","isOutgoing","isMissed","CallLog","callLog","lastEntryRecovered","onUpdate","lastRecoveredTimestamp","callLogs","createCallLogEntry","getEntries","getById","calculateStatus","callLogDatum","newEntry","oldEntry","CallManager","ownGatewayUsername","_wacProxy","_callAttemptService","_defaultMediaConstraints","_ownGatewayUsername","_pollingCalls","_incomingCalls","_outgoingCalls","_callLog","_bindEventHandlers","_onCallAttemptCreated","_onRinging","_addIncomingCall","isDatapipe","isReconnection","_addOutgoingCall","getDefaultMediaConstraints","setDefaultMediaConstraints","defaultMediaConstraints","getCallLog","createCall","getRemoteCalls","getRemoteSessions","calls","dev","pull","remoteCall","ConferenceEndReason","ConferenceStatus","Invitation","toUser","autoAccepted","responseCode","hasStreams","_toUser","_to","_mediaTypes","_autoAccepted","_responseCode","_hasStreams","_canceled","_timestamp","getToUser","isAutoAccepted","getResponseCode","isCanceled","isActive","setTo","setResponseCode","setCanceled","setStreams","ParticipantEvents","StreamChangeEvents","ConferenceInvite","getGatewayUri","gtUsername","Conference","_room","Status","_endReason","EndReason","_localMediaHandler","_transferingCall","_outgoingInvitations","_remoteParticipants","_remoteStreams","_remoteWacAddresses","invitationCount","recovered","conference","_owner","_onLocalStreamChanged","_onLocalStreamAdded","_onLocalStreamRemoved","_onRemoteStreamChanged","_onRemoteStreamAdded","_onRemoteStreamRemoved","_onExpelled","_onTransferingCall","_onDestroyed","_onParticipantAdded","_onParticipantRemoved","_onParticipantHold","_onParticipantUnhold","_unbindEventHandlers","screenTrack","onended","_getRemoteStream","remoteStream","invitationToSetStreamsTrue","oldRemoteStreams","managedStreams","_getOutgoingInvitation","_updateOutgoingInvitations","_setStatus","DESTROYED","_setTransferingCall","acceptCallTransfer","callTransferID","inviteParticipant","mediatypes","participantObj","_updateParticipants","invitationToAdd","invitationToRemove","oldOutgoingInvitations","invitation","_hasActiveInvitation","_alreadyJoined","_canSendInvitation","fetchRemoteParticipants","myAddress","myUser","plainRemoteParticipants","userStatusAsKeyValue","getStatus$","getOwner","getRemoteGatewayUsernames","getRemoteWacAddresses","getOutgoingInvitations","isBeingTransfered","oldStatus","canManage","isOwner","hasOwner","isRecovered","getCurrentParticipants","participantCount","getInvite","requestId","oldInvitation","newInvitation","whoAccepted","cancelInvitation","inviteParticipants","expelParticipants","errorCode","DISCONNECTING","unhold","isOnHold","unattendedCallTransfer","getState","ConferenceLogEntry","invites","getCandidates","inviteRequest","transfers","finishedAt","createdAt","getStartTimestamp","getStartDateTime","getEndDateTime","getInvites","getTransfers","ConferenceLog","conferenceLogService","timestampOfTheLastEntryRecovered","onCreate","newConferenceLog","conferenceLogEntry","conferenceLogEntries","getTimestampOfTheLastEntry","ConferenceManager","_conferences","_conferenceLog","_incomingInvitationRequestIds","_onIncomingConference","_onConferenceInvitationRequest","_onConferenceInvitationRequestCancelled","acceptInvitationRequest","_connect","_disconnect","createConference","getConferenceLog","getConferenceLogService","requestConferenceInvitation","hasLocalVideo","cancelInvitationRequest","requestInvitation","_getConferenceForRoom","getCurrentInvitations","conferences","isRequest","getConferenceByUri","getRoomByUri","Group","phonebook","getPhonebook","plusParticipants","minusParticipants","GroupManager","groupService","phonebookService","onPut","onDelete","convertToAddresses","newGroup","convertToIds","getPhonebooksBySubscriberId","getGroups","createGroup","participantIds","saveGroup","deleteGroup","InstantMessageType","InstantMessage","getSender","getReceiver","getMessage","outgoing","sendIm","Meeting","meeting","_language","language","_validSince","validSince","_validUntil","validUntil","_url","_phone","reinvite","sendMeetingInvites","isOnline","_source","MeetingManager","meetingService","_meetingService","_meetings","_message","onUserInMeeting","meetings","oMeeting","createMeeting","sendSmsViaWac","_checkInitializingOfService","_insertSendSMSFlagInParticipants","meetingCreated","_addMeeting","_getPhonesFromParticipants","updateMeeting","meetingUpdated","_updateMeeting","sendSMS","getMeetings","_rmMeeting","onLocalMeetingRemove","eventMeeting","DataPipeStatus","priv","getStatusIndex","REJECTED","DataPipe","wStack","removeParticipant","when","newIndex","DataPipeType","WacDataPipe","datapipeService","getDatapipeService","makeBindings","datapipe","internalId","destroyBindings","DataChannelDataPipe","rcv","handleCalling","_connectOutgoing","_connectIncoming","_reject","sendDataChannel","onQsCalling","onQsEstablished","onQsEndCall","onQsData","StreamChangeReason","ParticipantStatus","JanusEvents","OPEN_COMPLETED","ConnectionEvents","ConferenceMediaStream","feed","medium","STREAM_ADDED","STREAM_REMOVED","_feed","_localStream","_remoteStream","oldStream","janusMedia","fromIndex","fromRight","isCommon","valuesLength","outer","computed","valuesIndex","checkRTCDependency","deps","propertyExpected","streamEventHandler","conferenceMediaList","localStream","localStreams","onStreamAdded","onStreamRemoved","withReason","HOLD_MESSAGE_TYPES","HoldAPI","eventData","sendWithEmptyPayload","messageType","JANUS_EVENTS","BaseJanusFeedEventHandler","onNewFeed","getSubscribers","onFeedGone","subscribers","isSubscribedToVideo","onJanusFeed","LoginAPI","jsep","parallelSipExtension","onOpenCompleted","bitrate","UserAPI","getAll","ServerAddress","fromSocketIo","SOCKETIO","WEBSOCKET","_parent","_parents","hasErrors","_addParent","isInteropObservable","fromObservable","fromPromise","fromIterable","emptyScheduled","observableFactory","fromEvent","setupSubscription","sourceObj","isEventTarget","source_1","isJQueryStyleEventEmitter","source_2","isNodeStyleEventEmitter","source_3","MergeMapOperator","concurrent","POSITIVE_INFINITY","MergeMapSubscriber","hasCompleted","_tryNext","_innerSub","ish","mergeAll","mergeMap","ArgumentOutOfRangeErrorImpl","ArgumentOutOfRangeError","TakeOperator","TakeSubscriber","asPayloadOrError","errorPayload","dependencies","socketIo","endpoint","requestData","legacyRequest","fromSocketMethod","FilterOperator","FilterSubscriber","socketFactory","addr","PROTOCOL","fromSocket","asLegacyResponse","isValidEvent","asLegacyEvent","connection","webSocketClient","isValidResponse","serverAddress","parsedAddress","fromUnknownAddress","getTransport","clientEmitter","clientFactory","getEvents","reHasUnicode","rsAstral","rsCombo","rsFitz","rsNonAstral","rsRegional","rsSurrPair","reOptMod","rsSeq","rsSymbol","reUnicode","hasToUseMediaStreams","platformId","adapter","_pc","onicecandidate","onaddstream","ontrack","onremovestream","onconnectionstatechange","onremovetrack","_constraints","hasVideo","api","hasAudio","setLocalStream","pcConfig","trickle","remoteStreamHandlers","setRemoteStream","addStreamToPeerConnection","waitPublishComplete","createWebRTCConnection","unpublish","mediaApi","remoteSdp","RTCSessionDescription","_mediatypes","restoreOnErrors","_getUselessPublishers","_removeItem","getPublishersAndStartToPublish","_getRequiredPublishers","_addItem","constraint","createPublisher","Publisher","_medium","setRemoteStreamWithMedium","provides","createSubscriber","feeds","isSubscribedToSome","_ice","_loggedIn","_media","_publishers","_server","_subscribers","_token","_username","Publishers","createPublishers","Subscribers","createSubscribers","janusFeedHandler","createJanusFeedHandler","onConnect","login","unpublishAll","unsubscribeAll","logout","onDisconnect","onJanusWebRTC","onJanusDestroyed","onJanusDisconnected","onParticipantAdded","onParticipantRemoved","isConnected","JanusHoldableRoom","holdState","isHolding","savedSubscriptions","getSavedSubscriptions","feed1","feed2","isStored","feedStored","HeldSubscriptionsState","heldParticipants","u1","u2","HeldParticipantsState","HoldState","addReason","baseFeed","processFeed","feedEvent","saveSubscription","removeSubscription","HoldableJanusFeedEventHandler","publishers","getPublishers","apiHold","isParticipantInHold","RoomInterface","createRoomInterface","republishAllMediums","subscribeMany","HoldableRoom","ErrorResponse","promiseWithTimeout","getDisplayMedia","desktopCapturer","getSources","mandatory","chromeMediaSource","chromeMediaSourceId","getUserMediaWithMediatypes","audioStream","screenStream","ConferenceMediaFeed","asLocalStream","asRemoteStream","LOCAL_STREAM_CHANGED","ConferenceStreamChangeEvents","LOCAL_STREAM_ADDED","LOCAL_STREAM_REMOVED","REMOTE_STREAM_CHANGED","REMOTE_STREAM_ADDED","REMOTE_STREAM_REMOVED","_invite","_ownwer","_record","_left","_pendingInvites","_uninitedRoomPromise","sipUri","signaling","removeContentListener","onRoomUpdated","onRoomDestroyed","onInviteCancel","onTransferingCallToPeer","_uninitRoom","addContentListener","cancel","roomId","invited","_initRoom","cancelPendingInvite","removeRoomParticipants","_updateWithServerData","_declineInviteIfNeeded","_tryToLeaveSignalingRoom","_sendDeclineMessage","ignored","_mediaUpdateInProgress","setParallelSipExtension","startRecordingRoom","stopRecordingRoom","callTransfer","createDependencies","defaultDependencies","createJanusRoom","onParticipantHold","onParticipantUnhold","wss","fromWebsocket","https","injectedRoom","JanusRoom","_uninitRoomIfExists","_resetUninitedRoomPromise","_removeRoomListeners","_removeRoomMediaListeners","_resetCurrentRoom","requestID","onStreamChanged","transferingCall","ConferenceParticipantEvents","_pendingRequests","_receivedRequests","Conferences","onIncomingInvite","onIncomingInviteRequest","onInviteCancelRequest","getRooms","_addConferenceToCollection","_removeConferenceFromCollection","conferenceId","peerId","currentInvitations","createInviteRequestFromMessage","updateWithServerData","onUpdatedConference","onDestroyedConference","handleIncomingInvite","_buildInvitationRequestEvent","_match","_client","ServerAPI","retry","answerWaitingResponse","InvitesAPI","replyOf","InviteRequestAPI","RegisterAPI","CallTransferAPI","RoomsAPI","recording","addRoomParticipants","SignalingClient","pingTimer","ready","ReconnectingWebSocket","heartbeat","handlerErrorSocket","closePendingMessages","unbindSocketEvents","stopCurrentSocketAndReconnect","closeCurrentSocket","cleanState","Session","userName","applicationToken","bindSignalingEvents","onSessionCreated","unregister","unbindSignalingEvents","onSessionClosed","onReconnecting","onReconnected","CAPABILITIES","AlreadyRegisteredError","Janus","evtNames","evtName","callbackMod","th","getSession","capabilities","authserver","suspendSession","resumeSession","onSessionReconnecting","onSessionReconnected","WapiState","matchData","noCustomizer","srcValue","WapiMessageType","prop","DEFAULT_OPTIONS","getGlobalWebSocket","retryCount","wapiId","suspendedId","withDefaults","requestMap","doConnect","waitForState","SUSPENDED","SUSPENDING","MAX_SAFE_INTEGER","REQUEST","CONTROL","sendControl","connectionTimer","OPEN","authData","PING","PONG","RESPONSE","processResponse","getNextDelay","toFixed","successState","failureState","WacRequest","wapi","WapiClient","_urls","onWapiEvent","queryString","pickBy","SapiClient","provider","_request","_getContext","recover","languages","useragent","_getLocationHref","platform","vendor","XmppClient","chatUri","lock","throttleLock","mucJoinPromise","messagePromise","cachedSM","sessionStorage","connectClient","disconnectClient","onSessionEnd","onDisconnected","reconnectingInterval","onEvent","onMucJoin","onMucError","onStanzaAcked","PATH","CallAttemptService","onInstanceEvent","accepted","CallService","queueposition","seenIndex","arrays","CapabilitiesService","populate","forbiddenCapabilities","getForbiddenCapabilities","ConferenceLogService","lastEntryStartTimestamp","DatapipeService","FileSharingService","fileUploadUrl","socketsPromise","createSocket","token_type","access_token","fileUploader","SocketIoFileClient","getSockets","uploader","publicUrl","getEventData","groupId","GroupService","onParticipantEvent","participating","groupList","targetUserId","MeetingService","sendInvites","PhonebookService","subscriberId","phonebooks","PushNotificationsService","notifyToken","tokenType","destroyToken","Resolver","updateResolvedUsers","CallStats","onStatsEnable","onContact","onContacts","onContactChanged","searchContact","getContactsWacUser","fullPath","ldap","CredentialsThread","period","_thread","isRunning","retain","expireField","retained","lease","onThreadError","Credentials","_retain","EventInterval","SessionsThread","updateFn","updatedFn","Sessions","getSessions","onThreadCompleted","Login","sapiClient","doLoginToken","recoverSession","onContactPresenceUpdated","onPresencesReceived","withoutAvatar","subscribeToPresences","Recording","pathame","RemoteLog","_enabled","_logHandler","Settings","setSetting","_getAllSettings","_parseSettings","setting","_updateSettings","_createSettings","User","updateUser","validatePhone","getUser","objToUpdate","WacStack","wacUri","WACVersion","_reconnecting","generateWacProxyActions","actionProxy","contactService","settingsService","callStatsService","sessionsService","credentialsService","userService","onWapiStateChange","onConnection","releaseCredential","releaseSession","xmpp","_chatService","loginToken","processLogin","loginService","loginPromise","wapiToken","_wapiToken","userObj","_domain","capabilitiesService","onCapabilitiesChange","retainCredential","_sessionsService","getVersion","presenceService","isReconnecting","difference","remoteLogService","_callService","_callStatsService","CallStatsService","xmppUri","xmppPushUri","_contactService","ContactService","_credentialsService","CredentialsService","_datapipeService","_groupService","_fileSharingService","fileUploadUri","_loginService","LoginService","_phonebookService","_pushNotifications","_resolver","_presenceService","PresenceService","_recordingService","RecordingService","_remoteLogService","RemoteLogService","SessionsService","_settingsService","SettingsService","_userService","UserService","CapabilitiesManager","gatewayCapabilities","wacCapabilities","regenerateCapabilities","onCapabilitiesUpdated","setGatewayCapabilities","hasWacCapability","capability","hasGatewayCapability","ROUTES","NEW_ROUTES","WacProxy","_routeCall","_newRouteCall","stackReconnecting","cStack","capabilitiesManager","onWacStackDisconnected","onStackDisconnected","onWacStackReconnecting","onStackReconnecting","onWacStackReconnected","onStackReconnected","issuer","registeredCredential","_joinResults","getChatService","getFileSharingService","getGroupService","getContactService","getMeetingService","getPhonebookService","getPresenceService","getPushNotificationsService","pushNotificationsService","PresenceQueue","presences","getPresence","PresenceCollection","_presenceByAddress","removePresence","PresenceManager","isInitialized","updatedPresence","Selfie","_pipe","notifyTaking","_sendCommand","imgDataUrl","_initDatapipe","expected","_onPipeData","_parseData","_email","_created","_lastLogin","_role","_capabilities","_mobilePhone","_landLineNumber","_alias","oUpdated","lastLogin","landLineNumer","_landLineNumer","none","querySelector","EnterNode","ownerDocument","namespaceURI","querySelectorAll","bindIndex","enter","exit","groupLength","dataLength","bindKey","keyValue","nodeByKeyValue","ascending","xhtml","svg","xlink","space","attrRemove","removeAttribute","attrRemoveNS","fullname","removeAttributeNS","attrConstant","attrConstantNS","setAttributeNS","attrFunction","attrFunctionNS","defaultView","styleRemove","removeProperty","styleConstant","setProperty","styleFunction","styleValue","getPropertyValue","getComputedStyle","propertyRemove","propertyConstant","propertyFunction","classArray","classList","ClassList","_node","_names","classedAdd","classedRemove","classedTrue","classedFalse","classedFunction","textRemove","textConstant","textFunction","htmlRemove","innerHTML","htmlConstant","htmlFunction","raise","nextSibling","lower","previousSibling","firstChild","creatorInherit","createElementNS","creatorFixed","constantNull","selection_cloneShallow","cloneNode","selection_cloneDeep","filterEvents","mouseenter","mouseleave","filterContextListener","contextListener","related","relatedTarget","compareDocumentPosition","event1","event0","parseTypenames","typenames","onRemove","typename","__on","capture","onAdd","customEvent","sourceEvent","dispatchEvent","CustomEvent","createEvent","initEvent","bubbles","cancelable","detail","dispatchConstant","dispatchFunction","Selection","_groups","select","subgroups","subnode","subgroup","selectAll","matches","enterGroup","updateGroup","previous","i0","i1","_enter","_exit","sparse","onenter","onupdate","onexit","groups0","groups1","selection","m0","m1","merges","group0","group1","compareNode","sortgroups","sortgroup","getAttributeNS","classed","deep","dispatch","ownerSVGElement","createSVGPoint","clientX","clientY","matrixTransform","getScreenCTM","inverse","rect","getBoundingClientRect","clientLeft","clientTop","changedTouches","Dispatch","identifier","touches","touch","nopropagation","stopImmediatePropagation","noevent","__noselect","MozUserSelect","DragEvent","dx","dy","defaultFilter","ctrlKey","button","defaultContainer","defaultSubject","defaultTouchable","maxTouchPoints","mousedownx","mousedowny","mousemoving","touchending","container","touchable","gestures","clickDistance2","drag","mousedowned","touchstarted","touchmoved","touchended","gesture","beforestart","mouse","mousemoved","mouseupped","nodrag","noclick","sublisteners","p0","clickDistance","sqrt","pi","PI","tau","tauEpsilon","Path","_x0","_y0","_x1","_y1","moveTo","closePath","lineTo","quadraticCurveTo","x1","y1","bezierCurveTo","x2","y2","arcTo","x0","y0","x21","y21","x01","y01","l01_2","x20","y20","l21_2","l20_2","l21","l01","tan","acos","t01","t21","arc","a0","ccw","cos","sin","cw","da","Linear","areaStart","_line","areaEnd","lineStart","_point","lineEnd","WhiteboardHistory","_index","_history","_getPreviousShape","shape","canUndo","canRedo","undo","redo","Whiteboard","_width","_height","_tool","_color","_backgroundImage","_backgroundVideo","_element","_svg","_createCanvas","_lastShapeSendTimestamp","_pendingShapes","_pendingShapesTimer","_lineWidth","d3Select","_onPointerDown","d3Event","tool","_selectPointedElement","_send","_createLine","_createFreedraw","_createRect","_createCircle","_unselectAllElements","_updateShape","_renderShape","setArea","aspectRatio","stroke","TOOL","reader","_renderBackground","lineWidth","_sendShape","_updateOrAppend","shapes","oldIndex","_addDragBehaviour","graph","dragBehaviour","d3Drag","_renderLine","defined","curve","defined0","d3Line","_renderCircle","cx","cy","_renderRect","_renderRemoveShape","_bindEndActionEvents","coordinates","d3Mouse","onMove","startPoint","newCoordinates","rnds8","rng","byteToHex","rnds","SupportService","conferenceManager","callAgent","contextInfo","generateWacAgentUri","sessionEstablisher","meetingManager","_promiseQueue","_boundEvents","handleDataPipe","dataPipe","whiteboard","selfie","onDataPipeInvite","onInstantMessage","onSessionDisconnected","onConnectionLost","onUnknownClose","retainSession","getAlias","getSessionToken","createWhiteboard","createDataPipe","createSelfie","createInstantMessage","getCallManager","callManager","getConferenceManager","getUserManager","getChatManager","chatManager","getFileManager","getContactManager","contactManager","getPresenceManager","getMeetingList","getMeetingManager","getGroupManager","groupManager","getSupportService","supportService","_suspend","_resume","notifyPushToken","destroyPushToken","createSession","withOAuth2","withSessionToken","getAuthProviders"],"mappings":"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CA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,UACA,UACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,UACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,UACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,UACA,UACA,UACA,UACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,YAEJ,SAASC,GAAGrb,EAAGqa,EAAGC,GACd,OAAOA,EAAKta,GAAKqa,EAAIC,GAEzB,SAASgB,GAAMtb,EAAGqa,EAAGC,GACjB,OAAQta,EAAIqa,EAAMC,GAAKta,EAAIqa,GAE/B,SAASkB,GAASvb,EAAGwb,GACjB,OAASxb,IAAM,GAAOwb,GAAM,IAAQA,IAAO,EAAMxb,GAAK,KAASwb,IAAO,EAAMxb,GAAK,IAErF,SAASyb,GAASzb,EAAGwb,GACjB,OAASxb,IAAM,GAAOwb,GAAM,KAASxb,IAAM,GAAOwb,GAAM,KAASA,IAAO,EAAMxb,GAAK,IAEvF,SAAS0b,GAAO1b,EAAGwb,GACf,OAASxb,IAAM,EAAMwb,GAAM,KAASxb,IAAM,EAAMwb,GAAM,IAAQxb,IAAM,EAExE,SAAS2b,GAAQ3b,EAAGwb,GAChB,OAASxb,IAAM,EAAMwb,GAAM,KAASxb,IAAM,EAAMwb,G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GAAwB,CAC1BC,mBAAoB,sBACpBC,KAAM,OACNC,OAAQ,SACRC,kBAAmB,qBACnBC,QAAS,UACTC,QAAS,UACTC,kBAAmB,qBACnBC,gBAAiB,mBACjBC,aAAc,gBACdhH,KAAM,OACNiH,uBAAwB,0BACxBC,WAAY,cACZC,cAAe,iBACfC,QAAS,UACTC,QAAS,UACTC,wBAAyB,2BACzBC,sBAAuB,0BAKrBC,GAAa,CACf,SACA,SACA,UACA,QACA,UACA,UACA,UACA,UACA,QACA,QACA,OACA,WACA,OACA,YACA,WACA,gBACA,YACA,SACA,QACA,WACA,UACA,WACA,YACA,eACA,YACA,WACA,aACA,cACA,UACA,UACA,cACA,aACA,WACA,WACA,SACA,SACA,QACA,UACA,MACA,UACA,aACA,SACA,OACA,YACA,SACA,UACA,YACA,aACA,cACA,aACA,UACA,SACA,OACA,QACA,OACA,QACA,UACA,UACA,WACA,WACA,UACA,QACA,UACA,WACA,aACA,WACA,MACA,YACA,YACA,UACA,UACA,MACA,OACA,SACA,cACA,WACA,SACA,YACA,WACA,UACA,QACA,YACA,OACA,WAEEC,GAAwB,CAC1B,eACA,WACA,SACA,aACA,WACA,qBACA,WACA,WACA,UACA,YACA,YACA,WAEEC,GAAyB,CAC3B,aACA,iBACA,mBACA,WACA,SACA,YACA,UACA,UACA,UACA,UACA,UACA,oBACA,mBACA,oBACA,UACA,UACA,SACA,YACA,oBACA,YACA,cACA,gBACA,iBACA,mBACA,gBACA,gBACA,eACA,aACA,SACA,SACA,WACA,eACA,eACA,UACA,WACA,aACA,aACA,YACA,eACA,cACA,iBACA,QACA,WACA,iBACA,UACA,UACA,aACA,UACA,oBACA,oBACA,UACA,WACA,SACA,WACA,UACA,cACA,WACA,aACA,WACA,gBACA,kBACA,WACA,UACA,kBACA,mBACA,cACA,cACA,WAEEC,GAAc,CAACl8B,EAAW3V,IAAS,IAAI2V,KAAa3V,IACpD8xC,GAAmBD,GAAYzmB,GAAsB,QACrD2mB,GAAqBF,GAAYz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EE,aAAa3vB,KAAKuwB,GAAI,IACjBd,GAcf,MAAMoB,EAAM,CACR,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,UACA,UACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,UACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,UACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,UACA,WACA,UACA,WACA,UACA,WACA,UACA,UACA,UACA,UACA,UACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,YAEJ,SAASC,EAAGrb,EAAGqa,EAAGC,GACd,OAAOA,EAAKta,GAAKqa,EAAIC,GAEzB,SAASgB,EAAMtb,EAAGqa,EAAGC,GACjB,OAAQta,EAAIqa,EAAMC,GAAKta,EAAIqa,GAE/B,SAASkB,EAASvb,EAAGwb,GACjB,OAASxb,IAAM,GAAOwb,GAAM,IAAQA,IAAO,EAAMxb,GAAK,KAASwb,IAAO,EAAMxb,GAAK,IAErF,SAASyb,EAASzb,EAAGwb,GACjB,OAASxb,IAAM,GAAOwb,GAAM,KAASxb,IAAM,GAAOwb,GAAM,KAASA,IAAO,EAAMxb,GAAK,IAEvF,SAA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","file":"Sippo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Sippo\"] = factory();\n\telse\n\t\troot[\"Sippo\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 115);\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*!\r\n * EventEmitter2\r\n * https://github.com/hij1nx/EventEmitter2\r\n *\r\n * Copyright (c) 2013 hij1nx\r\n * Licensed under the MIT license.\r\n */\r\n;!function(undefined) {\r\n\r\n  var isArray = Array.isArray ? Array.isArray : function _isArray(obj) {\r\n    return Object.prototype.toString.call(obj) === \"[object Array]\";\r\n  };\r\n  var defaultMaxListeners = 10;\r\n\r\n  function init() {\r\n    this._events = {};\r\n    if (this._conf) {\r\n      configure.call(this, this._conf);\r\n    }\r\n  }\r\n\r\n  function configure(conf) {\r\n    if (conf) {\r\n      this._conf = conf;\r\n\r\n      conf.delimiter && (this.delimiter = conf.delimiter);\r\n      this._maxListeners = conf.maxListeners !== undefined ? conf.maxListeners : defaultMaxListeners;\r\n\r\n      conf.wildcard && (this.wildcard = conf.wildcard);\r\n      conf.newListener && (this._newListener = conf.newListener);\r\n      conf.removeListener && (this._removeListener = conf.removeListener);\r\n      conf.verboseMemoryLeak && (this.verboseMemoryLeak = conf.verboseMemoryLeak);\r\n\r\n      if (this.wildcard) {\r\n        this.listenerTree = {};\r\n      }\r\n    } else {\r\n      this._maxListeners = defaultMaxListeners;\r\n    }\r\n  }\r\n\r\n  function logPossibleMemoryLeak(count, eventName) {\r\n    var errorMsg = '(node) warning: possible EventEmitter memory ' +\r\n        'leak detected. ' + count + ' listeners added. ' +\r\n        'Use emitter.setMaxListeners() to increase limit.';\r\n\r\n    if(this.verboseMemoryLeak){\r\n      errorMsg += ' Event name: ' + eventName + '.';\r\n    }\r\n\r\n    if(typeof process !== 'undefined' && process.emitWarning){\r\n      var e = new Error(errorMsg);\r\n      e.name = 'MaxListenersExceededWarning';\r\n      e.emitter = this;\r\n      e.count = count;\r\n      process.emitWarning(e);\r\n    } else {\r\n      console.error(errorMsg);\r\n\r\n      if (console.trace){\r\n        console.trace();\r\n      }\r\n    }\r\n  }\r\n\r\n  function EventEmitter(conf) {\r\n    this._events = {};\r\n    this._newListener = false;\r\n    this._removeListener = false;\r\n    this.verboseMemoryLeak = false;\r\n    configure.call(this, conf);\r\n  }\r\n  EventEmitter.EventEmitter2 = EventEmitter; // backwards compatibility for exporting EventEmitter property\r\n\r\n  //\r\n  // Attention, function return type now is array, always !\r\n  // It has zero elements if no any matches found and one or more\r\n  // elements (leafs) if there are matches\r\n  //\r\n  function searchListenerTree(handlers, type, tree, i) {\r\n    if (!tree) {\r\n      return [];\r\n    }\r\n    var listeners=[], leaf, len, branch, xTree, xxTree, isolatedBranch, endReached,\r\n        typeLength = type.length, currentType = type[i], nextType = type[i+1];\r\n    if (i === typeLength && tree._listeners) {\r\n      //\r\n      // If at the end of the event(s) list and the tree has listeners\r\n      // invoke those listeners.\r\n      //\r\n      if (typeof tree._listeners === 'function') {\r\n        handlers && handlers.push(tree._listeners);\r\n        return [tree];\r\n      } else {\r\n        for (leaf = 0, len = tree._listeners.length; leaf < len; leaf++) {\r\n          handlers && handlers.push(tree._listeners[leaf]);\r\n        }\r\n        return [tree];\r\n      }\r\n    }\r\n\r\n    if ((currentType === '*' || currentType === '**') || tree[currentType]) {\r\n      //\r\n      // If the event emitted is '*' at this part\r\n      // or there is a concrete match at this patch\r\n      //\r\n      if (currentType === '*') {\r\n        for (branch in tree) {\r\n          if (branch !== '_listeners' && tree.hasOwnProperty(branch)) {\r\n            listeners = listeners.concat(searchListenerTree(handlers, type, tree[branch], i+1));\r\n          }\r\n        }\r\n        return listeners;\r\n      } else if(currentType === '**') {\r\n        endReached = (i+1 === typeLength || (i+2 === typeLength && nextType === '*'));\r\n        if(endReached && tree._listeners) {\r\n          // The next element has a _listeners, add it to the handlers.\r\n          listeners = listeners.concat(searchListenerTree(handlers, type, tree, typeLength));\r\n        }\r\n\r\n        for (branch in tree) {\r\n          if (branch !== '_listeners' && tree.hasOwnProperty(branch)) {\r\n            if(branch === '*' || branch === '**') {\r\n              if(tree[branch]._listeners && !endReached) {\r\n                listeners = listeners.concat(searchListenerTree(handlers, type, tree[branch], typeLength));\r\n              }\r\n              listeners = listeners.concat(searchListenerTree(handlers, type, tree[branch], i));\r\n            } else if(branch === nextType) {\r\n              listeners = listeners.concat(searchListenerTree(handlers, type, tree[branch], i+2));\r\n            } else {\r\n              // No match on this one, shift into the tree but not in the type array.\r\n              listeners = listeners.concat(searchListenerTree(handlers, type, tree[branch], i));\r\n            }\r\n          }\r\n        }\r\n        return listeners;\r\n      }\r\n\r\n      listeners = listeners.concat(searchListenerTree(handlers, type, tree[currentType], i+1));\r\n    }\r\n\r\n    xTree = tree['*'];\r\n    if (xTree) {\r\n      //\r\n      // If the listener tree will allow any match for this part,\r\n      // then recursively explore all branches of the tree\r\n      //\r\n      searchListenerTree(handlers, type, xTree, i+1);\r\n    }\r\n\r\n    xxTree = tree['**'];\r\n    if(xxTree) {\r\n      if(i < typeLength) {\r\n        if(xxTree._listeners) {\r\n          // If we have a listener on a '**', it will catch all, so add its handler.\r\n          searchListenerTree(handlers, type, xxTree, typeLength);\r\n        }\r\n\r\n        // Build arrays of matching next branches and others.\r\n        for(branch in xxTree) {\r\n          if(branch !== '_listeners' && xxTree.hasOwnProperty(branch)) {\r\n            if(branch === nextType) {\r\n              // We know the next element will match, so jump twice.\r\n              searchListenerTree(handlers, type, xxTree[branch], i+2);\r\n            } else if(branch === currentType) {\r\n              // Current node matches, move into the tree.\r\n              searchListenerTree(handlers, type, xxTree[branch], i+1);\r\n            } else {\r\n              isolatedBranch = {};\r\n              isolatedBranch[branch] = xxTree[branch];\r\n              searchListenerTree(handlers, type, { '**': isolatedBranch }, i+1);\r\n            }\r\n          }\r\n        }\r\n      } else if(xxTree._listeners) {\r\n        // We have reached the end and still on a '**'\r\n        searchListenerTree(handlers, type, xxTree, typeLength);\r\n      } else if(xxTree['*'] && xxTree['*']._listeners) {\r\n        searchListenerTree(handlers, type, xxTree['*'], typeLength);\r\n      }\r\n    }\r\n\r\n    return listeners;\r\n  }\r\n\r\n  function growListenerTree(type, listener) {\r\n\r\n    type = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n\r\n    //\r\n    // Looks for two consecutive '**', if so, don't add the event at all.\r\n    //\r\n    for(var i = 0, len = type.length; i+1 < len; i++) {\r\n      if(type[i] === '**' && type[i+1] === '**') {\r\n        return;\r\n      }\r\n    }\r\n\r\n    var tree = this.listenerTree;\r\n    var name = type.shift();\r\n\r\n    while (name !== undefined) {\r\n\r\n      if (!tree[name]) {\r\n        tree[name] = {};\r\n      }\r\n\r\n      tree = tree[name];\r\n\r\n      if (type.length === 0) {\r\n\r\n        if (!tree._listeners) {\r\n          tree._listeners = listener;\r\n        }\r\n        else {\r\n          if (typeof tree._listeners === 'function') {\r\n            tree._listeners = [tree._listeners];\r\n          }\r\n\r\n          tree._listeners.push(listener);\r\n\r\n          if (\r\n            !tree._listeners.warned &&\r\n            this._maxListeners > 0 &&\r\n            tree._listeners.length > this._maxListeners\r\n          ) {\r\n            tree._listeners.warned = true;\r\n            logPossibleMemoryLeak.call(this, tree._listeners.length, name);\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      name = type.shift();\r\n    }\r\n    return true;\r\n  }\r\n\r\n  // By default EventEmitters will print a warning if more than\r\n  // 10 listeners are added to it. This is a useful default which\r\n  // helps finding memory leaks.\r\n  //\r\n  // Obviously not all Emitters should be limited to 10. This function allows\r\n  // that to be increased. Set to zero for unlimited.\r\n\r\n  EventEmitter.prototype.delimiter = '.';\r\n\r\n  EventEmitter.prototype.setMaxListeners = function(n) {\r\n    if (n !== undefined) {\r\n      this._maxListeners = n;\r\n      if (!this._conf) this._conf = {};\r\n      this._conf.maxListeners = n;\r\n    }\r\n  };\r\n\r\n  EventEmitter.prototype.event = '';\r\n\r\n\r\n  EventEmitter.prototype.once = function(event, fn) {\r\n    return this._once(event, fn, false);\r\n  };\r\n\r\n  EventEmitter.prototype.prependOnceListener = function(event, fn) {\r\n    return this._once(event, fn, true);\r\n  };\r\n\r\n  EventEmitter.prototype._once = function(event, fn, prepend) {\r\n    this._many(event, 1, fn, prepend);\r\n    return this;\r\n  };\r\n\r\n  EventEmitter.prototype.many = function(event, ttl, fn) {\r\n    return this._many(event, ttl, fn, false);\r\n  }\r\n\r\n  EventEmitter.prototype.prependMany = function(event, ttl, fn) {\r\n    return this._many(event, ttl, fn, true);\r\n  }\r\n\r\n  EventEmitter.prototype._many = function(event, ttl, fn, prepend) {\r\n    var self = this;\r\n\r\n    if (typeof fn !== 'function') {\r\n      throw new Error('many only accepts instances of Function');\r\n    }\r\n\r\n    function listener() {\r\n      if (--ttl === 0) {\r\n        self.off(event, listener);\r\n      }\r\n      return fn.apply(this, arguments);\r\n    }\r\n\r\n    listener._origin = fn;\r\n\r\n    this._on(event, listener, prepend);\r\n\r\n    return self;\r\n  };\r\n\r\n  EventEmitter.prototype.emit = function() {\r\n\r\n    this._events || init.call(this);\r\n\r\n    var type = arguments[0];\r\n\r\n    if (type === 'newListener' && !this._newListener) {\r\n      if (!this._events.newListener) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    var al = arguments.length;\r\n    var args,l,i,j;\r\n    var handler;\r\n\r\n    if (this._all && this._all.length) {\r\n      handler = this._all.slice();\r\n      if (al > 3) {\r\n        args = new Array(al);\r\n        for (j = 0; j < al; j++) args[j] = arguments[j];\r\n      }\r\n\r\n      for (i = 0, l = handler.length; i < l; i++) {\r\n        this.event = type;\r\n        switch (al) {\r\n        case 1:\r\n          handler[i].call(this, type);\r\n          break;\r\n        case 2:\r\n          handler[i].call(this, type, arguments[1]);\r\n          break;\r\n        case 3:\r\n          handler[i].call(this, type, arguments[1], arguments[2]);\r\n          break;\r\n        default:\r\n          handler[i].apply(this, args);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.wildcard) {\r\n      handler = [];\r\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n      searchListenerTree.call(this, handler, ns, this.listenerTree, 0);\r\n    } else {\r\n      handler = this._events[type];\r\n      if (typeof handler === 'function') {\r\n        this.event = type;\r\n        switch (al) {\r\n        case 1:\r\n          handler.call(this);\r\n          break;\r\n        case 2:\r\n          handler.call(this, arguments[1]);\r\n          break;\r\n        case 3:\r\n          handler.call(this, arguments[1], arguments[2]);\r\n          break;\r\n        default:\r\n          args = new Array(al - 1);\r\n          for (j = 1; j < al; j++) args[j - 1] = arguments[j];\r\n          handler.apply(this, args);\r\n        }\r\n        return true;\r\n      } else if (handler) {\r\n        // need to make copy of handlers because list can change in the middle\r\n        // of emit call\r\n        handler = handler.slice();\r\n      }\r\n    }\r\n\r\n    if (handler && handler.length) {\r\n      if (al > 3) {\r\n        args = new Array(al - 1);\r\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\r\n      }\r\n      for (i = 0, l = handler.length; i < l; i++) {\r\n        this.event = type;\r\n        switch (al) {\r\n        case 1:\r\n          handler[i].call(this);\r\n          break;\r\n        case 2:\r\n          handler[i].call(this, arguments[1]);\r\n          break;\r\n        case 3:\r\n          handler[i].call(this, arguments[1], arguments[2]);\r\n          break;\r\n        default:\r\n          handler[i].apply(this, args);\r\n        }\r\n      }\r\n      return true;\r\n    } else if (!this._all && type === 'error') {\r\n      if (arguments[1] instanceof Error) {\r\n        throw arguments[1]; // Unhandled 'error' event\r\n      } else {\r\n        throw new Error(\"Uncaught, unspecified 'error' event.\");\r\n      }\r\n      return false;\r\n    }\r\n\r\n    return !!this._all;\r\n  };\r\n\r\n  EventEmitter.prototype.emitAsync = function() {\r\n\r\n    this._events || init.call(this);\r\n\r\n    var type = arguments[0];\r\n\r\n    if (type === 'newListener' && !this._newListener) {\r\n        if (!this._events.newListener) { return Promise.resolve([false]); }\r\n    }\r\n\r\n    var promises= [];\r\n\r\n    var al = arguments.length;\r\n    var args,l,i,j;\r\n    var handler;\r\n\r\n    if (this._all) {\r\n      if (al > 3) {\r\n        args = new Array(al);\r\n        for (j = 1; j < al; j++) args[j] = arguments[j];\r\n      }\r\n      for (i = 0, l = this._all.length; i < l; i++) {\r\n        this.event = type;\r\n        switch (al) {\r\n        case 1:\r\n          promises.push(this._all[i].call(this, type));\r\n          break;\r\n        case 2:\r\n          promises.push(this._all[i].call(this, type, arguments[1]));\r\n          break;\r\n        case 3:\r\n          promises.push(this._all[i].call(this, type, arguments[1], arguments[2]));\r\n          break;\r\n        default:\r\n          promises.push(this._all[i].apply(this, args));\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.wildcard) {\r\n      handler = [];\r\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n      searchListenerTree.call(this, handler, ns, this.listenerTree, 0);\r\n    } else {\r\n      handler = this._events[type];\r\n    }\r\n\r\n    if (typeof handler === 'function') {\r\n      this.event = type;\r\n      switch (al) {\r\n      case 1:\r\n        promises.push(handler.call(this));\r\n        break;\r\n      case 2:\r\n        promises.push(handler.call(this, arguments[1]));\r\n        break;\r\n      case 3:\r\n        promises.push(handler.call(this, arguments[1], arguments[2]));\r\n        break;\r\n      default:\r\n        args = new Array(al - 1);\r\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\r\n        promises.push(handler.apply(this, args));\r\n      }\r\n    } else if (handler && handler.length) {\r\n      handler = handler.slice();\r\n      if (al > 3) {\r\n        args = new Array(al - 1);\r\n        for (j = 1; j < al; j++) args[j - 1] = arguments[j];\r\n      }\r\n      for (i = 0, l = handler.length; i < l; i++) {\r\n        this.event = type;\r\n        switch (al) {\r\n        case 1:\r\n          promises.push(handler[i].call(this));\r\n          break;\r\n        case 2:\r\n          promises.push(handler[i].call(this, arguments[1]));\r\n          break;\r\n        case 3:\r\n          promises.push(handler[i].call(this, arguments[1], arguments[2]));\r\n          break;\r\n        default:\r\n          promises.push(handler[i].apply(this, args));\r\n        }\r\n      }\r\n    } else if (!this._all && type === 'error') {\r\n      if (arguments[1] instanceof Error) {\r\n        return Promise.reject(arguments[1]); // Unhandled 'error' event\r\n      } else {\r\n        return Promise.reject(\"Uncaught, unspecified 'error' event.\");\r\n      }\r\n    }\r\n\r\n    return Promise.all(promises);\r\n  };\r\n\r\n  EventEmitter.prototype.on = function(type, listener) {\r\n    return this._on(type, listener, false);\r\n  };\r\n\r\n  EventEmitter.prototype.prependListener = function(type, listener) {\r\n    return this._on(type, listener, true);\r\n  };\r\n\r\n  EventEmitter.prototype.onAny = function(fn) {\r\n    return this._onAny(fn, false);\r\n  };\r\n\r\n  EventEmitter.prototype.prependAny = function(fn) {\r\n    return this._onAny(fn, true);\r\n  };\r\n\r\n  EventEmitter.prototype.addListener = EventEmitter.prototype.on;\r\n\r\n  EventEmitter.prototype._onAny = function(fn, prepend){\r\n    if (typeof fn !== 'function') {\r\n      throw new Error('onAny only accepts instances of Function');\r\n    }\r\n\r\n    if (!this._all) {\r\n      this._all = [];\r\n    }\r\n\r\n    // Add the function to the event listener collection.\r\n    if(prepend){\r\n      this._all.unshift(fn);\r\n    }else{\r\n      this._all.push(fn);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  EventEmitter.prototype._on = function(type, listener, prepend) {\r\n    if (typeof type === 'function') {\r\n      this._onAny(type, listener);\r\n      return this;\r\n    }\r\n\r\n    if (typeof listener !== 'function') {\r\n      throw new Error('on only accepts instances of Function');\r\n    }\r\n    this._events || init.call(this);\r\n\r\n    // To avoid recursion in the case that type == \"newListeners\"! Before\r\n    // adding it to the listeners, first emit \"newListeners\".\r\n    if (this._newListener)\r\n       this.emit('newListener', type, listener);\r\n\r\n    if (this.wildcard) {\r\n      growListenerTree.call(this, type, listener);\r\n      return this;\r\n    }\r\n\r\n    if (!this._events[type]) {\r\n      // Optimize the case of one listener. Don't need the extra array object.\r\n      this._events[type] = listener;\r\n    }\r\n    else {\r\n      if (typeof this._events[type] === 'function') {\r\n        // Change to array.\r\n        this._events[type] = [this._events[type]];\r\n      }\r\n\r\n      // If we've already got an array, just add\r\n      if(prepend){\r\n        this._events[type].unshift(listener);\r\n      }else{\r\n        this._events[type].push(listener);\r\n      }\r\n\r\n      // Check for listener leak\r\n      if (\r\n        !this._events[type].warned &&\r\n        this._maxListeners > 0 &&\r\n        this._events[type].length > this._maxListeners\r\n      ) {\r\n        this._events[type].warned = true;\r\n        logPossibleMemoryLeak.call(this, this._events[type].length, type);\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  EventEmitter.prototype.off = function(type, listener) {\r\n    if (typeof listener !== 'function') {\r\n      throw new Error('removeListener only takes instances of Function');\r\n    }\r\n\r\n    var handlers,leafs=[];\r\n\r\n    if(this.wildcard) {\r\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n      leafs = searchListenerTree.call(this, null, ns, this.listenerTree, 0);\r\n    }\r\n    else {\r\n      // does not use listeners(), so no side effect of creating _events[type]\r\n      if (!this._events[type]) return this;\r\n      handlers = this._events[type];\r\n      leafs.push({_listeners:handlers});\r\n    }\r\n\r\n    for (var iLeaf=0; iLeaf<leafs.length; iLeaf++) {\r\n      var leaf = leafs[iLeaf];\r\n      handlers = leaf._listeners;\r\n      if (isArray(handlers)) {\r\n\r\n        var position = -1;\r\n\r\n        for (var i = 0, length = handlers.length; i < length; i++) {\r\n          if (handlers[i] === listener ||\r\n            (handlers[i].listener && handlers[i].listener === listener) ||\r\n            (handlers[i]._origin && handlers[i]._origin === listener)) {\r\n            position = i;\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (position < 0) {\r\n          continue;\r\n        }\r\n\r\n        if(this.wildcard) {\r\n          leaf._listeners.splice(position, 1);\r\n        }\r\n        else {\r\n          this._events[type].splice(position, 1);\r\n        }\r\n\r\n        if (handlers.length === 0) {\r\n          if(this.wildcard) {\r\n            delete leaf._listeners;\r\n          }\r\n          else {\r\n            delete this._events[type];\r\n          }\r\n        }\r\n        if (this._removeListener)\r\n          this.emit(\"removeListener\", type, listener);\r\n\r\n        return this;\r\n      }\r\n      else if (handlers === listener ||\r\n        (handlers.listener && handlers.listener === listener) ||\r\n        (handlers._origin && handlers._origin === listener)) {\r\n        if(this.wildcard) {\r\n          delete leaf._listeners;\r\n        }\r\n        else {\r\n          delete this._events[type];\r\n        }\r\n        if (this._removeListener)\r\n          this.emit(\"removeListener\", type, listener);\r\n      }\r\n    }\r\n\r\n    function recursivelyGarbageCollect(root) {\r\n      if (root === undefined) {\r\n        return;\r\n      }\r\n      var keys = Object.keys(root);\r\n      for (var i in keys) {\r\n        var key = keys[i];\r\n        var obj = root[key];\r\n        if ((obj instanceof Function) || (typeof obj !== \"object\") || (obj === null))\r\n          continue;\r\n        if (Object.keys(obj).length > 0) {\r\n          recursivelyGarbageCollect(root[key]);\r\n        }\r\n        if (Object.keys(obj).length === 0) {\r\n          delete root[key];\r\n        }\r\n      }\r\n    }\r\n    recursivelyGarbageCollect(this.listenerTree);\r\n\r\n    return this;\r\n  };\r\n\r\n  EventEmitter.prototype.offAny = function(fn) {\r\n    var i = 0, l = 0, fns;\r\n    if (fn && this._all && this._all.length > 0) {\r\n      fns = this._all;\r\n      for(i = 0, l = fns.length; i < l; i++) {\r\n        if(fn === fns[i]) {\r\n          fns.splice(i, 1);\r\n          if (this._removeListener)\r\n            this.emit(\"removeListenerAny\", fn);\r\n          return this;\r\n        }\r\n      }\r\n    } else {\r\n      fns = this._all;\r\n      if (this._removeListener) {\r\n        for(i = 0, l = fns.length; i < l; i++)\r\n          this.emit(\"removeListenerAny\", fns[i]);\r\n      }\r\n      this._all = [];\r\n    }\r\n    return this;\r\n  };\r\n\r\n  EventEmitter.prototype.removeListener = EventEmitter.prototype.off;\r\n\r\n  EventEmitter.prototype.removeAllListeners = function(type) {\r\n    if (type === undefined) {\r\n      !this._events || init.call(this);\r\n      return this;\r\n    }\r\n\r\n    if (this.wildcard) {\r\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n      var leafs = searchListenerTree.call(this, null, ns, this.listenerTree, 0);\r\n\r\n      for (var iLeaf=0; iLeaf<leafs.length; iLeaf++) {\r\n        var leaf = leafs[iLeaf];\r\n        leaf._listeners = null;\r\n      }\r\n    }\r\n    else if (this._events) {\r\n      this._events[type] = null;\r\n    }\r\n    return this;\r\n  };\r\n\r\n  EventEmitter.prototype.listeners = function(type) {\r\n    if (this.wildcard) {\r\n      var handlers = [];\r\n      var ns = typeof type === 'string' ? type.split(this.delimiter) : type.slice();\r\n      searchListenerTree.call(this, handlers, ns, this.listenerTree, 0);\r\n      return handlers;\r\n    }\r\n\r\n    this._events || init.call(this);\r\n\r\n    if (!this._events[type]) this._events[type] = [];\r\n    if (!isArray(this._events[type])) {\r\n      this._events[type] = [this._events[type]];\r\n    }\r\n    return this._events[type];\r\n  };\r\n\r\n  EventEmitter.prototype.eventNames = function(){\r\n    return Object.keys(this._events);\r\n  }\r\n\r\n  EventEmitter.prototype.listenerCount = function(type) {\r\n    return this.listeners(type).length;\r\n  };\r\n\r\n  EventEmitter.prototype.listenersAny = function() {\r\n\r\n    if(this._all) {\r\n      return this._all;\r\n    }\r\n    else {\r\n      return [];\r\n    }\r\n\r\n  };\r\n\r\n  if (typeof define === 'function' && define.amd) {\r\n     // AMD. Register as an anonymous module.\r\n    define(function() {\r\n      return EventEmitter;\r\n    });\r\n  } else if (typeof exports === 'object') {\r\n    // CommonJS\r\n    module.exports = EventEmitter;\r\n  }\r\n  else {\r\n    // Browser global.\r\n    window.EventEmitter2 = EventEmitter;\r\n  }\r\n}();\r\n","import { __awaiter } from 'tslib';\nimport { EventEmitter } from 'events';\nimport Punycode from 'punycode';\nimport { Transform } from 'readable-stream';\nimport { getMediaSections, getDescription, matchPrefix, getKind, isRejected, parseMLine, getDirection, getMid, getIceParameters, getDtlsParameters, parseRtpParameters, parseRtpEncodingParameters, parseRtcpParameters, parseMsid, parseSctpDescription, parseCandidate, writeSessionBoilerplate, writeSctpDescription, writeRtpDescription, writeIceParameters, writeDtlsParameters, writeCandidate } from 'sdp';\nimport { priorityQueue } from 'async';\n\nconst TABLE_DATA = {\n    'A.1': {\n        r: 'hk:if|le:lf|nf:nv|qg:qv|rg:rj|rm:rp|rr:rt|rv:s3|vn:vv|17m:17n|17q:17v|18g:19g|1an:1ao|1cb:1cg|1e5:1ef|1fb:1ff|1fl:1gb|1gd:1gq|1gs:1gu|1hr:1hv|1im:1iv|1ne:1nf|1pd:1pf|1qb:1rv|1ti:280|29q:29r|2ae:2af|2al:2an|2bh:2c0|2cd:2ce|2ch:2ci|2dj:2dl|2dq:2dr|2e5:2e6|2e9:2ea|2ee:2em|2eo:2er|2f4:2f5|2fr:2g1|2g3:2g4|2gb:2ge|2gh:2gi|2hq:2hr|2i3:2i6|2i9:2ia|2ie:2io|2iv:2j5|2jl:2k0|2lq:2lr|2me:2mf|2mh:2mv|2n1:2n5|2ng:2o0|2od:2oe|2oh:2oi|2pk:2pl|2pq:2pr|2q4:2q6|2q9:2qa|2qe:2ql|2qo:2qr|2r2:2r5|2rh:2s1|2sb:2sd|2sm:2so|2t0:2t2|2t5:2t7|2tb:2td|2tq:2tt|2u3:2u5|2ue:2um|2uo:2v6|2vj:300|31q:31t|32e:32k|32n:32v|332:335|33g:341|35q:35t|36e:36k|36n:36t|372:375|37g:381|39q:39t|3a4:3a5|3ae:3am|3ao:3av|3b2:3b5|3bg:3c1|3cn:3cp|3du:3dv|3e7:3e9|3eb:3ee|3f0:3fh|3fl:3g0|3hr:3hu|3is:3k0|3k5:3k6|3kb:3kc|3ke:3kj|3l8:3l9|3lu:3lv|3me:3mf|3mq:3mr|3mu:3nv|3rb:3rg|3sc:3sf|3ud:3ue|3ug:3vv|41j:41l|41q:41v|42q:44v|466:46f|47p:47q|47s:47v|4aq:4au|4d3:4d7|4fq:4fv|4ie:4if|4iu:4iv|4ke:4kf|4lm:4ln|4m6:4m7|4om:4on|4qr:4r0|4rt:4sv|4vl:500|5jn:5jv|5kt:5kv|5nh:5nv|5ol:5ov|5pn:5pv|5qk:5qv|5rk:5rv|5ut:5uv|5va:5vv|60q:60v|63o:63v|65a:7fv|7ks:7kv|7nq:7nv|7om:7on|7ou:7ov|7q6:7q7|7qe:7qf|7ru:7rv|7uk:7ul|7vg:7vh|82j:82m|82o:82u|834:839|83i:83j|84f:84v|85i:86f|87b:87v|89r:89s|8ac:8ai|8c4:8cf|8uf:8vv|917:91v|92b:92v|9gk:9gl|9ju:9jv|9ka:9o0|9oa:9ob|9qj:9ql|9qv:9r0|9sl:9sn|9tv:9uf|9vc:9vf|ao0:bjv|bnk:bnv|bum:bvf|bvs:bvv|c4n:c4o|c80:c84|c9d:c9g|cdo:cff|cgt:cgv|ci4:cig|cjs:cju|cmc:cmf|crn:crq|cuu:cuv|jdm:jfv|17t6:17vv|194d:194f|1967:1avv|1lt4:1lvv|1uhe:1uhf|1ujb:1unv|1uo7:1uoi|1uoo:1uos|1uti:1uui|1va0:1vaf|1vcg:1vch|1ve8:1vef|1vft:1vfv|1vgg:1vgv|1vh4:1vhf|1vi7:1vi8|1vjc:1vjf|1vnt:1vnu|1vtv:1vu1|1vu8:1vu9|1vug:1vuh|1vuo:1vup|1vut:1vuv|1vvf:1vvo|2000:20nv|20p4:20pf|20qb:20vv|2116:2117|212e:3jvv|3k7m:3k7v|3k97:3k99|3keu:3kvv|3l50:3l51|3l53:3l54|3l57:3l58|3l8b:3l8c|3la7:3la9|3ll4:3ll7|3lua:3lud|3m00:3vvt|59mn:5tvv|5ugu:5vvt|6000:7vvt|8000:9vvt|a000:bvvt|c000:dvvt|e000:fvvt|g000:hvvt|i000:jvvt|k000:lvvt|m000:nvvt|o000:pvvt|q000:rvvt|s002:s00v|s040:tvvt',\n        s: '9p8|9qc|9qe|9qn|9tg|147|bkq|3l2l|3l4t|3l5d|3l5q|3l5s|3l61|3l64|3l86|3l8l|3l8t|3l9q|3l9v|3la5|3lah|16f|c20|ccf|cnv|cvv|1b0|1c8|1d2|1dq|1h0|1nv|1oe|284|2c4|2d9|2dh|2dt|2eu|2h9|2hh|2hk|2hn|2ht|2it|2k4|2kc|2ke|2ki|2l9|2lh|2lk|2m6|2ma|2o4|2p9|2ph|2qu|2s4|2sh|2sr|2st|2tm|2u9|304|30d|30h|319|31k|325|329|344|34d|34h|359|35k|365|369|36v|384|38d|38h|399|3a9|3c4|3di|3ds|3el|3en|3k3|3k9|3ko|3l0|3l4|3l6|3lc|3lq|3m5|3m7|3q8|3so|3tt|412|418|41b|4g7|4i7|4i9|4in|4ip|4k7|4k9|4lf|4lh|4lv|4m1|4mf|4mn|4nf|4of|4oh|4ov|4q7|h1|5od|5rd|5rh|60f|1upn|1upt|1upv|1uq2|1uq5|1vij|1vj7|1vjl|1vo0|1vv7|20ov|7qo|7qq|7qs|7qu|7tl|7u5|7us|7vl|7vv|sb|sd|s000|t2|97v|uf|9go|9o5'\n    },\n    'B.1': {\n        r: '60b:60d|80b:80d|1vg0:1vgf',\n        s: '5d|606|1vnv|830|qf'\n    },\n    'B.2': {\n        m: '5l:ts|6v:3j;3j|9g:39;o7|a9:ls;3e|bv:3j|fg:3a;oc|q5:tp|rq:10;tp|sg:tp;o8;o1|tg:u5;o8;o1|u2:u3|ug:ti|uh:to|ui:u5|uj:ud|uk:ub|ul:u6|um:u0|vg:tq|vh:u1|vi:u3|vl:tl|1c7:1b5;1c2|7km:38;ph|7kn:3k;o8|7ko:3n;oa|7kp:3p;oa|7kq:31;lu|7kr:7j1|7qg:u5;oj|7qi:u5;oj;o0|7qk:u5;oj;o1|7qm:u5;oj;q2|7s0:7o0;tp|7s1:7o1;tp|7s2:7o2;tp|7s3:7o3;tp|7s4:7o4;tp|7s5:7o5;tp|7s6:7o6;tp|7s7:7o7;tp|7s8:7o0;tp|7s9:7o1;tp|7sa:7o2;tp|7sb:7o3;tp|7sc:7o4;tp|7sd:7o5;tp|7se:7o6;tp|7sf:7o7;tp|7sg:7p0;tp|7sh:7p1;tp|7si:7p2;tp|7sj:7p3;tp|7sk:7p4;tp|7sl:7p5;tp|7sm:7p6;tp|7sn:7p7;tp|7so:7p0;tp|7sp:7p1;tp|7sq:7p2;tp|7sr:7p3;tp|7ss:7p4;tp|7st:7p5;tp|7su:7p6;tp|7sv:7p7;tp|7t0:7r0;tp|7t1:7r1;tp|7t2:7r2;tp|7t3:7r3;tp|7t4:7r4;tp|7t5:7r5;tp|7t6:7r6;tp|7t7:7r7;tp|7t8:7r0;tp|7t9:7r1;tp|7ta:7r2;tp|7tb:7r3;tp|7tc:7r4;tp|7td:7r5;tp|7te:7r6;tp|7tf:7r7;tp|7ti:7rg;tp|7tj:th;tp|7tk:tc;tp|7tm:th;q2|7tn:th;q2;tp|7ts:th;tp|7tu:tp|7u2:7rk;tp|7u3:tn;tp|7u4:te;tp|7u6:tn;q2|7u7:tn;q2;tp|7uc:tn;tp|7ui:tp;o8;o0|7uj:tp;o8;o1|7um:tp;q2|7un:tp;o8;q2|7v2:u5;o8;o0|7v3:u5;o8;o1|7v4:u1;oj|7v6:u5;q2|7v7:u5;o8;q2|7vi:7rs;tp|7vj:u9;tp|7vk:ue;tp|7vm:u9;q2|7vn:u9;q2;tp|7vs:u9;tp|858:3i;3j|882:33|883:5g;33|887:ir|889:5g;36|88b:38|88c:38|88d:38|88g:39|88h:39|88i:3c|88l:3e|88m:3e;3f|88p:3g|88q:3h|88r:3i|88s:3i|88t:3i|890:3j;3d|891:3k;35;3c|892:3k;3d|894:3q|898:3q|89c:32|89d:33|89g:35|89h:36|89j:3d|89u:tj|89v:u0|8a5:34|crh:38;3g;31|crj:31;3l|crl:3f;3m|cs0:3g;31|cs1:3e;31|cs2:ts;31|cs3:3d;31|cs4:3b;31|cs5:3b;32|cs6:3d;32|cs7:37;32|csa:3g;36|csb:3e;36|csc:ts;36|csg:38;3q|csh:3b;38;3q|csi:3d;38;3q|csj:37;38;3q|csk:3k;38;3q|ct9:3g;31|cta:3b;3g;31|ctb:3d;3g;31|ctc:37;3g;31|ctk:3g;3m|ctl:3e;3m|ctm:ts;3m|ctn:3d;3m|cto:3b;3m|ctp:3d;3m|ctq:3g;3n|ctr:3e;3n|cts:ts;3n|ctt:3d;3n|ctu:3b;3n|ctv:3d;3n|cu0:3b;u9|cu1:3d;u9|cu3:32;3h|cu6:33;8gl;3b;37|cu7:33;3f;1e|cu8:34;32|cu9:37;3p|cub:38;3g|cud:3b;3b|cue:3b;3d|cun:3g;38|cup:3g;3g;3d|cuq:3g;3i|cus:3j;3m|cut:3n;32|1uo0:36;36|1uo1:36;39|1uo2:36;3c|1uo3:36;36;39|1uo4:36;36;3c|1uo5:3j;3k|1uo6:3j;3k|1uoj:1bk;1bm|1uok:1bk;1b5|1uol:1bk;1bb|1uom:1bu;1bm|1uon:1bk;1bd|3l00:31|3l01:32|3l02:33|3l03:34|3l04:35|3l05:36|3l06:37|3l07:38|3l08:39|3l09:3a|3l0a:3b|3l0b:3c|3l0c:3d|3l0d:3e|3l0e:3f|3l0f:3g|3l0g:3h|3l0h:3i|3l0i:3j|3l0j:3k|3l0k:3l|3l0l:3m|3l0m:3n|3l0n:3o|3l0o:3p|3l0p:3q|3l1k:31|3l1l:32|3l1m:33|3l1n:34|3l1o:35|3l1p:36|3l1q:37|3l1r:38|3l1s:39|3l1t:3a|3l1u:3b|3l1v:3c|3l20:3d|3l21:3e|3l22:3f|3l23:3g|3l24:3h|3l25:3i|3l26:3j|3l27:3k|3l28:3l|3l29:3m|3l2a:3n|3l2b:3o|3l2c:3p|3l2d:3q|3l38:31|3l39:32|3l3a:33|3l3b:34|3l3c:35|3l3d:36|3l3e:37|3l3f:38|3l3g:39|3l3h:3a|3l3i:3b|3l3j:3c|3l3k:3d|3l3l:3e|3l3m:3f|3l3n:3g|3l3o:3h|3l3p:3i|3l3q:3j|3l3r:3k|3l3s:3l|3l3t:3m|3l3u:3n|3l3v:3o|3l40:3p|3l41:3q|3l4s:31|3l4u:33|3l4v:34|3l52:37|3l55:3a|3l56:3b|3l59:3e|3l5a:3f|3l5b:3g|3l5c:3h|3l5e:3j|3l5f:3k|3l5g:3l|3l5h:3m|3l5i:3n|3l5j:3o|3l5k:3p|3l5l:3q|3l6g:31|3l6h:32|3l6i:33|3l6j:34|3l6k:35|3l6l:36|3l6m:37|3l6n:38|3l6o:39|3l6p:3a|3l6q:3b|3l6r:3c|3l6s:3d|3l6t:3e|3l6u:3f|3l6v:3g|3l70:3h|3l71:3i|3l72:3j|3l73:3k|3l74:3l|3l75:3m|3l76:3n|3l77:3o|3l78:3p|3l79:3q|3l84:31|3l85:32|3l87:34|3l88:35|3l89:36|3l8a:37|3l8d:3a|3l8e:3b|3l8f:3c|3l8g:3d|3l8h:3e|3l8i:3f|3l8j:3g|3l8k:3h|3l8m:3j|3l8n:3k|3l8o:3l|3l8p:3m|3l8q:3n|3l8r:3o|3l8s:3p|3l9o:31|3l9p:32|3l9r:34|3l9s:35|3l9t:36|3l9u:37|3la0:39|3la1:3a|3la2:3b|3la3:3c|3la4:3d|3la6:3f|3laa:3j|3lab:3k|3lac:3l|3lad:3m|3lae:3n|3laf:3o|3lag:3p|3lbc:31|3lbd:32|3lbe:33|3lbf:34|3lbg:35|3lbh:36|3lbi:37|3lbj:38|3lbk:39|3lbl:3a|3lbm:3b|3lbn:3c|3lbo:3d|3lbp:3e|3lbq:3f|3lbr:3g|3lbs:3h|3lbt:3i|3lbu:3j|3lbv:3k|3lc0:3l|3lc1:3m|3lc2:3n|3lc3:3o|3lc4:3p|3lc5:3q|3ld0:31|3ld1:32|3ld2:33|3ld3:34|3ld4:35|3ld5:36|3ld6:37|3ld7:38|3ld8:39|3ld9:3a|3lda:3b|3ldb:3c|3ldc:3d|3ldd:3e|3lde:3f|3ldf:3g|3ldg:3h|3ldh:3i|3ldi:3j|3ldj:3k|3ldk:3l|3ldl:3m|3ldm:3n|3ldn:3o|3ldo:3p|3ldp:3q|3lek:31|3lel:32|3lem:33|3len:34|3leo:35|3lep:36|3leq:37|3ler:38|3les:39|3let:3a|3leu:3b|3lev:3c|3lf0:3d|3lf1:3e|3lf2:3f|3lf3:3g|3lf4:3h|3lf5:3i|3lf6:3j|3lf7:3k|3lf8:3l|3lf9:3m|3lfa:3n|3lfb:3o|3lfc:3p|3lfd:3q|3lg8:31|3lg9:32|3lga:33|3lgb:34|3lgc:35|3lgd:36|3lge:37|3lgf:38|3lgg:39|3lgh:3a|3lgi:3b|3lgj:3c|3lgk:3d|3lgl:3e|3lgm:3f|3lgn:3g|3lgo:3h|3lgp:3i|3lgq:3j|3lgr:3k|3lgs:3l|3lgt:3m|3lgu:3n|3lgv:3o|3lh0:3p|3lh1:3q|3lhs:31|3lht:32|3lhu:33|3lhv:34|3li0:35|3li1:36|3li2:37|3li3:38|3li4:39|3li5:3a|3li6:3b|3li7:3c|3li8:3d|3li9:3e|3lia:3f|3lib:3g|3lic:3h|3lid:3i|3lie:3j|3lif:3k|3lig:3l|3lih:3m|3lii:3n|3lij:3o|3lik:3p|3lil:3q|3ljg:31|3ljh:32|3lji:33|3ljj:34|3ljk:35|3ljl:36|3ljm:37|3ljn:38|3ljo:39|3ljp:3a|3ljq:3b|3ljr:3c|3ljs:3d|3ljt:3e|3lju:3f|3ljv:3g|3lk0:3h|3lk1:3i|3lk2:3j|3lk3:3k|3lk4:3l|3lk5:3m|3lk6:3n|3lk7:3o|3lk8:3p|3lk9:3q|3ll8:th|3ll9:ti|3lla:tj|3llb:tk|3llc:tl|3lld:tm|3lle:tn|3llf:to|3llg:tp|3llh:tq|3lli:tr|3llj:ts|3llk:tt|3lll:tu|3llm:tv|3lln:u0|3llo:u1|3llp:to|3llq:u3|3llr:u4|3lls:u5|3llt:u6|3llu:u7|3llv:u8|3lm0:u9|3lmj:u3|3ln2:th|3ln3:ti|3ln4:tj|3ln5:tk|3ln6:tl|3ln7:tm|3ln8:tn|3ln9:to|3lna:tp|3lnb:tq|3lnc:tr|3lnd:ts|3lne:tt|3lnf:tu|3lng:tv|3lnh:u0|3lni:u1|3lnj:to|3lnk:u3|3lnl:u4|3lnm:u5|3lnn:u6|3lno:u7|3lnp:u8|3lnq:u9|3lod:u3|3los:th|3lot:ti|3lou:tj|3lov:tk|3lp0:tl|3lp1:tm|3lp2:tn|3lp3:to|3lp4:tp|3lp5:tq|3lp6:tr|3lp7:ts|3lp8:tt|3lp9:tu|3lpa:tv|3lpb:u0|3lpc:u1|3lpd:to|3lpe:u3|3lpf:u4|3lpg:u5|3lph:u6|3lpi:u7|3lpj:u8|3lpk:u9|3lq7:u3|3lqm:th|3lqn:ti|3lqo:tj|3lqp:tk|3lqq:tl|3lqr:tm|3lqs:tn|3lqt:to|3lqu:tp|3lqv:tq|3lr0:tr|3lr1:ts|3lr2:tt|3lr3:tu|3lr4:tv|3lr5:u0|3lr6:u1|3lr7:to|3lr8:u3|3lr9:u4|3lra:u5|3lrb:u6|3lrc:u7|3lrd:u8|3lre:u9|3ls1:u3|3lsg:th|3lsh:ti|3lsi:tj|3lsj:tk|3lsk:tl|3lsl:tm|3lsm:tn|3lsn:to|3lso:tp|3lsp:tq|3lsq:tr|3lsr:ts|3lss:tt|3lst:tu|3lsu:tv|3lsv:u0|3lt0:u1|3lt1:to|3lt2:u3|3lt3:u4|3lt4:u5|3lt5:u6|3lt6:u7|3lt7:u8|3lt8:u9|3ltr:u3',\n        r: '23:2c|2i:2k|2m:2q|60:6m|6o:6u|bo:bp|c1:c2|c6:c7|c9:cb|ce:ch|cj:ck|cm:co|cs:ct|cv:d0|d6:d7|de:df|dh:dj|dn:do|e4:e5|e7:e8|ea:eb|fh:fi|fm:fo|s8:sa|se:sf|sh:t1|t3:tb|100:11f|19h:1am|7o8:7of|7oo:7ot|7p8:7pf|7po:7pv|7q8:7qd|7r8:7rf|7to:7tr|7u8:7ub|7uo:7ur|7v8:7vc|7vo:7vr|89a:89b|8b0:8bf|95m:96f|1vp1:1vpq|2100:2115',\n        s: 'v8|va|vc|ve|vk|130|132|134|136|138|13a|13c|13e|13g|13i|13k|13m|13o|13q|13s|13u|140|14a|14c|14e|14g|14i|14k|14m|14o|14q|14s|14u|150|152|154|156|158|15a|15c|15e|15g|15i|15k|15m|15o|15q|15s|15u|161|163|165|167|169|16b|16d|16g|16i|16k|16m|16o|16q|16s|16u|170|172|174|176|178|17a|17c|17e|17g|17i|17k|17o|180|182|184|186|188|18a|18c|18e|80|82|84|86|88|8a|8c|8e|8g|8i|8k|8m|8o|8q|8s|8u|90|92|94|96|98|9a|9c|9e|9i|9k|9m|9p|9r|9t|9v|a1|a3|a5|a7|aa|ac|ae|ag|ai|ak|am|ao|aq|as|au|b0|b2|b4|b6|b8|ba|bc|be|bg|bi|bk|bm|br|bt|c4|d2|d4|d9|dc|dl|ds|ed|ef|eh|ej|el|en|ep|er|eu|f0|f2|f4|f6|f8|fa|fc|fe|fk|fq|fs|fu|g0|g2|g4|g6|g8|ga|gc|ge|gg|gi|gk|gm|go|gq|gs|gu|h0|h2|h4|h6|h8|ha|hc|he|hg|hi|21|22|7g0|7g2|7g4|7g6|7g8|7ga|7gc|7ge|7gg|7gi|2d|7gk|7gm|7go|7gq|7gs|7gu|7h0|7h2|7h4|7h6|7h8|7ha|7hc|7he|7hg|7hi|7hk|7hm|7ho|7hq|7hs|7hu|7i0|7i2|7i4|7i6|7i8|7ia|7ic|7ie|7ig|7ii|7ik|7im|7io|7iq|7is|7iu|7j0|7j2|7j4|7j6|7j8|7ja|7jc|7je|7jg|7ji|7jk|7jm|2e|7jo|7jq|7js|7ju|7k0|7k2|7k4|7k6|7k8|7ka|7kc|7ke|7kg|7ki|7kk|7l0|7l2|7l4|7l6|7l8|7la|7lc|7le|7lg|7li|7lk|7lm|7lo|7lq|7ls|7lu|7m0|7m2|7m4|7m6|7m8|7ma|7mc|7me|7mg|7mi|7mk|7mm|7mo|7mq|2f|7ms|7mu|7n0|7n2|7n4|7n6|7n8|7na|7nc|7ne|7ng|7ni|7nk|7nm|7no|2g|7qp|7qr|7qt|7qv|2h|896|2l|s6|sc|uo|uq|us|uu|v0|v2|v4|v6'\n    },\n    'B.3': {\n        m: '5l:ts|6v:3j;3j|9g:39;o7|a9:ls;3e|bv:3j|fg:3a;oc|q5:tp|sg:tp;o8;o1|tg:u5;o8;o1|u2:u3|ug:ti|uh:to|ul:u6|um:u0|vg:tq|vh:u1|vi:u3|vl:tl|1c7:1b5;1c2|7km:38;ph|7kn:3k;o8|7ko:3n;oa|7kp:3p;oa|7kq:31;lu|7kr:7j1|7qg:u5;oj|7qi:u5;oj;o0|7qk:u5;oj;o1|7qm:u5;oj;q2|7s0:7o0;tp|7s1:7o1;tp|7s2:7o2;tp|7s3:7o3;tp|7s4:7o4;tp|7s5:7o5;tp|7s6:7o6;tp|7s7:7o7;tp|7s8:7o0;tp|7s9:7o1;tp|7sa:7o2;tp|7sb:7o3;tp|7sc:7o4;tp|7sd:7o5;tp|7se:7o6;tp|7sf:7o7;tp|7sg:7p0;tp|7sh:7p1;tp|7si:7p2;tp|7sj:7p3;tp|7sk:7p4;tp|7sl:7p5;tp|7sm:7p6;tp|7sn:7p7;tp|7so:7p0;tp|7sp:7p1;tp|7sq:7p2;tp|7sr:7p3;tp|7ss:7p4;tp|7st:7p5;tp|7su:7p6;tp|7sv:7p7;tp|7t0:7r0;tp|7t1:7r1;tp|7t2:7r2;tp|7t3:7r3;tp|7t4:7r4;tp|7t5:7r5;tp|7t6:7r6;tp|7t7:7r7;tp|7t8:7r0;tp|7t9:7r1;tp|7ta:7r2;tp|7tb:7r3;tp|7tc:7r4;tp|7td:7r5;tp|7te:7r6;tp|7tf:7r7;tp|7ti:7rg;tp|7tj:th;tp|7tk:tc;tp|7tm:th;q2|7tn:th;q2;tp|7ts:th;tp|7tu:tp|7u2:7rk;tp|7u3:tn;tp|7u4:te;tp|7u6:tn;q2|7u7:tn;q2;tp|7uc:tn;tp|7ui:tp;o8;o0|7uj:tp;o8;o1|7um:tp;q2|7un:tp;o8;q2|7v2:u5;o8;o0|7v3:u5;o8;o1|7v4:u1;oj|7v6:u5;q2|7v7:u5;o8;q2|7vi:7rs;tp|7vj:u9;tp|7vk:ue;tp|7vm:u9;q2|7vn:u9;q2;tp|7vs:u9;tp|1uo0:36;36|1uo1:36;39|1uo2:36;3c|1uo3:36;36;39|1uo4:36;36;3c|1uo5:3j;3k|1uo6:3j;3k|1uoj:1bk;1bm|1uok:1bk;1b5|1uol:1bk;1bb|1uom:1bu;1bm|1uon:1bk;1bd',\n        r: '23:2c|2i:2k|2m:2q|60:6m|6o:6u|bo:bp|c1:c2|c6:c7|c9:cb|ce:ch|cj:ck|cm:co|cs:ct|cv:d0|d6:d7|de:df|dh:dj|dn:do|e4:e5|e7:e8|ea:eb|fh:fi|fm:fo|s8:sa|se:sf|sh:t1|t3:tb|100:11f|19h:1am|7o8:7of|7oo:7ot|7p8:7pf|7po:7pv|7q8:7qd|7r8:7rf|7to:7tr|7u8:7ub|7uo:7ur|7v8:7vc|7vo:7vr|89a:89b|8b0:8bf|95m:96f|1vp1:1vpq|2100:2115',\n        s: 'v8|va|vc|ve|vk|130|132|134|136|138|13a|13c|13e|13g|13i|13k|13m|13o|13q|13s|13u|140|14a|14c|14e|14g|14i|14k|14m|14o|14q|14s|14u|150|152|154|156|158|15a|15c|15e|15g|15i|15k|15m|15o|15q|15s|15u|161|163|165|167|169|16b|16d|16g|16i|16k|16m|16o|16q|16s|16u|170|172|174|176|178|17a|17c|17e|17g|17i|17k|17o|180|182|184|186|188|18a|18c|18e|80|82|84|86|88|8a|8c|8e|8g|8i|8k|8m|8o|8q|8s|8u|90|92|94|96|98|9a|9c|9e|9i|9k|9m|9p|9r|9t|9v|a1|a3|a5|a7|aa|ac|ae|ag|ai|ak|am|ao|aq|as|au|b0|b2|b4|b6|b8|ba|bc|be|bg|bi|bk|bm|br|bt|c4|d2|d4|d9|dc|dl|ds|ed|ef|eh|ej|el|en|ep|er|eu|f0|f2|f4|f6|f8|fa|fc|fe|fk|fq|fs|fu|g0|g2|g4|g6|g8|ga|gc|ge|gg|gi|gk|gm|go|gq|gs|gu|h0|h2|h4|h6|h8|ha|hc|he|hg|hi|21|22|7g0|7g2|7g4|7g6|7g8|7ga|7gc|7ge|7gg|7gi|2d|7gk|7gm|7go|7gq|7gs|7gu|7h0|7h2|7h4|7h6|7h8|7ha|7hc|7he|7hg|7hi|7hk|7hm|7ho|7hq|7hs|7hu|7i0|7i2|7i4|7i6|7i8|7ia|7ic|7ie|7ig|7ii|7ik|7im|7io|7iq|7is|7iu|7j0|7j2|7j4|7j6|7j8|7ja|7jc|7je|7jg|7ji|7jk|7jm|2e|7jo|7jq|7js|7ju|7k0|7k2|7k4|7k6|7k8|7ka|7kc|7ke|7kg|7ki|7kk|7l0|7l2|7l4|7l6|7l8|7la|7lc|7le|7lg|7li|7lk|7lm|7lo|7lq|7ls|7lu|7m0|7m2|7m4|7m6|7m8|7ma|7mc|7me|7mg|7mi|7mk|7mm|7mo|7mq|2f|7ms|7mu|7n0|7n2|7n4|7n6|7n8|7na|7nc|7ne|7ng|7ni|7nk|7nm|7no|2g|7qp|7qr|7qt|7qv|2h|896|2l|s6|sc|uo|uq|us|uu|v0|v2|v4|v6'\n    },\n    'C.1.1': {\n        s: '10'\n    },\n    'C.1.2': {\n        r: '800:80b',\n        s: 'c00|50|5k0|81f|82v'\n    },\n    'C.2.1': {\n        r: '0:v',\n        s: '3v'\n    },\n    'C.2.2': {\n        r: '40:4v|80c:80d|818:819|830:833|83a:83f|1vvp:1vvs|3kbj:3kbq',\n        s: '1mt|1of|60e|1vnv'\n    },\n    'C.3': {\n        r: '1o00:1u7v|u000:vvvt|10000:11vvt'\n    },\n    'C.4': {\n        r: '1veg:1vff|1vvu:1vvv|3vvu:3vvv|5vvu:5vvv|7vvu:7vvv|9vvu:9vvv|bvvu:bvvv|dvvu:dvvv|fvvu:fvvv|hvvu:hvvv|jvvu:jvvv|lvvu:lvvv|nvvu:nvvv|pvvu:pvvv|rvvu:rvvv|tvvu:tvvv|vvvu:vvvv|11vvu:11vvv'\n    },\n    'C.5': {\n        r: '1m00:1nvv'\n    },\n    'C.6': {\n        r: '1vvp:1vvt'\n    },\n    'C.7': {\n        r: 'bvg:bvr'\n    },\n    'C.8': {\n        r: 'q0:q1|80e:80f|81a:81e|83a:83f'\n    },\n    'C.9': {\n        r: 's010:s03v',\n        s: 's001'\n    },\n    'D.1': {\n        r: '1eg:1fa|1fg:1fk|1h1:1hq|1i0:1ia|1jd:1jf|1jh:1ml|1n5:1n6|1nq:1nu|1o0:1od|1oi:1pc|1s0:1t5|1uov:1up8|1upa:1upm|1upo:1ups|1uq0:1uq1|1uq3:1uq4|1uq6:1uth|1uuj:1v9t|1vag:1vcf|1vci:1ve7|1vfg:1vfs|1vjg:1vjk|1vjm:1vns',\n        s: '1du|1e0|1e3|1gr|1gv|1mt|1og|1th|1uot|1upu|80f'\n    },\n    'D.2': {\n        r: '21:2q|31:3q|60:6m|6o:7m|7o:h0|h2:hj|ig:ld|lg:lo|lr:m1|mg:mh|n0:n4|s8:sa|se:t1|t3:ue|ug:vl|100:142|14a:16e|16g:17l|17o:17p|180:18f|19h:1am|1ap:1av|1b1:1c7|285:29p|29t:2a0|2a9:2ac|2ao:2b1|2b4:2bg|2c2:2c3|2c5:2cc|2cf:2cg|2cj:2d8|2da:2dg|2dm:2dp|2du:2e0|2e7:2e8|2eb:2ec|2es:2et|2ev:2f1|2f6:2fh|2fk:2fq|2g5:2ga|2gf:2gg|2gj:2h8|2ha:2hg|2hi:2hj|2hl:2hm|2ho:2hp|2hu:2i0|2ip:2is|2j6:2jf|2ji:2jk|2k5:2kb|2kf:2kh|2kj:2l8|2la:2lg|2li:2lj|2ll:2lp|2lt:2m0|2mb:2mc|2n6:2nf|2o2:2o3|2o5:2oc|2of:2og|2oj:2p8|2pa:2pg|2pi:2pj|2pm:2pp|2pt:2pu|2q7:2q8|2qb:2qc|2qs:2qt|2qv:2r1|2r6:2rg|2s5:2sa|2se:2sg|2si:2sl|2sp:2sq|2su:2sv|2t3:2t4|2t8:2ta|2te:2tl|2tn:2tp|2tu:2tv|2u1:2u2|2u6:2u8|2ua:2uc|2v7:2vi|301:303|305:30c|30e:30g|30i:318|31a:31j|31l:31p|321:324|330:331|336:33f|342:343|345:34c|34e:34g|34i:358|35a:35j|35l:35p|360:364|367:368|36a:36b|36l:36m|370:371|376:37f|382:383|385:38c|38e:38g|38i:398|39a:39p|39u:3a0|3a6:3a8|3aa:3ac|3b0:3b1|3b6:3bf|3c2:3c3|3c5:3cm|3cq:3dh|3dj:3dr|3e0:3e6|3ef:3eh|3eo:3ev|3fi:3fk|3g1:3hg|3hi:3hj|3i0:3i6|3if:3ir|3k1:3k2|3k7:3k8|3kk:3kn|3kp:3kv|3l1:3l3|3la:3lb|3ld:3lg|3li:3lj|3m0:3m4|3mg:3mp|3ms:3mt|3o0:3on|3oq:3pk|3pu:3q7|3q9:3ra|3s8:3sb|3tu:3u5|3u7:3uc|400:411|413:417|419:41a|420:42n|450:465|46g:47o|480:4ap|4av:4d2|4d8:4fp|4g0:4g6|4g8:4i6|4ia:4id|4ig:4im|4iq:4it|4j0:4k6|4ka:4kd|4kg:4le|4li:4ll|4lo:4lu|4m2:4m5|4m8:4me|4mg:4mm|4mo:4ne|4ng:4oe|4oi:4ol|4oo:4ou|4p0:4q6|4q8:4qq|4r1:4rs|4t0:4vk|501:5jm|5k1:5kq|5l0:5ng|5o0:5oc|5oe:5oh|5p0:5ph|5pl:5pm|5q0:5qh|5r0:5rc|5re:5rg|5s0:5tm|5tu:5u5|5u7:5u8|5uk:5uq|5v0:5v9|60g:60p|610:63n|640:658|7g0:7kr|7l0:7np|7o0:7ol|7oo:7ot|7p0:7q5|7q8:7qd|7qg:7qn|7qv:7rt|7s0:7tk|7tm:7ts|7u2:7u4|7u6:7uc|7ug:7uj|7um:7ur|7v0:7vc|7vi:7vk|7vm:7vs|88a:88j|88p:88t|89a:89d|89f:89h|89j:89p|89t:89v|8a5:8a9|8b0:8c3|8pm:8rq|94s:979|c05:c07|c11:c19|c1h:c1l|c1o:c1s|c21:c4m|c4t:c4v|c51:c7q|c7s:c7v|c85:c9c|c9h:cce|ccg:cdn|cfg:cgs|ch0:ci3|cj0:cjr|cjv:clg|cm0:cmb|cmg:cnu|co0:crm|crr:cut|cv0:cvu|d00:jdl|jg0:17t5|1800:194c|1b00:1lt3|1m00:1uhd|1uhg:1uja|1uo0:1uo6|1uoj:1uon|1vp1:1vpq|1vq1:1vqq|1vr6:1vtu|1vu2:1vu7|1vua:1vuf|1vui:1vun|1vuq:1vus|20o0:20ou|20p0:20p3|20pg:20qa|2100:2115|2118:212d|3k00:3k7l|3k80:3k96|3k9a:3kb6|3kba:3kbi|3kc3:3kc4|3kcc:3kd9|3kde:3ket|3l00:3l2k|3l2m:3l4s|3l4u:3l4v|3l55:3l56|3l59:3l5c|3l5e:3l5p|3l5t:3l60|3l62:3l63|3l65:3l85|3l87:3l8a|3l8d:3l8k|3l8m:3l8s|3l8u:3l9p|3l9r:3l9u|3la0:3la4|3laa:3lag|3lai:3ll3|3ll8:3lu9|4000:59mm|5u00:5ugt|u000:vvvt|10000:11vvt',\n        s: '3l52|3l5r|3la6|1c9|5a|5l|5q|283|2ag|2di|2en|2iu|2k3|2kd|2m9|2mg|2n0|2q0|2qn|2s3|2ss|2un|35u|36u|3an|3dt|3k4|3ka|3kd|3l5|3l7|3lt|3m6|3pm|3po|3rv|3s5|3uf|41c|41h|41o|47r|4i8|4io|4k8|4lg|4m0|4og|5us|ne|7qp|7qr|7qt|7tu|80e|83h|83v|882|887|88l|894|896|898|rq|s6|sc|8sl'\n    }\n};\n\nclass Table {\n    constructor(name, points) {\n        this.singles = new Set();\n        this.ranges = [];\n        this.mappings = new Map();\n        const data = TABLE_DATA[name];\n        this.name = name;\n        if (data) {\n            if (data.s) {\n                this.singles = new Set(data.s.split('|').map(s => parseInt(s, 32)));\n            }\n            if (data.r) {\n                this.ranges = data.r.split('|').map(r => {\n                    const [start, end] = r.split(':');\n                    return [parseInt(start, 32), parseInt(end, 32)];\n                });\n            }\n            if (data.m) {\n                this.mappings = new Map(data.m.split('|').map(m => {\n                    const [point, mapping] = m.split(':');\n                    const mappedPoints = mapping.split(';').map(p => parseInt(p, 32));\n                    return [parseInt(point, 32), mappedPoints];\n                }));\n            }\n        }\n        else if (points) {\n            this.singles = new Set(points);\n        }\n    }\n    contains(codePoint) {\n        if (this.singles.has(codePoint)) {\n            return true;\n        }\n        let left = 0;\n        let right = this.ranges.length - 1;\n        while (left <= right) {\n            const pivot = Math.floor((left + right) / 2);\n            const range = this.ranges[pivot];\n            if (codePoint < range[0]) {\n                right = pivot - 1;\n                continue;\n            }\n            if (codePoint > range[1]) {\n                left = pivot + 1;\n                continue;\n            }\n            return true;\n        }\n        return false;\n    }\n    hasMapping(codePoint) {\n        return this.mappings.has(codePoint) || this.contains(codePoint);\n    }\n    map(codePoint) {\n        if (this.contains(codePoint) && !this.mappings.has(codePoint)) {\n            return String.fromCodePoint(codePoint)\n                .toLowerCase()\n                .codePointAt(0);\n        }\n        return this.mappings.get(codePoint) || null;\n    }\n}\nconst A1 = new Table('A.1');\nconst B1 = new Table('B.1');\nconst B2 = new Table('B.2');\nconst B3 = new Table('B.3');\nconst C11 = new Table('C.1.1');\nconst C12 = new Table('C.1.2');\nconst C21 = new Table('C.2.1');\nconst C22 = new Table('C.2.2');\nconst C3 = new Table('C.3');\nconst C4 = new Table('C.4');\nconst C5 = new Table('C.5');\nconst C6 = new Table('C.6');\nconst C7 = new Table('C.7');\nconst C8 = new Table('C.8');\nconst C9 = new Table('C.9');\nconst D1 = new Table('D.1');\nconst D2 = new Table('D.2');\n// Shortcut some of the simpler table operations\nB1.map = () => {\n    return null;\n};\nC11.contains = (codePoint) => codePoint === 32;\nC12.map = (codePoint) => {\n    return C12.contains(codePoint) ? 32 : null;\n};\nfunction prepare(profile, allowUnassigned, input) {\n    const inputCodePoints = Punycode.ucs2.decode(input);\n    let mappedCodePoints = [];\n    for (const codePoint of inputCodePoints) {\n        if (!allowUnassigned && profile.unassigned.contains(codePoint)) {\n            throw new Error('Unassigned codepoint: x' + codePoint.toString(16));\n        }\n        let hasMapping = false;\n        for (const mappingTable of profile.mappings) {\n            if (!mappingTable.hasMapping(codePoint)) {\n                continue;\n            }\n            hasMapping = true;\n            const mappedPoint = mappingTable.map(codePoint);\n            if (!mappedPoint) {\n                continue;\n            }\n            if (Array.isArray(mappedPoint)) {\n                mappedCodePoints = mappedCodePoints.concat(mappedPoint);\n            }\n            else {\n                mappedCodePoints.push(mappedPoint);\n            }\n        }\n        if (!hasMapping) {\n            mappedCodePoints.push(codePoint);\n        }\n    }\n    let normalizedCodePoints = mappedCodePoints;\n    if (profile.normalize) {\n        const mappedString = Punycode.ucs2.encode(mappedCodePoints);\n        const normalizedString = mappedString.normalize('NFKC');\n        normalizedCodePoints = Punycode.ucs2.decode(normalizedString);\n    }\n    let hasRandALCat = false;\n    let hasLCat = false;\n    for (const codePoint of normalizedCodePoints) {\n        for (const prohibited of profile.prohibited) {\n            if (prohibited.contains(codePoint)) {\n                throw new Error('Prohibited code point: x' + codePoint.toString(16));\n            }\n        }\n        if (!allowUnassigned && profile.unassigned.contains(codePoint)) {\n            throw new Error('Prohibited code point: x' + codePoint.toString(16));\n        }\n        if (profile.bidirectional) {\n            hasRandALCat = hasRandALCat || D1.contains(codePoint);\n            hasLCat = hasLCat || D2.contains(codePoint);\n        }\n    }\n    if (profile.bidirectional) {\n        if (hasRandALCat && hasLCat) {\n            throw new Error('String contained both LCat and RandALCat code points');\n        }\n        if (hasRandALCat &&\n            (!D1.contains(normalizedCodePoints[0]) ||\n                !D1.contains(normalizedCodePoints[normalizedCodePoints.length - 1]))) {\n            throw new Error('String containing RandALCat code points must start and end with RandALCat code points');\n        }\n    }\n    return Punycode.ucs2.encode(normalizedCodePoints);\n}\nconst NamePrepProfile = {\n    bidirectional: true,\n    mappings: [B1, B2],\n    normalize: true,\n    prohibited: [C12, C22, C3, C4, C5, C6, C7, C8, C9],\n    unassigned: A1\n};\nfunction nameprep(str, allowUnassigned = true) {\n    return prepare(NamePrepProfile, allowUnassigned, str);\n}\nconst NodePrepProhibited = new Table('NodePrepProhibited', [\n    0x22,\n    0x26,\n    0x27,\n    0x2f,\n    0x3a,\n    0x3c,\n    0x3e,\n    0x40\n]);\nconst NodePrepProfile = {\n    bidirectional: true,\n    mappings: [B1, B2],\n    normalize: true,\n    prohibited: [C11, C12, C21, C22, C3, C4, C5, C6, C7, C8, C9, NodePrepProhibited],\n    unassigned: A1\n};\nfunction nodeprep(str, allowUnassigned = true) {\n    return prepare(NodePrepProfile, allowUnassigned, str);\n}\nconst ResourcePrepProfile = {\n    bidirectional: true,\n    mappings: [B1],\n    normalize: true,\n    prohibited: [C12, C21, C22, C3, C4, C5, C6, C7, C8, C9],\n    unassigned: A1\n};\nfunction resourceprep(str, allowUnassigned = true) {\n    return prepare(ResourcePrepProfile, allowUnassigned, str);\n}\n\nfunction create(data, opts = {}) {\n    let localPart = data.local;\n    if (!opts.escaped) {\n        localPart = escapeLocal(data.local);\n    }\n    const prep = !opts.prepared\n        ? prepare$1({ local: localPart, domain: data.domain, resource: data.resource })\n        : data;\n    const bareJID = !!localPart ? `${localPart}@${prep.domain}` : prep.domain;\n    if (prep.resource) {\n        return `${bareJID}/${prep.resource}`;\n    }\n    return bareJID;\n}\nfunction prepare$1(data) {\n    let local = data.local || '';\n    let domain = data.domain;\n    let resource = data.resource || '';\n    if (local) {\n        local = nodeprep(local);\n    }\n    if (resource) {\n        resource = resourceprep(resource);\n    }\n    if (domain[domain.length - 1] === '.') {\n        domain = domain.slice(0, domain.length - 1);\n    }\n    domain = nameprep(domain\n        .split('.')\n        .map(Punycode.toUnicode)\n        .join('.'));\n    return {\n        domain,\n        local,\n        resource\n    };\n}\nfunction parse(jid = '') {\n    let local = '';\n    let domain = '';\n    let resource = '';\n    const resourceStart = jid.indexOf('/');\n    if (resourceStart > 0) {\n        resource = jid.slice(resourceStart + 1);\n        jid = jid.slice(0, resourceStart);\n    }\n    const localEnd = jid.indexOf('@');\n    if (localEnd > 0) {\n        local = jid.slice(0, localEnd);\n        jid = jid.slice(localEnd + 1);\n    }\n    domain = jid;\n    const prepped = prepare$1({\n        domain,\n        local,\n        resource\n    });\n    return {\n        bare: create({ local: prepped.local, domain: prepped.domain }, {\n            escaped: true,\n            prepared: true\n        }),\n        domain: prepped.domain,\n        full: create(prepped, {\n            escaped: true,\n            prepared: true\n        }),\n        local: unescapeLocal(prepped.local),\n        resource: prepped.resource\n    };\n}\nfunction allowedResponders(jid1, jid2) {\n    const allowed = new Set();\n    allowed.add(undefined);\n    allowed.add('');\n    if (jid1) {\n        const split1 = parse(jid1);\n        allowed.add(split1.full);\n        allowed.add(split1.bare);\n        allowed.add(split1.domain);\n    }\n    if (jid2) {\n        const split2 = parse(jid2);\n        allowed.add(split2.domain);\n        allowed.add(split2.bare);\n        allowed.add(split2.full);\n    }\n    return allowed;\n}\nfunction equal(jid1, jid2) {\n    if (!jid1 || !jid2) {\n        return false;\n    }\n    const parsed1 = parse(jid1);\n    const parsed2 = parse(jid2);\n    return (parsed1.local === parsed2.local &&\n        parsed1.domain === parsed2.domain &&\n        parsed1.resource === parsed2.resource);\n}\nfunction equalBare(jid1, jid2) {\n    if (!jid1 || !jid2) {\n        return false;\n    }\n    const parsed1 = parse(jid1);\n    const parsed2 = parse(jid2);\n    return parsed1.local === parsed2.local && parsed1.domain === parsed2.domain;\n}\nfunction isBare(jid) {\n    return !isFull(jid);\n}\nfunction isFull(jid) {\n    const parsed = parse(jid);\n    return !!parsed.resource;\n}\nfunction getLocal(jid = '') {\n    return parse(jid).local;\n}\nfunction getDomain(jid = '') {\n    return parse(jid).domain;\n}\nfunction getResource(jid = '') {\n    return parse(jid).resource;\n}\nfunction toBare(jid = '') {\n    return parse(jid).bare;\n}\nfunction escapeLocal(val = '') {\n    return val\n        .replace(/^\\s+|\\s+$/g, '')\n        .replace(/\\\\5c/g, '\\\\5c5c')\n        .replace(/\\\\20/g, '\\\\5c20')\n        .replace(/\\\\22/g, '\\\\5c22')\n        .replace(/\\\\26/g, '\\\\5c26')\n        .replace(/\\\\27/g, '\\\\5c27')\n        .replace(/\\\\2f/g, '\\\\5c2f')\n        .replace(/\\\\3a/g, '\\\\5c3a')\n        .replace(/\\\\3c/g, '\\\\5c3c')\n        .replace(/\\\\3e/g, '\\\\5c3e')\n        .replace(/\\\\40/g, '\\\\5c40')\n        .replace(/ /g, '\\\\20')\n        .replace(/\\\"/g, '\\\\22')\n        .replace(/\\&/g, '\\\\26')\n        .replace(/\\'/g, '\\\\27')\n        .replace(/\\//g, '\\\\2f')\n        .replace(/:/g, '\\\\3a')\n        .replace(/</g, '\\\\3c')\n        .replace(/>/g, '\\\\3e')\n        .replace(/@/g, '\\\\40');\n}\nfunction unescapeLocal(val) {\n    return val\n        .replace(/\\\\20/g, ' ')\n        .replace(/\\\\22/g, '\"')\n        .replace(/\\\\26/g, '&')\n        .replace(/\\\\27/g, `'`)\n        .replace(/\\\\2f/g, '/')\n        .replace(/\\\\3a/g, ':')\n        .replace(/\\\\3c/g, '<')\n        .replace(/\\\\3e/g, '>')\n        .replace(/\\\\40/g, '@')\n        .replace(/\\\\5c/g, '\\\\');\n}\nfunction parseURI(val) {\n    const parsed = new URL(val);\n    if (parsed.protocol !== 'xmpp:') {\n        throw new Error('Invalid XMPP URI, wrong protocol: ' + parsed.protocol);\n    }\n    const identity = parsed.hostname\n        ? parsed.username\n            ? create({\n                domain: decodeURIComponent(parsed.hostname),\n                local: decodeURIComponent(parsed.username)\n            }, {\n                escaped: true\n            })\n            : decodeURIComponent(parsed.hostname)\n        : undefined;\n    const jid = parse(decodeURIComponent(identity ? parsed.pathname.substr(1) : parsed.pathname))\n        .full;\n    const hasParameters = parsed.search && parsed.search.indexOf(';') >= 1;\n    const parameterString = hasParameters\n        ? parsed.search.substr(parsed.search.indexOf(';') + 1)\n        : '';\n    const action = parsed.search\n        ? decodeURIComponent(parsed.search.substr(1, hasParameters ? parsed.search.indexOf(';') - 1 : undefined))\n        : undefined;\n    const params = {};\n    for (const token of parameterString.split(';')) {\n        const [name, value] = token.split('=').map(decodeURIComponent);\n        if (!params[name]) {\n            params[name] = value;\n        }\n        else {\n            const existing = params[name];\n            if (Array.isArray(existing)) {\n                existing.push(value);\n            }\n            else {\n                params[name] = [existing, value];\n            }\n        }\n    }\n    return {\n        action,\n        identity,\n        jid,\n        parameters: params\n    };\n}\nfunction toURI(data) {\n    const parts = ['xmpp:'];\n    const pushJID = (jid, allowResource) => {\n        const res = parse(jid);\n        if (res.local) {\n            parts.push(encodeURIComponent(escapeLocal(res.local)));\n            parts.push('@');\n        }\n        parts.push(encodeURIComponent(res.domain));\n        if (allowResource && res.resource) {\n            parts.push('/');\n            parts.push(encodeURIComponent(res.resource));\n        }\n    };\n    if (data.identity) {\n        parts.push('//');\n        pushJID(data.identity, false);\n        if (data.jid) {\n            parts.push('/');\n        }\n    }\n    if (data.jid) {\n        pushJID(data.jid, true);\n    }\n    if (data.action) {\n        parts.push('?');\n        parts.push(encodeURIComponent(data.action));\n    }\n    for (let [name, values] of Object.entries(data.parameters || {})) {\n        if (!Array.isArray(values)) {\n            values = [values];\n        }\n        for (const val of values) {\n            parts.push(';');\n            parts.push(encodeURIComponent(name));\n            if (val !== undefined) {\n                parts.push('=');\n                parts.push(encodeURIComponent(val));\n            }\n        }\n    }\n    return parts.join('');\n}\n\nvar JID = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    create: create,\n    prepare: prepare$1,\n    parse: parse,\n    allowedResponders: allowedResponders,\n    equal: equal,\n    equalBare: equalBare,\n    isBare: isBare,\n    isFull: isFull,\n    getLocal: getLocal,\n    getDomain: getDomain,\n    getResource: getResource,\n    toBare: toBare,\n    escapeLocal: escapeLocal,\n    unescapeLocal: unescapeLocal,\n    parseURI: parseURI,\n    toURI: toURI\n});\n\nvar JXTErrorCondition;\n(function (JXTErrorCondition) {\n    JXTErrorCondition[\"NotWellFormed\"] = \"not-well-formed\";\n    JXTErrorCondition[\"RestrictedXML\"] = \"restricted-xml\";\n    JXTErrorCondition[\"AlreadyClosed\"] = \"already-closed\";\n    JXTErrorCondition[\"UnknownRoot\"] = \"unknown-stream-root\";\n})(JXTErrorCondition || (JXTErrorCondition = {}));\nclass JXTError extends Error {\n    constructor(opts) {\n        super(opts.text);\n        this.isJXTError = true;\n        this.condition = opts.condition;\n        this.text = opts.text;\n    }\n    static notWellFormed(text) {\n        return new JXTError({\n            condition: JXTErrorCondition.NotWellFormed,\n            text\n        });\n    }\n    static restrictedXML(text) {\n        return new JXTError({\n            condition: JXTErrorCondition.RestrictedXML,\n            text\n        });\n    }\n    static alreadyClosed(text) {\n        return new JXTError({\n            condition: JXTErrorCondition.AlreadyClosed,\n            text\n        });\n    }\n    static unknownRoot(text) {\n        return new JXTError({\n            condition: JXTErrorCondition.UnknownRoot,\n            text\n        });\n    }\n}\n\nconst ESCAPE_XML_CHAR = {\n    '\"': '&quot;',\n    '&': '&amp;',\n    \"'\": '&apos;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nconst UNESCAPE_XML_CHAR = {\n    '&amp;': '&',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&quot;': '\"'\n};\nconst ESCAPE_SEQUENCE = /&([a-zA-Z0-9]+|#[0-9]+|#x[0-9a-fA-F]+);/g;\nconst NEED_ESCAPING = /&|<|>|\"|'/g;\nconst NEED_ESCAPING_TEXT = /&|<|>/g;\nfunction escapeXMLReplaceChar(match) {\n    return ESCAPE_XML_CHAR[match];\n}\nfunction unescapeXMLReplaceChar(match) {\n    if (UNESCAPE_XML_CHAR[match]) {\n        return UNESCAPE_XML_CHAR[match];\n    }\n    const hex = match.startsWith('&#x');\n    const code = parseInt(match.substring(hex ? 3 : 2, match.length - 1), hex ? 16 : 10);\n    if (code === 0x9 ||\n        code === 0xa ||\n        code === 0xd ||\n        (0x20 <= code && code <= 0xd7ff) ||\n        (0xe000 <= code && code <= 0xfffd) ||\n        (0x10000 <= code && code <= 0x10ffff)) {\n        return String.fromCodePoint(code);\n    }\n    throw JXTError.restrictedXML('Prohibited entity: ' + match);\n}\nfunction escapeXML(text) {\n    return text.replace(NEED_ESCAPING, escapeXMLReplaceChar);\n}\nfunction unescapeXML(text) {\n    return text.replace(ESCAPE_SEQUENCE, match => {\n        return unescapeXMLReplaceChar(match);\n    });\n}\nfunction escapeXMLText(text) {\n    return text.replace(NEED_ESCAPING_TEXT, escapeXMLReplaceChar);\n}\nfunction basicLanguageResolver(available, accept = [], current = '') {\n    const avail = new Set(available.map(a => a.toLowerCase()));\n    for (let acceptLang of accept.map(a => a.toLowerCase())) {\n        if (acceptLang === '*') {\n            continue;\n        }\n        while (acceptLang.length > 0) {\n            if (avail.has(acceptLang)) {\n                return acceptLang;\n            }\n            // Remove ending tag\n            acceptLang = acceptLang.substring(0, acceptLang.lastIndexOf('-')).toLowerCase();\n            // Remove leftover single character tag\n            if (acceptLang.lastIndexOf('-') === acceptLang.length - 2) {\n                acceptLang = acceptLang.substring(0, acceptLang.lastIndexOf('-'));\n            }\n        }\n    }\n    return current;\n}\n\nclass XMLElement {\n    constructor(name, attrs = {}, children = []) {\n        this.name = name;\n        this.attributes = attrs;\n        this.children = [];\n        this.optionalNamespaces = {};\n        for (const child of children) {\n            if (typeof child !== 'string') {\n                const xmlChild = new XMLElement(child.name, child.attributes, child.children);\n                xmlChild.parent = this;\n                this.children.push(xmlChild);\n            }\n            else {\n                this.children.push(child);\n            }\n        }\n    }\n    getName() {\n        if (this.name.indexOf(':') >= 0) {\n            return this.name.substr(this.name.indexOf(':') + 1);\n        }\n        else {\n            return this.name;\n        }\n    }\n    getNamespace() {\n        if (this.name.indexOf(':') >= 0) {\n            const prefix = this.name.substr(0, this.name.indexOf(':'));\n            return this.findNamespaceForPrefix(prefix);\n        }\n        return this.findNamespaceForPrefix();\n    }\n    getNamespaceContext() {\n        let namespaces = {};\n        if (this.parent) {\n            namespaces = this.parent.getNamespaceContext();\n        }\n        for (const [attr, value] of Object.entries(this.attributes)) {\n            if (attr.startsWith('xmlns:')) {\n                const prefix = attr.substr(6);\n                namespaces[value] = prefix;\n            }\n        }\n        return namespaces;\n    }\n    getDefaultNamespace() {\n        if (this.attributes.xmlns) {\n            return this.attributes.xmlns;\n        }\n        if (this.parent) {\n            return this.parent.getDefaultNamespace();\n        }\n        return '';\n    }\n    getNamespaceRoot(namespace) {\n        if (this.parent) {\n            const parentRoot = this.parent.getNamespaceRoot(namespace);\n            if (parentRoot) {\n                return parentRoot;\n            }\n        }\n        for (const [attr, value] of Object.entries(this.attributes)) {\n            if (attr.startsWith('xmlns:') && value === namespace) {\n                return this;\n            }\n        }\n        if (this.optionalNamespaces[namespace]) {\n            return this;\n        }\n        return undefined;\n    }\n    getAttribute(name, xmlns) {\n        if (!xmlns) {\n            return this.attributes[name];\n        }\n        const namespaces = this.getNamespaceContext();\n        if (!namespaces[xmlns]) {\n            return undefined;\n        }\n        return this.attributes[[namespaces[xmlns], name].join(':')];\n    }\n    getChild(name, xmlns) {\n        return this.getChildren(name, xmlns)[0];\n    }\n    getChildren(name, xmlns) {\n        const result = [];\n        for (const child of this.children) {\n            if (typeof child !== 'string' &&\n                child.getName() === name &&\n                (!xmlns || child.getNamespace() === xmlns)) {\n                result.push(child);\n            }\n        }\n        return result;\n    }\n    getText() {\n        let text = '';\n        for (const child of this.children) {\n            if (typeof child === 'string') {\n                text += child;\n            }\n        }\n        return text;\n    }\n    appendChild(child) {\n        this.children.push(child);\n        if (typeof child !== 'string') {\n            child.parent = this;\n        }\n        return child;\n    }\n    setAttribute(attr, val, force = false) {\n        this.attributes[attr] = val || undefined;\n        if (val === '' && force) {\n            this.attributes[attr] = val;\n        }\n    }\n    addOptionalNamespace(prefix, namespace) {\n        this.optionalNamespaces[namespace] = prefix;\n    }\n    useNamespace(prefix, namespace) {\n        if (this.optionalNamespaces[namespace]) {\n            prefix = this.optionalNamespaces[namespace];\n        }\n        this.setAttribute(`xmlns:${prefix}`, namespace);\n        return prefix;\n    }\n    toJSON() {\n        const children = this.children\n            .map(child => {\n            if (typeof child === 'string') {\n                return child;\n            }\n            if (child) {\n                return child.toJSON();\n            }\n        })\n            .filter(child => !!child);\n        // Strip any undefined/null attributes\n        const attrs = {};\n        for (const key of Object.keys(this.attributes)) {\n            if (this.attributes[key] !== undefined && this.attributes[key] !== null) {\n                attrs[key] = this.attributes[key];\n            }\n        }\n        return {\n            attributes: attrs,\n            children,\n            name: this.name\n        };\n    }\n    toString() {\n        let output = this.openTag(true);\n        if (this.children.length) {\n            for (const child of this.children) {\n                if (typeof child === 'string') {\n                    output += escapeXMLText(child);\n                }\n                else if (child) {\n                    output += child.toString();\n                }\n            }\n            output += this.closeTag();\n        }\n        return output;\n    }\n    openTag(allowSelfClose = false) {\n        let output = '';\n        output += `<${this.name}`;\n        for (const key of Object.keys(this.attributes)) {\n            const value = this.attributes[key];\n            if (value !== undefined) {\n                output += ` ${key}=\"${escapeXML(value.toString())}\"`;\n            }\n        }\n        if (allowSelfClose && this.children.length === 0) {\n            output += '/>';\n        }\n        else {\n            output += '>';\n        }\n        return output;\n    }\n    closeTag() {\n        return `</${this.name}>`;\n    }\n    findNamespaceForPrefix(prefix) {\n        if (!prefix) {\n            if (this.attributes.xmlns) {\n                return this.attributes.xmlns;\n            }\n            else if (this.parent) {\n                return this.parent.findNamespaceForPrefix();\n            }\n        }\n        else {\n            const attr = 'xmlns:' + prefix;\n            if (this.attributes[attr]) {\n                return this.attributes[attr];\n            }\n            else if (this.parent) {\n                return this.parent.findNamespaceForPrefix(prefix);\n            }\n        }\n        return '';\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from: xhtml-im.js, Copyright  2013 Waqas Hussain\n */\nconst ALLOWED_ELEMENTS = new Set([\n    'a',\n    'blockquote',\n    'br',\n    'cite',\n    'em',\n    'img',\n    'li',\n    'ol',\n    'p',\n    'span',\n    'strong',\n    'ul'\n]);\nconst style = new Set(['style']);\nconst ALLOWED_ATTRIBUTES = new Map([\n    ['a', new Set(['href', 'style'])],\n    ['body', new Set(['style', 'xml:lang'])],\n    ['blockquote', style],\n    ['br', style],\n    ['cite', style],\n    ['em', style],\n    ['img', new Set(['alt', 'height', 'src', 'style', 'width'])],\n    ['li', style],\n    ['ol', style],\n    ['p', style],\n    ['span', style],\n    ['strong', style],\n    ['ul', style]\n]);\nconst CSS_RULES = new Map([\n    ['font-style', /normal|italic|oblique|inherit/i],\n    ['font-weight', /normal|bold|bolder|lighter|inherit|\\d\\d\\d/i],\n    ['text-decoration', /none|underline|overline|line-through|blink|inherit/i]\n    // These properties are allowed by XHTML-IM, but really only cause UX issues:\n    //  background-color\n    //  color\n    //  font-family\n    //  font-size\n    //  margin-left\n    //  margin-right\n    //  text-align\n]);\nconst sanitizeCSS = (css) => {\n    const declarations = `;${css}` // Declarations are ; delimited, not terminated\n        .replace(/\\/\\*[^*]*\\*+([^\\/*][^*]*\\*+)*\\//g, '') // Strip comments\n        .replace(/\\/\\*.*/, '') // Strip unclosed comments\n        .replace(/\\\\([a-fA-F0-9]{1,6})\\s?/, (_, x) => {\n        // Decode escape sequences\n        return String.fromCharCode(parseInt(x, 16));\n    })\n        .match(/;\\s*([a-z\\-]+)\\s*:\\s*([^;]*[^\\s;])\\s*/g); // Split into declarations\n    const rules = [];\n    if (!declarations) {\n        return false;\n    }\n    for (const declaration of declarations) {\n        const parts = declaration.match(/^;\\s*([a-z\\-]+)\\s*:\\s*([^;]*[^\\s])\\s*$/);\n        if (!parts) {\n            continue;\n        }\n        const sanitizer = CSS_RULES.get(parts[1]);\n        if (sanitizer) {\n            const value = parts[2].match(sanitizer);\n            if (value) {\n                rules.push(`${parts[1]}:${value[0]}`);\n            }\n        }\n    }\n    if (rules.length) {\n        return rules.join('');\n    }\n    return false;\n};\nconst sanitizeURL = (url) => {\n    return (!!url.match(/^(https?|xmpp|cid|mailto|ftps?|im|ircs?|sips?|tel|geo|bitcoin|magnet):/i) &&\n        url);\n};\nconst sanitizeNumber = (num) => {\n    return !!num.match(/^[0-9]*$/) && num;\n};\nconst ATTRIBUTE_SANITIZERS = {\n    alt: text => text,\n    height: sanitizeNumber,\n    href: sanitizeURL,\n    src: sanitizeURL,\n    style: sanitizeCSS,\n    width: sanitizeNumber\n};\nconst stripElement = (input) => {\n    let results = [];\n    for (const child of input.children) {\n        if (typeof child === 'string') {\n            results.push(child);\n        }\n        else if (child) {\n            const sanitized = sanitizeInterior(child);\n            if (sanitized) {\n                if (Array.isArray(sanitized)) {\n                    results = results.concat(sanitized);\n                }\n                else {\n                    results.push(sanitized);\n                }\n            }\n        }\n    }\n    return results;\n};\nconst sanitizeRoot = (input) => {\n    if (typeof input === 'string') {\n        return;\n    }\n    let children = [];\n    for (const child of input.children) {\n        if (!child) {\n            continue;\n        }\n        if (typeof child === 'string') {\n            children.push(child);\n            continue;\n        }\n        const sanitized = sanitizeInterior(child);\n        if (Array.isArray(sanitized)) {\n            children = children.concat(sanitized);\n        }\n        else if (sanitized) {\n            children.push(sanitized);\n        }\n    }\n    const attributes = {};\n    if (input.name !== 'body') {\n        return;\n    }\n    if (input.attributes.xmlns !== undefined) {\n        attributes.xmlns = input.attributes.xmlns;\n    }\n    if (input.attributes.style) {\n        attributes.style = input.attributes.style;\n    }\n    if (input.attributes['xml:lang'] !== undefined) {\n        attributes['xml:lang'] = input.attributes['xml:lang'];\n    }\n    return {\n        attributes,\n        children,\n        name: 'body'\n    };\n};\nconst sanitizeInterior = (input) => {\n    if (typeof input === 'string') {\n        return input;\n    }\n    if (!ALLOWED_ELEMENTS.has(input.name)) {\n        if (input.name === 'script') {\n            return;\n        }\n        return stripElement(input);\n    }\n    const children = input.children\n        .map(sanitizeInterior)\n        .filter(child => child !== undefined);\n    const attributes = {};\n    for (const key of Object.keys(input.attributes)) {\n        const allowed = ALLOWED_ATTRIBUTES.get(input.name);\n        if (!allowed || !allowed.has(key)) {\n            continue;\n        }\n        let value = input.attributes[key];\n        if (!value) {\n            continue;\n        }\n        value = ATTRIBUTE_SANITIZERS[key](value);\n        if (!value) {\n            continue;\n        }\n        attributes[key] = value;\n    }\n    return {\n        attributes,\n        children,\n        name: input.name\n    };\n};\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from: ltx, Copyright  2010 Stephan Maka\n */\nfunction isPrintable(c) {\n    return c >= 32 /* Space */;\n}\nfunction isWhitespace(c) {\n    return (c === 32 /* Space */ ||\n        c === 10 /* NewLine */ ||\n        c === 13 /* CarriageReturn */ ||\n        c === 9 /* Tab */);\n}\nfunction parse$1(data, opts = {}) {\n    const p = new Parser(opts);\n    let result;\n    let element;\n    let error = null;\n    p.on('text', (text) => {\n        if (element) {\n            element.children.push(text);\n        }\n    });\n    p.on('startElement', (name, attrs) => {\n        const child = new XMLElement(name, attrs);\n        if (!result) {\n            result = child;\n        }\n        if (!element) {\n            element = child;\n        }\n        else {\n            element = element.appendChild(child);\n        }\n    });\n    p.on('endElement', (name) => {\n        if (!element) {\n            p.emit('error', JXTError.notWellFormed());\n        }\n        else if (name === element.name) {\n            if (element.parent) {\n                element = element.parent;\n            }\n            else if (!result) {\n                result = element;\n                element = undefined;\n            }\n        }\n        else {\n            p.emit('error', JXTError.notWellFormed());\n        }\n    });\n    p.on('error', (e) => {\n        error = e;\n    });\n    p.write(data);\n    p.end();\n    if (error) {\n        throw error;\n    }\n    else {\n        return result;\n    }\n}\nclass Parser extends EventEmitter {\n    constructor(opts = {}) {\n        super();\n        this.allowComments = true;\n        this.endTag = false;\n        this.recordStart = 0;\n        this.state = 9 /* TEXT */;\n        this.haveDeclaration = false;\n        if (opts.allowComments !== undefined) {\n            this.allowComments = opts.allowComments;\n        }\n    }\n    write(data) {\n        let pos = 0;\n        if (this.remainder) {\n            data = this.remainder + data;\n            if (this.remainderPos !== undefined) {\n                pos = this.remainderPos;\n            }\n            else {\n                pos = this.remainder.length;\n            }\n            this.remainderPos = undefined;\n            this.remainder = undefined;\n        }\n        for (; pos < data.length; pos++) {\n            const c = data.charCodeAt(pos);\n            switch (this.state) {\n                case 9 /* TEXT */: {\n                    if (c === 60 /* LessThan */) {\n                        const text = this.endRecording(data, pos);\n                        if (text) {\n                            let unescaped;\n                            try {\n                                unescaped = unescapeXML(text);\n                            }\n                            catch (err) {\n                                this.emit('error', err);\n                                return;\n                            }\n                            this.emit('text', unescaped);\n                        }\n                        this.state = 8 /* TAG_NAME */;\n                        this.recordStart = pos + 1;\n                        this.attributes = {};\n                    }\n                    break;\n                }\n                case 4 /* CDATA */: {\n                    if (c === 62 /* GreaterThan */ && this.lookBehindMatch(data, pos, ']]')) {\n                        const text = this.endRecording(data, pos - 2);\n                        if (text) {\n                            this.emit('text', text);\n                        }\n                        this.state = 9 /* TEXT */;\n                    }\n                    break;\n                }\n                case 8 /* TAG_NAME */: {\n                    if (c === 47 /* Slash */ && this.recordStart === pos) {\n                        this.recordStart = pos + 1;\n                        this.endTag = true;\n                    }\n                    else if (c === 33 /* Exclamation */) {\n                        if (this.allowComments) {\n                            const commentLookAhead = this.lookAheadMatch(data, pos, '--');\n                            if (commentLookAhead === 1) {\n                                this.recordStart = undefined;\n                                this.state = 5 /* IGNORE_COMMENT */;\n                                break;\n                            }\n                            else if (commentLookAhead === 0) {\n                                this.waitForData(data, pos);\n                                return;\n                            }\n                        }\n                        const cdataLookAhead = this.lookAheadMatch(data, pos, '[CDATA[');\n                        if (cdataLookAhead === 1) {\n                            this.recordStart = pos + 8;\n                            this.state = 4 /* CDATA */;\n                            break;\n                        }\n                        else if (cdataLookAhead === 0) {\n                            this.waitForData(data, pos);\n                            return;\n                        }\n                        this.emit('error', JXTError.restrictedXML());\n                        return;\n                    }\n                    else if (c === 63 /* Question */) {\n                        this.recordStart = undefined;\n                        if (!this.haveDeclaration) {\n                            const xmlLookAhead = this.lookAheadMatch(data, pos, 'xml', true);\n                            if (xmlLookAhead === 1) {\n                                this.recordStart = pos + 4;\n                                this.state = 10 /* XML_DECLARATION */;\n                                break;\n                            }\n                            else if (xmlLookAhead === 0) {\n                                this.waitForData(data, pos);\n                                return;\n                            }\n                        }\n                        this.emit('error', JXTError.restrictedXML());\n                        return;\n                    }\n                    else if (!isPrintable(c) ||\n                        isWhitespace(c) ||\n                        c === 47 /* Slash */ ||\n                        c === 62 /* GreaterThan */ ||\n                        c === 60 /* LessThan */) {\n                        this.tagName = this.endRecording(data, pos);\n                        pos--;\n                        this.state = 7 /* TAG */;\n                    }\n                    break;\n                }\n                case 5 /* IGNORE_COMMENT */: {\n                    if (c === 62 /* GreaterThan */ &&\n                        (this.lookBehindMatch(data, pos, '--') ||\n                            this.lookBehindMatch(data, pos, ']]'))) {\n                        this.state = 9 /* TEXT */;\n                    }\n                    break;\n                }\n                case 10 /* XML_DECLARATION */: {\n                    if ((c === 120 /* x */ || c === 88 /* X */) &&\n                        this.lookBehindMatch(data, pos, '?', true)) {\n                        break;\n                    }\n                    else if ((c === 109 /* m */ || c === 77 /* M */) &&\n                        this.lookBehindMatch(data, pos, '?x', true)) {\n                        break;\n                    }\n                    else if ((c === 108 /* l */ || c === 78 /* L */) &&\n                        this.lookBehindMatch(data, pos, '?xm', true)) {\n                        break;\n                    }\n                    else if (isWhitespace(c)) {\n                        this.haveDeclaration = true;\n                        this.state = 6 /* IGNORE_INSTRUCTION */;\n                        break;\n                    }\n                    this.emit('error', JXTError.restrictedXML());\n                    return;\n                }\n                case 6 /* IGNORE_INSTRUCTION */: {\n                    if (c === 62 /* GreaterThan */ && this.lookBehindMatch(data, pos, '?')) {\n                        this.state = 9 /* TEXT */;\n                    }\n                    break;\n                }\n                case 7 /* TAG */: {\n                    if (c === 62 /* GreaterThan */ || c === 60 /* LessThan */) {\n                        this.handleTagOpening(this.endTag, this.tagName, this.attributes);\n                        this.tagName = undefined;\n                        this.attributes = undefined;\n                        this.endTag = false;\n                        this.selfClosing = false;\n                        this.state = 9 /* TEXT */;\n                        this.recordStart = pos + 1;\n                    }\n                    else if (c === 47 /* Slash */) {\n                        this.selfClosing = true;\n                    }\n                    else if (isPrintable(c) && c !== 32 /* Space */) {\n                        this.recordStart = pos;\n                        this.state = 1 /* ATTR_NAME */;\n                    }\n                    break;\n                }\n                case 1 /* ATTR_NAME */: {\n                    if (!isPrintable(c) || isWhitespace(c) || c === 61 /* Equal */) {\n                        this.attributeName = this.endRecording(data, pos);\n                        if (c === 61 /* Equal */) {\n                            this.state = 2 /* ATTR_QUOTE */;\n                        }\n                        else {\n                            pos--;\n                            this.state = 0 /* ATTR_EQ */;\n                        }\n                    }\n                    break;\n                }\n                case 0 /* ATTR_EQ */: {\n                    if (isWhitespace(c)) {\n                        break;\n                    }\n                    if (c === 61 /* Equal */) {\n                        this.state = 2 /* ATTR_QUOTE */;\n                        break;\n                    }\n                    this.emit('error', JXTError.notWellFormed());\n                    return;\n                }\n                case 2 /* ATTR_QUOTE */: {\n                    if (isWhitespace(c)) {\n                        break;\n                    }\n                    if (c === 34 /* DoubleQuote */ || c === 39 /* SingleQuote */) {\n                        this.attributeQuote = c;\n                        this.state = 3 /* ATTR_VALUE */;\n                        this.recordStart = pos + 1;\n                        break;\n                    }\n                    this.emit('error', JXTError.notWellFormed());\n                    return;\n                }\n                case 3 /* ATTR_VALUE */: {\n                    if (c === this.attributeQuote) {\n                        let value;\n                        try {\n                            value = unescapeXML(this.endRecording(data, pos));\n                        }\n                        catch (err) {\n                            this.emit('error', err);\n                            return;\n                        }\n                        if (this.attributes[this.attributeName] !== undefined) {\n                            this.emit('error', JXTError.notWellFormed());\n                            return;\n                        }\n                        this.attributes[this.attributeName] = value;\n                        this.attributeName = undefined;\n                        this.state = 7 /* TAG */;\n                    }\n                }\n            }\n        }\n        if (this.recordStart !== undefined && this.recordStart <= data.length) {\n            this.remainder = data.slice(this.recordStart);\n            this.recordStart = 0;\n        }\n    }\n    end(data) {\n        if (data) {\n            this.write(data);\n        }\n        this.write = () => undefined;\n    }\n    endRecording(data, pos) {\n        if (this.recordStart !== undefined) {\n            const recorded = data.slice(this.recordStart, pos);\n            this.recordStart = undefined;\n            return recorded;\n        }\n        return '';\n    }\n    handleTagOpening(endTag, tagName, attrs) {\n        if (!endTag) {\n            this.emit('startElement', tagName, attrs);\n            if (this.selfClosing) {\n                this.emit('endElement', tagName);\n            }\n        }\n        else {\n            this.emit('endElement', tagName);\n        }\n    }\n    waitForData(data, pos) {\n        this.remainder = data.substr(pos);\n        this.remainderPos = pos;\n    }\n    lookAheadMatch(data, pos, search, lowercase = false) {\n        const needed = search.length;\n        let lookahead = data.substr(pos + 1, needed);\n        if (lowercase) {\n            lookahead = lookahead.toLowerCase();\n        }\n        if (lookahead.length === needed && lookahead === search) {\n            return 1;\n        }\n        if (lookahead.length < needed && search.startsWith(lookahead)) {\n            return 0;\n        }\n        return -1;\n    }\n    lookBehindMatch(data, pos, search, lowercase = false) {\n        if (pos - search.length < 0) {\n            return false;\n        }\n        if (lowercase) {\n            return data.substr(pos - search.length, search.length).toLowerCase() === search;\n        }\n        return data.substr(pos - search.length, search.length) === search;\n    }\n}\n\nfunction createElement(namespace, name, parentNamespace, parent) {\n    if (parent) {\n        namespace = namespace || parent.getNamespace();\n        const root = parent.getNamespaceRoot(namespace);\n        if (root) {\n            const prefix = root.useNamespace('', namespace);\n            name = `${prefix}:${name}`;\n        }\n    }\n    const el = new XMLElement(name);\n    if (name.indexOf(':') < 0 && (!parentNamespace || namespace !== parentNamespace)) {\n        el.setAttribute('xmlns', namespace);\n    }\n    return el;\n}\nfunction getLang(xml, lang) {\n    return (xml.getAttribute('xml:lang') || lang || '').toLowerCase();\n}\nfunction getTargetLang(children, context) {\n    const availableLanguages = [];\n    for (const child of children) {\n        availableLanguages.push(getLang(child, context.lang));\n    }\n    let targetLanguage;\n    if (!context.resolveLanguage) {\n        targetLanguage = context.lang;\n    }\n    else {\n        targetLanguage = context.resolveLanguage(availableLanguages, context.acceptLanguages || [], context.lang);\n    }\n    return targetLanguage || '';\n}\nfunction findAll(xml, namespace, element, lang) {\n    const existing = xml.getChildren(element, namespace);\n    const parentLang = getLang(xml);\n    if (existing.length) {\n        if (lang) {\n            return existing.filter(child => {\n                const childLang = getLang(child, parentLang);\n                if (childLang === lang) {\n                    return true;\n                }\n            });\n        }\n        else {\n            return existing;\n        }\n    }\n    return [];\n}\nfunction findOrCreate(xml, namespace, element, lang) {\n    namespace = namespace || xml.getNamespace();\n    const existing = findAll(xml, namespace, element, lang);\n    if (existing.length) {\n        return existing[0];\n    }\n    const created = createElement(namespace, element, xml.getDefaultNamespace(), xml);\n    const parentLang = getLang(xml, lang);\n    if (lang && parentLang !== lang) {\n        created.setAttribute('xml:lang', lang);\n    }\n    xml.appendChild(created);\n    return created;\n}\nfunction createAttributeField(opts) {\n    return {\n        importer(xml) {\n            const rawValue = xml.getAttribute(opts.name, opts.namespace);\n            if (!rawValue) {\n                return opts.dynamicDefault ? opts.dynamicDefault(rawValue) : opts.staticDefault;\n            }\n            return opts.parseValue(rawValue);\n        },\n        exporter(xml, value) {\n            if (value === undefined) {\n                return;\n            }\n            const output = opts.writeValue(value);\n            if (!output && !opts.emitEmpty) {\n                return;\n            }\n            if (!opts.namespace || !opts.prefix) {\n                xml.setAttribute(opts.name, output, opts.emitEmpty);\n            }\n            else {\n                let prefix;\n                const root = xml.getNamespaceRoot(opts.namespace);\n                if (root) {\n                    prefix = root.useNamespace(opts.prefix, opts.namespace);\n                }\n                else {\n                    const namespaces = xml.getNamespaceContext();\n                    if (!namespaces[opts.namespace]) {\n                        prefix = xml.useNamespace(opts.prefix, opts.namespace);\n                        namespaces[opts.namespace] = prefix;\n                    }\n                }\n                xml.setAttribute(`${prefix}:${opts.name}`, output, opts.emitEmpty);\n            }\n        }\n    };\n}\nfunction createAttributeType(parser, createOpts) {\n    return (name, defaultValue = undefined, opts = {}) => {\n        opts = Object.assign({ staticDefault: defaultValue }, opts);\n        return createAttributeField(Object.assign(Object.assign({ name }, parser), (createOpts ? createOpts(opts) : opts)));\n    };\n}\nfunction createNamespacedAttributeType(parser, createOpts) {\n    return (prefix, namespace, name, defaultValue = undefined, opts = {}) => {\n        opts = Object.assign({ staticDefault: defaultValue }, opts);\n        return createAttributeField(Object.assign(Object.assign({ name,\n            namespace,\n            prefix }, parser), (createOpts ? createOpts(opts) : opts)));\n    };\n}\nfunction createChildAttributeField(opts) {\n    const converter = opts.converter ||\n        createAttributeField(Object.assign(Object.assign({}, opts), { namespace: opts.attributeNamespace }));\n    return {\n        importer(xml, context) {\n            const child = xml.getChild(opts.element, opts.namespace || xml.getNamespace());\n            if (!child) {\n                return opts.dynamicDefault ? opts.dynamicDefault() : opts.staticDefault;\n            }\n            return converter.importer(child, context);\n        },\n        exporter(xml, value, context) {\n            if (value !== undefined) {\n                const child = findOrCreate(xml, opts.namespace || xml.getNamespace(), opts.element);\n                converter.exporter(child, value, context);\n            }\n        }\n    };\n}\nfunction createChildAttributeType(parser, createOpts) {\n    return (namespace, element, name, defaultValue = undefined, opts = {}) => {\n        opts = Object.assign({ staticDefault: defaultValue }, opts);\n        return createChildAttributeField(Object.assign(Object.assign({ element,\n            name,\n            namespace }, parser), (createOpts ? createOpts(opts) : opts)));\n    };\n}\nfunction createTextField(opts) {\n    return {\n        importer(xml) {\n            const rawValue = xml.getText();\n            if (!rawValue) {\n                return opts.dynamicDefault ? opts.dynamicDefault(rawValue) : opts.staticDefault;\n            }\n            return opts.parseValue(rawValue);\n        },\n        exporter(xml, value) {\n            if (value === undefined) {\n                return;\n            }\n            const output = opts.writeValue(value);\n            if (output) {\n                xml.children.push(output);\n            }\n        }\n    };\n}\nfunction createChildTextField(opts) {\n    const converter = createTextField(opts);\n    return {\n        importer(xml, context) {\n            const children = findAll(xml, opts.namespace || xml.getNamespace(), opts.element);\n            const targetLanguage = getTargetLang(children, context);\n            if (!children.length) {\n                return opts.dynamicDefault ? opts.dynamicDefault() : opts.staticDefault;\n            }\n            if (opts.matchLanguage) {\n                for (const child of children) {\n                    if (getLang(child, context.lang) === targetLanguage) {\n                        return converter.importer(child, context);\n                    }\n                }\n            }\n            return converter.importer(children[0], context);\n        },\n        exporter(xml, value, context) {\n            if (value !== undefined) {\n                const child = findOrCreate(xml, opts.namespace || xml.getNamespace(), opts.element, opts.matchLanguage ? context.lang : undefined);\n                converter.exporter(child, value, context);\n            }\n        }\n    };\n}\nconst stringParser = {\n    parseValue: v => v,\n    writeValue: v => v\n};\nconst integerParser = {\n    parseValue: v => parseInt(v, 10),\n    writeValue: v => v.toString()\n};\nconst floatParser = {\n    parseValue: v => parseFloat(v),\n    writeValue: v => v.toString()\n};\nconst boolParser = {\n    parseValue: v => {\n        if (v === 'true' || v === '1') {\n            return true;\n        }\n        if (v === 'false' || v === '0') {\n            return false;\n        }\n        return;\n    },\n    writeValue: v => (v ? '1' : '0')\n};\nconst dateParser = {\n    parseValue: v => new Date(v),\n    writeValue: v => (typeof v === 'string' ? v : v.toISOString())\n};\nconst jsonParser = {\n    parseValue: v => JSON.parse(v),\n    writeValue: v => JSON.stringify(v)\n};\nconst bufferParser = (encoding = 'utf8') => ({\n    parseValue: v => {\n        if (encoding === 'base64' && v === '=') {\n            v = '';\n        }\n        return Buffer.from(v.trim(), encoding);\n    },\n    writeValue: v => {\n        let data;\n        if (typeof v === 'string') {\n            data = Buffer.from(v).toString(encoding);\n        }\n        else if (v) {\n            data = v.toString(encoding);\n        }\n        else {\n            data = '';\n        }\n        if (encoding === 'base64') {\n            data = data || '=';\n        }\n        return data;\n    }\n});\nconst tzOffsetParser = {\n    parseValue: v => {\n        let sign = -1;\n        if (v.charAt(0) === '-') {\n            sign = 1;\n            v = v.slice(1);\n        }\n        const split = v.split(':');\n        const hours = parseInt(split[0], 10);\n        const minutes = parseInt(split[1], 10);\n        return (hours * 60 + minutes) * sign;\n    },\n    writeValue: v => {\n        if (typeof v === 'string') {\n            return v;\n        }\n        else {\n            let formatted = '-';\n            if (v < 0) {\n                v = -v;\n                formatted = '+';\n            }\n            const hours = v / 60;\n            const minutes = v % 60;\n            formatted +=\n                (hours < 10 ? '0' : '') + hours + ':' + (minutes < 10 ? '0' : '') + minutes;\n            return formatted;\n        }\n    }\n};\n// ====================================================================\n// Field Types\n// ====================================================================\nconst attribute = createAttributeType(stringParser, opts => (Object.assign({ dynamicDefault: opts.emitEmpty ? v => (v === '' ? '' : opts.staticDefault) : undefined }, opts)));\nconst booleanAttribute = createAttributeType(boolParser);\nconst integerAttribute = createAttributeType(integerParser);\nconst floatAttribute = createAttributeType(floatParser);\nconst dateAttribute = createAttributeType(dateParser);\nconst namespacedAttribute = createNamespacedAttributeType(stringParser);\nconst namespacedBooleanAttribute = createNamespacedAttributeType(boolParser);\nconst namespacedIntegerAttribute = createNamespacedAttributeType(integerParser);\nconst namespacedFloatAttribute = createNamespacedAttributeType(floatParser);\nconst namespacedDateAttribute = createNamespacedAttributeType(dateParser);\nconst childAttribute = createChildAttributeType(stringParser);\nconst childBooleanAttribute = createChildAttributeType(boolParser);\nconst childIntegerAttribute = createChildAttributeType(integerParser);\nconst childFloatAttribute = createChildAttributeType(floatParser);\nconst childDateAttribute = createChildAttributeType(dateParser);\nconst text = (defaultValue) => createTextField(Object.assign({ staticDefault: defaultValue }, stringParser));\nconst textJSON = () => createTextField(Object.assign({}, jsonParser));\nconst textBuffer = (encoding = 'utf8') => createTextField(Object.assign({}, bufferParser(encoding)));\nfunction languageAttribute() {\n    return {\n        importer(xml, context) {\n            return getLang(xml, context.lang);\n        },\n        exporter(xml, value, context) {\n            if (value && value.toLowerCase() !== context.lang) {\n                xml.setAttribute('xml:lang', value);\n            }\n            else {\n                xml.setAttribute('xml:lang', undefined);\n            }\n        }\n    };\n}\nconst childLanguageAttribute = (namespace, element) => createChildAttributeField(Object.assign({ converter: languageAttribute(), element, name: 'xml:lang', namespace }, stringParser));\nconst childText = (namespace, element, defaultValue) => createChildTextField(Object.assign({ element, matchLanguage: true, namespace, staticDefault: defaultValue }, stringParser));\nconst childTextBuffer = (namespace, element, encoding = 'utf8') => createChildTextField(Object.assign({ element, matchLanguage: true, namespace }, bufferParser(encoding)));\nconst childDate = (namespace, element) => createChildTextField(Object.assign({ element,\n    namespace }, dateParser));\nconst childInteger = (namespace, element, defaultValue) => createChildTextField(Object.assign({ element,\n    namespace, staticDefault: defaultValue }, integerParser));\nconst childFloat = (namespace, element, defaultValue) => createChildTextField(Object.assign({ element,\n    namespace, staticDefault: defaultValue }, floatParser));\nconst childJSON = (namespace, element) => createChildTextField(Object.assign({ element,\n    namespace }, jsonParser));\nfunction childTimezoneOffset(namespace, element) {\n    return createChildTextField(Object.assign({ element,\n        namespace, staticDefault: 0 }, tzOffsetParser));\n}\nfunction childBoolean(namespace, element) {\n    return {\n        importer(xml) {\n            const child = xml.getChild(element, namespace || xml.getNamespace());\n            if (child) {\n                return true;\n            }\n        },\n        exporter(xml, value) {\n            if (value) {\n                findOrCreate(xml, namespace || xml.getNamespace(), element);\n            }\n        }\n    };\n}\nconst deepChildExpoter = (path, xml, value) => {\n    if (!value) {\n        return;\n    }\n    let current = xml;\n    for (const node of path) {\n        current = findOrCreate(current, node.namespace || current.getNamespace(), node.element);\n    }\n    current.children.push(value.toString());\n};\nfunction deepChildText(path, defaultValue) {\n    return {\n        importer(xml) {\n            let current = xml;\n            for (const node of path) {\n                current = current.getChild(node.element, node.namespace || current.getNamespace());\n                if (!current) {\n                    return defaultValue;\n                }\n            }\n            return current.getText() || defaultValue;\n        },\n        exporter(xml, value) {\n            deepChildExpoter(path, xml, value);\n        }\n    };\n}\nfunction deepChildInteger(path, defaultValue) {\n    return {\n        importer(xml) {\n            let current = xml;\n            for (const node of path) {\n                current = current.getChild(node.element, node.namespace || current.getNamespace());\n                if (!current) {\n                    return;\n                }\n            }\n            const data = current.getText();\n            if (data) {\n                return parseInt(data, 10);\n            }\n            else if (defaultValue) {\n                return defaultValue;\n            }\n        },\n        exporter(xml, value) {\n            deepChildExpoter(path, xml, value);\n        }\n    };\n}\nfunction deepChildBoolean(path) {\n    return {\n        importer(xml) {\n            let current = xml;\n            for (const node of path) {\n                current = current.getChild(node.element, node.namespace || current.getNamespace());\n                if (!current) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        exporter(xml, value) {\n            if (!value) {\n                return;\n            }\n            let current = xml;\n            for (const node of path) {\n                current = findOrCreate(current, node.namespace || current.getNamespace(), node.element);\n            }\n        }\n    };\n}\nfunction childEnum(namespace, elements, defaultValue) {\n    const elementNames = new Map();\n    const valueNames = new Map();\n    for (const el of elements) {\n        if (typeof el === 'string') {\n            elementNames.set(el, el);\n            valueNames.set(el, el);\n        }\n        else {\n            elementNames.set(el[1], el[0]);\n            valueNames.set(el[0], el[1]);\n        }\n    }\n    return {\n        importer(xml) {\n            for (const child of xml.children) {\n                if (typeof child === 'string') {\n                    continue;\n                }\n                else if (child.getNamespace() === (namespace || xml.getNamespace()) &&\n                    elementNames.has(child.getName())) {\n                    return elementNames.get(child.getName());\n                }\n            }\n            return defaultValue;\n        },\n        exporter(xml, value) {\n            if (valueNames.has(value)) {\n                findOrCreate(xml, namespace, valueNames.get(value));\n            }\n        }\n    };\n}\nfunction childDoubleEnum(namespace, parentElements, childElements, defaultValue) {\n    const parentNames = new Set(parentElements);\n    const childNames = new Set(childElements);\n    return {\n        importer(xml) {\n            for (const parent of xml.children) {\n                if (typeof parent === 'string') {\n                    continue;\n                }\n                else if (parent.getNamespace() === (namespace || xml.getNamespace()) &&\n                    parentNames.has(parent.getName())) {\n                    for (const child of parent.children) {\n                        if (typeof child === 'string') {\n                            continue;\n                        }\n                        else if (child.getNamespace() === (namespace || xml.getNamespace()) &&\n                            childNames.has(child.getName())) {\n                            return [parent.getName(), child.getName()];\n                        }\n                    }\n                    return [parent.getName()];\n                }\n            }\n            return defaultValue;\n        },\n        exporter(xml, value) {\n            const parent = findOrCreate(xml, namespace, value[0]);\n            if (value[1]) {\n                findOrCreate(parent, namespace, value[1]);\n            }\n        }\n    };\n}\nfunction multipleChildText(namespace, element) {\n    return {\n        importer(xml, context) {\n            const result = [];\n            const children = findAll(xml, namespace || xml.getNamespace(), element);\n            const targetLanguage = getTargetLang(children, context);\n            for (const child of children) {\n                if (getLang(child, context.lang) === targetLanguage) {\n                    result.push(child.getText());\n                }\n            }\n            return result;\n        },\n        exporter(xml, values, context) {\n            for (const value of values) {\n                const child = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                child.children.push(value);\n                xml.appendChild(child);\n            }\n        }\n    };\n}\nfunction multipleChildAttribute(namespace, element, name) {\n    return {\n        importer(xml) {\n            const result = [];\n            const children = xml.getChildren(element, namespace || xml.getNamespace());\n            for (const child of children) {\n                const childAttr = child.getAttribute(name);\n                if (childAttr !== undefined) {\n                    result.push(childAttr);\n                }\n            }\n            return result;\n        },\n        exporter(xml, values, context) {\n            for (const value of values) {\n                const child = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                child.setAttribute(name, value);\n                xml.appendChild(child);\n            }\n        }\n    };\n}\nfunction multipleChildIntegerAttribute(namespace, element, name) {\n    return {\n        importer(xml) {\n            const result = [];\n            const children = xml.getChildren(element, namespace || xml.getNamespace());\n            for (const child of children) {\n                const childAttr = child.getAttribute(name);\n                if (childAttr !== undefined) {\n                    result.push(parseInt(childAttr, 10));\n                }\n            }\n            return result;\n        },\n        exporter(xml, values, context) {\n            for (const value of values) {\n                const child = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                child.setAttribute(name, value.toString());\n                xml.appendChild(child);\n            }\n        }\n    };\n}\nfunction childAlternateLanguageText(namespace, element) {\n    return {\n        importer(xml, context) {\n            const results = [];\n            const children = findAll(xml, namespace || xml.getNamespace(), element);\n            const seenLanuages = new Set();\n            for (const child of children) {\n                const langText = child.getText();\n                if (langText) {\n                    const lang = getLang(child, context.lang);\n                    if (seenLanuages.has(lang)) {\n                        continue;\n                    }\n                    results.push({ lang, value: langText });\n                    seenLanuages.add(lang);\n                }\n            }\n            return seenLanuages.size > 0 ? results : undefined;\n        },\n        exporter(xml, values, context) {\n            for (const entry of values) {\n                const val = entry.value;\n                if (val) {\n                    const child = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                    if (entry.lang !== context.lang) {\n                        child.setAttribute('xml:lang', entry.lang);\n                    }\n                    child.children.push(val);\n                    xml.appendChild(child);\n                }\n            }\n        }\n    };\n}\nfunction multipleChildAlternateLanguageText(namespace, element) {\n    return {\n        importer(xml, context) {\n            const results = [];\n            const langIndex = new Map();\n            let hasResults = false;\n            const children = findAll(xml, namespace || xml.getNamespace(), element);\n            for (const child of children) {\n                const langText = child.getText();\n                if (langText) {\n                    const lang = getLang(child, context.lang);\n                    let langResults = langIndex.get(lang);\n                    if (!langResults) {\n                        langResults = [];\n                        langIndex.set(lang, langResults);\n                        results.push({ lang, value: langResults });\n                    }\n                    langResults.push(langText);\n                    hasResults = true;\n                }\n            }\n            return hasResults ? results : undefined;\n        },\n        exporter(xml, values, context) {\n            for (const entry of values) {\n                for (const val of entry.value) {\n                    const child = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                    if (entry.lang !== context.lang) {\n                        child.setAttribute('xml:lang', entry.lang);\n                    }\n                    child.children.push(val);\n                    xml.appendChild(child);\n                }\n            }\n        }\n    };\n}\nfunction multipleChildEnum(namespace, elements) {\n    const elementNames = new Map();\n    const valueNames = new Map();\n    for (const el of elements) {\n        if (typeof el === 'string') {\n            elementNames.set(el, el);\n            valueNames.set(el, el);\n        }\n        else {\n            elementNames.set(el[1], el[0]);\n            valueNames.set(el[0], el[1]);\n        }\n    }\n    return {\n        importer(xml) {\n            const results = [];\n            for (const child of xml.children) {\n                if (typeof child === 'string') {\n                    continue;\n                }\n                else if (child.getNamespace() === (namespace || xml.getNamespace()) &&\n                    elementNames.has(child.getName())) {\n                    results.push(elementNames.get(child.getName()));\n                }\n            }\n            return results;\n        },\n        exporter(xml, values) {\n            for (const value of values) {\n                findOrCreate(xml, namespace, valueNames.get(value));\n            }\n        }\n    };\n}\nfunction splicePath(namespace, element, path, multiple = false) {\n    return {\n        importer(xml, context) {\n            const child = xml.getChild(element, namespace || xml.getNamespace());\n            if (!child) {\n                return;\n            }\n            const results = [];\n            for (const grandChild of child.children) {\n                if (typeof grandChild === 'string') {\n                    continue;\n                }\n                if (context.registry.getImportKey(grandChild) === path) {\n                    const imported = context.registry.import(grandChild);\n                    if (imported) {\n                        results.push(imported);\n                    }\n                }\n            }\n            return multiple ? results : results[0];\n        },\n        exporter(xml, data, context) {\n            let values = [];\n            if (!Array.isArray(data)) {\n                values = [data];\n            }\n            else {\n                values = data;\n            }\n            const children = [];\n            for (const value of values) {\n                const child = context.registry.export(path, value, Object.assign(Object.assign({}, context), { namespace: namespace || xml.getNamespace() || undefined }));\n                if (child) {\n                    children.push(child);\n                }\n            }\n            if (children.length) {\n                const skipChild = findOrCreate(xml, namespace || xml.getNamespace(), element);\n                for (const child of children) {\n                    skipChild.appendChild(child);\n                }\n            }\n        }\n    };\n}\nfunction staticValue(value) {\n    return {\n        exporter: () => undefined,\n        importer: () => value\n    };\n}\nfunction childRawElement(namespace, element, sanitizer) {\n    return {\n        importer(xml, context) {\n            if (sanitizer && (!context.sanitizers || !context.sanitizers[sanitizer])) {\n                return;\n            }\n            const child = xml.getChild(element, namespace || xml.getNamespace());\n            if (child) {\n                if (sanitizer) {\n                    return context.sanitizers[sanitizer](child.toJSON());\n                }\n                else {\n                    return child.toJSON();\n                }\n            }\n        },\n        exporter(xml, value, context) {\n            if (typeof value === 'string') {\n                const wrapped = parse$1(`<${element} xmlns=\"${namespace || xml.getNamespace()}\">${value}</${element}>`);\n                value = wrapped.toJSON();\n            }\n            if (sanitizer) {\n                if (!context.sanitizers || !context.sanitizers[sanitizer]) {\n                    return;\n                }\n                value = context.sanitizers[sanitizer](value);\n            }\n            if (value) {\n                xml.appendChild(new XMLElement(value.name, value.attributes, value.children));\n            }\n        }\n    };\n}\nfunction childLanguageRawElement(namespace, element, sanitizer) {\n    return {\n        importer(xml, context) {\n            if (sanitizer && (!context.sanitizers || !context.sanitizers[sanitizer])) {\n                return;\n            }\n            const children = findAll(xml, namespace || xml.getNamespace(), element);\n            const targetLanguage = getTargetLang(children, context);\n            for (const child of children) {\n                if (getLang(child, context.lang) === targetLanguage) {\n                    if (sanitizer) {\n                        return context.sanitizers[sanitizer](child.toJSON());\n                    }\n                    else {\n                        return child.toJSON();\n                    }\n                }\n            }\n            if (children[0]) {\n                if (sanitizer) {\n                    return context.sanitizers[sanitizer](children[0].toJSON());\n                }\n                else {\n                    return children[0].toJSON();\n                }\n            }\n        },\n        exporter(xml, value, context) {\n            if (typeof value === 'string') {\n                const wrapped = parse$1(`<${element} xmlns=\"${namespace || xml.getNamespace()}\">${value}</${element}>`);\n                value = wrapped.toJSON();\n            }\n            if (value && sanitizer) {\n                if (!context.sanitizers || !context.sanitizers[sanitizer]) {\n                    return;\n                }\n                value = context.sanitizers[sanitizer](value);\n            }\n            if (!value) {\n                return;\n            }\n            const rawElement = findOrCreate(xml, namespace || xml.getNamespace(), element, context.lang);\n            for (const child of value.children) {\n                if (typeof child === 'string') {\n                    rawElement.appendChild(child);\n                }\n                else if (child) {\n                    rawElement.appendChild(new XMLElement(child.name, child.attributes, child.children));\n                }\n            }\n        }\n    };\n}\nfunction childAlternateLanguageRawElement(namespace, element, sanitizer) {\n    return {\n        importer(xml, context) {\n            if (sanitizer && (!context.sanitizers || !context.sanitizers[sanitizer])) {\n                return;\n            }\n            const results = [];\n            const seenLanuages = new Set();\n            const children = findAll(xml, namespace || xml.getNamespace(), element);\n            for (const child of children) {\n                let result = child.toJSON();\n                if (sanitizer) {\n                    result = context.sanitizers[sanitizer](result);\n                }\n                if (result) {\n                    const lang = getLang(child, context.lang);\n                    if (seenLanuages.has(lang)) {\n                        continue;\n                    }\n                    results.push({ lang, value: result });\n                    seenLanuages.add(lang);\n                }\n            }\n            return seenLanuages.size > 0 ? results : undefined;\n        },\n        exporter(xml, values, context) {\n            for (const entry of values) {\n                let value = entry.value;\n                if (typeof value === 'string') {\n                    const wrapped = parse$1(`<${element} xmlns=\"${namespace ||\n                        xml.getNamespace()}\">${value}</${element}>`);\n                    value = wrapped.toJSON();\n                }\n                if (value && sanitizer) {\n                    if (!context.sanitizers || !context.sanitizers[sanitizer]) {\n                        continue;\n                    }\n                    value = context.sanitizers[sanitizer](value);\n                }\n                if (value) {\n                    const rawElement = createElement(namespace || xml.getNamespace(), element, context.namespace, xml);\n                    xml.appendChild(rawElement);\n                    if (entry.lang !== context.lang) {\n                        rawElement.setAttribute('xml:lang', entry.lang);\n                    }\n                    for (const child of value.children) {\n                        if (typeof child === 'string') {\n                            rawElement.appendChild(child);\n                        }\n                        else {\n                            rawElement.appendChild(new XMLElement(child.name, child.attributes, child.children));\n                        }\n                    }\n                }\n            }\n        }\n    };\n}\nfunction parameterMap(namespace, element, keyName, valueName) {\n    return {\n        importer(xml, context) {\n            const result = {};\n            const params = findAll(xml, namespace, element);\n            const keyImporter = attribute(keyName).importer;\n            const valueImporter = attribute(valueName).importer;\n            for (const param of params) {\n                result[keyImporter(param, context)] = valueImporter(param, context);\n            }\n            return result;\n        },\n        exporter(xml, values, context) {\n            const keyExporter = attribute(keyName).exporter;\n            const valueExporter = attribute(valueName).exporter;\n            const ns = namespace || xml.getNamespace();\n            for (const [param, value] of Object.entries(values)) {\n                const paramEl = createElement(ns, element, context.namespace, xml);\n                keyExporter(paramEl, param, context);\n                if (values[param]) {\n                    valueExporter(paramEl, value, context);\n                }\n                xml.appendChild(paramEl);\n            }\n        }\n    };\n}\n\nclass Translator {\n    constructor() {\n        this.parents = new Set();\n        this.placeholder = false;\n        this.typeField = '';\n        this.defaultType = '';\n        this.languageField = 'lang';\n        this.typeValues = new Map();\n        this.typeOrders = new Map();\n        this.importers = new Map();\n        this.exporters = new Map();\n        this.children = new Map();\n        this.childrenIndex = new Map();\n        this.implicitChildren = new Set();\n        this.contexts = new Map();\n    }\n    addChild(name, translator, multiple = false, selector, implicit) {\n        const child = {\n            multiple: multiple || false,\n            name,\n            selector,\n            translator\n        };\n        const existingChild = this.children.get(name);\n        if (!existingChild) {\n            child.translator.parents.add(this);\n            this.children.set(name, child);\n            for (const [xid] of translator.importers) {\n                if (!this.implicitChildren.has(xid)) {\n                    this.childrenIndex.set(xid, name);\n                }\n            }\n            if (implicit) {\n                this.implicitChildren.add(implicit);\n            }\n            return;\n        }\n        const existing = existingChild.translator;\n        existingChild.multiple = multiple;\n        if (selector && existingChild.selector && selector !== existingChild.selector) {\n            existingChild.selector = undefined;\n        }\n        for (const [xid, importer] of translator.importers) {\n            existing.updateDefinition({\n                contexts: translator.contexts,\n                element: importer.element,\n                exporterOrdering: new Map(),\n                exporters: new Map(),\n                importerOrdering: importer.fieldOrders,\n                importers: importer.fields,\n                namespace: importer.namespace,\n                optionalNamespaces: new Map(),\n                type: existing.typeValues.get(xid)\n            });\n            if (!this.implicitChildren.has(xid)) {\n                this.childrenIndex.set(xid, name);\n            }\n        }\n        for (const [exportType, exporter] of translator.exporters) {\n            existing.updateDefinition({\n                contexts: translator.contexts,\n                element: exporter.element,\n                exporterOrdering: exporter.fieldOrders,\n                exporters: exporter.fields,\n                importerOrdering: new Map(),\n                importers: new Map(),\n                namespace: exporter.namespace,\n                optionalNamespaces: exporter.optionalNamespaces,\n                type: exportType\n            });\n        }\n    }\n    addContext(path, selector, field, xid, value, implied = false) {\n        if (selector) {\n            path = `${path}[${selector}]`;\n        }\n        let context = this.contexts.get(path);\n        if (!context) {\n            context = {\n                typeField: '',\n                typeValues: new Map()\n            };\n        }\n        if (implied) {\n            context.impliedType = value;\n        }\n        context.typeField = field || '';\n        context.typeValues.set(xid, value);\n        this.contexts.set(path, context);\n    }\n    getChild(name) {\n        const child = this.children.get(name);\n        if (!child) {\n            return;\n        }\n        return child.translator;\n    }\n    getImportKey(xml) {\n        return this.childrenIndex.get(`{${xml.getNamespace()}}${xml.getName()}`);\n    }\n    updateDefinition(opts) {\n        const xid = `{${opts.namespace}}${opts.element}`;\n        const importer = this.importers.get(xid) ||\n            {\n                element: opts.element,\n                fieldOrders: new Map(),\n                fields: new Map(),\n                namespace: opts.namespace\n            };\n        for (const [fieldName, fieldImporter] of opts.importers) {\n            importer.fields.set(fieldName, fieldImporter);\n        }\n        for (const [fieldName, order] of opts.importerOrdering) {\n            importer.fieldOrders.set(fieldName, order);\n        }\n        this.importers.set(xid, importer);\n        const exporter = this.exporters.get(opts.type || this.defaultType) ||\n            {\n                element: opts.element,\n                fieldOrders: new Map(),\n                fields: new Map(),\n                namespace: opts.namespace,\n                optionalNamespaces: opts.optionalNamespaces\n            };\n        for (const [fieldName, fieldExporter] of opts.exporters) {\n            exporter.fields.set(fieldName, fieldExporter);\n        }\n        for (const [name, order] of opts.exporterOrdering) {\n            exporter.fieldOrders.set(name, order);\n        }\n        for (const [prefix, namespace] of opts.optionalNamespaces) {\n            exporter.optionalNamespaces.set(prefix, namespace);\n        }\n        this.exporters.set(opts.type || this.defaultType, exporter);\n        for (const [path, newContext] of opts.contexts) {\n            const context = this.contexts.get(path) || {\n                impliedType: undefined,\n                typeField: newContext.typeField,\n                typeValues: new Map()\n            };\n            if (!context.typeField) {\n                context.typeField = newContext.typeField;\n            }\n            if (!context.impliedType) {\n                context.impliedType = newContext.impliedType;\n            }\n            for (const [xid2, type] of newContext.typeValues) {\n                context.typeValues.set(xid2, type);\n            }\n            this.contexts.set(path, context);\n        }\n        if (opts.type) {\n            this.typeValues.set(xid, opts.type);\n            if (opts.typeOrder) {\n                this.typeOrders.set(opts.type, opts.typeOrder);\n            }\n        }\n        else if (this.typeField && !opts.type) {\n            for (const [, imp] of this.importers) {\n                for (const [fieldName, fieldImporter] of opts.importers) {\n                    imp.fields.set(fieldName, fieldImporter);\n                }\n                for (const [fieldName, order] of opts.importerOrdering) {\n                    imp.fieldOrders.set(fieldName, order);\n                }\n            }\n            for (const [, exp] of this.exporters) {\n                for (const [fieldName, fieldExporter] of opts.exporters) {\n                    exp.fields.set(fieldName, fieldExporter);\n                }\n                for (const [fieldName, order] of opts.exporterOrdering) {\n                    exp.fieldOrders.set(fieldName, order);\n                }\n            }\n        }\n    }\n    replaceWith(replacement) {\n        for (const [a, b] of this.children) {\n            replacement.children.set(a, b);\n        }\n        for (const [a, b] of this.childrenIndex) {\n            replacement.childrenIndex.set(a, b);\n        }\n        for (const [a, b] of this.contexts) {\n            replacement.contexts.set(a, b);\n        }\n        for (const a of this.implicitChildren) {\n            replacement.implicitChildren.add(a);\n        }\n        for (const parent of this.parents) {\n            for (const child of parent.children.values()) {\n                if (child.translator === this) {\n                    child.translator = replacement;\n                }\n            }\n        }\n        this.parents = new Set();\n    }\n    import(xml, parentContext) {\n        const xid = `{${xml.getNamespace()}}${xml.getName()}`;\n        const output = {};\n        const importer = this.importers.get(xid);\n        if (!importer) {\n            return;\n        }\n        const typeValue = this.typeValues.get(xid);\n        const path = parentContext.path || '';\n        let implied;\n        if (parentContext.pathSelector) {\n            implied = this.contexts.get(`${path}[${parentContext.pathSelector}]`);\n        }\n        if (!implied) {\n            implied = this.contexts.get(path);\n        }\n        if (implied) {\n            if (!implied.impliedType) {\n                const impliedTypeValue = implied.typeValues.get(xid);\n                if (impliedTypeValue) {\n                    output[implied.typeField] = impliedTypeValue;\n                }\n            }\n        }\n        else if (this.typeField && typeValue && typeValue !== this.defaultType) {\n            output[this.typeField] = typeValue;\n        }\n        const context = Object.assign(Object.assign({}, parentContext), { data: output, importer, lang: (xml.getAttribute('xml:lang') || parentContext.lang || '').toLowerCase(), pathSelector: typeValue, translator: this });\n        const importFields = [...importer.fieldOrders.entries()].sort((a, b) => a[1] > b[1] ? -1 : a[1] < b[1] ? 1 : 0);\n        const preChildren = importFields.filter(field => field[1] >= 0);\n        const postChildren = importFields.filter(field => field[1] < 0);\n        for (const [fieldName] of preChildren) {\n            const importField = importer.fields.get(fieldName);\n            context.path = `${parentContext.path}.${fieldName}`;\n            const value = importField(xml, context);\n            if (value !== null && value !== undefined) {\n                output[fieldName] = value;\n            }\n        }\n        for (const child of xml.children) {\n            if (typeof child === 'string') {\n                continue;\n            }\n            const childName = `{${child.getNamespace()}}${child.getName()}`;\n            const fieldName = this.childrenIndex.get(childName);\n            if (!fieldName) {\n                continue;\n            }\n            context.path = `${parentContext.path}.${fieldName}`;\n            const { translator, multiple, selector } = this.children.get(fieldName);\n            if (!selector || selector === typeValue) {\n                const childOutput = translator.import(child, context);\n                if (childOutput !== undefined) {\n                    if (multiple) {\n                        if (!output[fieldName]) {\n                            output[fieldName] = [];\n                        }\n                        output[fieldName].push(childOutput);\n                    }\n                    else if (!output[fieldName]) {\n                        output[fieldName] = childOutput;\n                    }\n                    else {\n                        output[fieldName] = translator.resolveCollision(output[fieldName], childOutput);\n                    }\n                }\n            }\n        }\n        for (const [fieldName] of postChildren) {\n            const importField = importer.fields.get(fieldName);\n            context.path = `${parentContext.path}.${fieldName}`;\n            const value = importField(xml, context);\n            if (value !== null && value !== undefined) {\n                output[fieldName] = value;\n            }\n        }\n        return output;\n    }\n    export(data, parentContext) {\n        if (!data) {\n            return;\n        }\n        let exportType = this.defaultType;\n        const path = parentContext.path || '';\n        let implied;\n        if (parentContext.pathSelector) {\n            implied = this.contexts.get(`${path}[${parentContext.pathSelector}]`);\n        }\n        if (!implied) {\n            implied = this.contexts.get(path);\n        }\n        if (implied) {\n            exportType = implied.impliedType || data[implied.typeField] || this.defaultType;\n        }\n        else if (this.typeField) {\n            exportType = data[this.typeField] || this.defaultType;\n        }\n        const exporter = this.exporters.get(exportType);\n        if (!exporter) {\n            return;\n        }\n        const output = createElement(exporter.namespace, exporter.element, parentContext.namespace, parentContext.element);\n        if (parentContext.element) {\n            output.parent = parentContext.element;\n        }\n        for (const [prefix, namespace] of exporter.optionalNamespaces) {\n            output.addOptionalNamespace(prefix, namespace);\n        }\n        const context = Object.assign(Object.assign({}, parentContext), { data, element: output, exporter, lang: (data[this.languageField] || parentContext.lang || '').toLowerCase(), namespace: output.getDefaultNamespace(), pathSelector: exportType, translator: this });\n        const langExporter = exporter.fields.get(this.languageField);\n        if (langExporter) {\n            langExporter(output, data[this.languageField], parentContext);\n        }\n        const keys = Object.keys(data);\n        keys.sort((key1, key2) => {\n            const a = exporter.fieldOrders.get(key1) || 100000;\n            const b = exporter.fieldOrders.get(key2) || 100000;\n            return a - b;\n        });\n        for (const key of keys) {\n            if (key === this.languageField) {\n                // We've already processed this field\n                continue;\n            }\n            const value = data[key];\n            const fieldExporter = exporter.fields.get(key);\n            if (fieldExporter) {\n                fieldExporter(output, value, context);\n                continue;\n            }\n            const childTranslator = this.children.get(key);\n            if (!childTranslator) {\n                continue;\n            }\n            context.path = `${parentContext.path ? parentContext.path + '.' : ''}${key}`;\n            const { translator, multiple, selector } = childTranslator;\n            if (!selector || selector === exportType) {\n                let items;\n                if (multiple) {\n                    items = value;\n                }\n                else {\n                    items = [value];\n                }\n                for (const item of items) {\n                    const childOutput = translator.export(item, context);\n                    if (childOutput) {\n                        output.appendChild(childOutput);\n                    }\n                }\n            }\n        }\n        return output;\n    }\n    resolveCollision(existingData, newData) {\n        const existingOrder = this.typeOrders.get(existingData[this.typeField] || this.defaultType) || 0;\n        const newOrder = this.typeOrders.get(newData[this.typeField] || this.defaultType) || 0;\n        return existingOrder <= newOrder ? existingData : newData;\n    }\n}\n\nclass Registry {\n    constructor() {\n        this.languageResolver = basicLanguageResolver;\n        this.translators = new Map();\n        this.root = new Translator();\n    }\n    setLanguageResolver(resolver) {\n        this.languageResolver = resolver;\n    }\n    import(xml, context = { registry: this }) {\n        if (!this.hasTranslator(xml.getNamespace(), xml.getName())) {\n            return;\n        }\n        if (!context.acceptLanguages) {\n            context.acceptLanguages = [];\n        }\n        else {\n            context.acceptLanguages = context.acceptLanguages.map(lang => lang.toLowerCase());\n        }\n        if (context.lang) {\n            context.lang = context.lang.toLowerCase();\n        }\n        if (!context.resolveLanguage) {\n            context.resolveLanguage = this.languageResolver;\n        }\n        context.path = this.getImportKey(xml);\n        if (!context.sanitizers) {\n            context.sanitizers = {\n                xhtmlim: sanitizeRoot\n            };\n        }\n        const translator = this.getOrCreateTranslator(xml.getNamespace(), xml.getName());\n        return translator.import(xml, Object.assign(Object.assign({}, context), { registry: this }));\n    }\n    export(path, data, context = { registry: this }) {\n        if (!context.acceptLanguages) {\n            context.acceptLanguages = [];\n        }\n        else {\n            context.acceptLanguages = context.acceptLanguages.map(lang => lang.toLowerCase());\n        }\n        if (context.lang) {\n            context.lang = context.lang.toLowerCase();\n        }\n        if (!context.sanitizers) {\n            context.sanitizers = {\n                xhtmlim: sanitizeRoot\n            };\n        }\n        context.path = path;\n        const fields = path.split('.').filter(item => {\n            return item !== '';\n        });\n        let translator = this.root;\n        for (const field of fields) {\n            const nextTranslator = translator.getChild(field);\n            if (!nextTranslator) {\n                return;\n            }\n            translator = nextTranslator;\n        }\n        return translator.export(data, Object.assign(Object.assign({}, context), { registry: this }));\n    }\n    getImportKey(xml, path = '') {\n        const root = !path ? this.root : this.walkToTranslator(path.split('.'));\n        if (!root) {\n            return undefined;\n        }\n        return root.getImportKey(xml);\n    }\n    define(defs) {\n        if (Array.isArray(defs)) {\n            for (const def of defs) {\n                if (typeof def === 'object') {\n                    this.define(def);\n                }\n                else {\n                    def(this);\n                }\n            }\n            return;\n        }\n        else if (typeof defs !== 'object') {\n            defs(this);\n            return;\n        }\n        const definition = defs;\n        definition.aliases = definition.aliases || [];\n        if (definition.path && !definition.aliases.includes(definition.path)) {\n            definition.aliases.push(definition.path);\n        }\n        const aliases = definition.aliases\n            .map(alias => {\n            if (typeof alias === 'string') {\n                return { path: alias };\n            }\n            else {\n                return alias;\n            }\n        })\n            .sort((a, b) => {\n            const aLen = a.path.split('.').length;\n            const bLen = b.path.split('.').length;\n            return bLen - aLen;\n        });\n        let translator;\n        if (this.hasTranslator(definition.namespace, definition.element)) {\n            // Get existing translator\n            translator = this.getOrCreateTranslator(definition.namespace, definition.element);\n        }\n        if (!translator) {\n            let placeholder;\n            for (const alias of aliases) {\n                const t = this.walkToTranslator(alias.path.split('.'));\n                if (t && !t.placeholder) {\n                    translator = t;\n                    break;\n                }\n                else if (t) {\n                    placeholder = t;\n                }\n            }\n            if (placeholder && !translator) {\n                translator = placeholder;\n                translator.placeholder = false;\n            }\n        }\n        if (!translator) {\n            // Create a new translator\n            translator = this.getOrCreateTranslator(definition.namespace, definition.element);\n        }\n        this.indexTranslator(definition.namespace, definition.element, translator);\n        const fields = definition.fields || {};\n        const importers = new Map();\n        const exporters = new Map();\n        const importerOrdering = new Map();\n        const exporterOrdering = new Map();\n        if (definition.typeField) {\n            translator.typeField = definition.typeField;\n        }\n        if (definition.defaultType) {\n            translator.defaultType = definition.defaultType;\n        }\n        if (definition.languageField) {\n            translator.languageField = definition.languageField;\n        }\n        for (const key of Object.keys(fields)) {\n            const field = fields[key];\n            importers.set(key, field.importer);\n            importerOrdering.set(key, field.importOrder || field.order || 0);\n            exporters.set(key, field.exporter);\n            exporterOrdering.set(key, field.exportOrder || field.order || 0);\n        }\n        if (definition.childrenExportOrder) {\n            for (const [key, order] of Object.entries(definition.childrenExportOrder)) {\n                exporterOrdering.set(key, order || 0);\n            }\n        }\n        const optionalNamespaces = new Map();\n        for (const [prefix, namespace] of Object.entries(definition.optionalNamespaces || {})) {\n            optionalNamespaces.set(prefix, namespace);\n        }\n        translator.updateDefinition({\n            contexts: new Map(),\n            element: definition.element,\n            exporterOrdering,\n            exporters,\n            importerOrdering,\n            importers,\n            namespace: definition.namespace,\n            optionalNamespaces,\n            type: definition.type,\n            typeOrder: definition.typeOrder\n        });\n        for (const link of aliases) {\n            if (typeof link === 'string') {\n                this.alias(definition.namespace, definition.element, link);\n            }\n            else {\n                this.alias(definition.namespace, definition.element, link.path, link.multiple, link.selector, link.contextField, definition.type, link.impliedType);\n            }\n        }\n        for (const alias of aliases) {\n            const existing = this.walkToTranslator(alias.path.split('.'));\n            if (existing && existing !== translator) {\n                existing.replaceWith(translator);\n            }\n        }\n    }\n    alias(namespace, element, path, multiple = false, selector, contextField, contextType, contextImpliedType = false) {\n        const linkedTranslator = this.getOrCreateTranslator(namespace, element);\n        linkedTranslator.placeholder = false;\n        const keys = path.split('.').filter(key => {\n            return key !== '';\n        });\n        const finalKey = keys.pop();\n        const translator = this.walkToTranslator(keys, true);\n        const xid = `{${namespace}}${element}`;\n        if (contextType && (contextField || contextImpliedType)) {\n            linkedTranslator.addContext(path, selector, contextField, xid, contextType, contextImpliedType);\n        }\n        translator.addChild(finalKey, linkedTranslator, multiple, selector, xid);\n    }\n    walkToTranslator(path, vivify = false) {\n        let translator = this.root;\n        for (const key of path) {\n            let next = translator.getChild(key);\n            if (!next) {\n                if (vivify) {\n                    next = new Translator();\n                    next.placeholder = true;\n                    translator.addChild(key, next);\n                }\n                else {\n                    return;\n                }\n            }\n            translator = next;\n        }\n        return translator;\n    }\n    hasTranslator(namespace, element) {\n        return this.translators.has(`{${namespace}}${element}`);\n    }\n    getOrCreateTranslator(namespace, element) {\n        let translator = this.translators.get(`{${namespace}}${element}`);\n        if (!translator) {\n            translator = new Translator();\n            this.indexTranslator(namespace, element, translator);\n        }\n        return translator;\n    }\n    indexTranslator(namespace, element, translator) {\n        this.translators.set(`{${namespace}}${element}`, translator);\n    }\n}\n\n// ================================================================\n// RFCS\n// ================================================================\n// RFC 6120\nconst NS_BIND = 'urn:ietf:params:xml:ns:xmpp-bind';\nconst NS_CLIENT = 'jabber:client';\nconst NS_SASL = 'urn:ietf:params:xml:ns:xmpp-sasl';\nconst NS_SERVER = 'jabber:server';\nconst NS_SESSION = 'urn:ietf:params:xml:ns:xmpp-session';\nconst NS_STANZAS = 'urn:ietf:params:xml:ns:xmpp-stanzas';\nconst NS_STREAM = 'http://etherx.jabber.org/streams';\nconst NS_STREAMS = 'urn:ietf:params:xml:ns:xmpp-streams';\nconst NS_STARTTLS = 'urn:ietf:params:xml:ns:xmpp-tls';\n// RFC 6121\nconst NS_ROSTER = 'jabber:iq:roster';\nconst NS_ROSTER_VERSIONING = 'urn:xmpp:features:rosterver';\nconst NS_SUBSCRIPTION_PREAPPROVAL = 'urn:xmpp:features:pre-approval';\n// RFC 7395\nconst NS_FRAMING = 'urn:ietf:params:xml:ns:xmpp-framing';\n// ================================================================\n// XEPS\n// ================================================================\n// XEP-0004\nconst NS_DATAFORM = 'jabber:x:data';\n// XEP-0009\nconst NS_RPC = 'jabber:iq:rpc';\n// XEP-0012\nconst NS_LAST_ACTIVITY = 'jabber:iq:last';\n// XEP-0016\nconst NS_PRIVACY = 'jabber:iq:privacy';\n// XEP-0022\nconst NS_LEGACY_CHAT_EVENTS = 'jabber:x:event';\n// XEP-0030\nconst NS_DISCO_INFO = 'http://jabber.org/protocol/disco#info';\nconst NS_DISCO_ITEMS = 'http://jabber.org/protocol/disco#items';\n// XEP-0033\nconst NS_ADDRESS = 'http://jabber.org/protocol/address';\n// XEP-0045\nconst NS_MUC = 'http://jabber.org/protocol/muc';\nconst NS_MUC_ADMIN = 'http://jabber.org/protocol/muc#admin';\nconst NS_MUC_OWNER = 'http://jabber.org/protocol/muc#owner';\nconst NS_MUC_USER = 'http://jabber.org/protocol/muc#user';\n// XEP-0047\nconst NS_IBB = 'http://jabber.org/protocol/ibb';\n// XEP-0048\nconst NS_BOOKMARKS = 'storage:bookmarks';\n// XEP-0049\nconst NS_PRIVATE = 'jabber:iq:private';\n// XEP-0050\nconst NS_ADHOC_COMMANDS = 'http://jabber.org/protocol/commands';\n// XEP-0054\nconst NS_VCARD_TEMP = 'vcard-temp';\n// XEP-0055\nconst NS_SEARCH = 'jabber:iq:search';\n// XEP-0059\nconst NS_RSM = 'http://jabber.org/protocol/rsm';\n// XEP-0060\nconst NS_PUBSUB = 'http://jabber.org/protocol/pubsub';\nconst NS_PUBSUB_ERRORS = 'http://jabber.org/protocol/pubsub#errors';\nconst NS_PUBSUB_EVENT = 'http://jabber.org/protocol/pubsub#event';\nconst NS_PUBSUB_OWNER = 'http://jabber.org/protocol/pubsub#owner';\n// XEP-0065\nconst NS_SOCKS5 = 'http://jabber.org/protocol/bytestreams';\n// XEP-0066\nconst NS_OOB = 'jabber:x:oob';\nconst NS_OOB_TRANSFER = 'jabber:iq:oob';\n// XEP-0070\nconst NS_HTTP_AUTH = 'http://jabber.org/protocol/http-auth';\n// XEP-0071\nconst NS_XHTML = 'http://www.w3.org/1999/xhtml';\nconst NS_XHTML_IM = 'http://jabber.org/protocol/xhtml-im';\n// XEP-0077\nconst NS_REGISTER = 'jabber:iq:register';\nconst NS_INBAND_REGISTRATION = 'http://jabber.org/features/iq-register';\n// XEP-0079\nconst NS_AMP = 'http://jabber.org/protocol/amp';\n// XEP-0080\nconst NS_GEOLOC = 'http://jabber.org/protocol/geoloc';\n// XEP-0083\nconst NS_ROSTER_DELIMITER = 'roster:delimiter';\n// XEP-0084\nconst NS_AVATAR_DATA = 'urn:xmpp:avatar:data';\nconst NS_AVATAR_METADATA = 'urn:xmpp:avatar:metadata';\n// XEP-0085\nconst NS_CHAT_STATES = 'http://jabber.org/protocol/chatstates';\n// XEP-0092\nconst NS_VERSION = 'jabber:iq:version';\n// XEP-0107\nconst NS_MOOD = 'http://jabber.org/protocol/mood';\n// XEP-0108\nconst NS_ACTIVITY = 'http://jabber.org/protocol/activity';\n// XEP-0114\nconst NS_COMPONENT = 'jabber:component:accept';\n// XEP-0115\nconst NS_DISCO_LEGACY_CAPS = 'http://jabber.org/protocol/caps';\n// XEP-0118\nconst NS_TUNE = 'http://jabber.org/protocol/tune';\n// XEP-0122\nconst NS_DATAFORM_VALIDATION = 'http://jabber.org/protocol/xdata-validate';\n// XEP-0124\nconst NS_BOSH = 'http://jabber.org/protocol/httpbind';\n// XEP-0131\nconst NS_SHIM = 'http://jabber.org/protocol/shim';\n// XEP-0138\nconst NS_COMPRESSION_FEATURE = 'http://jabber.org/features/compress';\nconst NS_COMPRESSION = 'http://jabber.org/protocol/compress';\n// XEP-0141\nconst NS_DATAFORM_LAYOUT = 'http://jabber.org/protocol/xdata-layout';\n// XEP-0144\nconst NS_ROSTER_EXCHANGE = 'http://jabber.org/protocol/rosterx';\n// XEP-0145\nconst NS_ROSTER_NOTES = 'storage:rosternotes';\n// XEP-0152\nconst NS_REACH_0 = 'urn:xmpp:reach:0';\n// XEP-0153\nconst NS_VCARD_TEMP_UPDATE = 'vcard-temp:x:update';\n// XEP-0156\nconst NS_ALT_CONNECTIONS_WEBSOCKET = 'urn:xmpp:alt-connections:websocket';\nconst NS_ALT_CONNECTIONS_XBOSH = 'urn:xmpp:alt-connections:xbosh';\n// XEP-0158\nconst NS_CAPTCHA = 'urn:xmpp:captcha';\n// XEP-0163\nconst NS_PEP_NOTIFY = (ns) => `${ns}+notify`;\n// XEP-0166\nconst NS_JINGLE_1 = 'urn:xmpp:jingle:1';\nconst NS_JINGLE_ERRORS_1 = 'urn:xmpp:jingle:errors:1';\n// XEP-0167\nconst NS_JINGLE_RTP_1 = 'urn:xmpp:jingle:apps:rtp:1';\nconst NS_JINGLE_RTP_ERRORS_1 = 'urn:xmpp:jingle:apps:rtp:errors:1';\nconst NS_JINGLE_RTP_INFO_1 = 'urn:xmpp:jingle:apps:rtp:info:1';\nconst NS_JINGLE_RTP_AUDIO = 'urn:xmpp:jingle:apps:rtp:audio';\nconst NS_JINGLE_RTP_VIDEO = 'urn:xmpp:jingle:apps:rtp:video';\n// XEP-0171\nconst NS_LANG_TRANS = 'urn:xmpp:langtrans';\nconst NS_LANG_TRANS_ITEMS = 'urn:xmpp:langtrans:items';\n// XEP-0172\nconst NS_NICK = 'http://jabber.org/protocol/nick';\n// XEP-0176\nconst NS_JINGLE_ICE_UDP_1 = 'urn:xmpp:jingle:transports:ice-udp:1';\n// XEP-0177\nconst NS_JINGLE_RAW_UDP_1 = 'urn:xmpp:jingle:transports:raw-udp:1';\n// XEP-0184\nconst NS_RECEIPTS = 'urn:xmpp:receipts';\n// XEP-0186\nconst NS_INVISIBLE_0 = 'urn:xmpp:invisible:0';\n// XEP-0191\nconst NS_BLOCKING = 'urn:xmpp:blocking';\nconst NS_BLOCKING_ERRORS = 'urn:xmpp:blocking:errors';\n// XEP-0198\nconst NS_SMACKS_3 = 'urn:xmpp:sm:3';\n// XEP-0199\nconst NS_PING = 'urn:xmpp:ping';\n// XEP-0202\nconst NS_TIME = 'urn:xmpp:time';\n// XEP-0203\nconst NS_DELAY = 'urn:xmpp:delay';\n// XEP-0206\nconst NS_BOSH_XMPP = 'urn:xmpp:xbosh';\n// XEP-0215\nconst NS_DISCO_EXTERNAL_1 = 'urn:xmpp:extdisco:1';\n// XEP-0221\nconst NS_DATAFORM_MEDIA = 'urn:xmpp:media-element';\n// XEP-0224\nconst NS_ATTENTION_0 = 'urn:xmpp:attention:0';\n// XEP-0231\nconst NS_BOB = 'urn:xmpp:bob';\n// XEP-0232\nconst NS_SOFTWARE_INFO = 'urn:xmpp:dataforms:softwareinfo';\n// XEP-0234\nconst NS_JINGLE_FILE_TRANSFER_3 = 'urn:xmpp:jingle:apps:file-transfer:3';\nconst NS_JINGLE_FILE_TRANSFER_4 = 'urn:xmpp:jingle:apps:file-transfer:4';\nconst NS_JINGLE_FILE_TRANSFER_5 = 'urn:xmpp:jingle:apps:file-transfer:5';\n// XEP-0247\nconst NS_JINGLE_XML_0 = 'urn:xmpp:jingle:apps:xmlstream:0';\n// XEP-0249\nconst NS_MUC_DIRECT_INVITE = 'jabber:x:conference';\n// XEP-0258\nconst NS_SEC_LABEL_0 = 'urn:xmpp:sec-label:0';\nconst NS_SEC_LABEL_CATALOG_2 = 'urn:xmpp:sec-label:catalog:2';\nconst NS_SEC_LABEL_ESS_0 = 'urn:xmpp:sec-label:ess:0';\n// XEP-0260\nconst NS_JINGLE_SOCKS5_1 = 'urn:xmpp:jingle:transports:s5b:1';\n// XEP-0261\nconst NS_JINGLE_IBB_1 = 'urn:xmpp:jingle:transports:ibb:1';\n// XEP-0262\nconst NS_JINGLE_RTP_ZRTP_1 = 'urn:xmpp:jingle:apps:rtp:zrtp:1';\n// XEP-0264\nconst NS_THUMBS_0 = 'urn:xmpp:thumbs:0';\nconst NS_THUMBS_1 = 'urn:xmpp:thumbs:1';\n// XEP-0276\nconst NS_DECLOAKING_0 = 'urn:xmpp:decloaking:0';\n// XEP-0280\nconst NS_CARBONS_2 = 'urn:xmpp:carbons:2';\n// XEP-0293\nconst NS_JINGLE_RTP_RTCP_FB_0 = 'urn:xmpp:jingle:apps:rtp:rtcp-fb:0';\n// XEP-0294\nconst NS_JINGLE_RTP_HDREXT_0 = 'urn:xmpp:jingle:apps:rtp:rtp-hdrext:0';\n// XEP-0297\nconst NS_FORWARD_0 = 'urn:xmpp:forward:0';\n// XEP-0300\nconst NS_HASHES_1 = 'urn:xmpp:hashes:1';\nconst NS_HASHES_2 = 'urn:xmpp:hashes:2';\nconst NS_HASH_NAME = (name) => `urn:xmpp:hash-function-text-names:${name}`;\n// XEP-0301\nconst NS_RTT_0 = 'urn:xmpp:rtt:0';\n// XEP-0307\nconst NS_MUC_UNIQUE = 'http://jabber.org/protocol/muc#unique';\n// XEP-308\nconst NS_CORRECTION_0 = 'urn:xmpp:message-correct:0';\n// XEP-0310\nconst NS_PSA = 'urn:xmpp:psa';\n// XEP-0313\nconst NS_MAM_TMP = 'urn:xmpp:mam:tmp';\nconst NS_MAM_0 = 'urn:xmpp:mam:0';\nconst NS_MAM_1 = 'urn:xmpp:mam:1';\nconst NS_MAM_2 = 'urn:xmpp:mam:2';\n// XEP-0317\nconst NS_HATS_0 = 'urn:xmpp:hats:0';\n// XEP-0319\nconst NS_IDLE_1 = 'urn:xmpp:idle:1';\n// XEP-0320\nconst NS_JINGLE_DTLS_0 = 'urn:xmpp:jingle:apps:dtls:0';\n// XEP-0333\nconst NS_CHAT_MARKERS_0 = 'urn:xmpp:chat-markers:0';\n// XEP-0334\nconst NS_HINTS = 'urn:xmpp:hints';\n// XEP-0335\nconst NS_JSON_0 = 'urn:xmpp:json:0';\n// XEP-0338\nconst NS_JINGLE_GROUPING_0 = 'urn:xmpp:jingle:apps:grouping:0';\n// XEP-0339\nconst NS_JINGLE_RTP_SSMA_0 = 'urn:xmpp:jingle:apps:rtp:ssma:0';\n// XEP-0343\nconst NS_JINGLE_DTLS_SCTP_1 = 'urn:xmpp:jingle:transports:dtls-sctp:1';\n// XEP-0352\nconst NS_CSI_0 = 'urn:xmpp:csi:0';\n// XEP-0353\nconst NS_JINGLE_MSG_INITIATE_0 = 'urn:xmpp:jingle:jingle-message:0';\n// XEP-0355\nconst NS_DELEGATION_1 = 'urn:xmpp:delegation:1';\n// XEP-0357\nconst NS_PUSH_0 = 'urn:xmpp:push:0';\n// XEP-0358\nconst NS_JINGLE_PUB_1 = 'urn:xmpp:jinglepub:1';\n// XEP-0359\nconst NS_SID_0 = 'urn:xmpp:sid:0';\n// XEP-0363\nconst NS_HTTP_UPLOAD_0 = 'urn:xmpp:http:upload:0';\n// XEP-0370\nconst NS_JINGLE_HTTP_0 = 'urn:xmpp:jingle:transports:http:0';\nconst NS_JINGLE_HTTP_UPLOAD_0 = 'urn:xmpp:jingle:transports:http:upload:0';\n// XEP-0371\nconst NS_JINGLE_ICE_0 = 'urn:xmpp:jingle:transports:ice:0';\n// XEP-0372\nconst NS_REFERENCE_0 = 'urn:xmpp:reference:0';\n// XEP-0380\nconst NS_EME_0 = 'urn:xmpp:eme:0';\n// XEP-0382\nconst NS_SPOILER_0 = 'urn:xmppp:spoiler:0';\n// XEP-0384\nconst NS_OMEMO_AXOLOTL = 'eu.siacs.conversations.axolotl';\nconst NS_OMEMO_AXOLOTL_DEVICELIST = 'eu.siacs.conversations.axolotl.devicelist';\nconst NS_OMEMO_AXOLOTL_BUNDLES = 'eu.siacs.conversations.axolotl.bundles';\nconst NS_OMEMO_AXOLOTL_BUNDLE = (deviceId) => `${NS_OMEMO_AXOLOTL_BUNDLES}:${deviceId}`;\n// ================================================================\n// Other Standards\n// ================================================================\n// Extensible Resource Descriptor (XRD) Version 1.0\n// http://docs.oasis-open.org/xri/xrd/v1.0/xrd-1.0.html\nconst NS_XRD = 'http://docs.oasis-open.org/ns/xri/xrd-1.0';\n// ====================================================================\n// Not yet standardized\n// ====================================================================\nconst NS_JINGLE_RTP_MSID_0 = 'urn:xmpp:jingle:apps:rtp:msid:0';\n\nvar Namespaces = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    NS_BIND: NS_BIND,\n    NS_CLIENT: NS_CLIENT,\n    NS_SASL: NS_SASL,\n    NS_SERVER: NS_SERVER,\n    NS_SESSION: NS_SESSION,\n    NS_STANZAS: NS_STANZAS,\n    NS_STREAM: NS_STREAM,\n    NS_STREAMS: NS_STREAMS,\n    NS_STARTTLS: NS_STARTTLS,\n    NS_ROSTER: NS_ROSTER,\n    NS_ROSTER_VERSIONING: NS_ROSTER_VERSIONING,\n    NS_SUBSCRIPTION_PREAPPROVAL: NS_SUBSCRIPTION_PREAPPROVAL,\n    NS_FRAMING: NS_FRAMING,\n    NS_DATAFORM: NS_DATAFORM,\n    NS_RPC: NS_RPC,\n    NS_LAST_ACTIVITY: NS_LAST_ACTIVITY,\n    NS_PRIVACY: NS_PRIVACY,\n    NS_LEGACY_CHAT_EVENTS: NS_LEGACY_CHAT_EVENTS,\n    NS_DISCO_INFO: NS_DISCO_INFO,\n    NS_DISCO_ITEMS: NS_DISCO_ITEMS,\n    NS_ADDRESS: NS_ADDRESS,\n    NS_MUC: NS_MUC,\n    NS_MUC_ADMIN: NS_MUC_ADMIN,\n    NS_MUC_OWNER: NS_MUC_OWNER,\n    NS_MUC_USER: NS_MUC_USER,\n    NS_IBB: NS_IBB,\n    NS_BOOKMARKS: NS_BOOKMARKS,\n    NS_PRIVATE: NS_PRIVATE,\n    NS_ADHOC_COMMANDS: NS_ADHOC_COMMANDS,\n    NS_VCARD_TEMP: NS_VCARD_TEMP,\n    NS_SEARCH: NS_SEARCH,\n    NS_RSM: NS_RSM,\n    NS_PUBSUB: NS_PUBSUB,\n    NS_PUBSUB_ERRORS: NS_PUBSUB_ERRORS,\n    NS_PUBSUB_EVENT: NS_PUBSUB_EVENT,\n    NS_PUBSUB_OWNER: NS_PUBSUB_OWNER,\n    NS_SOCKS5: NS_SOCKS5,\n    NS_OOB: NS_OOB,\n    NS_OOB_TRANSFER: NS_OOB_TRANSFER,\n    NS_HTTP_AUTH: NS_HTTP_AUTH,\n    NS_XHTML: NS_XHTML,\n    NS_XHTML_IM: NS_XHTML_IM,\n    NS_REGISTER: NS_REGISTER,\n    NS_INBAND_REGISTRATION: NS_INBAND_REGISTRATION,\n    NS_AMP: NS_AMP,\n    NS_GEOLOC: NS_GEOLOC,\n    NS_ROSTER_DELIMITER: NS_ROSTER_DELIMITER,\n    NS_AVATAR_DATA: NS_AVATAR_DATA,\n    NS_AVATAR_METADATA: NS_AVATAR_METADATA,\n    NS_CHAT_STATES: NS_CHAT_STATES,\n    NS_VERSION: NS_VERSION,\n    NS_MOOD: NS_MOOD,\n    NS_ACTIVITY: NS_ACTIVITY,\n    NS_COMPONENT: NS_COMPONENT,\n    NS_DISCO_LEGACY_CAPS: NS_DISCO_LEGACY_CAPS,\n    NS_TUNE: NS_TUNE,\n    NS_DATAFORM_VALIDATION: NS_DATAFORM_VALIDATION,\n    NS_BOSH: NS_BOSH,\n    NS_SHIM: NS_SHIM,\n    NS_COMPRESSION_FEATURE: NS_COMPRESSION_FEATURE,\n    NS_COMPRESSION: NS_COMPRESSION,\n    NS_DATAFORM_LAYOUT: NS_DATAFORM_LAYOUT,\n    NS_ROSTER_EXCHANGE: NS_ROSTER_EXCHANGE,\n    NS_ROSTER_NOTES: NS_ROSTER_NOTES,\n    NS_REACH_0: NS_REACH_0,\n    NS_VCARD_TEMP_UPDATE: NS_VCARD_TEMP_UPDATE,\n    NS_ALT_CONNECTIONS_WEBSOCKET: NS_ALT_CONNECTIONS_WEBSOCKET,\n    NS_ALT_CONNECTIONS_XBOSH: NS_ALT_CONNECTIONS_XBOSH,\n    NS_CAPTCHA: NS_CAPTCHA,\n    NS_PEP_NOTIFY: NS_PEP_NOTIFY,\n    NS_JINGLE_1: NS_JINGLE_1,\n    NS_JINGLE_ERRORS_1: NS_JINGLE_ERRORS_1,\n    NS_JINGLE_RTP_1: NS_JINGLE_RTP_1,\n    NS_JINGLE_RTP_ERRORS_1: NS_JINGLE_RTP_ERRORS_1,\n    NS_JINGLE_RTP_INFO_1: NS_JINGLE_RTP_INFO_1,\n    NS_JINGLE_RTP_AUDIO: NS_JINGLE_RTP_AUDIO,\n    NS_JINGLE_RTP_VIDEO: NS_JINGLE_RTP_VIDEO,\n    NS_LANG_TRANS: NS_LANG_TRANS,\n    NS_LANG_TRANS_ITEMS: NS_LANG_TRANS_ITEMS,\n    NS_NICK: NS_NICK,\n    NS_JINGLE_ICE_UDP_1: NS_JINGLE_ICE_UDP_1,\n    NS_JINGLE_RAW_UDP_1: NS_JINGLE_RAW_UDP_1,\n    NS_RECEIPTS: NS_RECEIPTS,\n    NS_INVISIBLE_0: NS_INVISIBLE_0,\n    NS_BLOCKING: NS_BLOCKING,\n    NS_BLOCKING_ERRORS: NS_BLOCKING_ERRORS,\n    NS_SMACKS_3: NS_SMACKS_3,\n    NS_PING: NS_PING,\n    NS_TIME: NS_TIME,\n    NS_DELAY: NS_DELAY,\n    NS_BOSH_XMPP: NS_BOSH_XMPP,\n    NS_DISCO_EXTERNAL_1: NS_DISCO_EXTERNAL_1,\n    NS_DATAFORM_MEDIA: NS_DATAFORM_MEDIA,\n    NS_ATTENTION_0: NS_ATTENTION_0,\n    NS_BOB: NS_BOB,\n    NS_SOFTWARE_INFO: NS_SOFTWARE_INFO,\n    NS_JINGLE_FILE_TRANSFER_3: NS_JINGLE_FILE_TRANSFER_3,\n    NS_JINGLE_FILE_TRANSFER_4: NS_JINGLE_FILE_TRANSFER_4,\n    NS_JINGLE_FILE_TRANSFER_5: NS_JINGLE_FILE_TRANSFER_5,\n    NS_JINGLE_XML_0: NS_JINGLE_XML_0,\n    NS_MUC_DIRECT_INVITE: NS_MUC_DIRECT_INVITE,\n    NS_SEC_LABEL_0: NS_SEC_LABEL_0,\n    NS_SEC_LABEL_CATALOG_2: NS_SEC_LABEL_CATALOG_2,\n    NS_SEC_LABEL_ESS_0: NS_SEC_LABEL_ESS_0,\n    NS_JINGLE_SOCKS5_1: NS_JINGLE_SOCKS5_1,\n    NS_JINGLE_IBB_1: NS_JINGLE_IBB_1,\n    NS_JINGLE_RTP_ZRTP_1: NS_JINGLE_RTP_ZRTP_1,\n    NS_THUMBS_0: NS_THUMBS_0,\n    NS_THUMBS_1: NS_THUMBS_1,\n    NS_DECLOAKING_0: NS_DECLOAKING_0,\n    NS_CARBONS_2: NS_CARBONS_2,\n    NS_JINGLE_RTP_RTCP_FB_0: NS_JINGLE_RTP_RTCP_FB_0,\n    NS_JINGLE_RTP_HDREXT_0: NS_JINGLE_RTP_HDREXT_0,\n    NS_FORWARD_0: NS_FORWARD_0,\n    NS_HASHES_1: NS_HASHES_1,\n    NS_HASHES_2: NS_HASHES_2,\n    NS_HASH_NAME: NS_HASH_NAME,\n    NS_RTT_0: NS_RTT_0,\n    NS_MUC_UNIQUE: NS_MUC_UNIQUE,\n    NS_CORRECTION_0: NS_CORRECTION_0,\n    NS_PSA: NS_PSA,\n    NS_MAM_TMP: NS_MAM_TMP,\n    NS_MAM_0: NS_MAM_0,\n    NS_MAM_1: NS_MAM_1,\n    NS_MAM_2: NS_MAM_2,\n    NS_HATS_0: NS_HATS_0,\n    NS_IDLE_1: NS_IDLE_1,\n    NS_JINGLE_DTLS_0: NS_JINGLE_DTLS_0,\n    NS_CHAT_MARKERS_0: NS_CHAT_MARKERS_0,\n    NS_HINTS: NS_HINTS,\n    NS_JSON_0: NS_JSON_0,\n    NS_JINGLE_GROUPING_0: NS_JINGLE_GROUPING_0,\n    NS_JINGLE_RTP_SSMA_0: NS_JINGLE_RTP_SSMA_0,\n    NS_JINGLE_DTLS_SCTP_1: NS_JINGLE_DTLS_SCTP_1,\n    NS_CSI_0: NS_CSI_0,\n    NS_JINGLE_MSG_INITIATE_0: NS_JINGLE_MSG_INITIATE_0,\n    NS_DELEGATION_1: NS_DELEGATION_1,\n    NS_PUSH_0: NS_PUSH_0,\n    NS_JINGLE_PUB_1: NS_JINGLE_PUB_1,\n    NS_SID_0: NS_SID_0,\n    NS_HTTP_UPLOAD_0: NS_HTTP_UPLOAD_0,\n    NS_JINGLE_HTTP_0: NS_JINGLE_HTTP_0,\n    NS_JINGLE_HTTP_UPLOAD_0: NS_JINGLE_HTTP_UPLOAD_0,\n    NS_JINGLE_ICE_0: NS_JINGLE_ICE_0,\n    NS_REFERENCE_0: NS_REFERENCE_0,\n    NS_EME_0: NS_EME_0,\n    NS_SPOILER_0: NS_SPOILER_0,\n    NS_OMEMO_AXOLOTL: NS_OMEMO_AXOLOTL,\n    NS_OMEMO_AXOLOTL_DEVICELIST: NS_OMEMO_AXOLOTL_DEVICELIST,\n    NS_OMEMO_AXOLOTL_BUNDLES: NS_OMEMO_AXOLOTL_BUNDLES,\n    NS_OMEMO_AXOLOTL_BUNDLE: NS_OMEMO_AXOLOTL_BUNDLE,\n    NS_XRD: NS_XRD,\n    NS_JINGLE_RTP_MSID_0: NS_JINGLE_RTP_MSID_0\n});\n\n// ====================================================================\n// Useful XMPP Aliases\n// ====================================================================\nconst JIDAttribute = attribute;\nconst childJIDAttribute = childAttribute;\nconst childJID = childText;\n// ====================================================================\n// XMPP Definition Shortcuts\n// ====================================================================\nfunction addAlias(namespace, element, aliases) {\n    return {\n        aliases: Array.isArray(aliases) ? aliases : [aliases],\n        element,\n        fields: {},\n        namespace\n    };\n}\nfunction extendMessage(fields) {\n    return { element: 'message', fields, namespace: NS_CLIENT };\n}\nfunction extendPresence(fields) {\n    return { element: 'presence', fields, namespace: NS_CLIENT };\n}\nfunction extendIQ(fields) {\n    return { element: 'iq', fields, namespace: NS_CLIENT };\n}\nfunction extendStreamFeatures(fields) {\n    return {\n        element: 'features',\n        fields,\n        namespace: NS_STREAM\n    };\n}\nfunction extendStanzaError(fields) {\n    return {\n        element: 'error',\n        fields,\n        namespace: NS_STANZAS,\n        path: 'stanzaError'\n    };\n}\nfunction pubsubItemContentAliases(impliedType) {\n    return [\n        { path: 'pubsubcontent', contextField: 'itemType' },\n        { path: 'pubsubitem.content', contextField: 'itemType' },\n        { path: 'pubsubeventitem.content', contextField: 'itemType' },\n        { path: 'iq.pubsub.publish.items', contextField: 'itemType' }\n    ];\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from: ltx, Copyright  2010 Stephan Maka\n */\nclass StreamParser extends Transform {\n    constructor(opts) {\n        super({ objectMode: true });\n        this.closedStream = false;\n        this.wrappedStream = false;\n        this.registry = opts.registry;\n        this.acceptLanguages = opts.acceptLanguages || [];\n        if (opts.wrappedStream) {\n            this.wrappedStream = true;\n            this.rootImportKey = opts.rootKey;\n        }\n        this.parser = new Parser({\n            allowComments: opts.allowComments\n        });\n        this.parser.on('error', err => {\n            this.destroy(err);\n        });\n        this.parser.on('startElement', (name, attributes) => {\n            if (this.destroyed) {\n                return;\n            }\n            if (this.closedStream) {\n                return this.destroy(JXTError.alreadyClosed());\n            }\n            const el = new XMLElement(name, attributes);\n            const key = this.registry.getImportKey(el);\n            if (this.wrappedStream && !this.rootElement) {\n                if (this.rootImportKey && key !== this.rootImportKey) {\n                    return this.destroy(JXTError.unknownRoot());\n                }\n                const root = this.registry.import(el, {\n                    acceptLanguages: this.acceptLanguages,\n                    lang: this.lang\n                });\n                if (root) {\n                    this.rootElement = el;\n                    this.push({\n                        event: 'stream-start',\n                        kind: key,\n                        stanza: root,\n                        xml: el\n                    });\n                    return;\n                }\n                else {\n                    return this.destroy(JXTError.notWellFormed());\n                }\n            }\n            if (!this.currentElement) {\n                this.currentElement = el;\n            }\n            else {\n                this.currentElement = this.currentElement.appendChild(el);\n            }\n        });\n        this.parser.on('endElement', (name) => {\n            if (this.destroyed) {\n                return;\n            }\n            if (this.wrappedStream && !this.currentElement) {\n                if (!this.rootElement || name !== this.rootElement.name) {\n                    this.closedStream = true;\n                    return this.destroy(JXTError.notWellFormed());\n                }\n                this.closedStream = true;\n                this.push({\n                    event: 'stream-end',\n                    kind: this.rootImportKey,\n                    stanza: {},\n                    xml: this.rootElement\n                });\n                return this.end();\n            }\n            if (!this.currentElement || name !== this.currentElement.name) {\n                this.closedStream = true;\n                return this.destroy(JXTError.notWellFormed());\n            }\n            if (this.currentElement.parent) {\n                this.currentElement = this.currentElement.parent;\n            }\n            else {\n                if (this.wrappedStream) {\n                    this.currentElement.parent = this.rootElement;\n                }\n                const key = this.registry.getImportKey(this.currentElement);\n                const stanza = this.registry.import(this.currentElement, {\n                    acceptLanguages: this.acceptLanguages,\n                    lang: this.lang\n                });\n                if (stanza) {\n                    this.push({\n                        kind: key,\n                        stanza,\n                        xml: this.currentElement\n                    });\n                }\n                this.currentElement = undefined;\n            }\n        });\n        this.parser.on('text', (text) => {\n            if (this.currentElement) {\n                this.currentElement.children.push(text);\n            }\n        });\n    }\n    _transform(chunk, encoding, done) {\n        this.parser.write(chunk.toString());\n        done();\n    }\n}\n\nfunction define(definitions) {\n    return (registry) => {\n        registry.define(definitions);\n    };\n}\n\nvar index = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    Registry: Registry,\n    Translator: Translator,\n    XMLElement: XMLElement,\n    define: define,\n    Parser: Parser,\n    parse: parse$1,\n    StreamParser: StreamParser,\n    escapeXML: escapeXML,\n    unescapeXML: unescapeXML,\n    escapeXMLText: escapeXMLText,\n    basicLanguageResolver: basicLanguageResolver,\n    createElement: createElement,\n    getLang: getLang,\n    getTargetLang: getTargetLang,\n    findAll: findAll,\n    findOrCreate: findOrCreate,\n    attribute: attribute,\n    booleanAttribute: booleanAttribute,\n    integerAttribute: integerAttribute,\n    floatAttribute: floatAttribute,\n    dateAttribute: dateAttribute,\n    namespacedAttribute: namespacedAttribute,\n    namespacedBooleanAttribute: namespacedBooleanAttribute,\n    namespacedIntegerAttribute: namespacedIntegerAttribute,\n    namespacedFloatAttribute: namespacedFloatAttribute,\n    namespacedDateAttribute: namespacedDateAttribute,\n    childAttribute: childAttribute,\n    childBooleanAttribute: childBooleanAttribute,\n    childIntegerAttribute: childIntegerAttribute,\n    childFloatAttribute: childFloatAttribute,\n    childDateAttribute: childDateAttribute,\n    text: text,\n    textJSON: textJSON,\n    textBuffer: textBuffer,\n    languageAttribute: languageAttribute,\n    childLanguageAttribute: childLanguageAttribute,\n    childText: childText,\n    childTextBuffer: childTextBuffer,\n    childDate: childDate,\n    childInteger: childInteger,\n    childFloat: childFloat,\n    childJSON: childJSON,\n    childTimezoneOffset: childTimezoneOffset,\n    childBoolean: childBoolean,\n    deepChildText: deepChildText,\n    deepChildInteger: deepChildInteger,\n    deepChildBoolean: deepChildBoolean,\n    childEnum: childEnum,\n    childDoubleEnum: childDoubleEnum,\n    multipleChildText: multipleChildText,\n    multipleChildAttribute: multipleChildAttribute,\n    multipleChildIntegerAttribute: multipleChildIntegerAttribute,\n    childAlternateLanguageText: childAlternateLanguageText,\n    multipleChildAlternateLanguageText: multipleChildAlternateLanguageText,\n    multipleChildEnum: multipleChildEnum,\n    splicePath: splicePath,\n    staticValue: staticValue,\n    childRawElement: childRawElement,\n    childLanguageRawElement: childLanguageRawElement,\n    childAlternateLanguageRawElement: childAlternateLanguageRawElement,\n    parameterMap: parameterMap,\n    JIDAttribute: JIDAttribute,\n    childJIDAttribute: childJIDAttribute,\n    childJID: childJID,\n    addAlias: addAlias,\n    extendMessage: extendMessage,\n    extendPresence: extendPresence,\n    extendIQ: extendIQ,\n    extendStreamFeatures: extendStreamFeatures,\n    extendStanzaError: extendStanzaError,\n    pubsubItemContentAliases: pubsubItemContentAliases\n});\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - create-hash, Copyright (c) 2017 crypto-browserify contributors\n */\nclass Hash extends Transform {\n    constructor(blockSize, finalSize, endian = 'be') {\n        super();\n        this._block = Buffer.alloc(blockSize);\n        this._finalSize = finalSize;\n        this._blockSize = blockSize;\n        this._bigEndian = endian === 'be';\n        this._len = 0;\n    }\n    _transform(chunk, encoding, callback) {\n        let error = null;\n        try {\n            this.update(chunk, encoding);\n        }\n        catch (err) {\n            error = err;\n        }\n        callback(error);\n    }\n    _flush(callback) {\n        let error = null;\n        try {\n            this.push(this.digest());\n        }\n        catch (err) {\n            error = err;\n        }\n        callback(error);\n    }\n    update(data, enc) {\n        if (typeof data === 'string') {\n            enc = enc || 'utf8';\n            data = Buffer.from(data, enc);\n        }\n        const block = this._block;\n        const blockSize = this._blockSize;\n        const length = data.length;\n        let accum = this._len;\n        for (let offset = 0; offset < length;) {\n            const assigned = accum % blockSize;\n            const remainder = Math.min(length - offset, blockSize - assigned);\n            for (let i = 0; i < remainder; i++) {\n                block[assigned + i] = data[offset + i];\n            }\n            accum += remainder;\n            offset += remainder;\n            if (accum % blockSize === 0) {\n                this._update(block);\n            }\n        }\n        this._len += length;\n        return this;\n    }\n    digest(enc) {\n        const rem = this._len % this._blockSize;\n        this._block[rem] = 0x80;\n        // zero (rem + 1) trailing bits, where (rem + 1) is the smallest\n        // non-negative solution to the equation (length + 1 + (rem + 1)) === finalSize mod blockSize\n        this._block.fill(0, rem + 1);\n        if (rem >= this._finalSize) {\n            this._update(this._block);\n            this._block.fill(0);\n        }\n        const bits = this._len * 8;\n        if (bits <= 0xffffffff) {\n            if (this._bigEndian) {\n                this._block.writeUInt32BE(0, this._blockSize - 8);\n                this._block.writeUInt32BE(bits, this._blockSize - 4);\n            }\n            else {\n                this._block.writeUInt32LE(bits, this._blockSize - 8);\n                this._block.writeUInt32LE(0, this._blockSize - 4);\n            }\n        }\n        else {\n            const lowBits = (bits & 0xffffffff) >>> 0;\n            const highBits = (bits - lowBits) / 0x100000000;\n            if (this._bigEndian) {\n                this._block.writeUInt32BE(highBits, this._blockSize - 8);\n                this._block.writeUInt32BE(lowBits, this._blockSize - 4);\n            }\n            else {\n                this._block.writeUInt32LE(lowBits, this._blockSize - 8);\n                this._block.writeUInt32LE(highBits, this._blockSize - 4);\n            }\n        }\n        this._update(this._block);\n        const hash = this._hash();\n        return enc ? hash.toString(enc) : hash;\n    }\n    _update(block) {\n        throw new Error('_update must be implemented by subclass');\n    }\n    _hash() {\n        throw new Error('_update must be implemented by subclass');\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - md5.js, Copyright (c) 2016 Kirill Fomichev\n */\nfunction rotl(x, n) {\n    return (x << n) | (x >>> (32 - n));\n}\nfunction fnF(a, b, c, d, m, k, s) {\n    return (rotl((a + ((b & c) | (~b & d)) + m + k) | 0, s) + b) | 0;\n}\nfunction fnG(a, b, c, d, m, k, s) {\n    return (rotl((a + ((b & d) | (c & ~d)) + m + k) | 0, s) + b) | 0;\n}\nfunction fnH(a, b, c, d, m, k, s) {\n    return (rotl((a + (b ^ c ^ d) + m + k) | 0, s) + b) | 0;\n}\nfunction fnI(a, b, c, d, m, k, s) {\n    return (rotl((a + (c ^ (b | ~d)) + m + k) | 0, s) + b) | 0;\n}\nclass MD5 extends Hash {\n    constructor() {\n        super(64, 56, 'le');\n        this._a = 0x67452301;\n        this._b = 0xefcdab89;\n        this._c = 0x98badcfe;\n        this._d = 0x10325476;\n        this._m = new Array(16);\n    }\n    _update(B) {\n        const M = this._m;\n        for (let i = 0; i < 16; ++i) {\n            M[i] = B.readInt32LE(i * 4);\n        }\n        let a = this._a;\n        let b = this._b;\n        let c = this._c;\n        let d = this._d;\n        a = fnF(a, b, c, d, M[0], 0xd76aa478, 7);\n        d = fnF(d, a, b, c, M[1], 0xe8c7b756, 12);\n        c = fnF(c, d, a, b, M[2], 0x242070db, 17);\n        b = fnF(b, c, d, a, M[3], 0xc1bdceee, 22);\n        a = fnF(a, b, c, d, M[4], 0xf57c0faf, 7);\n        d = fnF(d, a, b, c, M[5], 0x4787c62a, 12);\n        c = fnF(c, d, a, b, M[6], 0xa8304613, 17);\n        b = fnF(b, c, d, a, M[7], 0xfd469501, 22);\n        a = fnF(a, b, c, d, M[8], 0x698098d8, 7);\n        d = fnF(d, a, b, c, M[9], 0x8b44f7af, 12);\n        c = fnF(c, d, a, b, M[10], 0xffff5bb1, 17);\n        b = fnF(b, c, d, a, M[11], 0x895cd7be, 22);\n        a = fnF(a, b, c, d, M[12], 0x6b901122, 7);\n        d = fnF(d, a, b, c, M[13], 0xfd987193, 12);\n        c = fnF(c, d, a, b, M[14], 0xa679438e, 17);\n        b = fnF(b, c, d, a, M[15], 0x49b40821, 22);\n        a = fnG(a, b, c, d, M[1], 0xf61e2562, 5);\n        d = fnG(d, a, b, c, M[6], 0xc040b340, 9);\n        c = fnG(c, d, a, b, M[11], 0x265e5a51, 14);\n        b = fnG(b, c, d, a, M[0], 0xe9b6c7aa, 20);\n        a = fnG(a, b, c, d, M[5], 0xd62f105d, 5);\n        d = fnG(d, a, b, c, M[10], 0x02441453, 9);\n        c = fnG(c, d, a, b, M[15], 0xd8a1e681, 14);\n        b = fnG(b, c, d, a, M[4], 0xe7d3fbc8, 20);\n        a = fnG(a, b, c, d, M[9], 0x21e1cde6, 5);\n        d = fnG(d, a, b, c, M[14], 0xc33707d6, 9);\n        c = fnG(c, d, a, b, M[3], 0xf4d50d87, 14);\n        b = fnG(b, c, d, a, M[8], 0x455a14ed, 20);\n        a = fnG(a, b, c, d, M[13], 0xa9e3e905, 5);\n        d = fnG(d, a, b, c, M[2], 0xfcefa3f8, 9);\n        c = fnG(c, d, a, b, M[7], 0x676f02d9, 14);\n        b = fnG(b, c, d, a, M[12], 0x8d2a4c8a, 20);\n        a = fnH(a, b, c, d, M[5], 0xfffa3942, 4);\n        d = fnH(d, a, b, c, M[8], 0x8771f681, 11);\n        c = fnH(c, d, a, b, M[11], 0x6d9d6122, 16);\n        b = fnH(b, c, d, a, M[14], 0xfde5380c, 23);\n        a = fnH(a, b, c, d, M[1], 0xa4beea44, 4);\n        d = fnH(d, a, b, c, M[4], 0x4bdecfa9, 11);\n        c = fnH(c, d, a, b, M[7], 0xf6bb4b60, 16);\n        b = fnH(b, c, d, a, M[10], 0xbebfbc70, 23);\n        a = fnH(a, b, c, d, M[13], 0x289b7ec6, 4);\n        d = fnH(d, a, b, c, M[0], 0xeaa127fa, 11);\n        c = fnH(c, d, a, b, M[3], 0xd4ef3085, 16);\n        b = fnH(b, c, d, a, M[6], 0x04881d05, 23);\n        a = fnH(a, b, c, d, M[9], 0xd9d4d039, 4);\n        d = fnH(d, a, b, c, M[12], 0xe6db99e5, 11);\n        c = fnH(c, d, a, b, M[15], 0x1fa27cf8, 16);\n        b = fnH(b, c, d, a, M[2], 0xc4ac5665, 23);\n        a = fnI(a, b, c, d, M[0], 0xf4292244, 6);\n        d = fnI(d, a, b, c, M[7], 0x432aff97, 10);\n        c = fnI(c, d, a, b, M[14], 0xab9423a7, 15);\n        b = fnI(b, c, d, a, M[5], 0xfc93a039, 21);\n        a = fnI(a, b, c, d, M[12], 0x655b59c3, 6);\n        d = fnI(d, a, b, c, M[3], 0x8f0ccc92, 10);\n        c = fnI(c, d, a, b, M[10], 0xffeff47d, 15);\n        b = fnI(b, c, d, a, M[1], 0x85845dd1, 21);\n        a = fnI(a, b, c, d, M[8], 0x6fa87e4f, 6);\n        d = fnI(d, a, b, c, M[15], 0xfe2ce6e0, 10);\n        c = fnI(c, d, a, b, M[6], 0xa3014314, 15);\n        b = fnI(b, c, d, a, M[13], 0x4e0811a1, 21);\n        a = fnI(a, b, c, d, M[4], 0xf7537e82, 6);\n        d = fnI(d, a, b, c, M[11], 0xbd3af235, 10);\n        c = fnI(c, d, a, b, M[2], 0x2ad7d2bb, 15);\n        b = fnI(b, c, d, a, M[9], 0xeb86d391, 21);\n        this._a = (this._a + a) | 0;\n        this._b = (this._b + b) | 0;\n        this._c = (this._c + c) | 0;\n        this._d = (this._d + d) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(16);\n        H.writeInt32LE(this._a, 0);\n        H.writeInt32LE(this._b, 4);\n        H.writeInt32LE(this._c, 8);\n        H.writeInt32LE(this._d, 12);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc | 0, 0xca62c1d6 | 0];\nfunction rotl1(num) {\n    return (num << 1) | (num >>> 31);\n}\nfunction rotl5(num) {\n    return (num << 5) | (num >>> 27);\n}\nfunction rotl30(num) {\n    return (num << 30) | (num >>> 2);\n}\nfunction ft(s, b, c, d) {\n    if (s === 0) {\n        return (b & c) | (~b & d);\n    }\n    if (s === 2) {\n        return (b & c) | (b & d) | (c & d);\n    }\n    return b ^ c ^ d;\n}\nclass Sha1 extends Hash {\n    constructor() {\n        super(64, 56);\n        this._a = 0x67452301;\n        this._b = 0xefcdab89;\n        this._c = 0x98badcfe;\n        this._d = 0x10325476;\n        this._e = 0xc3d2e1f0;\n        this._w = new Array(80);\n    }\n    _update(M) {\n        const W = this._w;\n        let a = this._a | 0;\n        let b = this._b | 0;\n        let c = this._c | 0;\n        let d = this._d | 0;\n        let e = this._e | 0;\n        let i;\n        for (i = 0; i < 16; ++i) {\n            W[i] = M.readInt32BE(i * 4);\n        }\n        for (; i < 80; ++i) {\n            W[i] = rotl1(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16]);\n        }\n        for (let j = 0; j < 80; ++j) {\n            const s = ~~(j / 20);\n            const t = (rotl5(a) + ft(s, b, c, d) + e + W[j] + K[s]) | 0;\n            e = d;\n            d = c;\n            c = rotl30(b);\n            b = a;\n            a = t;\n        }\n        this._a = (a + this._a) | 0;\n        this._b = (b + this._b) | 0;\n        this._c = (c + this._c) | 0;\n        this._d = (d + this._d) | 0;\n        this._e = (e + this._e) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(20);\n        H.writeInt32BE(this._a | 0, 0);\n        H.writeInt32BE(this._b | 0, 4);\n        H.writeInt32BE(this._c | 0, 8);\n        H.writeInt32BE(this._d | 0, 12);\n        H.writeInt32BE(this._e | 0, 16);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K$1 = [\n    0x428a2f98,\n    0x71374491,\n    0xb5c0fbcf,\n    0xe9b5dba5,\n    0x3956c25b,\n    0x59f111f1,\n    0x923f82a4,\n    0xab1c5ed5,\n    0xd807aa98,\n    0x12835b01,\n    0x243185be,\n    0x550c7dc3,\n    0x72be5d74,\n    0x80deb1fe,\n    0x9bdc06a7,\n    0xc19bf174,\n    0xe49b69c1,\n    0xefbe4786,\n    0x0fc19dc6,\n    0x240ca1cc,\n    0x2de92c6f,\n    0x4a7484aa,\n    0x5cb0a9dc,\n    0x76f988da,\n    0x983e5152,\n    0xa831c66d,\n    0xb00327c8,\n    0xbf597fc7,\n    0xc6e00bf3,\n    0xd5a79147,\n    0x06ca6351,\n    0x14292967,\n    0x27b70a85,\n    0x2e1b2138,\n    0x4d2c6dfc,\n    0x53380d13,\n    0x650a7354,\n    0x766a0abb,\n    0x81c2c92e,\n    0x92722c85,\n    0xa2bfe8a1,\n    0xa81a664b,\n    0xc24b8b70,\n    0xc76c51a3,\n    0xd192e819,\n    0xd6990624,\n    0xf40e3585,\n    0x106aa070,\n    0x19a4c116,\n    0x1e376c08,\n    0x2748774c,\n    0x34b0bcb5,\n    0x391c0cb3,\n    0x4ed8aa4a,\n    0x5b9cca4f,\n    0x682e6ff3,\n    0x748f82ee,\n    0x78a5636f,\n    0x84c87814,\n    0x8cc70208,\n    0x90befffa,\n    0xa4506ceb,\n    0xbef9a3f7,\n    0xc67178f2\n];\nfunction ch(x, y, z) {\n    return z ^ (x & (y ^ z));\n}\nfunction maj(x, y, z) {\n    return (x & y) | (z & (x | y));\n}\nfunction sigma0(x) {\n    return ((x >>> 2) | (x << 30)) ^ ((x >>> 13) | (x << 19)) ^ ((x >>> 22) | (x << 10));\n}\nfunction sigma1(x) {\n    return ((x >>> 6) | (x << 26)) ^ ((x >>> 11) | (x << 21)) ^ ((x >>> 25) | (x << 7));\n}\nfunction gamma0(x) {\n    return ((x >>> 7) | (x << 25)) ^ ((x >>> 18) | (x << 14)) ^ (x >>> 3);\n}\nfunction gamma1(x) {\n    return ((x >>> 17) | (x << 15)) ^ ((x >>> 19) | (x << 13)) ^ (x >>> 10);\n}\nclass Sha256 extends Hash {\n    constructor() {\n        super(64, 56);\n        this._a = 0x6a09e667;\n        this._b = 0xbb67ae85;\n        this._c = 0x3c6ef372;\n        this._d = 0xa54ff53a;\n        this._e = 0x510e527f;\n        this._f = 0x9b05688c;\n        this._g = 0x1f83d9ab;\n        this._h = 0x5be0cd19;\n        this._w = new Array(64);\n    }\n    _update(M) {\n        const W = this._w;\n        let a = this._a | 0;\n        let b = this._b | 0;\n        let c = this._c | 0;\n        let d = this._d | 0;\n        let e = this._e | 0;\n        let f = this._f | 0;\n        let g = this._g | 0;\n        let h = this._h | 0;\n        let i;\n        for (i = 0; i < 16; ++i) {\n            W[i] = M.readInt32BE(i * 4);\n        }\n        for (; i < 64; ++i) {\n            W[i] = (gamma1(W[i - 2]) + W[i - 7] + gamma0(W[i - 15]) + W[i - 16]) | 0;\n        }\n        for (let j = 0; j < 64; ++j) {\n            const T1 = (h + sigma1(e) + ch(e, f, g) + K$1[j] + W[j]) | 0;\n            const T2 = (sigma0(a) + maj(a, b, c)) | 0;\n            h = g;\n            g = f;\n            f = e;\n            e = (d + T1) | 0;\n            d = c;\n            c = b;\n            b = a;\n            a = (T1 + T2) | 0;\n        }\n        this._a = (a + this._a) | 0;\n        this._b = (b + this._b) | 0;\n        this._c = (c + this._c) | 0;\n        this._d = (d + this._d) | 0;\n        this._e = (e + this._e) | 0;\n        this._f = (f + this._f) | 0;\n        this._g = (g + this._g) | 0;\n        this._h = (h + this._h) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(32);\n        H.writeInt32BE(this._a, 0);\n        H.writeInt32BE(this._b, 4);\n        H.writeInt32BE(this._c, 8);\n        H.writeInt32BE(this._d, 12);\n        H.writeInt32BE(this._e, 16);\n        H.writeInt32BE(this._f, 20);\n        H.writeInt32BE(this._g, 24);\n        H.writeInt32BE(this._h, 28);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K$2 = [\n    0x428a2f98,\n    0xd728ae22,\n    0x71374491,\n    0x23ef65cd,\n    0xb5c0fbcf,\n    0xec4d3b2f,\n    0xe9b5dba5,\n    0x8189dbbc,\n    0x3956c25b,\n    0xf348b538,\n    0x59f111f1,\n    0xb605d019,\n    0x923f82a4,\n    0xaf194f9b,\n    0xab1c5ed5,\n    0xda6d8118,\n    0xd807aa98,\n    0xa3030242,\n    0x12835b01,\n    0x45706fbe,\n    0x243185be,\n    0x4ee4b28c,\n    0x550c7dc3,\n    0xd5ffb4e2,\n    0x72be5d74,\n    0xf27b896f,\n    0x80deb1fe,\n    0x3b1696b1,\n    0x9bdc06a7,\n    0x25c71235,\n    0xc19bf174,\n    0xcf692694,\n    0xe49b69c1,\n    0x9ef14ad2,\n    0xefbe4786,\n    0x384f25e3,\n    0x0fc19dc6,\n    0x8b8cd5b5,\n    0x240ca1cc,\n    0x77ac9c65,\n    0x2de92c6f,\n    0x592b0275,\n    0x4a7484aa,\n    0x6ea6e483,\n    0x5cb0a9dc,\n    0xbd41fbd4,\n    0x76f988da,\n    0x831153b5,\n    0x983e5152,\n    0xee66dfab,\n    0xa831c66d,\n    0x2db43210,\n    0xb00327c8,\n    0x98fb213f,\n    0xbf597fc7,\n    0xbeef0ee4,\n    0xc6e00bf3,\n    0x3da88fc2,\n    0xd5a79147,\n    0x930aa725,\n    0x06ca6351,\n    0xe003826f,\n    0x14292967,\n    0x0a0e6e70,\n    0x27b70a85,\n    0x46d22ffc,\n    0x2e1b2138,\n    0x5c26c926,\n    0x4d2c6dfc,\n    0x5ac42aed,\n    0x53380d13,\n    0x9d95b3df,\n    0x650a7354,\n    0x8baf63de,\n    0x766a0abb,\n    0x3c77b2a8,\n    0x81c2c92e,\n    0x47edaee6,\n    0x92722c85,\n    0x1482353b,\n    0xa2bfe8a1,\n    0x4cf10364,\n    0xa81a664b,\n    0xbc423001,\n    0xc24b8b70,\n    0xd0f89791,\n    0xc76c51a3,\n    0x0654be30,\n    0xd192e819,\n    0xd6ef5218,\n    0xd6990624,\n    0x5565a910,\n    0xf40e3585,\n    0x5771202a,\n    0x106aa070,\n    0x32bbd1b8,\n    0x19a4c116,\n    0xb8d2d0c8,\n    0x1e376c08,\n    0x5141ab53,\n    0x2748774c,\n    0xdf8eeb99,\n    0x34b0bcb5,\n    0xe19b48a8,\n    0x391c0cb3,\n    0xc5c95a63,\n    0x4ed8aa4a,\n    0xe3418acb,\n    0x5b9cca4f,\n    0x7763e373,\n    0x682e6ff3,\n    0xd6b2b8a3,\n    0x748f82ee,\n    0x5defb2fc,\n    0x78a5636f,\n    0x43172f60,\n    0x84c87814,\n    0xa1f0ab72,\n    0x8cc70208,\n    0x1a6439ec,\n    0x90befffa,\n    0x23631e28,\n    0xa4506ceb,\n    0xde82bde9,\n    0xbef9a3f7,\n    0xb2c67915,\n    0xc67178f2,\n    0xe372532b,\n    0xca273ece,\n    0xea26619c,\n    0xd186b8c7,\n    0x21c0c207,\n    0xeada7dd6,\n    0xcde0eb1e,\n    0xf57d4f7f,\n    0xee6ed178,\n    0x06f067aa,\n    0x72176fba,\n    0x0a637dc5,\n    0xa2c898a6,\n    0x113f9804,\n    0xbef90dae,\n    0x1b710b35,\n    0x131c471b,\n    0x28db77f5,\n    0x23047d84,\n    0x32caab7b,\n    0x40c72493,\n    0x3c9ebe0a,\n    0x15c9bebc,\n    0x431d67c4,\n    0x9c100d4c,\n    0x4cc5d4be,\n    0xcb3e42b6,\n    0x597f299c,\n    0xfc657e2a,\n    0x5fcb6fab,\n    0x3ad6faec,\n    0x6c44198c,\n    0x4a475817\n];\nfunction Ch(x, y, z) {\n    return z ^ (x & (y ^ z));\n}\nfunction maj$1(x, y, z) {\n    return (x & y) | (z & (x | y));\n}\nfunction sigma0$1(x, xl) {\n    return ((x >>> 28) | (xl << 4)) ^ ((xl >>> 2) | (x << 30)) ^ ((xl >>> 7) | (x << 25));\n}\nfunction sigma1$1(x, xl) {\n    return ((x >>> 14) | (xl << 18)) ^ ((x >>> 18) | (xl << 14)) ^ ((xl >>> 9) | (x << 23));\n}\nfunction Gamma0(x, xl) {\n    return ((x >>> 1) | (xl << 31)) ^ ((x >>> 8) | (xl << 24)) ^ (x >>> 7);\n}\nfunction Gamma0l(x, xl) {\n    return ((x >>> 1) | (xl << 31)) ^ ((x >>> 8) | (xl << 24)) ^ ((x >>> 7) | (xl << 25));\n}\nfunction Gamma1(x, xl) {\n    return ((x >>> 19) | (xl << 13)) ^ ((xl >>> 29) | (x << 3)) ^ (x >>> 6);\n}\nfunction Gamma1l(x, xl) {\n    return ((x >>> 19) | (xl << 13)) ^ ((xl >>> 29) | (x << 3)) ^ ((x >>> 6) | (xl << 26));\n}\nfunction getCarry(a, b) {\n    return a >>> 0 < b >>> 0 ? 1 : 0;\n}\nclass Sha512 extends Hash {\n    constructor() {\n        super(128, 112);\n        this._ah = 0x6a09e667;\n        this._bh = 0xbb67ae85;\n        this._ch = 0x3c6ef372;\n        this._dh = 0xa54ff53a;\n        this._eh = 0x510e527f;\n        this._fh = 0x9b05688c;\n        this._gh = 0x1f83d9ab;\n        this._hh = 0x5be0cd19;\n        this._al = 0xf3bcc908;\n        this._bl = 0x84caa73b;\n        this._cl = 0xfe94f82b;\n        this._dl = 0x5f1d36f1;\n        this._el = 0xade682d1;\n        this._fl = 0x2b3e6c1f;\n        this._gl = 0xfb41bd6b;\n        this._hl = 0x137e2179;\n        this._w = new Array(160);\n    }\n    _update(M) {\n        const W = this._w;\n        let ah = this._ah | 0;\n        let bh = this._bh | 0;\n        let ch = this._ch | 0;\n        let dh = this._dh | 0;\n        let eh = this._eh | 0;\n        let fh = this._fh | 0;\n        let gh = this._gh | 0;\n        let hh = this._hh | 0;\n        let al = this._al | 0;\n        let bl = this._bl | 0;\n        let cl = this._cl | 0;\n        let dl = this._dl | 0;\n        let el = this._el | 0;\n        let fl = this._fl | 0;\n        let gl = this._gl | 0;\n        let hl = this._hl | 0;\n        let Wih;\n        let Wil;\n        let i = 0;\n        for (i = 0; i < 32; i += 2) {\n            W[i] = M.readInt32BE(i * 4);\n            W[i + 1] = M.readInt32BE(i * 4 + 4);\n        }\n        for (; i < 160; i += 2) {\n            let xh = W[i - 15 * 2];\n            let xl = W[i - 15 * 2 + 1];\n            const gamma0 = Gamma0(xh, xl);\n            const gamma0l = Gamma0l(xl, xh);\n            xh = W[i - 2 * 2];\n            xl = W[i - 2 * 2 + 1];\n            const gamma1 = Gamma1(xh, xl);\n            const gamma1l = Gamma1l(xl, xh);\n            // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]\n            const Wi7h = W[i - 7 * 2];\n            const Wi7l = W[i - 7 * 2 + 1];\n            const Wi16h = W[i - 16 * 2];\n            const Wi16l = W[i - 16 * 2 + 1];\n            Wil = (gamma0l + Wi7l) | 0;\n            Wih = (gamma0 + Wi7h + getCarry(Wil, gamma0l)) | 0;\n            Wil = (Wil + gamma1l) | 0;\n            Wih = (Wih + gamma1 + getCarry(Wil, gamma1l)) | 0;\n            Wil = (Wil + Wi16l) | 0;\n            Wih = (Wih + Wi16h + getCarry(Wil, Wi16l)) | 0;\n            W[i] = Wih;\n            W[i + 1] = Wil;\n        }\n        for (let j = 0; j < 160; j += 2) {\n            Wih = W[j];\n            Wil = W[j + 1];\n            const majh = maj$1(ah, bh, ch);\n            const majl = maj$1(al, bl, cl);\n            const sigma0h = sigma0$1(ah, al);\n            const sigma0l = sigma0$1(al, ah);\n            const sigma1h = sigma1$1(eh, el);\n            const sigma1l = sigma1$1(el, eh);\n            // t1 = h + sigma1 + ch + K[j] + W[j]\n            const Kih = K$2[j];\n            const Kil = K$2[j + 1];\n            const chh = Ch(eh, fh, gh);\n            const chl = Ch(el, fl, gl);\n            let t1l = (hl + sigma1l) | 0;\n            let t1h = (hh + sigma1h + getCarry(t1l, hl)) | 0;\n            t1l = (t1l + chl) | 0;\n            t1h = (t1h + chh + getCarry(t1l, chl)) | 0;\n            t1l = (t1l + Kil) | 0;\n            t1h = (t1h + Kih + getCarry(t1l, Kil)) | 0;\n            t1l = (t1l + Wil) | 0;\n            t1h = (t1h + Wih + getCarry(t1l, Wil)) | 0;\n            // t2 = sigma0 + maj\n            const t2l = (sigma0l + majl) | 0;\n            const t2h = (sigma0h + majh + getCarry(t2l, sigma0l)) | 0;\n            hh = gh;\n            hl = gl;\n            gh = fh;\n            gl = fl;\n            fh = eh;\n            fl = el;\n            el = (dl + t1l) | 0;\n            eh = (dh + t1h + getCarry(el, dl)) | 0;\n            dh = ch;\n            dl = cl;\n            ch = bh;\n            cl = bl;\n            bh = ah;\n            bl = al;\n            al = (t1l + t2l) | 0;\n            ah = (t1h + t2h + getCarry(al, t1l)) | 0;\n        }\n        this._al = (this._al + al) | 0;\n        this._bl = (this._bl + bl) | 0;\n        this._cl = (this._cl + cl) | 0;\n        this._dl = (this._dl + dl) | 0;\n        this._el = (this._el + el) | 0;\n        this._fl = (this._fl + fl) | 0;\n        this._gl = (this._gl + gl) | 0;\n        this._hl = (this._hl + hl) | 0;\n        this._ah = (this._ah + ah + getCarry(this._al, al)) | 0;\n        this._bh = (this._bh + bh + getCarry(this._bl, bl)) | 0;\n        this._ch = (this._ch + ch + getCarry(this._cl, cl)) | 0;\n        this._dh = (this._dh + dh + getCarry(this._dl, dl)) | 0;\n        this._eh = (this._eh + eh + getCarry(this._el, el)) | 0;\n        this._fh = (this._fh + fh + getCarry(this._fl, fl)) | 0;\n        this._gh = (this._gh + gh + getCarry(this._gl, gl)) | 0;\n        this._hh = (this._hh + hh + getCarry(this._hl, hl)) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(64);\n        function writeInt64BE(h, l, offset) {\n            H.writeInt32BE(h, offset);\n            H.writeInt32BE(l, offset + 4);\n        }\n        writeInt64BE(this._ah, this._al, 0);\n        writeInt64BE(this._bh, this._bl, 8);\n        writeInt64BE(this._ch, this._cl, 16);\n        writeInt64BE(this._dh, this._dl, 24);\n        writeInt64BE(this._eh, this._el, 32);\n        writeInt64BE(this._fh, this._fl, 40);\n        writeInt64BE(this._gh, this._gl, 48);\n        writeInt64BE(this._hh, this._hl, 56);\n        return H;\n    }\n}\n\nconst HASH_IMPLEMENTATIONS = new Map([\n    ['md5', MD5],\n    ['sha-1', Sha1],\n    ['sha-256', Sha256],\n    ['sha-512', Sha512],\n    ['sha1', Sha1],\n    ['sha256', Sha256],\n    ['sha512', Sha512]\n]);\nfunction createHash(alg) {\n    alg = alg.toLowerCase();\n    const HashImp = HASH_IMPLEMENTATIONS.get(alg);\n    if (HashImp) {\n        return new HashImp();\n    }\n    else {\n        throw new Error('Unsupported hash algorithm: ' + alg);\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - create-hash, Copyright (c) 2017 crypto-browserify contributors\n * - create-hmac, Copyright (c) 2017 crypto-browserify contributors\n * - randombytes, Copyright (c) 2017 crypto-browserify\n */\nconst ZEROS = Buffer.alloc(128);\nclass Hmac extends Transform {\n    constructor(alg, key) {\n        super();\n        if (typeof key === 'string') {\n            key = Buffer.from(key);\n        }\n        const blocksize = alg === 'sha512' ? 128 : 64;\n        this._alg = alg;\n        if (key.length > blocksize) {\n            key = createHash(alg)\n                .update(key)\n                .digest();\n        }\n        else if (key.length < blocksize) {\n            key = Buffer.concat([key, ZEROS], blocksize);\n        }\n        this._ipad = Buffer.alloc(blocksize);\n        this._opad = Buffer.alloc(blocksize);\n        for (let i = 0; i < blocksize; i++) {\n            this._ipad[i] = key[i] ^ 0x36;\n            this._opad[i] = key[i] ^ 0x5c;\n        }\n        this._hash = createHash(alg).update(this._ipad);\n    }\n    _transform(data, enc, next) {\n        let err;\n        try {\n            this.update(data, enc);\n        }\n        catch (e) {\n            err = e;\n        }\n        finally {\n            next(err);\n        }\n    }\n    _flush(done) {\n        let err;\n        try {\n            this.push(this._final());\n        }\n        catch (e) {\n            err = e;\n        }\n        done(err);\n    }\n    _final() {\n        const h = this._hash.digest();\n        return createHash(this._alg)\n            .update(this._opad)\n            .update(h)\n            .digest();\n    }\n    update(data, inputEnc) {\n        this._hash.update(data, inputEnc);\n        return this;\n    }\n    digest(outputEnc) {\n        const outData = this._final() || Buffer.alloc(0);\n        if (outputEnc) {\n            return outData.toString(outputEnc);\n        }\n        return outData;\n    }\n}\n\nlet root;\nif (typeof window !== 'undefined') {\n    root = window;\n}\nelse if (typeof global !== 'undefined') {\n    root = global;\n}\nfunction randomBytes(size) {\n    const rawBytes = new Uint8Array(size);\n    if (size > 0) {\n        (root.crypto || root.msCrypto).getRandomValues(rawBytes);\n    }\n    return Buffer.from(rawBytes.buffer);\n}\nfunction getHashes() {\n    return ['sha-1', 'sha-256', 'sha-512', 'md5'];\n}\nfunction createHmac(alg, key) {\n    return new Hmac(alg.toLowerCase(), key);\n}\nconst nativeFetch = fetch;\nconst nativeWS = WebSocket;\n\nclass SimpleMech {\n    constructor(name) {\n        this.authenticated = false;\n        this.mutuallyAuthenticated = false;\n        this.name = name;\n    }\n    getCacheableCredentials() {\n        return null;\n    }\n    processChallenge(challenge) {\n        return;\n    }\n    processSuccess(success) {\n        this.authenticated = true;\n        if (success) {\n            this.processChallenge(success);\n        }\n    }\n    finalize() {\n        return {\n            authenticated: this.authenticated,\n            mutuallyAuthenticated: this.mutuallyAuthenticated\n        };\n    }\n}\nclass Factory {\n    constructor() {\n        this.mechanisms = [];\n    }\n    register(name, constructor, priority) {\n        this.mechanisms.push({\n            constructor,\n            name: name.toUpperCase(),\n            priority: priority || this.mechanisms.length\n        });\n        // We want mechanisms with highest priority at the start of the list\n        this.mechanisms.sort((a, b) => b.priority - a.priority);\n    }\n    disable(name) {\n        const mechName = name.toUpperCase();\n        this.mechanisms = this.mechanisms.filter(mech => mech.name !== mechName);\n    }\n    createMechanism(names) {\n        const availableNames = names.map(name => name.toUpperCase());\n        for (const knownMech of this.mechanisms) {\n            for (const availableMechName of availableNames) {\n                if (availableMechName === knownMech.name) {\n                    return new knownMech.constructor(knownMech.name);\n                }\n            }\n        }\n        return null;\n    }\n}\n// ====================================================================\n// Utility helpers\n// ====================================================================\n// tslint:disable no-bitwise\nfunction XOR(a, b) {\n    const res = [];\n    if (a.length > b.length) {\n        for (let i = 0; i < b.length; i++) {\n            res.push(a[i] ^ b[i]);\n        }\n    }\n    else {\n        for (let i = 0; i < a.length; i++) {\n            res.push(a[i] ^ b[i]);\n        }\n    }\n    return Buffer.from(res);\n}\n// tslint:enable no-bitwise\nfunction H(text, alg = 'sha-1') {\n    return createHash(alg)\n        .update(text)\n        .digest();\n}\nfunction HMAC(key, msg, alg = 'sha-1') {\n    return createHmac(alg, key)\n        .update(msg)\n        .digest();\n}\nfunction Hi(text, salt, iterations, alg = 'sha-1') {\n    let ui1 = HMAC(text, Buffer.concat([salt, Buffer.from('00000001', 'hex')]), alg);\n    let ui = ui1;\n    for (let i = 0; i < iterations - 1; i++) {\n        ui1 = HMAC(text, ui1, alg);\n        ui = XOR(ui, ui1);\n    }\n    return ui;\n}\nfunction createClientNonce(length = 32) {\n    return randomBytes(length).toString('hex');\n}\nfunction parse$2(challenge) {\n    const directives = {};\n    const tokens = challenge.toString().split(/,(?=(?:[^\"]|\"[^\"]*\")*$)/);\n    for (let i = 0, len = tokens.length; i < len; i++) {\n        const directive = /(\\w+)=[\"]?([^\"]+)[\"]?$/.exec(tokens[i]);\n        if (directive) {\n            directives[directive[1]] = directive[2];\n        }\n    }\n    return directives;\n}\n// ====================================================================\n// ANONYMOUS\n// ====================================================================\nclass ANONYMOUS extends SimpleMech {\n    getExpectedCredentials() {\n        return { optional: ['trace'], required: [] };\n    }\n    createResponse(credentials) {\n        return Buffer.from(credentials.trace || '');\n    }\n}\n// ====================================================================\n// EXTERNAL\n// ====================================================================\nclass EXTERNAL extends SimpleMech {\n    getExpectedCredentials() {\n        return { optional: ['authzid'], required: [] };\n    }\n    createResponse(credentials) {\n        return Buffer.from(credentials.authzid || '');\n    }\n}\n// ====================================================================\n// PLAIN\n// ====================================================================\nclass PLAIN extends SimpleMech {\n    getExpectedCredentials() {\n        return {\n            optional: ['authzid'],\n            required: ['username', 'password']\n        };\n    }\n    createResponse(credentials) {\n        return Buffer.from((credentials.authzid || '') +\n            '\\x00' +\n            credentials.username +\n            '\\x00' +\n            credentials.password);\n    }\n}\n// ====================================================================\n// OAUTHBEARER\n// ====================================================================\nclass OAUTH extends SimpleMech {\n    constructor(name) {\n        super(name);\n        this.name = name;\n    }\n    getExpectedCredentials() {\n        return {\n            optional: [],\n            required: ['token']\n        };\n    }\n    createResponse(credentials) {\n        return Buffer.from(credentials.token);\n    }\n}\n// ====================================================================\n// DIGEST-MD5\n// ====================================================================\nclass DIGEST extends SimpleMech {\n    constructor(name) {\n        super(name);\n        this.providesMutualAuthentication = false;\n        this.name = name;\n    }\n    processChallenge(challenge) {\n        const values = parse$2(challenge);\n        this.authenticated = !!values.rspauth;\n        this.realm = values.realm;\n        this.nonce = values.nonce;\n        this.charset = values.charset;\n    }\n    getExpectedCredentials() {\n        return {\n            optional: ['authzid', 'realm', 'clientNonce'],\n            required: ['host', 'password', 'serviceName', 'serviceType', 'username']\n        };\n    }\n    createResponse(credentials) {\n        if (this.authenticated) {\n            return null;\n        }\n        let uri = credentials.serviceType + '/' + credentials.host;\n        if (credentials.serviceName && credentials.host !== credentials.serviceName) {\n            uri += '/' + credentials.serviceName;\n        }\n        const realm = credentials.realm || this.realm || '';\n        const cnonce = credentials.clientNonce || createClientNonce(16);\n        const nc = '00000001';\n        const qop = 'auth';\n        let str = '';\n        str += 'username=\"' + credentials.username + '\"';\n        if (realm) {\n            str += ',realm=\"' + realm + '\"';\n        }\n        str += ',nonce=\"' + this.nonce + '\"';\n        str += ',cnonce=\"' + cnonce + '\"';\n        str += ',nc=' + nc;\n        str += ',qop=' + qop;\n        str += ',digest-uri=\"' + uri + '\"';\n        const base = createHash('md5')\n            .update(credentials.username)\n            .update(':')\n            .update(realm)\n            .update(':')\n            .update(credentials.password)\n            .digest();\n        const ha1 = createHash('md5')\n            .update(base)\n            .update(':')\n            .update(this.nonce)\n            .update(':')\n            .update(cnonce);\n        if (credentials.authzid) {\n            ha1.update(':').update(credentials.authzid);\n        }\n        const dha1 = ha1.digest('hex');\n        const ha2 = createHash('md5')\n            .update('AUTHENTICATE:')\n            .update(uri);\n        const dha2 = ha2.digest('hex');\n        const digest = createHash('md5')\n            .update(dha1)\n            .update(':')\n            .update(this.nonce)\n            .update(':')\n            .update(nc)\n            .update(':')\n            .update(cnonce)\n            .update(':')\n            .update(qop)\n            .update(':')\n            .update(dha2)\n            .digest('hex');\n        str += ',response=' + digest;\n        if (this.charset === 'utf-8') {\n            str += ',charset=utf-8';\n        }\n        if (credentials.authzid) {\n            str += 'authzid=\"' + credentials.authzid + '\"';\n        }\n        return Buffer.from(str);\n    }\n}\n// ====================================================================\n// SCRAM-SHA-1(-PLUS)\n// ====================================================================\nclass SCRAM {\n    constructor(name) {\n        this.providesMutualAuthentication = true;\n        this.name = name;\n        this.state = 'INITIAL';\n        this.useChannelBinding = this.name.toLowerCase().endsWith('-plus');\n        this.algorithm = this.name\n            .toLowerCase()\n            .split('scram-')[1]\n            .split('-plus')[0];\n    }\n    getExpectedCredentials() {\n        const optional = ['authzid'];\n        const required = ['username', 'password'];\n        if (this.useChannelBinding) {\n            required.push('tlsUnique');\n        }\n        return {\n            optional,\n            required\n        };\n    }\n    getCacheableCredentials() {\n        return this.cache;\n    }\n    createResponse(credentials) {\n        switch (this.state) {\n            case 'INITIAL':\n                return this.initialResponse(credentials);\n            case 'CHALLENGE':\n                return this.challengeResponse(credentials);\n        }\n        return null;\n    }\n    processChallenge(challenge) {\n        const values = parse$2(challenge);\n        this.salt = Buffer.from(values.s || '', 'base64');\n        this.iterationCount = parseInt(values.i, 10);\n        this.nonce = values.r;\n        this.verifier = values.v;\n        this.error = values.e;\n        this.challenge = challenge;\n    }\n    processSuccess(success) {\n        this.processChallenge(success);\n    }\n    finalize(credentials) {\n        if (!this.verifier) {\n            return {\n                authenticated: false,\n                error: this.error,\n                mutuallyAuthenticated: false\n            };\n        }\n        if (this.serverSignature.toString('base64') !== this.verifier) {\n            return {\n                authenticated: false,\n                error: 'Mutual authentication failed',\n                mutuallyAuthenticated: false\n            };\n        }\n        return {\n            authenticated: true,\n            mutuallyAuthenticated: true\n        };\n    }\n    initialResponse(credentials) {\n        const authzid = this.escapeUsername(credentials.authzid);\n        const username = this.escapeUsername(credentials.username);\n        this.clientNonce = credentials.clientNonce || createClientNonce();\n        let cbindHeader = 'n';\n        if (credentials.tlsUnique) {\n            if (!this.useChannelBinding) {\n                cbindHeader = 'y';\n            }\n            else {\n                cbindHeader = 'p=tls-unique';\n            }\n        }\n        this.gs2Header = Buffer.from(authzid ? `${cbindHeader},a=${authzid},` : `${cbindHeader},,`);\n        this.clientFirstMessageBare = Buffer.from(`n=${username},r=${this.clientNonce}`);\n        const result = Buffer.concat([this.gs2Header, this.clientFirstMessageBare]);\n        this.state = 'CHALLENGE';\n        return result;\n    }\n    challengeResponse(credentials) {\n        const CLIENT_KEY = Buffer.from('Client Key');\n        const SERVER_KEY = Buffer.from('Server Key');\n        const cbindData = Buffer.concat([\n            this.gs2Header,\n            credentials.tlsUnique || Buffer.from('')\n        ]).toString('base64');\n        const clientFinalMessageWithoutProof = Buffer.from(`c=${cbindData},r=${this.nonce}`);\n        let saltedPassword;\n        let clientKey;\n        let serverKey;\n        // If our cached salt is the same, we can reuse cached credentials to speed\n        // up the hashing process.\n        const cached = credentials.salt && Buffer.compare(credentials.salt, this.salt) === 0;\n        if (cached && credentials.clientKey && credentials.serverKey) {\n            clientKey = Buffer.from(credentials.clientKey);\n            serverKey = Buffer.from(credentials.serverKey);\n        }\n        else if (cached && credentials.saltedPassword) {\n            saltedPassword = Buffer.from(credentials.saltedPassword);\n            clientKey = HMAC(saltedPassword, CLIENT_KEY, this.algorithm);\n            serverKey = HMAC(saltedPassword, SERVER_KEY, this.algorithm);\n        }\n        else {\n            saltedPassword = Hi(Buffer.from(credentials.password || ''), this.salt, this.iterationCount, this.algorithm);\n            clientKey = HMAC(saltedPassword, CLIENT_KEY, this.algorithm);\n            serverKey = HMAC(saltedPassword, SERVER_KEY, this.algorithm);\n        }\n        const storedKey = H(clientKey, this.algorithm);\n        const separator = Buffer.from(',');\n        const authMessage = Buffer.concat([\n            this.clientFirstMessageBare,\n            separator,\n            this.challenge,\n            separator,\n            clientFinalMessageWithoutProof\n        ]);\n        const clientSignature = HMAC(storedKey, authMessage, this.algorithm);\n        const clientProof = XOR(clientKey, clientSignature).toString('base64');\n        this.serverSignature = HMAC(serverKey, authMessage, this.algorithm);\n        const result = Buffer.concat([\n            clientFinalMessageWithoutProof,\n            Buffer.from(`,p=${clientProof}`)\n        ]);\n        this.state = 'FINAL';\n        this.cache = {\n            clientKey,\n            salt: this.salt,\n            saltedPassword,\n            serverKey\n        };\n        return result;\n    }\n    escapeUsername(name = '') {\n        const escaped = [];\n        for (const curr of name) {\n            if (curr === ',') {\n                escaped.push('=2C');\n            }\n            else if (curr === '=') {\n                escaped.push('=3D');\n            }\n            else {\n                escaped.push(curr);\n            }\n        }\n        return escaped.join('');\n    }\n}\n\nvar index$1 = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    SimpleMech: SimpleMech,\n    Factory: Factory,\n    ANONYMOUS: ANONYMOUS,\n    EXTERNAL: EXTERNAL,\n    PLAIN: PLAIN,\n    OAUTH: OAUTH,\n    DIGEST: DIGEST,\n    SCRAM: SCRAM\n});\n\nfunction Account (client) {\n    client.getAccountInfo = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            account: {},\n            to: jid,\n            type: 'get'\n        });\n        return resp.account;\n    });\n    client.updateAccount = (jid, data) => {\n        return client.sendIQ({\n            account: data,\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.deleteAccount = (jid) => {\n        return client.sendIQ({\n            account: {\n                remove: true\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.getPrivateData = (key) => __awaiter(this, void 0, void 0, function* () {\n        const res = yield client.sendIQ({\n            privateStorage: {\n                [key]: {}\n            },\n            type: 'get'\n        });\n        return res.privateStorage[key];\n    });\n    client.setPrivateData = (key, value) => __awaiter(this, void 0, void 0, function* () {\n        return client.sendIQ({\n            privateStorage: {\n                [key]: value\n            },\n            type: 'set'\n        });\n    });\n    client.getVCard = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            to: jid,\n            type: 'get',\n            vcard: {\n                format: NS_VCARD_TEMP\n            }\n        });\n        return resp.vcard;\n    });\n    client.publishVCard = (vcard) => __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            type: 'set',\n            vcard\n        });\n    });\n    client.enableNotifications = (jid, node, fieldList = []) => {\n        return client.sendIQ({\n            push: {\n                action: 'enable',\n                form: {\n                    fields: [\n                        {\n                            name: 'FORM_TYPE',\n                            type: 'hidden',\n                            value: 'http://jabber.org/protocol/pubsub#publish-options'\n                        },\n                        ...fieldList\n                    ],\n                    type: 'submit'\n                },\n                jid,\n                node\n            },\n            type: 'set'\n        });\n    };\n    client.disableNotifications = (jid, node) => {\n        return client.sendIQ({\n            push: {\n                action: 'disable',\n                jid,\n                node\n            },\n            type: 'set'\n        });\n    };\n}\n\nfunction Avatar (client) {\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_AVATAR_METADATA));\n    client.on('pubsub:published', msg => {\n        if (msg.pubsub.items.node !== NS_AVATAR_METADATA) {\n            return;\n        }\n        const info = msg.pubsub.items.published[0].content;\n        client.emit('avatar', {\n            avatars: info.versions || [],\n            jid: msg.from,\n            source: 'pubsub'\n        });\n    });\n    client.on('presence', pres => {\n        if (pres.vcardAvatar && typeof pres.vcardAvatar === 'string') {\n            client.emit('avatar', {\n                avatars: [\n                    {\n                        id: pres.vcardAvatar\n                    }\n                ],\n                jid: pres.from,\n                source: 'vcard'\n            });\n        }\n    });\n    client.publishAvatar = (id, data) => {\n        return client.publish('', NS_AVATAR_DATA, {\n            data,\n            itemType: NS_AVATAR_DATA\n        }, id);\n    };\n    client.useAvatars = (versions, pointers = []) => {\n        return client.publish('', NS_AVATAR_METADATA, {\n            itemType: NS_AVATAR_METADATA,\n            pointers,\n            versions\n        }, 'current');\n    };\n    client.getAvatar = (jid, id) => {\n        return client.getItem(jid, NS_AVATAR_DATA, id);\n    };\n}\n\nfunction Bind (client) {\n    client.registerFeature('bind', 300, (features, cb) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            const resp = yield client.sendIQ({\n                bind: {\n                    resource: client.config.resource\n                },\n                type: 'set'\n            });\n            client.features.negotiated.bind = true;\n            client.emit('session:prebind', resp.bind.jid);\n            const canStartSession = !features.legacySession ||\n                (features.legacySession && features.legacySession.optional);\n            if (!client.sessionStarted && canStartSession) {\n                client.emit('session:started', client.jid);\n            }\n            return cb();\n        }\n        catch (err) {\n            console.error(err);\n            return cb('disconnect', 'JID binding failed');\n        }\n    }));\n    client.registerFeature('legacySession', 1000, (features, cb) => __awaiter(this, void 0, void 0, function* () {\n        if (client.sessionStarted || (features.legacySession && features.legacySession.optional)) {\n            client.features.negotiated.session = true;\n            return cb();\n        }\n        try {\n            yield client.sendIQ({\n                legacySession: true,\n                type: 'set'\n            });\n            client.features.negotiated.session = true;\n            if (!client.sessionStarted) {\n                client.sessionStarted = true;\n                client.emit('session:started', client.jid);\n            }\n            return cb();\n        }\n        catch (err) {\n            return cb('disconnect', 'Session requeset failed');\n        }\n    }));\n    client.on('session:started', () => {\n        client.sessionStarted = true;\n    });\n    client.on('session:prebind', boundJID => {\n        client.jid = boundJID;\n        client.emit('session:bound', client.jid);\n    });\n    client.on('disconnected', () => {\n        client.sessionStarted = false;\n        client.features.negotiated.bind = false;\n        client.features.negotiated.session = false;\n    });\n}\n\nfunction Command (client) {\n    client.disco.addFeature(NS_ADHOC_COMMANDS);\n    client.disco.addItem({\n        name: 'Ad-Hoc Commands',\n        node: NS_ADHOC_COMMANDS\n    });\n    client.getCommands = (jid) => {\n        return client.getDiscoItems(jid, NS_ADHOC_COMMANDS);\n    };\n}\n\n/**\n * Portions of this file are derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - uuid, Copyright (c) 2010-2016 Robert Kieffer and other contributors\n */\nconst bth = [];\nfor (let i = 0; i < 256; ++i) {\n    bth[i] = (i + 0x100).toString(16).substr(1);\n}\nfunction timeoutPromise(target, delay, rejectValue = () => undefined) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let timeoutRef;\n        const result = yield Promise.race([\n            target,\n            new Promise((resolve, reject) => {\n                timeoutRef = setTimeout(() => reject(rejectValue()), delay);\n            })\n        ]);\n        if (timeoutRef) {\n            clearTimeout(timeoutRef);\n        }\n        return result;\n    });\n}\nfunction sleep(time) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise(resolve => {\n            setTimeout(() => resolve(), time);\n        });\n    });\n}\nfunction octetCompare(str1, str2) {\n    const b1 = typeof str1 === 'string' ? Buffer.from(str1, 'utf8') : str1;\n    const b2 = typeof str2 === 'string' ? Buffer.from(str2, 'utf8') : str2;\n    return b1.compare(b2);\n}\nfunction uuid() {\n    const buf = randomBytes(16);\n    // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n    buf[6] = (buf[6] & 0x0f) | 0x40;\n    buf[8] = (buf[8] & 0x3f) | 0x80;\n    let i = 0;\n    return [\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i]]\n    ].join('');\n}\nconst ISO_DT = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)(?:Z|((\\+|-)([\\d|:]*)))?$/;\nfunction reviveData(key, value) {\n    if (value && typeof value === 'string' && ISO_DT.test(value)) {\n        return new Date(value);\n    }\n    if (value &&\n        typeof value === 'object' &&\n        value.type === 'Buffer' &&\n        Array.isArray(value.data)) {\n        return Buffer.from(value);\n    }\n    return value;\n}\n\nvar Utils = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    timeoutPromise: timeoutPromise,\n    sleep: sleep,\n    octetCompare: octetCompare,\n    uuid: uuid,\n    reviveData: reviveData\n});\n\nfunction checkConnection(client) {\n    return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n        if (client.sm.started) {\n            client.once('stream:management:ack', () => resolve());\n            client.sm.request();\n        }\n        else {\n            try {\n                yield client.ping();\n                resolve();\n            }\n            catch (err) {\n                if (err.error && err.error.condition !== 'timeout') {\n                    resolve();\n                }\n                else {\n                    reject();\n                }\n            }\n        }\n    }));\n}\nfunction sendCSI(client, type) {\n    if (client.features.negotiated.clientStateIndication) {\n        client.send('csi', {\n            type\n        });\n    }\n}\nfunction Connection (client) {\n    client.disco.addFeature(NS_PING);\n    client.on('iq:get:ping', iq => {\n        client.sendIQResult(iq);\n    });\n    client.on('disconnected', () => {\n        client.disableKeepAlive();\n        client.features.negotiated.streamManagement = false;\n        client.features.negotiated.clientStateIndication = false;\n    });\n    client.markActive = () => sendCSI(client, 'active');\n    client.markInactive = () => sendCSI(client, 'inactive');\n    client.ping = (jid) => __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            ping: true,\n            to: jid,\n            type: 'get'\n        });\n    });\n    client.enableKeepAlive = (opts = {}) => {\n        // Ping every 5 minutes\n        const interval = opts.interval || 300;\n        // Disconnect if no response in 15 seconds\n        const timeout = opts.timeout || client.config.timeout || 15;\n        function keepalive() {\n            return __awaiter(this, void 0, void 0, function* () {\n                if (client.sessionStarted) {\n                    try {\n                        yield timeoutPromise(checkConnection(client), timeout * 1000);\n                    }\n                    catch (err) {\n                        // Kill the apparently dead connection without closing\n                        // the stream itself so we can reconnect and potentially\n                        // resume the session.\n                        client.emit('stream:error', {\n                            condition: 'connection-timeout',\n                            text: 'Server did not respond in ' + timeout + ' seconds'\n                        });\n                        if (client.transport) {\n                            client.transport.hasStream = false;\n                            client.transport.disconnect();\n                        }\n                    }\n                }\n            });\n        }\n        client._keepAliveInterval = setInterval(keepalive, interval * 1000);\n    };\n    client.disableKeepAlive = () => {\n        if (client._keepAliveInterval) {\n            clearInterval(client._keepAliveInterval);\n            delete client._keepAliveInterval;\n        }\n    };\n    const smacks = (features, done) => __awaiter(this, void 0, void 0, function* () {\n        if (!client.config.useStreamManagement) {\n            return done();\n        }\n        const smHandler = (sm) => {\n            switch (sm.type) {\n                case 'enabled':\n                    client.sm.enabled(sm);\n                    client.features.negotiated.streamManagement = true;\n                    client.off('sm', smHandler);\n                    return done();\n                case 'resumed':\n                    client.sm.resumed(sm);\n                    client.features.negotiated.streamManagement = true;\n                    client.features.negotiated.bind = true;\n                    client.sessionStarted = true;\n                    client.emit('stream:management:resumed', sm);\n                    client.off('sm', smHandler);\n                    return done('break'); // Halt further processing of stream features\n                case 'failed':\n                    client.sm.failed(sm);\n                    client.emit('session:end');\n                    client.off('sm', smHandler);\n                    done();\n            }\n        };\n        client.on('sm', smHandler);\n        if (!client.sm.id) {\n            if (client.features.negotiated.bind) {\n                client.sm.enable();\n            }\n            else {\n                client.off('sm', smHandler);\n                done();\n            }\n        }\n        else if (client.sm.id && client.sm.allowResume) {\n            client.sm.resume();\n        }\n        else {\n            client.off('sm', smHandler);\n            done();\n        }\n    });\n    client.registerFeature('streamManagement', 200, smacks);\n    client.registerFeature('streamManagement', 500, smacks);\n    client.registerFeature('clientStateIndication', 400, (features, cb) => {\n        client.features.negotiated.clientStateIndication = true;\n        cb();\n    });\n}\n\nfunction escape(value) {\n    return new Buffer(value.replace(/</g, '&lt;'), 'utf-8');\n}\nfunction encodeIdentities(identities = []) {\n    const result = [];\n    const existing = new Set();\n    for (const { category, type, lang, name } of identities) {\n        const encoded = `${category}/${type}/${lang || ''}/${name || ''}`;\n        if (existing.has(encoded)) {\n            return null;\n        }\n        existing.add(encoded);\n        result.push(escape(encoded));\n    }\n    result.sort(octetCompare);\n    return result;\n}\nfunction encodeFeatures(features = []) {\n    const result = [];\n    const existing = new Set();\n    for (const feature of features) {\n        if (existing.has(feature)) {\n            return null;\n        }\n        existing.add(feature);\n        result.push(escape(feature));\n    }\n    result.sort(octetCompare);\n    return result;\n}\nfunction encodeForms(extensions = []) {\n    const forms = [];\n    const types = new Set();\n    for (const form of extensions) {\n        let type;\n        for (const field of form.fields || []) {\n            if (field.name === 'FORM_TYPE' &&\n                field.type === 'hidden' &&\n                field.rawValues &&\n                field.rawValues.length === 1) {\n                type = escape(field.rawValues[0]);\n                break;\n            }\n        }\n        if (!type) {\n            continue;\n        }\n        if (types.has(type.toString())) {\n            return null;\n        }\n        types.add(type.toString());\n        forms.push({ type, form });\n    }\n    forms.sort((a, b) => octetCompare(a.type, b.type));\n    const results = [];\n    for (const form of forms) {\n        results.push(form.type);\n        const fields = encodeFields(form.form.fields);\n        for (const field of fields) {\n            results.push(field);\n        }\n    }\n    return results;\n}\nfunction encodeFields(fields = []) {\n    const sortedFields = [];\n    for (const field of fields) {\n        if (field.name === 'FORM_TYPE') {\n            continue;\n        }\n        sortedFields.push({\n            name: escape(field.name),\n            values: (field.rawValues || []).map(val => escape(val)).sort(octetCompare)\n        });\n    }\n    sortedFields.sort((a, b) => octetCompare(a.name, b.name));\n    const result = [];\n    for (const field of sortedFields) {\n        result.push(field.name);\n        for (const value of field.values) {\n            result.push(value);\n        }\n    }\n    return result;\n}\nfunction generate(info, hashName) {\n    const S = [];\n    const separator = new Buffer('<');\n    const append = (b1, b2) => {\n        S.push(b1);\n        S.push(separator);\n        if (b2) {\n            S.push(b2);\n        }\n    };\n    const identities = encodeIdentities(info.identities);\n    const features = encodeFeatures(info.features);\n    const extensions = encodeForms(info.extensions);\n    if (!identities || !features || !extensions) {\n        return null;\n    }\n    for (const id of identities) {\n        append(id);\n    }\n    for (const feature of features) {\n        append(feature);\n    }\n    for (const form of extensions) {\n        append(form);\n    }\n    let version = createHash(hashName)\n        .update(Buffer.concat(S))\n        .digest('base64');\n    let padding = 4 - (version.length % 4);\n    if (padding === 4) {\n        padding = 0;\n    }\n    for (let i = 0; i < padding; i++) {\n        version += '=';\n    }\n    return version;\n}\n\nclass Disco {\n    constructor() {\n        this.capsAlgorithms = ['sha-1'];\n        this.features = new Map();\n        this.identities = new Map();\n        this.extensions = new Map();\n        this.items = new Map();\n        this.caps = new Map();\n        this.features.set('', new Set());\n        this.identities.set('', []);\n        this.extensions.set('', []);\n    }\n    getNodeInfo(node) {\n        return {\n            extensions: [...(this.extensions.get(node) || [])],\n            features: [...(this.features.get(node) || [])],\n            identities: [...(this.identities.get(node) || [])]\n        };\n    }\n    addFeature(feature, node = '') {\n        if (!this.features.has(node)) {\n            this.features.set(node, new Set());\n        }\n        this.features.get(node).add(feature);\n    }\n    addIdentity(identity, node = '') {\n        if (!this.identities.has(node)) {\n            this.identities.set(node, []);\n        }\n        this.identities.get(node).push(identity);\n    }\n    addItem(item, node = '') {\n        if (!this.items.has(node)) {\n            this.items.set(node, []);\n        }\n        this.items.get(node).push(item);\n    }\n    addExtension(form, node = '') {\n        if (!this.extensions.has(node)) {\n            this.extensions.set(node, []);\n        }\n        this.extensions.get(node).push(form);\n    }\n    updateCaps(node, algorithms = this.capsAlgorithms) {\n        const info = {\n            extensions: [...this.extensions.get('')],\n            features: [...this.features.get('')],\n            identities: [...this.identities.get('')],\n            type: 'info'\n        };\n        for (const algorithm of algorithms) {\n            const version = generate(info, algorithm);\n            if (!version) {\n                this.caps.delete(algorithm);\n                continue;\n            }\n            this.caps.set(algorithm, {\n                algorithm,\n                node,\n                value: version\n            });\n            const hashedNode = `${node}#${version}`;\n            for (const feature of info.features) {\n                this.addFeature(feature, hashedNode);\n            }\n            for (const identity of info.identities) {\n                this.addIdentity(identity, hashedNode);\n            }\n            for (const form of info.extensions) {\n                this.addExtension(form, hashedNode);\n            }\n            this.identities.set(hashedNode, info.identities);\n            this.features.set(hashedNode, new Set(info.features));\n            this.extensions.set(hashedNode, info.extensions);\n        }\n        return [...this.caps.values()];\n    }\n    getCaps() {\n        return [...this.caps.values()];\n    }\n}\n\nfunction Disco$1 (client) {\n    client.disco = new Disco();\n    client.disco.addFeature(NS_DISCO_INFO);\n    client.disco.addFeature(NS_DISCO_ITEMS);\n    client.disco.addIdentity({\n        category: 'client',\n        type: 'web'\n    });\n    client.registerFeature('caps', 100, (features, done) => {\n        const domain = getDomain(client.jid) || client.config.server;\n        client.emit('disco:caps', {\n            caps: features.legacyCapabilities || [],\n            jid: domain\n        });\n        client.features.negotiated.caps = true;\n        done();\n    });\n    client.getDiscoInfo = (jid, node) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            disco: {\n                node,\n                type: 'info'\n            },\n            to: jid,\n            type: 'get'\n        });\n        return Object.assign({ extensions: [], features: [], identities: [] }, resp.disco);\n    });\n    client.getDiscoItems = (jid, node) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            disco: {\n                node,\n                type: 'items'\n            },\n            to: jid,\n            type: 'get'\n        });\n        return Object.assign({ items: [] }, resp.disco);\n    });\n    client.updateCaps = () => {\n        const node = client.config.capsNode || 'https://stanzajs.org';\n        return client.disco.updateCaps(node);\n    };\n    client.getCurrentCaps = () => {\n        const caps = client.disco.getCaps();\n        if (!caps) {\n            return;\n        }\n        const node = `${caps[0].node}#${caps[0].value}`;\n        return {\n            info: client.disco.getNodeInfo(node),\n            legacyCapabilities: caps\n        };\n    };\n    client.on('presence', pres => {\n        if (pres.legacyCapabilities) {\n            client.emit('disco:caps', {\n                caps: pres.legacyCapabilities,\n                jid: pres.from\n            });\n        }\n    });\n    client.on('iq:get:disco', iq => {\n        const { type, node } = iq.disco;\n        if (type === 'info') {\n            client.sendIQResult(iq, {\n                disco: Object.assign(Object.assign({}, client.disco.getNodeInfo(node || '')), { node, type: 'info' })\n            });\n        }\n        if (type === 'items') {\n            client.sendIQResult(iq, {\n                disco: {\n                    items: client.disco.items.get(node || '') || [],\n                    type: 'items'\n                }\n            });\n        }\n    });\n}\n\nconst VERSION = '12.4.5';\n// ====================================================================\n// Frequently Used Values\n// ====================================================================\nconst NotAuthorized = 'not-authorized';\n// ====================================================================\n// Named Enum Constants\n// ====================================================================\nconst StreamType = {\n    Bosh: NS_BOSH,\n    Client: NS_CLIENT,\n    Component: NS_COMPONENT,\n    Server: NS_SERVER\n};\nconst SASLFailureCondition = {\n    AccountDisabled: 'account-disabled',\n    CredentialsExpired: 'credentials-expired',\n    EncryptionRequired: 'encryption-required',\n    IncorrectEncoding: 'incorrect-encoding',\n    InvalidAuthzid: 'invalid-authzid',\n    InvalidMechanism: 'invalid-mechanism',\n    MalformedRequest: 'malformed-request',\n    MechanismTooWeak: 'mechanism-too-weak',\n    NotAuthorized,\n    TemporaryAuthFailure: 'temporary-auth-failure'\n};\nconst StreamErrorCondition = {\n    BadFormat: 'bad-format',\n    BadNamespacePrefix: 'bad-namespace-prefix',\n    Conflict: 'conflict',\n    ConnectionTimeout: 'connection-timeout',\n    HostGone: 'host-gone',\n    HostUnknown: 'host-unknown',\n    ImproperAddressing: 'improper-addressing',\n    InternalServerError: 'internal-server-error',\n    InvalidFrom: 'invalid-from',\n    InvalidId: 'invalid-id',\n    InvalidNamespace: 'invalid-namespace',\n    InvalidXML: 'invalid-xml',\n    NotAuthorized,\n    NotWellFormed: 'not-well-formed',\n    PolicyViolation: 'policy-violation',\n    RemoteConnectionFailed: 'remote-connection-failed',\n    Reset: 'reset',\n    ResourceConstraint: 'resource-constraint',\n    RestrictedXML: 'restricted-xml',\n    SeeOtherHost: 'see-other-host',\n    SystemShutdown: 'system-shutdown',\n    UndefinedCondition: 'undefined-condition',\n    UnsupportedEncoding: 'unsupported-encoding',\n    UnsupportedStanzaType: 'unsupported-stanza-type',\n    UnsupportedVersion: 'unsupported-version'\n};\nconst StanzaErrorCondition = {\n    BadRequest: 'bad-request',\n    Conflict: 'conflict',\n    FeatureNotImplemented: 'feature-not-implemented',\n    Forbidden: 'forbidden',\n    Gone: 'gone',\n    InternalServerError: 'internal-server-error',\n    ItemNotFound: 'item-not-found',\n    JIDMalformed: 'jid-malformed',\n    NotAcceptable: 'not-acceptable',\n    NotAllowed: 'not-allowed',\n    NotAuthorized,\n    PolicyViolation: 'policy-violation',\n    RecipientUnavailable: 'recipient-unavailable',\n    Redirect: 'redirect',\n    RegistrationRequired: 'registration-required',\n    RemoteServerNotFound: 'remote-server-not-found',\n    RemoteServerTimeout: 'remote-server-timeout',\n    ResourceConstraint: 'resource-constraint',\n    ServiceUnavailable: 'service-unavailable',\n    SubscriptionRequired: 'subscription-required',\n    UndefinedCondition: 'undefined-condition',\n    UnexpectedRequest: 'unexpected-request'\n};\nconst MessageType = {\n    Chat: 'chat',\n    Error: 'error',\n    GroupChat: 'groupchat',\n    Headline: 'headline',\n    Normal: 'normal'\n};\nconst PresenceType = {\n    Available: undefined,\n    Error: 'error',\n    Probe: 'probe',\n    Subscribe: 'subscribe',\n    Subscribed: 'subscribed',\n    Unavailable: 'unavailable',\n    Unsubscribe: 'unsubscribe',\n    Unsubscribed: 'unsubscribed'\n};\nconst IQType = {\n    Error: 'error',\n    Get: 'get',\n    Result: 'result',\n    Set: 'set'\n};\nconst PresenceShow = {\n    Away: 'away',\n    Chat: 'chat',\n    DoNotDisturb: 'dnd',\n    ExtendedAway: 'xa'\n};\nconst RosterSubscription = {\n    Both: 'both',\n    From: 'from',\n    None: 'none',\n    ReceivePresenceOnly: 'to',\n    Remove: 'remove',\n    SendAndReceivePresence: 'both',\n    SendPresenceOnly: 'from',\n    To: 'to'\n};\nconst DataFormType = {\n    Cancel: 'cancel',\n    Form: 'form',\n    Result: 'result',\n    Submit: 'submit'\n};\nconst DataFormFieldType = {\n    Boolean: 'boolean',\n    Fixed: 'fixed',\n    Hidden: 'hidden',\n    JID: 'jid-single',\n    JIDMultiple: 'jid-multi',\n    List: 'list-single',\n    ListMultiple: 'list-multi',\n    Password: 'text-private',\n    Text: 'text-single',\n    TextMultiple: 'text-multi',\n    TextPrivate: 'text-private'\n};\nconst MUCAffiliation = {\n    Admin: 'admin',\n    Banned: 'outcast',\n    Member: 'member',\n    None: 'none',\n    Outcast: 'outcast',\n    Owner: 'owner'\n};\nconst MUCRole = {\n    Moderator: 'moderator',\n    None: 'none',\n    Participant: 'participant',\n    Visitor: 'visitor'\n};\nconst MUCStatusCode = {\n    AffiliationChanged: '101',\n    AffiliationLost: '321',\n    Banned: '301',\n    Error: '333',\n    Kicked: '307',\n    LoggingDisabled: '171',\n    LoggingEnabled: '170',\n    MembershipLost: '322',\n    NickChanged: '303',\n    NickChangedByService: '210',\n    NonAnonymous: '172',\n    NonAnonymousRoom: '100',\n    NonPrivacyConfigurationChange: '104',\n    RoomCreated: '201',\n    SelfPresence: '110',\n    SemiAnonymous: '173',\n    Shutdown: '332',\n    UnavailableMembersListed: '102',\n    UnavailableMembersNotListed: '103'\n};\nconst PubsubErrorCondition = {\n    ClosedNode: 'closed-node',\n    ConfigurationRequired: 'configuration-required',\n    InvalidJID: 'invalid-jid',\n    InvalidOptions: 'invalid-options',\n    InvalidPayload: 'invalid-payload',\n    InvalidSubscriptionId: 'invalid-subid',\n    ItemForbidden: 'item-forbidden',\n    ItemRequired: 'item-required',\n    JIDRequired: 'jid-required',\n    MaxItemsExceeded: 'max-items-exceeded',\n    MaxNodesExceeded: 'max-nodes-exceeded',\n    NodeIdRequired: 'nodeid-required',\n    NotInRosterGroup: 'not-in-roster-group',\n    NotSubscribed: 'not-subscribed',\n    PayloadRequired: 'payload-required',\n    PayloadTooBig: 'payload-too-big',\n    PendingSubscription: 'pending-subscription',\n    PresenceSubscriptionRequired: 'presence-subscription-required',\n    SubscriptionIdRequired: 'subid-required',\n    TooManySubscriptions: 'too-many-subscriptions',\n    Unsupported: 'unsupported',\n    UnsupportedAccessModel: 'unsupported-access-model'\n};\nconst ChatState = {\n    Active: 'active',\n    Composing: 'composing',\n    Gone: 'gone',\n    Inactive: 'inactive',\n    Paused: 'paused'\n};\nconst JingleSessionRole = {\n    Initiator: 'initiator',\n    Responder: 'responder'\n};\nconst JingleApplicationDirection = {\n    Inactive: 'inactive',\n    Receive: 'recvonly',\n    Send: 'sendonly',\n    SendReceive: 'sendrecv'\n};\nconst JingleContentSenders = {\n    Both: 'both',\n    Initiator: 'initiator',\n    None: 'none',\n    Responder: 'responder'\n};\nconst JingleAction = {\n    ContentAccept: 'content-accept',\n    ContentAdd: 'content-add',\n    ContentModify: 'content-modify',\n    ContentReject: 'content-reject',\n    ContentRemove: 'content-remove',\n    DescriptionInfo: 'description-info',\n    SecurityInfo: 'security-info',\n    SessionAccept: 'session-accept',\n    SessionInfo: 'session-info',\n    SessionInitiate: 'session-initiate',\n    SessionTerminate: 'session-terminate',\n    TransportAccept: 'transport-accept',\n    TransportInfo: 'transport-info',\n    TransportReject: 'transport-reject',\n    TransportReplace: 'transport-replace'\n};\nconst JingleErrorCondition = {\n    OutOfOrder: 'out-of-order',\n    TieBreak: 'tie-break',\n    UnknownContent: 'unknown-content',\n    UnknownSession: 'unknown-session',\n    UnsupportedInfo: 'unsupported-info'\n};\nconst JingleReasonCondition = {\n    AlternativeSession: 'alternative-session',\n    Busy: 'busy',\n    Cancel: 'cancel',\n    ConnectivityError: 'connectivity-error',\n    Decline: 'decline',\n    Expired: 'expired',\n    FailedApplication: 'failed-application',\n    FailedTransport: 'failed-transport',\n    GeneralError: 'general-error',\n    Gone: 'gone',\n    IncompatibleParameters: 'incompatible-parameters',\n    MediaError: 'media-error',\n    SecurityError: 'security-error',\n    Success: 'success',\n    Timeout: 'timeout',\n    UnsupportedApplications: 'unsupported-applications',\n    UnsupportedTransports: 'unsupported-transports'\n};\n// ====================================================================\n// Standalone Constants\n// ====================================================================\nconst USER_MOODS = [\n    'afraid',\n    'amazed',\n    'amorous',\n    'angry',\n    'annoyed',\n    'anxious',\n    'aroused',\n    'ashamed',\n    'bored',\n    'brave',\n    'calm',\n    'cautious',\n    'cold',\n    'confident',\n    'confused',\n    'contemplative',\n    'contented',\n    'cranky',\n    'crazy',\n    'creative',\n    'curious',\n    'dejected',\n    'depressed',\n    'disappointed',\n    'disgusted',\n    'dismayed',\n    'distracted',\n    'embarrassed',\n    'envious',\n    'excited',\n    'flirtatious',\n    'frustrated',\n    'grateful',\n    'grieving',\n    'grumpy',\n    'guilty',\n    'happy',\n    'hopeful',\n    'hot',\n    'humbled',\n    'humiliated',\n    'hungry',\n    'hurt',\n    'impressed',\n    'in_awe',\n    'in_love',\n    'indignant',\n    'interested',\n    'intoxicated',\n    'invincible',\n    'jealous',\n    'lonely',\n    'lost',\n    'lucky',\n    'mean',\n    'moody',\n    'nervous',\n    'neutral',\n    'offended',\n    'outraged',\n    'playful',\n    'proud',\n    'relaxed',\n    'relieved',\n    'remorseful',\n    'restless',\n    'sad',\n    'sarcastic',\n    'satisfied',\n    'serious',\n    'shocked',\n    'shy',\n    'sick',\n    'sleepy',\n    'spontaneous',\n    'stressed',\n    'strong',\n    'surprised',\n    'thankful',\n    'thirsty',\n    'tired',\n    'undefined',\n    'weak',\n    'worried'\n];\nconst USER_ACTIVITY_GENERAL = [\n    'doing_chores',\n    'drinking',\n    'eating',\n    'exercising',\n    'grooming',\n    'having_appointment',\n    'inactive',\n    'relaxing',\n    'talking',\n    'traveling',\n    'undefined',\n    'working'\n];\nconst USER_ACTIVITY_SPECIFIC = [\n    'at_the_spa',\n    'brushing_teeth',\n    'buying_groceries',\n    'cleaning',\n    'coding',\n    'commuting',\n    'cooking',\n    'cycling',\n    'cycling',\n    'dancing',\n    'day_off',\n    'doing_maintenance',\n    'doing_the_dishes',\n    'doing_the_laundry',\n    'driving',\n    'fishing',\n    'gaming',\n    'gardening',\n    'getting_a_haircut',\n    'going_out',\n    'hanging_out',\n    'having_a_beer',\n    'having_a_snack',\n    'having_breakfast',\n    'having_coffee',\n    'having_dinner',\n    'having_lunch',\n    'having_tea',\n    'hiding',\n    'hiking',\n    'in_a_car',\n    'in_a_meeting',\n    'in_real_life',\n    'jogging',\n    'on_a_bus',\n    'on_a_plane',\n    'on_a_train',\n    'on_a_trip',\n    'on_the_phone',\n    'on_vacation',\n    'on_video_phone',\n    'other',\n    'partying',\n    'playing_sports',\n    'praying',\n    'reading',\n    'rehearsing',\n    'running',\n    'running_an_errand',\n    'scheduled_holiday',\n    'shaving',\n    'shopping',\n    'skiing',\n    'sleeping',\n    'smoking',\n    'socializing',\n    'studying',\n    'sunbathing',\n    'swimming',\n    'taking_a_bath',\n    'taking_a_shower',\n    'thinking',\n    'walking',\n    'walking_the_dog',\n    'watching_a_movie',\n    'watching_tv',\n    'working_out',\n    'writing'\n];\nconst JINGLE_INFO = (namespace, name) => `{${namespace}}${name}`;\nconst JINGLE_INFO_MUTE = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'mute');\nconst JINGLE_INFO_UNMUTE = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'unmute');\nconst JINGLE_INFO_HOLD = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'hold');\nconst JINGLE_INFO_UNHOLD = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'unhold');\nconst JINGLE_INFO_ACTIVE = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'active');\nconst JINGLE_INFO_RINGING = JINGLE_INFO(NS_JINGLE_RTP_INFO_1, 'ringing');\nconst JINGLE_INFO_CHECKSUM_5 = JINGLE_INFO(NS_JINGLE_FILE_TRANSFER_5, 'checksum');\nconst JINGLE_INFO_RECEIVED_5 = JINGLE_INFO(NS_JINGLE_FILE_TRANSFER_5, 'received');\n// ====================================================================\n// Helper Functions\n// ====================================================================\nfunction toList(data) {\n    return Object.keys(data).map(key => data[key]);\n}\nfunction sendersToDirection(role, senders = JingleContentSenders.Both) {\n    const isInitiator = role === JingleSessionRole.Initiator;\n    switch (senders) {\n        case JingleContentSenders.Initiator:\n            return isInitiator\n                ? JingleApplicationDirection.Send\n                : JingleApplicationDirection.Receive;\n        case JingleContentSenders.Responder:\n            return isInitiator\n                ? JingleApplicationDirection.Receive\n                : JingleApplicationDirection.Send;\n        case JingleContentSenders.Both:\n            return JingleApplicationDirection.SendReceive;\n    }\n    return JingleApplicationDirection.Inactive;\n}\nfunction directionToSenders(role, direction = JingleApplicationDirection.SendReceive) {\n    const isInitiator = role === JingleSessionRole.Initiator;\n    switch (direction) {\n        case JingleApplicationDirection.Send:\n            return isInitiator ? JingleContentSenders.Initiator : JingleContentSenders.Responder;\n        case JingleApplicationDirection.Receive:\n            return isInitiator ? JingleContentSenders.Responder : JingleContentSenders.Initiator;\n        case JingleApplicationDirection.SendReceive:\n            return JingleContentSenders.Both;\n    }\n    return JingleContentSenders.None;\n}\n\nvar Constants = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    VERSION: VERSION,\n    StreamType: StreamType,\n    SASLFailureCondition: SASLFailureCondition,\n    StreamErrorCondition: StreamErrorCondition,\n    StanzaErrorCondition: StanzaErrorCondition,\n    MessageType: MessageType,\n    PresenceType: PresenceType,\n    IQType: IQType,\n    PresenceShow: PresenceShow,\n    RosterSubscription: RosterSubscription,\n    DataFormType: DataFormType,\n    DataFormFieldType: DataFormFieldType,\n    MUCAffiliation: MUCAffiliation,\n    MUCRole: MUCRole,\n    MUCStatusCode: MUCStatusCode,\n    PubsubErrorCondition: PubsubErrorCondition,\n    ChatState: ChatState,\n    JingleSessionRole: JingleSessionRole,\n    JingleApplicationDirection: JingleApplicationDirection,\n    JingleContentSenders: JingleContentSenders,\n    JingleAction: JingleAction,\n    JingleErrorCondition: JingleErrorCondition,\n    JingleReasonCondition: JingleReasonCondition,\n    USER_MOODS: USER_MOODS,\n    USER_ACTIVITY_GENERAL: USER_ACTIVITY_GENERAL,\n    USER_ACTIVITY_SPECIFIC: USER_ACTIVITY_SPECIFIC,\n    JINGLE_INFO: JINGLE_INFO,\n    JINGLE_INFO_MUTE: JINGLE_INFO_MUTE,\n    JINGLE_INFO_UNMUTE: JINGLE_INFO_UNMUTE,\n    JINGLE_INFO_HOLD: JINGLE_INFO_HOLD,\n    JINGLE_INFO_UNHOLD: JINGLE_INFO_UNHOLD,\n    JINGLE_INFO_ACTIVE: JINGLE_INFO_ACTIVE,\n    JINGLE_INFO_RINGING: JINGLE_INFO_RINGING,\n    JINGLE_INFO_CHECKSUM_5: JINGLE_INFO_CHECKSUM_5,\n    JINGLE_INFO_RECEIVED_5: JINGLE_INFO_RECEIVED_5,\n    toList: toList,\n    sendersToDirection: sendersToDirection,\n    directionToSenders: directionToSenders\n});\n\nfunction Entity (client) {\n    client.disco.addFeature('jid\\\\20escaping');\n    client.disco.addFeature(NS_DELAY);\n    client.disco.addFeature(NS_EME_0);\n    client.disco.addFeature(NS_FORWARD_0);\n    client.disco.addFeature(NS_HASHES_2);\n    client.disco.addFeature(NS_HASHES_1);\n    client.disco.addFeature(NS_IDLE_1);\n    client.disco.addFeature(NS_JSON_0);\n    client.disco.addFeature(NS_OOB);\n    client.disco.addFeature(NS_PSA);\n    client.disco.addFeature(NS_REFERENCE_0);\n    client.disco.addFeature(NS_SHIM);\n    client.disco.addFeature(NS_DATAFORM);\n    client.disco.addFeature(NS_DATAFORM_MEDIA);\n    client.disco.addFeature(NS_DATAFORM_VALIDATION);\n    client.disco.addFeature(NS_DATAFORM_LAYOUT);\n    const names = getHashes();\n    for (const name of names) {\n        client.disco.addFeature(NS_HASH_NAME(name));\n    }\n    client.disco.addFeature(NS_TIME);\n    client.disco.addFeature(NS_VERSION);\n    client.on('iq:get:softwareVersion', iq => {\n        return client.sendIQResult(iq, {\n            softwareVersion: client.config.softwareVersion || {\n                name: 'stanzajs.org',\n                version: VERSION\n            }\n        });\n    });\n    client.on('iq:get:time', (iq) => {\n        const time = new Date();\n        client.sendIQResult(iq, {\n            time: {\n                tzo: time.getTimezoneOffset(),\n                utc: time\n            }\n        });\n    });\n    client.getSoftwareVersion = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            softwareVersion: {},\n            to: jid,\n            type: 'get'\n        });\n        return resp.softwareVersion;\n    });\n    client.getTime = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            time: {},\n            to: jid,\n            type: 'get'\n        });\n        return resp.time;\n    });\n    client.getLastActivity = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            lastActivity: {},\n            to: jid,\n            type: 'get'\n        });\n        return resp.lastActivity;\n    });\n}\n\nfunction Features (client) {\n    client.features = {\n        handlers: {},\n        negotiated: {},\n        order: []\n    };\n    client.registerFeature = function (name, priority, handler) {\n        this.features.order.push({\n            name,\n            priority\n        });\n        // We want the features with smallest priority values at the start of the list\n        this.features.order.sort((a, b) => a.priority - b.priority);\n        this.features.handlers[name] = handler.bind(client);\n    };\n    client.on('features', (features) => __awaiter(this, void 0, void 0, function* () {\n        const series = [];\n        const negotiated = client.features.negotiated;\n        const handlers = client.features.handlers;\n        for (const feature of client.features.order) {\n            const name = feature.name;\n            if (features[name] && handlers[name] && !negotiated[name]) {\n                series.push(() => new Promise(resolve => {\n                    if (!negotiated[name]) {\n                        handlers[name](features, (command, message) => {\n                            if (command) {\n                                resolve({ command, message });\n                            }\n                            else {\n                                resolve();\n                            }\n                        });\n                    }\n                    else {\n                        resolve();\n                    }\n                }));\n            }\n        }\n        for (const item of series) {\n            let cmd = '';\n            let msg = '';\n            try {\n                const res = yield item();\n                if (res) {\n                    cmd = res.command;\n                    msg = res.message || '';\n                }\n            }\n            catch (err) {\n                cmd = 'disconnect';\n                msg = err.message;\n                console.error(err);\n            }\n            if (!cmd) {\n                continue;\n            }\n            if (cmd === 'restart' && client.transport) {\n                client.transport.restart();\n            }\n            if (cmd === 'disconnect') {\n                client.emit('stream:error', {\n                    condition: 'policy-violation',\n                    text: 'Failed to negotiate stream features: ' + msg\n                });\n                client.disconnect();\n            }\n            return;\n        }\n    }));\n}\n\nfunction promiseAny(promises) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const errors = yield Promise.all(promises.map(p => {\n                return p.then(val => Promise.reject(val), err => Promise.resolve(err));\n            }));\n            return Promise.reject(errors);\n        }\n        catch (val) {\n            return Promise.resolve(val);\n        }\n    });\n}\nfunction getHostMeta(registry, opts) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (typeof opts === 'string') {\n            opts = { host: opts };\n        }\n        const config = Object.assign({ json: true, ssl: true, xrd: true }, opts);\n        const scheme = config.ssl ? 'https://' : 'http://';\n        return promiseAny([\n            nativeFetch(`${scheme}${config.host}/.well-known/host-meta.json`).then((res) => __awaiter(this, void 0, void 0, function* () {\n                if (!res.ok) {\n                    throw new Error('could-not-fetch-json');\n                }\n                return res.json();\n            })),\n            nativeFetch(`${scheme}${config.host}/.well-known/host-meta`).then((res) => __awaiter(this, void 0, void 0, function* () {\n                if (!res.ok) {\n                    throw new Error('could-not-fetch-xml');\n                }\n                const data = yield res.text();\n                const xml = parse$1(data);\n                if (xml) {\n                    return registry.import(xml);\n                }\n            }))\n        ]);\n    });\n}\nfunction HostMeta (client, stanzas) {\n    client.discoverBindings = (server) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            const data = yield getHostMeta(stanzas, server);\n            const results = {\n                bosh: [],\n                websocket: []\n            };\n            const links = data.links || [];\n            for (const link of links) {\n                if (link.href && link.rel === NS_ALT_CONNECTIONS_WEBSOCKET) {\n                    results.websocket.push(link.href);\n                }\n                if (link.href && link.rel === NS_ALT_CONNECTIONS_XBOSH) {\n                    results.bosh.push(link.href);\n                }\n            }\n            return results;\n        }\n        catch (err) {\n            return {};\n        }\n    });\n}\n\n// ====================================================================\n// Import SDP to Intermediary\n// ====================================================================\nfunction importFromSDP(sdp) {\n    const mediaSections = getMediaSections(sdp);\n    const sessionPart = getDescription(sdp);\n    const session = {\n        groups: [],\n        media: []\n    };\n    for (const groupLine of matchPrefix(sessionPart, 'a=group:')) {\n        const parts = groupLine.split(' ');\n        const semantics = parts.shift().substr(8);\n        session.groups.push({\n            mids: parts,\n            semantics\n        });\n    }\n    for (const mediaSection of mediaSections) {\n        const kind = getKind(mediaSection);\n        const isRejected$1 = isRejected(mediaSection);\n        const mLine = parseMLine(mediaSection);\n        const media = {\n            direction: getDirection(mediaSection, sessionPart),\n            kind,\n            mid: getMid(mediaSection),\n            protocol: mLine.protocol\n            // TODO: what about end-of-candidates?\n        };\n        if (!isRejected$1) {\n            media.iceParameters = getIceParameters(mediaSection, sessionPart);\n            media.dtlsParameters = getDtlsParameters(mediaSection, sessionPart);\n            media.setup = matchPrefix(mediaSection, 'a=setup:')[0].substr(8);\n        }\n        if (kind === 'audio' || kind === 'video') {\n            media.rtpParameters = parseRtpParameters(mediaSection);\n            media.rtpEncodingParameters = parseRtpEncodingParameters(mediaSection);\n            media.rtcpParameters = parseRtcpParameters(mediaSection);\n            const msid = parseMsid(mediaSection);\n            if (msid) {\n                media.streams = [msid];\n            }\n            else {\n                media.streams = [];\n            }\n        }\n        else if (kind === 'application') {\n            media.sctp = parseSctpDescription(mediaSection);\n        }\n        media.candidates = matchPrefix(mediaSection, 'a=candidate:').map(parseCandidate);\n        session.media.push(media);\n    }\n    return session;\n}\n// ====================================================================\n// Export Intermediary to SDP\n// ====================================================================\nfunction exportToSDP(session) {\n    const output = [];\n    output.push(writeSessionBoilerplate(session.sessionId, session.sessionVersion), 'a=msid-semantic:WMS *\\r\\n');\n    if (session.iceLite) {\n        output.push('a=ice-lite\\r\\n');\n    }\n    for (const group of session.groups || []) {\n        output.push(`a=group:${group.semantics} ${group.mids.join(' ')}\\r\\n`);\n    }\n    for (const media of session.media || []) {\n        const isRejected = !(media.iceParameters && media.dtlsParameters);\n        if (media.kind === 'application' && media.sctp) {\n            output.push(writeSctpDescription(media, media.sctp));\n        }\n        else if (media.rtpParameters) {\n            let mline = writeRtpDescription(media.kind, media.rtpParameters);\n            if (isRejected) {\n                mline = mline.replace(`m=${media.kind} 9 `, `m=${media.kind} 0 `);\n            }\n            output.push(mline);\n            output.push(`a=${media.direction || 'sendrecv'}\\r\\n`);\n            for (const stream of media.streams || []) {\n                output.push(`a=msid:${stream.stream} ${stream.track}\\r\\n`);\n            }\n            if (media.rtcpParameters && media.rtcpParameters.cname) {\n                output.push(`a=ssrc:${media.rtcpParameters.ssrc} cname:${media.rtcpParameters.cname}\\r\\n`);\n                if (media.rtpEncodingParameters && media.rtpEncodingParameters[0].rtx) {\n                    const params = media.rtpEncodingParameters[0];\n                    output.push(`a=ssrc-group:FID ${params.ssrc} ${params.rtx.ssrc}\\r\\n`);\n                    output.push(`a=ssrc:${params.rtx.ssrc} cname:${media.rtcpParameters.cname}\\r\\n`);\n                }\n            }\n        }\n        if (media.mid !== undefined) {\n            output.push(`a=mid:${media.mid}\\r\\n`);\n        }\n        if (media.iceParameters) {\n            output.push(writeIceParameters(media.iceParameters));\n        }\n        if (media.dtlsParameters && media.setup) {\n            output.push(writeDtlsParameters(media.dtlsParameters, media.setup));\n        }\n        if (media.candidates && media.candidates.length) {\n            for (const candidate of media.candidates) {\n                output.push(`a=${writeCandidate(candidate)}`);\n            }\n        }\n    }\n    return output.join('');\n}\n\nfunction convertIntermediateToApplication(media, role) {\n    const rtp = media.rtpParameters;\n    const rtcp = media.rtcpParameters || {};\n    const encodingParameters = media.rtpEncodingParameters || [];\n    let hasSSRC = false;\n    if (encodingParameters && encodingParameters.length) {\n        hasSSRC = !!encodingParameters[0].ssrc; // !== false ???\n    }\n    const application = {\n        applicationType: NS_JINGLE_RTP_1,\n        codecs: [],\n        headerExtensions: [],\n        media: media.kind,\n        rtcpMux: rtcp.mux,\n        rtcpReducedSize: rtcp.reducedSize,\n        sourceGroups: [],\n        sources: [],\n        ssrc: hasSSRC ? encodingParameters[0].ssrc.toString() : undefined,\n        streams: []\n    };\n    for (const ext of rtp.headerExtensions || []) {\n        application.headerExtensions.push({\n            id: ext.id,\n            senders: ext.direction && ext.direction !== 'sendrecv'\n                ? directionToSenders(role, ext.direction)\n                : undefined,\n            uri: ext.uri\n        });\n    }\n    if (rtcp.ssrc && rtcp.cname) {\n        application.sources = [\n            {\n                parameters: {\n                    cname: rtcp.cname\n                },\n                ssrc: rtcp.ssrc.toString()\n            }\n        ];\n    }\n    if (hasSSRC && encodingParameters[0] && encodingParameters[0].rtx) {\n        application.sourceGroups = [\n            {\n                semantics: 'FID',\n                sources: [\n                    encodingParameters[0].ssrc.toString(),\n                    encodingParameters[0].rtx.ssrc.toString()\n                ]\n            }\n        ];\n    }\n    for (const stream of media.streams || []) {\n        application.streams.push({\n            id: stream.stream,\n            track: stream.track\n        });\n    }\n    for (const codec of rtp.codecs || []) {\n        const payload = {\n            channels: codec.channels,\n            clockRate: codec.clockRate,\n            id: codec.payloadType.toString(),\n            maxptime: codec.maxptime ? codec.maxptime.toString() : undefined,\n            name: codec.name,\n            parameters: codec.parameters,\n            rtcpFeedback: codec.rtcpFeedback\n        };\n        for (const key of Object.keys(codec.parameters || {})) {\n            if (key === 'ptime') {\n                payload.ptime = codec.parameters[key].toString();\n            }\n        }\n        application.codecs.push(payload);\n    }\n    return application;\n}\nfunction convertIntermediateToCandidate(candidate) {\n    return {\n        component: candidate.component,\n        foundation: candidate.foundation,\n        generation: undefined,\n        id: undefined,\n        ip: candidate.ip,\n        network: undefined,\n        port: candidate.port,\n        priority: candidate.priority,\n        protocol: candidate.protocol,\n        relatedAddress: candidate.relatedAddress,\n        relatedPort: candidate.relatedPort,\n        tcpType: candidate.tcpType,\n        type: candidate.type\n    };\n}\nfunction convertCandidateToIntermediate(candidate) {\n    return {\n        address: candidate.ip,\n        component: candidate.component,\n        foundation: candidate.foundation,\n        ip: candidate.ip,\n        port: candidate.port,\n        priority: candidate.priority,\n        protocol: candidate.protocol,\n        relatedAddress: candidate.relatedAddress,\n        relatedPort: candidate.relatedPort,\n        tcpType: candidate.tcpType,\n        type: candidate.type\n    };\n}\nfunction convertIntermediateToTransport(media, transportType) {\n    const ice = media.iceParameters;\n    const dtls = media.dtlsParameters;\n    const transport = {\n        candidates: [],\n        transportType\n    };\n    if (ice) {\n        transport.usernameFragment = ice.usernameFragment;\n        transport.password = ice.password;\n    }\n    if (dtls) {\n        transport.fingerprints = dtls.fingerprints.map(fingerprint => ({\n            algorithm: fingerprint.algorithm,\n            setup: media.setup,\n            value: fingerprint.value\n        }));\n    }\n    if (media.sctp) {\n        transport.sctp = media.sctp;\n    }\n    for (const candidate of media.candidates || []) {\n        transport.candidates.push(convertIntermediateToCandidate(candidate));\n    }\n    return transport;\n}\nfunction convertIntermediateToRequest(session, role, transportType) {\n    return {\n        contents: session.media.map(media => {\n            const isRTP = media.kind === 'audio' || media.kind === 'video';\n            return {\n                application: isRTP\n                    ? convertIntermediateToApplication(media, role)\n                    : {\n                        applicationType: 'datachannel',\n                        protocol: media.protocol\n                    },\n                creator: JingleSessionRole.Initiator,\n                name: media.mid,\n                senders: directionToSenders(role, media.direction),\n                transport: convertIntermediateToTransport(media, transportType)\n            };\n        }),\n        groups: session.groups\n            ? session.groups.map(group => ({\n                contents: group.mids,\n                semantics: group.semantics\n            }))\n            : []\n    };\n}\nfunction convertContentToIntermediate(content, role) {\n    const application = content.application || {};\n    const transport = content.transport;\n    const isRTP = application && application.applicationType === NS_JINGLE_RTP_1;\n    const media = {\n        direction: sendersToDirection(role, content.senders),\n        kind: application.media || 'application',\n        mid: content.name,\n        protocol: isRTP ? 'UDP/TLS/RTP/SAVPF' : 'UDP/DTLS/SCTP'\n    };\n    if (isRTP) {\n        media.rtcpParameters = {\n            mux: application.rtcpMux,\n            reducedSize: application.rtcpReducedSize\n        };\n        if (application.sources && application.sources.length) {\n            const source = application.sources[0];\n            media.rtcpParameters.ssrc = parseInt(source.ssrc, 10);\n            if (source.parameters) {\n                media.rtcpParameters.cname = source.parameters.cname;\n            }\n        }\n        media.rtpParameters = {\n            codecs: [],\n            fecMechanisms: [],\n            headerExtensions: []\n        };\n        if (application.streams) {\n            media.streams = [];\n            for (const stream of application.streams) {\n                media.streams.push({\n                    stream: stream.id,\n                    track: stream.track\n                });\n            }\n        }\n        if (application.ssrc) {\n            media.rtpEncodingParameters = [\n                {\n                    ssrc: parseInt(application.ssrc, 10)\n                }\n            ];\n            if (application.sourceGroups && application.sourceGroups.length) {\n                const group = application.sourceGroups[0];\n                media.rtpEncodingParameters[0].rtx = {\n                    // TODO: actually look for a FID one with matching ssrc\n                    ssrc: parseInt(group.sources[1], 10)\n                };\n            }\n        }\n        for (const payload of application.codecs || []) {\n            const parameters = payload.parameters || {};\n            const rtcpFeedback = [];\n            for (const fb of payload.rtcpFeedback || []) {\n                rtcpFeedback.push({\n                    parameter: fb.parameter,\n                    type: fb.type\n                });\n            }\n            media.rtpParameters.codecs.push({\n                channels: payload.channels,\n                clockRate: payload.clockRate,\n                name: payload.name,\n                numChannels: payload.channels,\n                parameters,\n                payloadType: parseInt(payload.id, 10),\n                rtcpFeedback\n            });\n        }\n        for (const ext of application.headerExtensions || []) {\n            media.rtpParameters.headerExtensions.push({\n                direction: ext.senders && ext.senders !== 'both'\n                    ? sendersToDirection(role, ext.senders)\n                    : undefined,\n                id: ext.id,\n                uri: ext.uri\n            });\n        }\n    }\n    if (transport) {\n        if (transport.usernameFragment && transport.password) {\n            media.iceParameters = {\n                password: transport.password,\n                usernameFragment: transport.usernameFragment\n            };\n        }\n        if (transport.fingerprints && transport.fingerprints.length) {\n            media.dtlsParameters = {\n                fingerprints: [],\n                role: 'auto'\n            };\n            for (const fingerprint of transport.fingerprints) {\n                media.dtlsParameters.fingerprints.push({\n                    algorithm: fingerprint.algorithm,\n                    value: fingerprint.value\n                });\n            }\n            if (transport.sctp) {\n                media.sctp = transport.sctp;\n            }\n            media.setup = transport.fingerprints[0].setup;\n        }\n    }\n    return media;\n}\nfunction convertRequestToIntermediate(jingle, role) {\n    const session = {\n        groups: [],\n        media: []\n    };\n    for (const group of jingle.groups || []) {\n        session.groups.push({\n            mids: group.contents,\n            semantics: group.semantics\n        });\n    }\n    for (const content of jingle.contents || []) {\n        session.media.push(convertContentToIntermediate(content, role));\n    }\n    return session;\n}\nfunction convertIntermediateToTransportInfo(mid, candidate, transportType) {\n    return {\n        contents: [\n            {\n                creator: JingleSessionRole.Initiator,\n                name: mid,\n                transport: {\n                    candidates: [convertIntermediateToCandidate(candidate)],\n                    transportType,\n                    usernameFragment: candidate.usernameFragment || undefined\n                }\n            }\n        ]\n    };\n}\n\nconst badRequest = { condition: StanzaErrorCondition.BadRequest };\nconst unsupportedInfo = {\n    condition: StanzaErrorCondition.FeatureNotImplemented,\n    jingleError: JingleErrorCondition.UnsupportedInfo,\n    type: 'modify'\n};\nclass JingleSession {\n    constructor(opts) {\n        this.parent = opts.parent;\n        this.sid = opts.sid || uuid();\n        this.peerID = opts.peerID;\n        this.role = opts.initiator ? JingleSessionRole.Initiator : JingleSessionRole.Responder;\n        this._sessionState = 'starting';\n        this._connectionState = 'starting';\n        // We track the intial pending description types in case\n        // of the need for a tie-breaker.\n        this.pendingApplicationTypes = opts.applicationTypes || [];\n        this.pendingAction = undefined;\n        // Here is where we'll ensure that all actions are processed\n        // in order, even if a particular action requires async handling.\n        this.processingQueue = priorityQueue((task, next) => __awaiter(this, void 0, void 0, function* () {\n            if (this.state === 'ended') {\n                // Don't process anything once the session has been ended\n                if (task.type === 'local' && task.reject) {\n                    task.reject(new Error('Session ended'));\n                }\n                if (next) {\n                    next();\n                }\n                return;\n            }\n            if (task.type === 'local') {\n                this._log('debug', 'Processing local action:', task.name);\n                try {\n                    const res = yield task.handler();\n                    task.resolve(res);\n                }\n                catch (err) {\n                    task.reject(err);\n                }\n                if (next) {\n                    next();\n                }\n                return;\n            }\n            const { action, changes, cb } = task;\n            this._log('debug', 'Processing remote action:', action);\n            return new Promise(resolve => {\n                const done = (err, result) => {\n                    cb(err, result);\n                    if (next) {\n                        next();\n                    }\n                    resolve();\n                };\n                switch (action) {\n                    case JingleAction.ContentAccept:\n                        return this.onContentAccept(changes, done);\n                    case JingleAction.ContentAdd:\n                        return this.onContentAdd(changes, done);\n                    case JingleAction.ContentModify:\n                        return this.onContentModify(changes, done);\n                    case JingleAction.ContentReject:\n                        return this.onContentReject(changes, done);\n                    case JingleAction.ContentRemove:\n                        return this.onContentRemove(changes, done);\n                    case JingleAction.DescriptionInfo:\n                        return this.onDescriptionInfo(changes, done);\n                    case JingleAction.SecurityInfo:\n                        return this.onSecurityInfo(changes, done);\n                    case JingleAction.SessionAccept:\n                        return this.onSessionAccept(changes, done);\n                    case JingleAction.SessionInfo:\n                        return this.onSessionInfo(changes, done);\n                    case JingleAction.SessionInitiate:\n                        return this.onSessionInitiate(changes, done);\n                    case JingleAction.SessionTerminate:\n                        return this.onSessionTerminate(changes, done);\n                    case JingleAction.TransportAccept:\n                        return this.onTransportAccept(changes, done);\n                    case JingleAction.TransportInfo:\n                        return this.onTransportInfo(changes, done);\n                    case JingleAction.TransportReject:\n                        return this.onTransportReject(changes, done);\n                    case JingleAction.TransportReplace:\n                        return this.onTransportReplace(changes, done);\n                    default:\n                        this._log('error', 'Invalid or unsupported action: ' + action);\n                        done({ condition: StanzaErrorCondition.BadRequest });\n                }\n            });\n        }), 1);\n    }\n    get isInitiator() {\n        return this.role === JingleSessionRole.Initiator;\n    }\n    get peerRole() {\n        return this.isInitiator ? JingleSessionRole.Responder : JingleSessionRole.Initiator;\n    }\n    get state() {\n        return this._sessionState;\n    }\n    set state(value) {\n        if (value !== this._sessionState) {\n            this._log('info', 'Changing session state to: ' + value);\n            this._sessionState = value;\n            if (this.parent) {\n                this.parent.emit('sessionState', this, value);\n            }\n        }\n    }\n    get connectionState() {\n        return this._connectionState;\n    }\n    set connectionState(value) {\n        if (value !== this._connectionState) {\n            this._log('info', 'Changing connection state to: ' + value);\n            this._connectionState = value;\n            if (this.parent) {\n                this.parent.emit('connectionState', this, value);\n            }\n        }\n    }\n    send(action, data) {\n        data = data || {};\n        data.sid = this.sid;\n        data.action = action;\n        const requirePending = new Set([\n            JingleAction.ContentAccept,\n            JingleAction.ContentAdd,\n            JingleAction.ContentModify,\n            JingleAction.ContentReject,\n            JingleAction.ContentRemove,\n            JingleAction.SessionAccept,\n            JingleAction.SessionInitiate,\n            JingleAction.TransportAccept,\n            JingleAction.TransportReject,\n            JingleAction.TransportReplace\n        ]);\n        if (requirePending.has(action)) {\n            this.pendingAction = action;\n        }\n        else {\n            this.pendingAction = undefined;\n        }\n        this.parent.signal(this, {\n            id: uuid(),\n            jingle: data,\n            to: this.peerID,\n            type: 'set'\n        });\n    }\n    processLocal(name, handler) {\n        return new Promise((resolve, reject) => {\n            this.processingQueue.push({\n                handler,\n                name,\n                reject,\n                resolve,\n                type: 'local'\n            }, 1 // Process local requests first\n            );\n        });\n    }\n    process(action, changes, cb) {\n        this.processingQueue.push({\n            action,\n            cb,\n            changes,\n            type: 'remote'\n        }, 2 // Process remote requests second\n        );\n    }\n    start(opts, next) {\n        this._log('error', 'Can not start base sessions');\n        this.end('unsupported-applications', true);\n    }\n    accept(opts, next) {\n        this._log('error', 'Can not accept base sessions');\n        this.end('unsupported-applications');\n    }\n    cancel() {\n        this.end('cancel');\n    }\n    decline() {\n        this.end('decline');\n    }\n    end(reason = 'success', silent = false) {\n        this.state = 'ended';\n        this.processingQueue.kill();\n        if (typeof reason === 'string') {\n            reason = {\n                condition: reason\n            };\n        }\n        if (!silent) {\n            this.send('session-terminate', {\n                reason\n            });\n        }\n        this.parent.emit('terminated', this, reason);\n        this.parent.forgetSession(this);\n    }\n    _log(level, message, ...data) {\n        if (this.parent) {\n            message = this.sid + ': ' + message;\n            this.parent.emit('log:' + level, message, ...data);\n        }\n    }\n    onSessionInitiate(changes, cb) {\n        cb();\n    }\n    onSessionAccept(changes, cb) {\n        cb();\n    }\n    onSessionTerminate(changes, cb) {\n        this.end(changes.reason, true);\n        cb();\n    }\n    // It is mandatory to reply to a session-info action with\n    // an unsupported-info error if the info isn't recognized.\n    //\n    // However, a session-info action with no associated payload\n    // is acceptable (works like a ping).\n    onSessionInfo(changes, cb) {\n        if (!changes.info) {\n            cb();\n        }\n        else {\n            cb(unsupportedInfo);\n        }\n    }\n    // It is mandatory to reply to a security-info action with\n    // an unsupported-info error if the info isn't recognized.\n    onSecurityInfo(changes, cb) {\n        cb(unsupportedInfo);\n    }\n    // It is mandatory to reply to a description-info action with\n    // an unsupported-info error if the info isn't recognized.\n    onDescriptionInfo(changes, cb) {\n        cb(unsupportedInfo);\n    }\n    // It is mandatory to reply to a transport-info action with\n    // an unsupported-info error if the info isn't recognized.\n    onTransportInfo(changes, cb) {\n        cb(unsupportedInfo);\n    }\n    // It is mandatory to reply to a content-add action with either\n    // a content-accept or content-reject.\n    onContentAdd(changes, cb) {\n        // Allow ack for the content-add to be sent.\n        cb();\n        this.send(JingleAction.ContentReject, {\n            reason: {\n                condition: JingleReasonCondition.FailedApplication,\n                text: 'content-add is not supported'\n            }\n        });\n    }\n    onContentAccept(changes, cb) {\n        cb(badRequest);\n    }\n    onContentReject(changes, cb) {\n        cb(badRequest);\n    }\n    onContentModify(changes, cb) {\n        cb(badRequest);\n    }\n    onContentRemove(changes, cb) {\n        cb(badRequest);\n    }\n    // It is mandatory to reply to a transport-add action with either\n    // a transport-accept or transport-reject.\n    onTransportReplace(changes, cb) {\n        // Allow ack for the transport-replace be sent.\n        cb();\n        this.send(JingleAction.TransportReject, {\n            reason: {\n                condition: JingleReasonCondition.FailedTransport,\n                text: 'transport-replace is not supported'\n            }\n        });\n    }\n    onTransportAccept(changes, cb) {\n        cb(badRequest);\n    }\n    onTransportReject(changes, cb) {\n        cb(badRequest);\n    }\n}\n\nclass ICESession extends JingleSession {\n    constructor(opts) {\n        super(opts);\n        this.transportType = NS_JINGLE_ICE_UDP_1;\n        this.pc = new RTCPeerConnection(Object.assign(Object.assign({}, opts.config), { iceServers: opts.iceServers }), opts.constraints);\n        this.pc.addEventListener('iceconnectionstatechange', () => {\n            this.onIceStateChange();\n        });\n        this.pc.addEventListener('icecandidate', e => {\n            if (e.candidate) {\n                this.onIceCandidate(e);\n            }\n            else {\n                this.onIceEndOfCandidates();\n            }\n        });\n        this.restrictRelayBandwidth();\n        this.bitrateLimit = 0;\n        this.maxRelayBandwidth = opts.maxRelayBandwidth;\n        this.candidateBuffer = [];\n        this.restartingIce = false;\n    }\n    end(reason = 'success', silent = false) {\n        this.pc.close();\n        super.end(reason, silent);\n    }\n    /* actually do an ice restart */\n    restartIce() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // only initiators do an ice-restart to avoid conflicts.\n            if (!this.isInitiator) {\n                return;\n            }\n            if (this._maybeRestartingIce !== undefined) {\n                clearTimeout(this._maybeRestartingIce);\n            }\n            this.restartingIce = true;\n            try {\n                yield this.processLocal('restart-ice', () => __awaiter(this, void 0, void 0, function* () {\n                    const offer = yield this.pc.createOffer({ iceRestart: true });\n                    // extract new ufrag / pwd, send transport-info with just that.\n                    const json = importFromSDP(offer.sdp);\n                    this.send(JingleAction.TransportInfo, {\n                        contents: json.media.map(media => ({\n                            creator: JingleSessionRole.Initiator,\n                            name: media.mid,\n                            transport: convertIntermediateToTransport(media, this.transportType)\n                        })),\n                        sid: this.sid\n                    });\n                    yield this.pc.setLocalDescription(offer);\n                }));\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC offer', err);\n                this.end(JingleReasonCondition.FailedTransport, true);\n            }\n        });\n    }\n    // set the maximum bitrate. Only supported in Chrome and Firefox right now.\n    setMaximumBitrate(maximumBitrate) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.maximumBitrate) {\n                // potentially take into account bandwidth restrictions due to using TURN.\n                maximumBitrate = Math.min(maximumBitrate, this.maximumBitrate);\n            }\n            this.currentBitrate = maximumBitrate;\n            if (!(window.RTCRtpSender &&\n                'getParameters' in window.RTCRtpSender.prototype)) {\n                return;\n            }\n            // changes the maximum bandwidth using RTCRtpSender.setParameters.\n            const sender = this.pc.getSenders().find(s => !!s.track && s.track.kind === 'video');\n            if (!sender) {\n                return;\n            }\n            let browser = '';\n            if (window.navigator && window.navigator.mozGetUserMedia) {\n                browser = 'firefox';\n            }\n            else if (window.navigator && window.navigator.webkitGetUserMedia) {\n                browser = 'chrome';\n            }\n            const parameters = sender.getParameters();\n            if (browser === 'firefox' && !parameters.encodings) {\n                parameters.encodings = [{}];\n            }\n            if (maximumBitrate === 0) {\n                delete parameters.encodings[0].maxBitrate;\n            }\n            else {\n                if (!parameters.encodings.length) {\n                    parameters.encodings[0] = {};\n                }\n                parameters.encodings[0].maxBitrate = maximumBitrate;\n            }\n            try {\n                yield this.processLocal('set-bitrate', () => __awaiter(this, void 0, void 0, function* () {\n                    if (browser === 'chrome') {\n                        yield sender.setParameters(parameters);\n                    }\n                    else if (browser === 'firefox') {\n                        // Firefox needs renegotiation:\n                        // https://bugzilla.mozilla.org/show_bug.cgi?id=1253499\n                        // but we do not want to intefere with our queue so we\n                        // just hope this gets picked up.\n                        if (this.pc.signalingState !== 'stable') {\n                            yield sender.setParameters(parameters);\n                        }\n                        else if (this.pc.localDescription &&\n                            this.pc.localDescription.type === 'offer') {\n                            yield sender.setParameters(parameters);\n                            const offer = yield this.pc.createOffer();\n                            yield this.pc.setLocalDescription(offer);\n                            yield this.pc.setRemoteDescription(this.pc.remoteDescription);\n                            yield this.processBufferedCandidates();\n                        }\n                        else if (this.pc.localDescription &&\n                            this.pc.localDescription.type === 'answer') {\n                            yield sender.setParameters(parameters);\n                            yield this.pc.setRemoteDescription(this.pc.remoteDescription);\n                            yield this.processBufferedCandidates();\n                            const answer = yield this.pc.createAnswer();\n                            yield this.pc.setLocalDescription(answer);\n                        }\n                    }\n                }));\n            }\n            catch (err) {\n                this._log('error', 'setParameters failed', err);\n            }\n        });\n    }\n    // ----------------------------------------------------------------\n    // Jingle action handers\n    // ----------------------------------------------------------------\n    onTransportInfo(changes, cb) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (changes.contents &&\n                changes.contents[0] &&\n                changes.contents[0].transport.gatheringComplete) {\n                try {\n                    if (this.pc.signalingState === 'stable') {\n                        yield this.pc.addIceCandidate(null);\n                    }\n                    else {\n                        this.candidateBuffer.push(null);\n                    }\n                }\n                catch (err) {\n                    this._log('debug', 'Could not add null ICE candidate');\n                }\n                finally {\n                    cb();\n                }\n                return;\n            }\n            // detect an ice restart.\n            if (this.pc.remoteDescription) {\n                const remoteDescription = this.pc.remoteDescription;\n                const remoteJSON = importFromSDP(remoteDescription.sdp);\n                const remoteMedia = remoteJSON.media.find(m => m.mid === changes.contents[0].name);\n                const currentUsernameFragment = remoteMedia.iceParameters.usernameFragment;\n                const remoteUsernameFragment = changes.contents[0].transport\n                    .usernameFragment;\n                if (remoteUsernameFragment && currentUsernameFragment !== remoteUsernameFragment) {\n                    changes.contents.forEach((content, idx) => {\n                        const transport = content.transport;\n                        remoteJSON.media[idx].iceParameters = {\n                            password: transport.password,\n                            usernameFragment: transport.usernameFragment\n                        };\n                        remoteJSON.media[idx].candidates = [];\n                    });\n                    if (remoteDescription.type === 'offer') {\n                        try {\n                            yield this.pc.setRemoteDescription(remoteDescription);\n                            yield this.processBufferedCandidates();\n                            const answer = yield this.pc.createAnswer();\n                            const json = importFromSDP(answer.sdp);\n                            this.send(JingleAction.TransportInfo, {\n                                contents: json.media.map(media => ({\n                                    creator: JingleSessionRole.Initiator,\n                                    name: media.mid,\n                                    transport: convertIntermediateToTransport(media, this.transportType)\n                                })),\n                                sid: this.sid\n                            });\n                            yield this.pc.setLocalDescription(answer);\n                            cb();\n                        }\n                        catch (err) {\n                            this._log('error', 'Could not do remote ICE restart', err);\n                            cb(err);\n                            this.end(JingleReasonCondition.FailedTransport);\n                        }\n                        return;\n                    }\n                    try {\n                        yield this.pc.setRemoteDescription(remoteDescription);\n                        yield this.processBufferedCandidates();\n                        cb();\n                    }\n                    catch (err) {\n                        this._log('error', 'Could not do local ICE restart', err);\n                        cb(err);\n                        this.end(JingleReasonCondition.FailedTransport);\n                    }\n                }\n            }\n            const all = (changes.contents || []).map(content => {\n                const sdpMid = content.name;\n                const results = (content.transport.candidates || []).map((json) => __awaiter(this, void 0, void 0, function* () {\n                    const candidate = writeCandidate(convertCandidateToIntermediate(json));\n                    let sdpMLineIndex;\n                    // workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1456417\n                    const remoteSDP = this.pc.remoteDescription.sdp;\n                    const mediaSections = getMediaSections(remoteSDP);\n                    for (let i = 0; i < mediaSections.length; i++) {\n                        if (getMid(mediaSections[i]) === sdpMid) {\n                            sdpMLineIndex = i;\n                            break;\n                        }\n                    }\n                    if (this.pc.signalingState === 'stable') {\n                        try {\n                            yield this.pc.addIceCandidate({ sdpMid, sdpMLineIndex, candidate });\n                        }\n                        catch (err) {\n                            this._log('error', 'Could not add ICE candidate', err);\n                        }\n                    }\n                    else {\n                        this.candidateBuffer.push({ sdpMid, sdpMLineIndex, candidate });\n                    }\n                }));\n                return Promise.all(results);\n            });\n            try {\n                yield Promise.all(all);\n                cb();\n            }\n            catch (err) {\n                cb(err);\n            }\n        });\n    }\n    onSessionAccept(changes, cb) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.state = 'active';\n            const json = convertRequestToIntermediate(changes, this.peerRole);\n            const sdp = exportToSDP(json);\n            try {\n                yield this.pc.setRemoteDescription({ type: 'answer', sdp });\n                yield this.processBufferedCandidates();\n                this.parent.emit('accepted', this, undefined);\n                cb();\n            }\n            catch (err) {\n                this._log('error', `Could not process WebRTC answer: ${err}`);\n                cb({ condition: 'general-error' });\n            }\n        });\n    }\n    onSessionTerminate(changes, cb) {\n        this._log('info', 'Terminating session');\n        this.pc.close();\n        super.end(changes.reason, true);\n        cb();\n    }\n    // ----------------------------------------------------------------\n    // ICE action handers\n    // ----------------------------------------------------------------\n    onIceCandidate(e) {\n        if (!e.candidate.candidate) {\n            return;\n        }\n        const candidate = parseCandidate(e.candidate.candidate);\n        const jingle = convertIntermediateToTransportInfo(e.candidate.sdpMid, candidate, this.transportType);\n        /* monkeypatch ufrag in Firefox */\n        jingle.contents.forEach((content, idx) => {\n            const transport = content.transport;\n            if (!transport.usernameFragment) {\n                const json = importFromSDP(this.pc.localDescription.sdp);\n                transport.usernameFragment = json.media[idx].iceParameters.usernameFragment;\n            }\n        });\n        this._log('info', 'Discovered new ICE candidate', jingle);\n        this.send(JingleAction.TransportInfo, jingle);\n    }\n    onIceEndOfCandidates() {\n        this._log('info', 'ICE end of candidates');\n        const json = importFromSDP(this.pc.localDescription.sdp);\n        const firstMedia = json.media[0];\n        // signal end-of-candidates with our first media mid/ufrag\n        this.send(JingleAction.TransportInfo, {\n            contents: [\n                {\n                    creator: JingleSessionRole.Initiator,\n                    name: firstMedia.mid,\n                    transport: {\n                        gatheringComplete: true,\n                        transportType: this.transportType,\n                        usernameFragment: firstMedia.iceParameters.usernameFragment\n                    }\n                }\n            ]\n        });\n    }\n    onIceStateChange() {\n        switch (this.pc.iceConnectionState) {\n            case 'checking':\n                this.connectionState = 'connecting';\n                break;\n            case 'completed':\n            case 'connected':\n                this.connectionState = 'connected';\n                this.restartingIce = false;\n                break;\n            case 'disconnected':\n                if (this.pc.signalingState === 'stable') {\n                    this.connectionState = 'interrupted';\n                }\n                else {\n                    this.connectionState = 'disconnected';\n                }\n                if (this.restartingIce) {\n                    this.end(JingleReasonCondition.FailedTransport);\n                    return;\n                }\n                this.maybeRestartIce();\n                break;\n            case 'failed':\n                if (this.connectionState === 'failed' || this.restartingIce) {\n                    this.end(JingleReasonCondition.FailedTransport);\n                    return;\n                }\n                this.connectionState = 'failed';\n                this.restartIce();\n                break;\n            case 'closed':\n                this.connectionState = 'disconnected';\n                if (this.restartingIce) {\n                    this.end(JingleReasonCondition.FailedTransport);\n                }\n                else {\n                    this.end();\n                }\n                break;\n        }\n    }\n    processBufferedCandidates() {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const candidate of this.candidateBuffer) {\n                try {\n                    yield this.pc.addIceCandidate(candidate);\n                }\n                catch (err) {\n                    this._log('error', 'Could not add ICE candidate', err);\n                }\n            }\n            this.candidateBuffer = [];\n        });\n    }\n    /* when using TURN, we might want to restrict the bandwidth\n     * to the value specified by MAX_RELAY_BANDWIDTH\n     * in order to prevent sending excessive traffic through\n     * the TURN server.\n     */\n    restrictRelayBandwidth() {\n        if (!(window.RTCRtpSender &&\n            'getParameters' in window.RTCRtpSender.prototype)) {\n            return;\n        }\n        this.pc.addEventListener('iceconnectionstatechange', () => __awaiter(this, void 0, void 0, function* () {\n            if (this.pc.iceConnectionState !== 'completed' &&\n                this.pc.iceConnectionState !== 'connected') {\n                return;\n            }\n            if (this._firstTimeConnected) {\n                return;\n            }\n            this._firstTimeConnected = true;\n            const stats = yield this.pc.getStats();\n            let activeCandidatePair;\n            stats.forEach(report => {\n                if (report.type === 'transport') {\n                    activeCandidatePair = stats.get(report.selectedCandidatePairId);\n                }\n            });\n            // Fallback for Firefox.\n            if (!activeCandidatePair) {\n                stats.forEach(report => {\n                    if (report.type === 'candidate-pair' && report.selected) {\n                        activeCandidatePair = report;\n                    }\n                });\n            }\n            if (activeCandidatePair) {\n                let isRelay = false;\n                if (activeCandidatePair.remoteCandidateId) {\n                    const remoteCandidate = stats.get(activeCandidatePair.remoteCandidateId);\n                    if (remoteCandidate && remoteCandidate.candidateType === 'relay') {\n                        isRelay = true;\n                    }\n                }\n                if (activeCandidatePair.localCandidateId) {\n                    const localCandidate = stats.get(activeCandidatePair.localCandidateId);\n                    if (localCandidate && localCandidate.candidateType === 'relay') {\n                        isRelay = true;\n                    }\n                }\n                if (isRelay) {\n                    this.maximumBitrate = this.maxRelayBandwidth;\n                    if (this.currentBitrate) {\n                        this.setMaximumBitrate(Math.min(this.currentBitrate, this.maximumBitrate));\n                    }\n                }\n            }\n        }));\n    }\n    /* determine whether an ICE restart is in order\n     * when transitioning to disconnected. Strategy is\n     * 'wait 2 seconds for things to repair themselves'\n     * 'maybe check if bytes are sent/received' by comparing\n     *   getStats measurements\n     */\n    maybeRestartIce() {\n        // only initiators do an ice-restart to avoid conflicts.\n        if (!this.isInitiator) {\n            return;\n        }\n        if (this._maybeRestartingIce !== undefined) {\n            clearTimeout(this._maybeRestartingIce);\n        }\n        this._maybeRestartingIce = setTimeout(() => {\n            delete this._maybeRestartingIce;\n            if (this.pc.iceConnectionState === 'disconnected') {\n                this.restartIce();\n            }\n        }, 2000);\n    }\n}\n\nclass Sender extends EventEmitter {\n    constructor(opts = {}) {\n        super();\n        this.config = Object.assign({ chunkSize: 16384, hash: 'sha-1' }, opts);\n        this.file = undefined;\n        this.channel = undefined;\n        this.hash = createHash(this.config.hash);\n    }\n    send(file, channel) {\n        if (this.file && this.channel) {\n            return;\n        }\n        this.file = file;\n        this.channel = channel;\n        this.channel.binaryType = 'arraybuffer';\n        const fileReader = new FileReader();\n        let offset = 0;\n        let pendingRead = false;\n        fileReader.addEventListener('load', (event) => {\n            const data = event.target.result;\n            pendingRead = false;\n            offset += data.byteLength;\n            this.channel.send(data);\n            this.hash.update(new Uint8Array(data));\n            this.emit('progress', offset, file.size, data);\n            if (offset < file.size) {\n                if (this.channel.bufferedAmount <= this.channel.bufferedAmountLowThreshold) {\n                    sliceFile();\n                }\n                // Otherwise wait for bufferedamountlow event to trigger reading more data\n            }\n            else {\n                this.emit('progress', file.size, file.size, null);\n                this.emit('sentFile', {\n                    algorithm: this.config.hash,\n                    name: file.name,\n                    size: file.size,\n                    value: this.hash.digest()\n                });\n            }\n        });\n        const sliceFile = () => {\n            if (pendingRead || offset >= file.size) {\n                return;\n            }\n            pendingRead = true;\n            const slice = file.slice(offset, offset + this.config.chunkSize);\n            fileReader.readAsArrayBuffer(slice);\n        };\n        channel.bufferedAmountLowThreshold = 8 * this.config.chunkSize;\n        channel.onbufferedamountlow = () => {\n            sliceFile();\n        };\n        sliceFile();\n    }\n}\nclass Receiver extends EventEmitter {\n    constructor(opts = {}) {\n        super();\n        this.config = Object.assign({ hash: 'sha-1' }, opts);\n        this.receiveBuffer = [];\n        this.received = 0;\n        this.channel = undefined;\n        this.hash = createHash(this.config.hash);\n    }\n    receive(metadata, channel) {\n        this.metadata = metadata;\n        this.channel = channel;\n        this.channel.binaryType = 'arraybuffer';\n        this.channel.onmessage = e => {\n            const len = e.data.byteLength;\n            this.received += len;\n            this.receiveBuffer.push(e.data);\n            if (e.data) {\n                this.hash.update(new Uint8Array(e.data));\n            }\n            this.emit('progress', this.received, this.metadata.size, e.data);\n            if (this.received === this.metadata.size) {\n                this.metadata.actualhash = this.hash.digest('hex');\n                this.emit('receivedFile', new Blob(this.receiveBuffer), this.metadata);\n                this.receiveBuffer = [];\n            }\n            else if (this.received > this.metadata.size) {\n                // FIXME\n                console.error('received more than expected, discarding...');\n                this.receiveBuffer = []; // just discard...\n            }\n        };\n    }\n}\nclass FileTransferSession extends ICESession {\n    constructor(opts) {\n        super(opts);\n        this.sender = undefined;\n        this.receiver = undefined;\n        this.file = undefined;\n    }\n    start(file, next) {\n        return __awaiter(this, void 0, void 0, function* () {\n            next = next || (() => undefined);\n            if (!file || typeof file === 'function') {\n                throw new Error('File object required');\n            }\n            this.state = 'pending';\n            this.role = 'initiator';\n            this.file = file;\n            this.sender = new Sender();\n            this.sender.on('progress', (sent, size) => {\n                this._log('info', 'Send progress ' + sent + '/' + size);\n            });\n            this.sender.on('sentFile', meta => {\n                this._log('info', 'Sent file', meta.name);\n                this.send(JingleAction.SessionInfo, {\n                    info: {\n                        creator: JingleSessionRole.Initiator,\n                        file: {\n                            hashes: [\n                                {\n                                    algorithm: meta.algorithm,\n                                    value: meta.value\n                                }\n                            ]\n                        },\n                        infoType: JINGLE_INFO_CHECKSUM_5,\n                        name: this.contentName\n                    }\n                });\n                this.parent.emit('sentFile', this, meta);\n            });\n            this.channel = this.pc.createDataChannel('filetransfer', {\n                ordered: true\n            });\n            this.channel.onopen = () => {\n                this.sender.send(this.file, this.channel);\n            };\n            try {\n                yield this.processLocal(JingleAction.SessionInitiate, () => __awaiter(this, void 0, void 0, function* () {\n                    const offer = yield this.pc.createOffer({\n                        offerToReceiveAudio: false,\n                        offerToReceiveVideo: false\n                    });\n                    const json = importFromSDP(offer.sdp);\n                    const jingle = convertIntermediateToRequest(json, this.role, this.transportType);\n                    this.contentName = jingle.contents[0].name;\n                    jingle.sid = this.sid;\n                    jingle.action = JingleAction.SessionInitiate;\n                    jingle.contents[0].application = {\n                        applicationType: NS_JINGLE_FILE_TRANSFER_5,\n                        file: {\n                            date: file.lastModified ? new Date(file.lastModified) : undefined,\n                            hashesUsed: [\n                                {\n                                    algorithm: 'sha-1'\n                                }\n                            ],\n                            name: file.name,\n                            size: file.size\n                        }\n                    };\n                    this.send('session-initiate', jingle);\n                    yield this.pc.setLocalDescription(offer);\n                }));\n                next();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC offer', err);\n                return this.end('failed-application', true);\n            }\n        });\n    }\n    accept(next) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Accepted incoming session');\n            this.role = 'responder';\n            this.state = 'active';\n            next = next || (() => undefined);\n            try {\n                yield this.processLocal(JingleAction.SessionAccept, () => __awaiter(this, void 0, void 0, function* () {\n                    const answer = yield this.pc.createAnswer();\n                    const json = importFromSDP(answer.sdp);\n                    const jingle = convertIntermediateToRequest(json, this.role, this.transportType);\n                    jingle.sid = this.sid;\n                    jingle.action = 'session-accept';\n                    jingle.contents.forEach(content => {\n                        content.creator = 'initiator';\n                    });\n                    this.contentName = jingle.contents[0].name;\n                    this.send('session-accept', jingle);\n                    yield this.pc.setLocalDescription(answer);\n                }));\n                next();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC answer', err);\n                this.end('failed-application');\n            }\n        });\n    }\n    onSessionInitiate(changes, cb) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Initiating incoming session');\n            this.role = 'responder';\n            this.state = 'pending';\n            this.transportType = changes.contents[0].transport.transportType;\n            const json = convertRequestToIntermediate(changes, this.peerRole);\n            const sdp = exportToSDP(json);\n            const desc = changes.contents[0].application;\n            const hashes = desc.file.hashesUsed ? desc.file.hashesUsed : desc.file.hashes || [];\n            this.receiver = new Receiver({ hash: hashes[0] && hashes[0].algorithm });\n            this.receiver.on('progress', (received, size) => {\n                this._log('info', 'Receive progress ' + received + '/' + size);\n            });\n            this.receiver.on('receivedFile', file => {\n                this.receivedFile = file;\n                this._maybeReceivedFile();\n            });\n            this.receiver.metadata = desc.file;\n            this.pc.addEventListener('datachannel', e => {\n                this.channel = e.channel;\n                this.receiver.receive(this.receiver.metadata, e.channel);\n            });\n            try {\n                yield this.pc.setRemoteDescription({ type: 'offer', sdp });\n                yield this.processBufferedCandidates();\n                cb();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC answer', err);\n                cb({ condition: 'general-error' });\n            }\n        });\n    }\n    onSessionInfo(changes, cb) {\n        const info = changes.info;\n        if (!info || !info.file || !info.file.hashes) {\n            return;\n        }\n        this.receiver.metadata.hashes = info.file.hashes;\n        if (this.receiver.metadata.actualhash) {\n            this._maybeReceivedFile();\n        }\n        cb();\n    }\n    _maybeReceivedFile() {\n        if (!this.receiver.metadata.hashes || !this.receiver.metadata.hashes.length) {\n            // unknown hash, file transfer not completed\n            return;\n        }\n        for (const hash of this.receiver.metadata.hashes || []) {\n            if (hash.value && hash.value.toString('hex') === this.receiver.metadata.actualhash) {\n                this._log('info', 'File hash matches');\n                this.parent.emit('receivedFile', this, this.receivedFile, this.receiver.metadata);\n                this.end('success');\n                return;\n            }\n        }\n        this._log('error', 'File hash does not match');\n        this.end('media-error');\n    }\n}\n\nfunction applyStreamsCompatibility(content) {\n    const application = content.application;\n    /* signal .streams as a=ssrc: msid */\n    if (application.streams &&\n        application.streams.length &&\n        application.sources &&\n        application.sources.length) {\n        const msid = application.streams[0];\n        application.sources[0].parameters.msid = `${msid.id} ${msid.track}`;\n        if (application.sourceGroups && application.sourceGroups.length > 0) {\n            application.sources.push({\n                parameters: {\n                    cname: application.sources[0].parameters.cname,\n                    msid: `${msid.id} ${msid.track}`\n                },\n                ssrc: application.sourceGroups[0].sources[1]\n            });\n        }\n    }\n}\nclass MediaSession extends ICESession {\n    constructor(opts) {\n        super(opts);\n        this._ringing = false;\n        this.pc.addEventListener('track', (e) => {\n            this.onAddTrack(e.track, e.streams[0]);\n        });\n        if (opts.stream) {\n            for (const track of opts.stream.getTracks()) {\n                this.addTrack(track, opts.stream);\n            }\n        }\n    }\n    get ringing() {\n        return this._ringing;\n    }\n    set ringing(value) {\n        if (value !== this._ringing) {\n            this._ringing = value;\n        }\n    }\n    get streams() {\n        if (this.pc.signalingState !== 'closed') {\n            return this.pc.getRemoteStreams();\n        }\n        return [];\n    }\n    // ----------------------------------------------------------------\n    // Session control methods\n    // ----------------------------------------------------------------\n    start(opts, next) {\n        return __awaiter(this, arguments, void 0, function* () {\n            this.state = 'pending';\n            if (arguments.length === 1 && typeof opts === 'function') {\n                next = opts;\n                opts = {};\n            }\n            next = next || (() => undefined);\n            opts = opts || {};\n            this.role = 'initiator';\n            this.offerOptions = opts;\n            try {\n                yield this.processLocal(JingleAction.SessionInitiate, () => __awaiter(this, void 0, void 0, function* () {\n                    const offer = yield this.pc.createOffer(opts);\n                    const json = importFromSDP(offer.sdp);\n                    const jingle = convertIntermediateToRequest(json, this.role, this.transportType);\n                    jingle.sid = this.sid;\n                    jingle.action = JingleAction.SessionInitiate;\n                    for (const content of jingle.contents || []) {\n                        content.creator = 'initiator';\n                        applyStreamsCompatibility(content);\n                    }\n                    yield this.pc.setLocalDescription(offer);\n                    this.send('session-initiate', jingle);\n                }));\n                next();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC offer', err);\n                this.end('failed-application', true);\n            }\n        });\n    }\n    accept(opts, next) {\n        return __awaiter(this, arguments, void 0, function* () {\n            // support calling with accept(next) or accept(opts, next)\n            if (arguments.length === 1 && typeof opts === 'function') {\n                next = opts;\n                opts = {};\n            }\n            next = next || (() => undefined);\n            opts = opts || {};\n            this._log('info', 'Accepted incoming session');\n            this.state = 'active';\n            this.role = 'responder';\n            try {\n                yield this.processLocal(JingleAction.SessionAccept, () => __awaiter(this, void 0, void 0, function* () {\n                    const answer = yield this.pc.createAnswer(opts);\n                    const json = importFromSDP(answer.sdp);\n                    const jingle = convertIntermediateToRequest(json, this.role, this.transportType);\n                    jingle.sid = this.sid;\n                    jingle.action = JingleAction.SessionAccept;\n                    for (const content of jingle.contents || []) {\n                        content.creator = 'initiator';\n                    }\n                    yield this.pc.setLocalDescription(answer);\n                    this.send('session-accept', jingle);\n                }));\n                next();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC answer', err);\n                this.end('failed-application');\n            }\n        });\n    }\n    end(reason = 'success', silent = false) {\n        for (const receiver of this.pc.getReceivers()) {\n            this.onRemoveTrack(receiver.track);\n        }\n        super.end(reason, silent);\n    }\n    ring() {\n        return this.processLocal('ring', () => __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Ringing on incoming session');\n            this.ringing = true;\n            this.send(JingleAction.SessionInfo, {\n                info: {\n                    infoType: JINGLE_INFO_RINGING\n                }\n            });\n        }));\n    }\n    mute(creator, name) {\n        return this.processLocal('mute', () => __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Muting', name);\n            this.send(JingleAction.SessionInfo, {\n                info: {\n                    creator,\n                    infoType: JINGLE_INFO_MUTE,\n                    name\n                }\n            });\n        }));\n    }\n    unmute(creator, name) {\n        return this.processLocal('unmute', () => __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Unmuting', name);\n            this.send(JingleAction.SessionInfo, {\n                info: {\n                    creator,\n                    infoType: JINGLE_INFO_UNMUTE,\n                    name\n                }\n            });\n        }));\n    }\n    hold() {\n        return this.processLocal('hold', () => __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Placing on hold');\n            this.send('session-info', {\n                info: {\n                    infoType: JINGLE_INFO_HOLD\n                }\n            });\n        }));\n    }\n    resume() {\n        return this.processLocal('resume', () => __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Resuming from hold');\n            this.send('session-info', {\n                info: {\n                    infoType: JINGLE_INFO_ACTIVE\n                }\n            });\n        }));\n    }\n    // ----------------------------------------------------------------\n    // Track control methods\n    // ----------------------------------------------------------------\n    addTrack(track, stream, cb) {\n        return this.processLocal('addtrack', () => __awaiter(this, void 0, void 0, function* () {\n            if (this.pc.addTrack) {\n                this.pc.addTrack(track, stream);\n            }\n            else {\n                this.pc.addStream(stream);\n            }\n            if (cb) {\n                cb();\n            }\n        }));\n    }\n    removeTrack(sender, cb) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this.processLocal('removetrack', () => __awaiter(this, void 0, void 0, function* () {\n                this.pc.removeTrack(sender);\n                if (cb) {\n                    return cb();\n                }\n            }));\n        });\n    }\n    // ----------------------------------------------------------------\n    // Track event handlers\n    // ----------------------------------------------------------------\n    onAddTrack(track, stream) {\n        this._log('info', 'Track added');\n        this.parent.emit('peerTrackAdded', this, track, stream);\n    }\n    onRemoveTrack(track) {\n        this._log('info', 'Track removed');\n        this.parent.emit('peerTrackRemoved', this, track);\n    }\n    // ----------------------------------------------------------------\n    // Jingle action handers\n    // ----------------------------------------------------------------\n    onSessionInitiate(changes, cb) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this._log('info', 'Initiating incoming session');\n            this.state = 'pending';\n            this.role = 'responder';\n            this.transportType = changes.contents[0].transport.transportType;\n            const json = convertRequestToIntermediate(changes, this.peerRole);\n            json.media.forEach(media => {\n                if (!media.streams) {\n                    media.streams = [{ stream: 'legacy', track: media.kind }];\n                }\n            });\n            const sdp = exportToSDP(json);\n            try {\n                yield this.pc.setRemoteDescription({ type: 'offer', sdp });\n                yield this.processBufferedCandidates();\n                return cb();\n            }\n            catch (err) {\n                this._log('error', 'Could not create WebRTC answer', err);\n                return cb({ condition: 'general-error' });\n            }\n        });\n    }\n    onSessionTerminate(changes, cb) {\n        for (const receiver of this.pc.getReceivers()) {\n            this.onRemoveTrack(receiver.track);\n        }\n        super.onSessionTerminate(changes, cb);\n    }\n    onSessionInfo(changes, cb) {\n        const info = changes.info || { infoType: '' };\n        switch (info.infoType) {\n            case JINGLE_INFO_RINGING:\n                this._log('info', 'Outgoing session is ringing');\n                this.ringing = true;\n                this.parent.emit('ringing', this);\n                return cb();\n            case JINGLE_INFO_HOLD:\n                this._log('info', 'On hold');\n                this.parent.emit('hold', this);\n                return cb();\n            case JINGLE_INFO_UNHOLD:\n            case JINGLE_INFO_ACTIVE:\n                this._log('info', 'Resuming from hold');\n                this.parent.emit('resumed', this);\n                return cb();\n            case JINGLE_INFO_MUTE:\n                this._log('info', 'Muting', info);\n                this.parent.emit('mute', this, info);\n                return cb();\n            case JINGLE_INFO_UNMUTE:\n                this._log('info', 'Unmuting', info);\n                this.parent.emit('unmute', this, info);\n                return cb();\n            default:\n        }\n        return cb();\n    }\n}\n\nconst MAX_RELAY_BANDWIDTH = 768 * 1024; // maximum bandwidth used via TURN.\nclass SessionManager extends EventEmitter {\n    constructor(conf = {}) {\n        super();\n        conf = conf || {};\n        this.selfID = conf.selfID;\n        this.sessions = {};\n        this.peers = {};\n        this.iceServers = conf.iceServers || [{ urls: 'stun:stun.l.google.com:19302' }];\n        this.prepareSession =\n            conf.prepareSession ||\n                (opts => {\n                    if (opts.applicationTypes.indexOf(NS_JINGLE_RTP_1) >= 0) {\n                        return new MediaSession(opts);\n                    }\n                    if (opts.applicationTypes.indexOf(NS_JINGLE_FILE_TRANSFER_5) >= 0) {\n                        return new FileTransferSession(opts);\n                    }\n                });\n        this.performTieBreak =\n            conf.performTieBreak ||\n                ((sess, req) => {\n                    const applicationTypes = (req.jingle.contents || []).map(content => {\n                        if (content.application) {\n                            return content.application.applicationType;\n                        }\n                    });\n                    const intersection = (sess.pendingApplicationTypes || []).filter(appType => applicationTypes.includes(appType));\n                    return intersection.length > 0;\n                });\n        this.config = Object.assign({ debug: false, peerConnectionConfig: {\n                bundlePolicy: conf.bundlePolicy || 'balanced',\n                iceTransportPolicy: conf.iceTransportPolicy || 'all',\n                rtcpMuxPolicy: conf.rtcpMuxPolicy || 'require',\n                sdpSemantics: conf.sdpSemantics || 'plan-b'\n            }, peerConnectionConstraints: {\n                optional: [{ DtlsSrtpKeyAgreement: true }, { RtpDataChannels: false }]\n            } }, conf);\n    }\n    addICEServer(server) {\n        if (typeof server === 'string') {\n            server = { urls: server };\n        }\n        this.iceServers.push(server);\n    }\n    resetICEServers() {\n        this.iceServers = [];\n    }\n    addSession(session) {\n        session.parent = this;\n        const sid = session.sid;\n        const peer = session.peerID;\n        this.sessions[sid] = session;\n        if (!this.peers[peer]) {\n            this.peers[peer] = [];\n        }\n        this.peers[peer].push(session);\n        this.emit('createdSession', session);\n        return session;\n    }\n    forgetSession(session) {\n        const peers = this.peers[session.peerID] || [];\n        if (peers.length) {\n            peers.splice(peers.indexOf(session), 1);\n        }\n        delete this.sessions[session.sid];\n    }\n    createMediaSession(peer, sid, stream) {\n        const session = new MediaSession({\n            config: this.config.peerConnectionConfig,\n            constraints: this.config.peerConnectionConstraints,\n            iceServers: this.iceServers,\n            initiator: true,\n            maxRelayBandwidth: MAX_RELAY_BANDWIDTH,\n            parent: this,\n            peerID: peer,\n            sid,\n            stream\n        });\n        this.addSession(session);\n        return session;\n    }\n    createFileTransferSession(peer, sid) {\n        const session = new FileTransferSession({\n            config: this.config.peerConnectionConfig,\n            constraints: this.config.peerConnectionConstraints,\n            iceServers: this.iceServers,\n            initiator: true,\n            maxRelayBandwidth: MAX_RELAY_BANDWIDTH,\n            parent: this,\n            peerID: peer,\n            sid\n        });\n        this.addSession(session);\n        return session;\n    }\n    endPeerSessions(peer, reason, silent = false) {\n        const sessions = this.peers[peer] || [];\n        delete this.peers[peer];\n        sessions.forEach(session => {\n            session.end(reason || 'gone', silent);\n        });\n    }\n    endAllSessions(reason, silent = false) {\n        Object.keys(this.peers).forEach(peer => {\n            this.endPeerSessions(peer, reason, silent);\n        });\n    }\n    process(req) {\n        const self = this;\n        // Extract the request metadata that we need to verify\n        const sid = !!req.jingle ? req.jingle.sid : undefined;\n        let session = sid ? this.sessions[sid] : undefined;\n        const rid = req.id;\n        const sender = req.from;\n        if (!sender) {\n            return;\n        }\n        if (req.type === 'error') {\n            const isTieBreak = req.error && req.error.jingleError === 'tie-break';\n            if (session && session.state === 'pending' && isTieBreak) {\n                return session.end('alternative-session', true);\n            }\n            else {\n                if (session) {\n                    session.pendingAction = undefined;\n                }\n                return;\n            }\n        }\n        if (req.type === 'result') {\n            if (session) {\n                session.pendingAction = undefined;\n            }\n            return;\n        }\n        const action = req.jingle.action;\n        const contents = req.jingle.contents || [];\n        const applicationTypes = contents.map(content => {\n            return content.application ? content.application.applicationType : undefined;\n        });\n        const transportTypes = contents.map(content => {\n            return content.transport ? content.transport.transportType : undefined;\n        });\n        // Now verify that we are allowed to actually process the\n        // requested action\n        if (action !== JingleAction.SessionInitiate) {\n            // Can't modify a session that we don't have.\n            if (!session) {\n                if (action === 'session-terminate') {\n                    this.emit('send', {\n                        id: rid,\n                        to: sender,\n                        type: 'result'\n                    });\n                    return;\n                }\n                this._log('error', 'Unknown session', sid);\n                return this._sendError(sender, rid, {\n                    condition: 'item-not-found',\n                    jingleError: 'unknown-session'\n                });\n            }\n            // Check if someone is trying to hijack a session.\n            if (session.peerID !== sender || session.state === 'ended') {\n                this._log('error', 'Session has ended, or action has wrong sender');\n                return this._sendError(sender, rid, {\n                    condition: 'item-not-found',\n                    jingleError: 'unknown-session'\n                });\n            }\n            // Can't accept a session twice\n            if (action === 'session-accept' && session.state !== 'pending') {\n                this._log('error', 'Tried to accept session twice', sid);\n                return this._sendError(sender, rid, {\n                    condition: 'unexpected-request',\n                    jingleError: 'out-of-order'\n                });\n            }\n            // Can't process two requests at once, need to tie break\n            if (action !== 'session-terminate' && action === session.pendingAction) {\n                this._log('error', 'Tie break during pending request');\n                if (session.isInitiator) {\n                    return this._sendError(sender, rid, {\n                        condition: 'conflict',\n                        jingleError: 'tie-break'\n                    });\n                }\n            }\n        }\n        else if (session) {\n            // Don't accept a new session if we already have one.\n            if (session.peerID !== sender) {\n                this._log('error', 'Duplicate sid from new sender');\n                return this._sendError(sender, rid, {\n                    condition: 'service-unavailable'\n                });\n            }\n            // Check if we need to have a tie breaker because both parties\n            // happened to pick the same random sid.\n            if (session.state === 'pending') {\n                if (this.selfID &&\n                    this.selfID > session.peerID &&\n                    this.performTieBreak(session, req)) {\n                    this._log('error', 'Tie break new session because of duplicate sids');\n                    return this._sendError(sender, rid, {\n                        condition: 'conflict',\n                        jingleError: 'tie-break'\n                    });\n                }\n            }\n            else {\n                // The other side is just doing it wrong.\n                this._log('error', 'Someone is doing this wrong');\n                return this._sendError(sender, rid, {\n                    condition: 'unexpected-request',\n                    jingleError: 'out-of-order'\n                });\n            }\n        }\n        else if (this.peers[sender] && this.peers[sender].length) {\n            // Check if we need to have a tie breaker because we already have\n            // a different session with this peer that is using the requested\n            // content application types.\n            for (let i = 0, len = this.peers[sender].length; i < len; i++) {\n                const sess = this.peers[sender][i];\n                if (sess &&\n                    sess.state === 'pending' &&\n                    sid &&\n                    octetCompare(sess.sid, sid) > 0 &&\n                    this.performTieBreak(sess, req)) {\n                    this._log('info', 'Tie break session-initiate');\n                    return this._sendError(sender, rid, {\n                        condition: 'conflict',\n                        jingleError: 'tie-break'\n                    });\n                }\n            }\n        }\n        // We've now weeded out invalid requests, so we can process the action now.\n        if (action === 'session-initiate') {\n            if (!contents.length) {\n                return self._sendError(sender, rid, {\n                    condition: 'bad-request'\n                });\n            }\n            session = this._createIncomingSession({\n                applicationTypes,\n                config: this.config.peerConnectionConfig,\n                constraints: this.config.peerConnectionConstraints,\n                iceServers: this.iceServers,\n                initiator: false,\n                parent: this,\n                peerID: sender,\n                sid,\n                transportTypes\n            }, req);\n        }\n        session.process(action, req.jingle, (err) => {\n            if (err) {\n                this._log('error', 'Could not process request', req, err);\n                this._sendError(sender, rid, err);\n            }\n            else {\n                this.emit('send', {\n                    id: rid,\n                    to: sender,\n                    type: 'result'\n                });\n                // Wait for the initial action to be processed before emitting\n                // the session for the user to accept/reject.\n                if (action === 'session-initiate') {\n                    this.emit('incoming', session);\n                }\n            }\n        });\n    }\n    signal(session, data) {\n        const action = data.jingle && data.jingle.action;\n        if (session.isInitiator && action === JingleAction.SessionInitiate) {\n            this.emit('outgoing', session);\n        }\n        this.emit('send', data);\n    }\n    _createIncomingSession(meta, req) {\n        let session;\n        if (this.prepareSession) {\n            session = this.prepareSession(meta, req);\n        }\n        // Fallback to a generic session type, which can\n        // only be used to end the session.\n        if (!session) {\n            session = new JingleSession(meta);\n        }\n        this.addSession(session);\n        return session;\n    }\n    _sendError(to, id, data) {\n        if (!data.type) {\n            data.type = 'cancel';\n        }\n        this.emit('send', {\n            error: data,\n            id,\n            to,\n            type: 'error'\n        });\n    }\n    _log(level, message, ...args) {\n        this.emit('log:' + level, message, ...args);\n    }\n}\n\n\n\nvar index$2 = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    Session: JingleSession,\n    ICESession: ICESession,\n    MediaSession: MediaSession,\n    FileSession: FileTransferSession,\n    SessionManager: SessionManager\n});\n\nlet root$1;\ntry {\n    root$1 = window;\n}\ncatch (err) {\n    root$1 = global;\n}\nfunction Jingle (client) {\n    const jingle = (client.jingle = new SessionManager());\n    client.disco.addFeature(NS_JINGLE_1);\n    if (root$1.RTCPeerConnection) {\n        const caps = [\n            NS_JINGLE_RTP_1,\n            NS_JINGLE_RTP_RTCP_FB_0,\n            NS_JINGLE_RTP_HDREXT_0,\n            NS_JINGLE_RTP_SSMA_0,\n            NS_JINGLE_DTLS_0,\n            NS_JINGLE_GROUPING_0,\n            NS_JINGLE_ICE_0,\n            NS_JINGLE_ICE_UDP_1,\n            NS_JINGLE_RTP_AUDIO,\n            NS_JINGLE_RTP_VIDEO,\n            NS_JINGLE_FILE_TRANSFER_3,\n            NS_JINGLE_DTLS_SCTP_1,\n            'urn:ietf:rfc:3264',\n            'urn:ietf:rfc:5576',\n            'urn:ietf:rfc:5888'\n        ];\n        for (const cap of caps) {\n            client.disco.addFeature(cap);\n        }\n    }\n    const mappedEvents = [\n        'outgoing',\n        'incoming',\n        'accepted',\n        'terminated',\n        'ringing',\n        'mute',\n        'unmute',\n        'hold',\n        'resumed'\n    ];\n    for (const event of mappedEvents) {\n        jingle.on(event, (session, data) => {\n            client.emit(('jingle:' + event), session, data);\n        });\n    }\n    jingle.on('createdSession', data => {\n        client.emit('jingle:created', data);\n    });\n    jingle.on('send', (data) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            if (data.type === 'set') {\n                const resp = yield client.sendIQ(data);\n                if (!resp.jingle) {\n                    resp.jingle = {};\n                }\n                resp.jingle.sid = data.jingle.sid;\n                jingle.process(resp);\n            }\n            if (data.type === 'result') {\n                client.sendIQResult({ type: 'set', id: data.id, from: data.to }, data);\n            }\n            if (data.type === 'error') {\n                client.sendIQError({ type: 'set', id: data.id, from: data.to }, data);\n            }\n        }\n        catch (err) {\n            console.error(err);\n            if (!err.jingle) {\n                err.jingle = {};\n            }\n            err.jingle.sid = data.jingle.sid;\n            jingle.process(err);\n        }\n    }));\n    client.on('session:bound', (jid) => {\n        jingle.selfID = jid;\n    });\n    client.on('iq:set:jingle', (data) => {\n        jingle.process(data);\n    });\n    client.on('unavailable', (pres) => {\n        jingle.endPeerSessions(pres.from, undefined, true);\n    });\n    client.getServices = (jid, type) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            externalServices: {\n                type\n            },\n            to: jid,\n            type: 'get'\n        });\n        const services = resp.externalServices;\n        services.services = services.services || [];\n        return services;\n    });\n    client.getServiceCredentials = (jid, host, type, port) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            externalServiceCredentials: {\n                host,\n                port,\n                type\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.externalServiceCredentials;\n    });\n    client.discoverICEServers = () => __awaiter(this, void 0, void 0, function* () {\n        try {\n            const resp = yield client.getServices(client.config.server);\n            const services = resp.services || [];\n            const discovered = [];\n            for (const service of services) {\n                const ice = {\n                    urls: []\n                };\n                const baseUrl = `${service.type}:${service.host}`;\n                const port = service.port ? `:${service.port}` : '';\n                const transport = service.transport ? `?transport=${service.transport}` : '';\n                if (service.type === 'stun' || service.type === 'stuns') {\n                    ice.urls = [`${baseUrl}${port}`];\n                }\n                if (service.type === 'turn' || service.type === 'turns') {\n                    if (service.username) {\n                        ice.username = service.username;\n                    }\n                    if (service.password) {\n                        ice.credential = service.password;\n                    }\n                    ice.urls = [`${baseUrl}${port}${transport}`];\n                }\n                if (ice.urls.length) {\n                    discovered.push(ice);\n                }\n            }\n            for (const ice of discovered) {\n                client.jingle.addICEServer(ice);\n            }\n            return discovered;\n        }\n        catch (err) {\n            return [];\n        }\n    });\n}\n\nfunction mergeFields(original, updated) {\n    const merged = [];\n    const mappedUpdates = new Map();\n    for (const field of updated) {\n        if (field.name) {\n            mappedUpdates.set(field.name, field);\n        }\n    }\n    const usedUpdates = new Set();\n    // Update any existing fields with new values.\n    for (const field of original) {\n        if (field.name && mappedUpdates.has(field.name)) {\n            merged.push(Object.assign(Object.assign({}, field), mappedUpdates.get(field.name)));\n            usedUpdates.add(field.name);\n        }\n        else {\n            merged.push(Object.assign({}, field));\n        }\n    }\n    // Append any brand new fields to the list\n    for (const field of updated) {\n        if (!field.name || (field.name && !usedUpdates.has(field.name))) {\n            merged.push(Object.assign({}, field));\n        }\n    }\n    return merged;\n}\n\nfunction MAM (client) {\n    client.getHistorySearchForm = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const res = yield client.sendIQ({\n            archive: {\n                type: 'query'\n            },\n            to: jid,\n            type: 'get'\n        });\n        return res.archive.form;\n    });\n    client.searchHistory = (jidOrOpts, opts = {}) => __awaiter(this, void 0, void 0, function* () {\n        const queryid = client.nextId();\n        let jid = '';\n        if (typeof jidOrOpts === 'string') {\n            jid = jidOrOpts;\n        }\n        else {\n            jid = jidOrOpts.to || '';\n            opts = jidOrOpts;\n        }\n        opts.queryId = queryid;\n        const form = opts.form || {};\n        form.type = 'submit';\n        const fields = form.fields || [];\n        const defaultFields = [\n            {\n                name: 'FORM_TYPE',\n                type: 'hidden',\n                value: NS_MAM_2\n            }\n        ];\n        if (opts.with) {\n            defaultFields.push({\n                name: 'with',\n                type: 'text-single',\n                value: opts.with\n            });\n        }\n        if (opts.start) {\n            defaultFields.push({\n                name: 'start',\n                type: 'text-single',\n                value: opts.start.toISOString()\n            });\n        }\n        if (opts.end) {\n            defaultFields.push({\n                name: 'end',\n                type: 'text-single',\n                value: opts.end.toISOString()\n            });\n        }\n        form.fields = mergeFields(defaultFields, fields);\n        opts.form = form;\n        const allowed = allowedResponders(client.jid, jid);\n        const results = [];\n        const collector = (msg) => {\n            if (allowed.has(msg.from) && msg.archive && msg.archive.queryId === queryid) {\n                results.push(msg.archive);\n            }\n        };\n        client.on('mam:item', collector);\n        try {\n            const resp = yield client.sendIQ({\n                archive: opts,\n                id: queryid,\n                to: jid,\n                type: 'set'\n            });\n            return Object.assign(Object.assign({}, resp.archive), { results });\n        }\n        finally {\n            client.off('mam:item', collector);\n        }\n    });\n    client.getHistoryPreferences = () => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            archive: {\n                type: 'preferences'\n            },\n            type: 'get'\n        });\n        return resp.archive;\n    });\n    client.setHistoryPreferences = (opts) => {\n        return client.sendIQ({\n            archive: Object.assign({ type: 'preferences' }, opts),\n            type: 'set'\n        });\n    };\n    client.on('message', msg => {\n        if (msg.archive) {\n            client.emit('mam:item', msg);\n        }\n    });\n}\n\nconst ACK_TYPES = new Set(['chat', 'headline', 'normal']);\nconst ALLOWED_CHAT_STATE_TYPES = new Set(['chat', 'groupchat', 'normal']);\nconst isReceivedCarbon = (msg) => !!msg.carbon && msg.carbon.type === 'received';\nconst isSentCarbon = (msg) => !!msg.carbon && msg.carbon.type === 'sent';\nconst isChatState = (msg) => !!msg.chatState;\nconst isReceiptMessage = (msg) => !!msg.receipt;\nconst hasRTT = (msg) => !!msg.rtt;\nconst isCorrection = (msg) => !!msg.replace;\nconst isMarkable = (msg, client) => msg.marker && msg.marker.type === 'markable' && client.config.chatMarkers !== false;\nconst isFormsMessage = (msg) => !!msg.forms && msg.forms.length > 0;\nfunction toggleCarbons(client, action) {\n    return __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            carbons: {\n                action\n            },\n            type: 'set'\n        });\n    });\n}\nfunction sendMarker(client, msg, marker) {\n    if (isMarkable(msg, client)) {\n        const to = msg.type === 'groupchat' ? toBare(msg.from) : msg.from;\n        client.sendMessage({\n            body: '',\n            marker: {\n                id: msg.id,\n                type: marker\n            },\n            to,\n            type: msg.type\n        });\n    }\n}\nfunction Messaging (client) {\n    client.disco.addFeature(NS_ATTENTION_0);\n    client.disco.addFeature(NS_CHAT_MARKERS_0);\n    client.disco.addFeature(NS_CHAT_STATES);\n    client.disco.addFeature(NS_CORRECTION_0);\n    client.disco.addFeature(NS_RECEIPTS);\n    client.disco.addFeature(NS_RTT_0);\n    client.enableCarbons = () => toggleCarbons(client, 'enable');\n    client.disableCarbons = () => toggleCarbons(client, 'disable');\n    client.markReceived = (msg) => sendMarker(client, msg, 'received');\n    client.markDisplayed = (msg) => sendMarker(client, msg, 'displayed');\n    client.markAcknowledged = (msg) => sendMarker(client, msg, 'acknowledged');\n    client.getAttention = (jid, opts = {}) => {\n        return client.sendMessage(Object.assign(Object.assign({}, opts), { requestingAttention: true, to: jid, type: 'headline' }));\n    };\n    client.on('message', msg => {\n        if (msg.carbon && equalBare(msg.from, client.jid)) {\n            const forwardedMessage = msg.carbon.forward.message;\n            if (!forwardedMessage.delay) {\n                forwardedMessage.delay = msg.carbon.forward.delay || {\n                    timestamp: new Date(Date.now())\n                };\n            }\n            if (isReceivedCarbon(msg)) {\n                client.emit('carbon:received', msg);\n                client.emit('message', forwardedMessage);\n            }\n            if (isSentCarbon(msg)) {\n                client.emit('carbon:sent', msg);\n                client.emit('message:sent', forwardedMessage, true);\n            }\n        }\n        if (isFormsMessage(msg)) {\n            client.emit('dataform', msg);\n        }\n        if (msg.requestingAttention) {\n            client.emit('attention', msg);\n        }\n        if (hasRTT(msg)) {\n            client.emit('rtt', msg);\n        }\n        if (isCorrection(msg)) {\n            client.emit('replace', msg);\n        }\n        if (isChatState(msg) && ALLOWED_CHAT_STATE_TYPES.has(msg.type || 'normal')) {\n            client.emit('chat:state', msg);\n        }\n        if (isMarkable(msg, client)) {\n            client.markReceived(msg);\n        }\n        if (msg.marker && msg.marker.type !== 'markable') {\n            client.emit(`marker:${msg.marker.type}`, msg);\n        }\n        if (isReceiptMessage(msg)) {\n            const sendReceipts = client.config.sendReceipts !== false;\n            if (sendReceipts &&\n                ACK_TYPES.has(msg.type || 'normal') &&\n                msg.receipt.type === 'request') {\n                client.sendMessage({\n                    id: msg.id,\n                    receipt: {\n                        id: msg.id,\n                        type: 'received'\n                    },\n                    to: msg.from,\n                    type: msg.type\n                });\n            }\n            if (msg.receipt.type === 'received') {\n                client.emit('receipt', msg);\n            }\n        }\n    });\n}\n\nfunction isMUCPresence(pres) {\n    return !!pres.muc;\n}\nfunction MUC (client) {\n    client.disco.addFeature(NS_MUC);\n    client.disco.addFeature(NS_MUC_DIRECT_INVITE);\n    client.disco.addFeature(NS_HATS_0);\n    client.joinedRooms = new Map();\n    client.joiningRooms = new Map();\n    function rejoinRooms() {\n        const oldJoiningRooms = client.joiningRooms;\n        client.joiningRooms = new Map();\n        for (const [room, nick] of oldJoiningRooms) {\n            client.joinRoom(room, nick);\n        }\n        const oldJoinedRooms = client.joinedRooms;\n        client.joinedRooms = new Map();\n        for (const [room, nick] of oldJoinedRooms) {\n            client.joinRoom(room, nick);\n        }\n    }\n    client.on('session:started', rejoinRooms);\n    client.on('stream:management:resumed', rejoinRooms);\n    client.on('message', msg => {\n        if (msg.type === 'groupchat' && msg.hasSubject) {\n            client.emit('muc:topic', {\n                from: msg.from,\n                room: toBare(msg.from),\n                topic: msg.subject || ''\n            });\n            return;\n        }\n        if (!msg.muc) {\n            return;\n        }\n        if (msg.muc.type === 'direct-invite' || (!msg.muc.invite && msg.legacyMUC)) {\n            const invite = msg.muc.type === 'direct-invite' ? msg.muc : msg.legacyMUC;\n            client.emit('muc:invite', {\n                from: msg.from,\n                password: invite.password,\n                reason: invite.reason,\n                room: invite.jid,\n                thread: invite.thread,\n                type: 'direct'\n            });\n            return;\n        }\n        if (msg.muc.invite) {\n            client.emit('muc:invite', {\n                from: msg.muc.invite[0].from,\n                password: msg.muc.password,\n                reason: msg.muc.invite[0].reason,\n                room: msg.from,\n                thread: msg.muc.invite[0].thread,\n                type: 'mediated'\n            });\n            return;\n        }\n        if (msg.muc.decline) {\n            client.emit('muc:declined', {\n                from: msg.muc.decline.from,\n                reason: msg.muc.decline.reason,\n                room: msg.from\n            });\n            return;\n        }\n        client.emit('muc:other', msg);\n    });\n    client.on('presence', pres => {\n        const room = toBare(pres.from);\n        if (client.joiningRooms.has(room) && pres.type === 'error') {\n            client.joiningRooms.delete(room);\n            client.emit('muc:failed', pres);\n            client.emit('muc:error', pres);\n            return;\n        }\n        if (!isMUCPresence(pres)) {\n            return;\n        }\n        const isSelf = pres.muc.statusCodes && pres.muc.statusCodes.indexOf(MUCStatusCode.SelfPresence) >= 0;\n        if (pres.type === 'error') {\n            client.emit('muc:error', pres);\n            return;\n        }\n        if (pres.type === 'unavailable') {\n            client.emit('muc:unavailable', pres);\n            if (isSelf) {\n                client.emit('muc:leave', pres);\n                client.joinedRooms.delete(room);\n            }\n            if (pres.muc.destroy) {\n                client.emit('muc:destroyed', {\n                    newRoom: pres.muc.destroy.jid,\n                    password: pres.muc.destroy.password,\n                    reason: pres.muc.destroy.reason,\n                    room\n                });\n            }\n            return;\n        }\n        client.emit('muc:available', pres);\n        if (isSelf && !client.joinedRooms.has(room)) {\n            client.emit('muc:join', pres);\n            client.joinedRooms.set(room, getResource(pres.from));\n            client.joiningRooms.delete(room);\n        }\n    });\n    client.joinRoom = (room, nick, opts = {}) => {\n        room = toBare(room);\n        client.joiningRooms.set(room, nick);\n        client.sendPresence(Object.assign(Object.assign({}, opts), { muc: Object.assign(Object.assign({}, opts.muc), { type: 'join' }), to: `${room}/${nick}` }));\n    };\n    client.leaveRoom = (room, nick, opts = {}) => {\n        client.sendPresence(Object.assign(Object.assign({}, opts), { to: `${room}/${nick}`, type: 'unavailable' }));\n    };\n    client.ban = (room, occupantRealJID, reason) => {\n        return client.setRoomAffiliation(room, occupantRealJID, 'outcast', reason);\n    };\n    client.kick = (room, nick, reason) => {\n        return client.setRoomRole(room, nick, 'none', reason);\n    };\n    client.invite = (room, opts = []) => {\n        if (!Array.isArray(opts)) {\n            opts = [opts];\n        }\n        client.sendMessage({\n            muc: {\n                invite: opts,\n                type: 'info'\n            },\n            to: room\n        });\n    };\n    client.directInvite = (room, to, opts = {}) => {\n        client.sendMessage({\n            muc: Object.assign(Object.assign({}, opts), { jid: room, type: 'direct-invite' }),\n            to\n        });\n    };\n    client.declineInvite = (room, sender, reason) => {\n        client.sendMessage({\n            muc: {\n                decline: {\n                    reason,\n                    to: sender\n                },\n                type: 'info'\n            },\n            to: room\n        });\n    };\n    client.changeNick = (room, nick) => {\n        client.sendPresence({\n            to: `${toBare(room)}/${nick}`\n        });\n    };\n    client.setSubject = (room, subject) => {\n        client.sendMessage({\n            subject,\n            to: room,\n            type: 'groupchat'\n        });\n    };\n    client.getReservedNick = (room) => __awaiter(this, void 0, void 0, function* () {\n        try {\n            const info = yield client.getDiscoInfo(room, 'x-roomuser-item');\n            const identity = info.identities[0];\n            if (identity.name) {\n                return identity.name;\n            }\n            else {\n                throw new Error('No nickname reserved');\n            }\n        }\n        catch (err) {\n            throw new Error('No nickname reserved');\n        }\n    });\n    client.requestRoomVoice = (room) => {\n        client.sendMessage({\n            forms: [\n                {\n                    fields: [\n                        {\n                            name: 'FORM_TYPE',\n                            type: 'hidden',\n                            value: 'http://jabber.org/protocol/muc#request'\n                        },\n                        {\n                            name: 'muc#role',\n                            type: 'text-single',\n                            value: 'participant'\n                        }\n                    ],\n                    type: 'submit'\n                }\n            ],\n            to: room\n        });\n    };\n    client.setRoomAffiliation = (room, occupantRealJID, affiliation, reason) => {\n        return client.sendIQ({\n            muc: {\n                type: 'user-list',\n                users: [\n                    {\n                        affiliation,\n                        jid: occupantRealJID,\n                        reason\n                    }\n                ]\n            },\n            to: room,\n            type: 'set'\n        });\n    };\n    client.setRoomRole = (room, nick, role, reason) => {\n        return client.sendIQ({\n            muc: {\n                type: 'user-list',\n                users: [\n                    {\n                        nick,\n                        reason,\n                        role\n                    }\n                ]\n            },\n            to: room,\n            type: 'set'\n        });\n    };\n    client.getRoomMembers = (room, opts = {}) => {\n        return client.sendIQ({\n            muc: {\n                type: 'user-list',\n                users: [opts]\n            },\n            to: room,\n            type: 'get'\n        });\n    };\n    client.getRoomConfig = (room) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield client.sendIQ({\n            muc: {\n                type: 'configure'\n            },\n            to: room,\n            type: 'get'\n        });\n        if (!result.muc.form) {\n            throw new Error('No configuration form returned');\n        }\n        return result.muc.form;\n    });\n    client.configureRoom = (room, form = {}) => {\n        return client.sendIQ({\n            muc: {\n                form: Object.assign(Object.assign({}, form), { type: 'submit' }),\n                type: 'configure'\n            },\n            to: room,\n            type: 'set'\n        });\n    };\n    client.destroyRoom = (room, opts = {}) => {\n        return client.sendIQ({\n            muc: {\n                destroy: opts,\n                type: 'configure'\n            },\n            to: room,\n            type: 'set'\n        });\n    };\n    client.getUniqueRoomName = function (mucHost) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = yield this.sendIQ({\n                muc: {\n                    type: 'unique'\n                },\n                to: mucHost,\n                type: 'get'\n            });\n            if (!result.muc.name) {\n                throw new Error('No unique name returned');\n            }\n            return result.muc.name;\n        });\n    };\n    client.getBookmarks = () => __awaiter(this, void 0, void 0, function* () {\n        const res = yield client.getPrivateData('bookmarks');\n        if (!res || !res.rooms) {\n            return [];\n        }\n        return res.rooms;\n    });\n    client.setBookmarks = (bookmarks) => {\n        return client.setPrivateData('bookmarks', {\n            rooms: bookmarks\n        });\n    };\n    client.addBookmark = (bookmark) => __awaiter(this, void 0, void 0, function* () {\n        const mucs = yield client.getBookmarks();\n        const updated = [];\n        let updatedExisting = false;\n        for (const muc of mucs) {\n            if (equalBare(muc.jid, bookmark.jid)) {\n                updated.push(Object.assign(Object.assign({}, muc), bookmark));\n                updatedExisting = true;\n            }\n            else {\n                updated.push(muc);\n            }\n        }\n        if (!updatedExisting) {\n            updated.push(bookmark);\n        }\n        return client.setBookmarks(updated);\n    });\n    client.removeBookmark = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const existingMucs = yield client.getBookmarks();\n        const updated = existingMucs.filter(muc => {\n            return !equalBare(muc.jid, jid);\n        });\n        return client.setBookmarks(updated);\n    });\n}\n\nfunction PEP (client) {\n    client.disco.addFeature(NS_ACTIVITY);\n    client.disco.addFeature(NS_GEOLOC);\n    client.disco.addFeature(NS_MOOD);\n    client.disco.addFeature(NS_NICK);\n    client.disco.addFeature(NS_TUNE);\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_ACTIVITY));\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_GEOLOC));\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_MOOD));\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_NICK));\n    client.disco.addFeature(NS_PEP_NOTIFY(NS_TUNE));\n    client.publishActivity = (data) => {\n        return client.publish('', NS_ACTIVITY, Object.assign({ itemType: NS_ACTIVITY }, data));\n    };\n    client.publishGeoLoc = (data) => {\n        return client.publish('', NS_GEOLOC, Object.assign({ itemType: NS_GEOLOC }, data));\n    };\n    client.publishMood = (mood) => {\n        return client.publish('', NS_MOOD, Object.assign({ itemType: NS_MOOD }, mood));\n    };\n    client.publishNick = (nick) => {\n        return client.publish('', NS_NICK, {\n            itemType: NS_NICK,\n            nick\n        });\n    };\n    client.publishTune = (tune) => {\n        return client.publish('', NS_TUNE, Object.assign({ itemType: NS_TUNE }, tune));\n    };\n    client.on('pubsub:published', msg => {\n        const content = msg.pubsub.items.published[0].content;\n        switch (msg.pubsub.items.node) {\n            case NS_ACTIVITY:\n                return client.emit('activity', {\n                    activity: content,\n                    jid: msg.from\n                });\n            case NS_GEOLOC:\n                return client.emit('geoloc', {\n                    geoloc: content,\n                    jid: msg.from\n                });\n            case NS_MOOD:\n                return client.emit('mood', {\n                    jid: msg.from,\n                    mood: content\n                });\n            case NS_NICK:\n                return client.emit('nick', {\n                    jid: msg.from,\n                    nick: content.nick\n                });\n            case NS_TUNE:\n                return client.emit('tune', {\n                    jid: msg.from,\n                    tune: msg.pubsub.items.published[0].content\n                });\n        }\n    });\n}\n\nfunction isPubsubMessage(msg) {\n    return !!msg.pubsub;\n}\nfunction isPubsubPublish(msg) {\n    return !!msg.pubsub.items && !!msg.pubsub.items.published;\n}\nfunction isPubsubRetract(msg) {\n    return !!msg.pubsub.items && !!msg.pubsub.items.retracted;\n}\nfunction isPubsubPurge(msg) {\n    return msg.pubsub.eventType === 'purge';\n}\nfunction isPubsubDelete(msg) {\n    return msg.pubsub.eventType === 'purge';\n}\nfunction isPubsubSubscription(msg) {\n    return msg.pubsub.eventType === 'subscription';\n}\nfunction isPubsubConfiguration(msg) {\n    return msg.pubsub.eventType === 'configuration';\n}\nfunction isPubsubAffiliation(msg) {\n    if (!msg.pubsub) {\n        return false;\n    }\n    return (!msg.pubsub.context || msg.pubsub.context === 'user') && !!msg.pubsub.affiliations;\n}\nfunction PubSub (client) {\n    client.disco.addFeature(`${NS_SHIM}#SubID`, NS_SHIM);\n    client.on('message', msg => {\n        if (isPubsubAffiliation(msg)) {\n            client.emit('pubsub:affiliations', msg);\n            return;\n        }\n        if (!isPubsubMessage(msg)) {\n            return;\n        }\n        client.emit('pubsub:event', msg);\n        if (isPubsubPublish(msg)) {\n            client.emit('pubsub:published', msg);\n            return;\n        }\n        if (isPubsubRetract(msg)) {\n            client.emit('pubsub:retracted', msg);\n            return;\n        }\n        if (isPubsubPurge(msg)) {\n            client.emit('pubsub:purged', msg);\n            return;\n        }\n        if (isPubsubDelete(msg)) {\n            client.emit('pubsub:deleted', msg);\n            return;\n        }\n        if (isPubsubSubscription(msg)) {\n            client.emit('pubsub:subscription', msg);\n            return;\n        }\n        if (isPubsubConfiguration(msg)) {\n            client.emit('pubsub:config', msg);\n            return;\n        }\n    });\n    client.subscribeToNode = (jid, opts) => __awaiter(this, void 0, void 0, function* () {\n        const subscribe = {};\n        let form;\n        if (typeof opts === 'string') {\n            subscribe.node = opts;\n            subscribe.jid = toBare(client.jid);\n        }\n        else {\n            subscribe.node = opts.node;\n            subscribe.jid = opts.jid || (opts.useBareJID ? toBare(client.jid) : client.jid);\n            form = opts.options;\n        }\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'user',\n                subscribe,\n                subscriptionOptions: form ? { form } : undefined\n            },\n            to: jid,\n            type: 'set'\n        });\n        const sub = resp.pubsub.subscription || {};\n        if (resp.pubsub.subscriptionOptions) {\n            sub.options = resp.pubsub.subscriptionOptions.form;\n        }\n        return sub;\n    });\n    client.unsubscribeFromNode = (jid, opts) => __awaiter(this, void 0, void 0, function* () {\n        const unsubscribe = {};\n        if (typeof opts === 'string') {\n            unsubscribe.node = opts;\n            unsubscribe.jid = toBare(client.jid);\n        }\n        else {\n            unsubscribe.node = opts.node;\n            unsubscribe.subid = opts.subid;\n            unsubscribe.jid = opts.jid || (opts.useBareJID ? toBare(client.jid) : client.jid);\n        }\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'user',\n                unsubscribe\n            },\n            to: jid,\n            type: 'set'\n        });\n        if (!resp.pubsub || !resp.pubsub.subscription) {\n            return Object.assign(Object.assign({}, unsubscribe), { state: 'none' });\n        }\n        return resp.pubsub.subscription;\n    });\n    client.publish = (jid, node, item, id) => {\n        return client.sendIQ({\n            pubsub: {\n                context: 'user',\n                publish: {\n                    item: {\n                        content: item,\n                        id\n                    },\n                    node\n                }\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.getItem = (jid, node, id) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'user',\n                fetch: {\n                    items: [{ id }],\n                    node\n                }\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.fetch.items[0];\n    });\n    client.getItems = (jid, node, opts = {}) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'user',\n                fetch: {\n                    max: opts.max,\n                    node\n                },\n                paging: opts\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.fetch;\n    });\n    client.retract = (jid, node, id, notify) => {\n        return client.sendIQ({\n            pubsub: {\n                context: 'user',\n                retract: {\n                    id,\n                    node,\n                    notify\n                }\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.purgeNode = (jid, node) => {\n        return client.sendIQ({\n            pubsub: {\n                context: 'owner',\n                purge: node\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.deleteNode = (jid, node, redirect) => {\n        return client.sendIQ({\n            pubsub: {\n                context: 'owner',\n                destroy: {\n                    node,\n                    redirect\n                }\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.createNode = (jid, node, config) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                configure: !!config\n                    ? {\n                        form: config\n                    }\n                    : undefined,\n                context: 'user',\n                create: {\n                    node\n                }\n            },\n            to: jid,\n            type: 'set'\n        });\n        if (!resp.pubsub || !resp.pubsub.create) {\n            return {\n                node\n            };\n        }\n        return resp.pubsub.create;\n    });\n    client.getSubscriptions = (jid, opts = {}) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'user',\n                subscriptions: opts\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.subscriptions;\n    });\n    client.getAffiliations = (jid, node) => {\n        return client.sendIQ({\n            pubsub: {\n                affiliations: {\n                    node\n                }\n            },\n            to: jid,\n            type: 'get'\n        });\n    };\n    client.getNodeSubscribers = (jid, node, opts = {}) => {\n        if (typeof node === 'string') {\n            opts.node = node;\n        }\n        else {\n            opts = Object.assign(Object.assign({}, opts), node);\n        }\n        return client.sendIQ({\n            pubsub: {\n                context: 'owner',\n                subscriptions: opts\n            },\n            to: jid,\n            type: 'get'\n        });\n    };\n    client.updateNodeSubscriptions = (jid, node, delta) => {\n        return client.sendIQ({\n            pubsub: {\n                context: 'owner',\n                subscriptions: {\n                    items: delta,\n                    node\n                }\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.getNodeAffiliations = (jid, node) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                affiliations: {\n                    node\n                },\n                context: 'owner'\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.affiliations;\n    });\n    client.updateNodeAffiliations = (jid, node, items) => {\n        return client.sendIQ({\n            pubsub: {\n                affiliations: {\n                    items,\n                    node\n                },\n                context: 'owner'\n            },\n            to: jid,\n            type: 'set'\n        });\n    };\n    client.getNodeConfig = (jid, node) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                configure: {\n                    node\n                },\n                context: 'owner'\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.configure.form || {};\n    });\n    client.getDefaultNodeConfig = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                context: 'owner',\n                defaultConfiguration: {}\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.defaultConfiguration.form || {};\n    });\n    client.configureNode = (jid, node, config) => __awaiter(this, void 0, void 0, function* () {\n        return client.sendIQ({\n            pubsub: {\n                configure: {\n                    form: config,\n                    node\n                },\n                context: 'owner'\n            },\n            to: jid,\n            type: 'set'\n        });\n    });\n    client.getDefaultSubscriptionOptions = (jid) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            pubsub: {\n                defaultSubscriptionOptions: {}\n            },\n            to: jid,\n            type: 'get'\n        });\n        return resp.pubsub.defaultSubscriptionOptions.form || {};\n    });\n}\n\nfunction Roster (client) {\n    client.on('iq:set:roster', iq => {\n        const allowed = allowedResponders(client.jid);\n        if (!allowed.has(iq.from)) {\n            return client.sendIQError(iq, {\n                error: {\n                    condition: 'service-unavailable',\n                    type: 'cancel'\n                }\n            });\n        }\n        client.emit('roster:update', iq);\n        client.sendIQResult(iq);\n    });\n    client.on('iq:set:blockList', iq => {\n        const blockList = iq.blockList;\n        client.emit(blockList.action, {\n            jids: blockList.jids || []\n        });\n        client.sendIQResult(iq);\n    });\n    client.getRoster = () => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            roster: {\n                version: client.config.rosterVer\n            },\n            type: 'get'\n        });\n        if (resp.roster) {\n            const version = resp.roster.version;\n            if (version) {\n                client.config.rosterVer = version;\n                client.emit('roster:ver', version);\n            }\n            resp.roster.items = resp.roster.items || [];\n            return resp.roster;\n        }\n        else {\n            return { items: [] };\n        }\n    });\n    client.updateRosterItem = (item) => __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            roster: {\n                items: [item]\n            },\n            type: 'set'\n        });\n    });\n    client.removeRosterItem = (jid) => {\n        return client.updateRosterItem({ jid, subscription: 'remove' });\n    };\n    client.subscribe = (jid) => {\n        client.sendPresence({ type: 'subscribe', to: jid });\n    };\n    client.unsubscribe = (jid) => {\n        client.sendPresence({ type: 'unsubscribe', to: jid });\n    };\n    client.acceptSubscription = (jid) => {\n        client.sendPresence({ type: 'subscribed', to: jid });\n    };\n    client.denySubscription = (jid) => {\n        client.sendPresence({ type: 'unsubscribed', to: jid });\n    };\n    client.getBlocked = () => __awaiter(this, void 0, void 0, function* () {\n        const result = yield client.sendIQ({\n            blockList: {\n                action: 'list'\n            },\n            type: 'get'\n        });\n        return Object.assign({ jids: [] }, result.blockList);\n    });\n    function toggleBlock(action, jid) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield client.sendIQ({\n                blockList: {\n                    action,\n                    jids: [jid]\n                },\n                type: 'set'\n            });\n        });\n    }\n    client.block = (jid) => __awaiter(this, void 0, void 0, function* () { return toggleBlock('block', jid); });\n    client.unblock = (jid) => __awaiter(this, void 0, void 0, function* () { return toggleBlock('unblock', jid); });\n    client.goInvisible = (probe = false) => __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            type: 'set',\n            visiblity: {\n                probe,\n                type: 'invisible'\n            }\n        });\n    });\n    client.goVisible = () => __awaiter(this, void 0, void 0, function* () {\n        yield client.sendIQ({\n            type: 'set',\n            visiblity: {\n                type: 'visible'\n            }\n        });\n    });\n}\n\nfunction SASL (client) {\n    client.registerFeature('sasl', 100, (features, done) => __awaiter(this, void 0, void 0, function* () {\n        const mech = client.sasl.createMechanism(features.sasl.mechanisms);\n        const saslHandler = (sasl) => __awaiter(this, void 0, void 0, function* () {\n            if (!mech) {\n                return;\n            }\n            switch (sasl.type) {\n                case 'success': {\n                    client.features.negotiated.sasl = true;\n                    client.off('sasl', saslHandler);\n                    client.emit('auth:success', client.config.credentials);\n                    done('restart');\n                    return;\n                }\n                case 'challenge': {\n                    mech.processChallenge(sasl.value);\n                    try {\n                        const credentials = (yield client.getCredentials());\n                        const resp = mech.createResponse(credentials);\n                        if (resp || resp === '') {\n                            client.send('sasl', {\n                                type: 'response',\n                                value: resp\n                            });\n                        }\n                        else {\n                            client.send('sasl', {\n                                type: 'response'\n                            });\n                        }\n                        const cacheable = mech.getCacheableCredentials();\n                        if (cacheable) {\n                            if (!client.config.credentials) {\n                                client.config.credentials = {};\n                            }\n                            client.config.credentials = Object.assign(Object.assign({}, client.config.credentials), cacheable);\n                            client.emit('credentials:update', client.config.credentials);\n                        }\n                    }\n                    catch (err) {\n                        console.error(err);\n                        client.send('sasl', {\n                            type: 'abort'\n                        });\n                    }\n                    return;\n                }\n                case 'failure':\n                case 'abort': {\n                    client.off('sasl', saslHandler);\n                    client.emit('auth:failed');\n                    done('disconnect', 'authentication failed');\n                    return;\n                }\n            }\n        });\n        if (!mech) {\n            client.off('sasl', saslHandler);\n            client.emit('auth:failed');\n            return done('disconnect', 'authentication failed');\n        }\n        client.on('sasl', saslHandler);\n        client.once('disconnected', () => {\n            client.features.negotiated.sasl = false;\n            client.off('sasl', saslHandler);\n        });\n        try {\n            const credentials = (yield client.getCredentials());\n            client.send('sasl', {\n                mechanism: mech.name,\n                type: 'auth',\n                value: mech.createResponse(credentials)\n            });\n        }\n        catch (err) {\n            console.error(err);\n            client.send('sasl', {\n                type: 'abort'\n            });\n        }\n    }));\n}\n\nfunction Sharing (client) {\n    client.disco.addFeature(NS_BOB);\n    client.getBits = (jid, cid) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield client.sendIQ({\n            bits: {\n                cid\n            },\n            to: jid,\n            type: 'get'\n        });\n        return result.bits;\n    });\n    function getUploadParameters(jid) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const disco = yield client.getDiscoInfo(jid);\n            if (!disco.features || !disco.features.includes(NS_HTTP_UPLOAD_0)) {\n                return;\n            }\n            let maxSize;\n            for (const form of disco.extensions || []) {\n                const fields = form.fields || [];\n                if (fields.some(field => field.name === 'FORM_TYPE' && field.value === NS_HTTP_UPLOAD_0)) {\n                    const sizeField = fields.find(field => field.name === 'max-file-size');\n                    if (sizeField) {\n                        maxSize = parseInt(sizeField.value, 10);\n                    }\n                    return {\n                        jid,\n                        maxSize\n                    };\n                }\n            }\n        });\n    }\n    client.getUploadService = (domain = getDomain(client.jid)) => __awaiter(this, void 0, void 0, function* () {\n        const domainParameters = yield getUploadParameters(domain);\n        if (domainParameters) {\n            return domainParameters;\n        }\n        const disco = yield client.getDiscoItems(domain);\n        for (const item of disco.items || []) {\n            if (!item.jid) {\n                continue;\n            }\n            const itemParameters = yield getUploadParameters(item.jid);\n            if (itemParameters) {\n                return itemParameters;\n            }\n        }\n        throw new Error('No upload service discovered on: ' + domain);\n    });\n    client.getUploadSlot = (uploadService, uploadRequest) => __awaiter(this, void 0, void 0, function* () {\n        const resp = yield client.sendIQ({\n            httpUpload: Object.assign({ type: 'request' }, uploadRequest),\n            to: uploadService,\n            type: 'get'\n        });\n        return resp.httpUpload;\n    });\n}\n\nfunction core(client) {\n    client.use(Features);\n    client.use(Disco$1);\n    client.use(Bind);\n    client.use(Connection);\n    client.use(HostMeta);\n    client.use(SASL);\n}\nfunction Plugins (client) {\n    client.use(Account);\n    client.use(Messaging);\n    client.use(Avatar);\n    client.use(Command);\n    client.use(Entity);\n    client.use(Jingle);\n    client.use(MAM);\n    client.use(MUC);\n    client.use(PEP);\n    client.use(PubSub);\n    client.use(Roster);\n    client.use(Sharing);\n}\n\n// ====================================================================\nconst Protocol = {\n    aliases: ['features.legacySession', 'iq.legacySession'],\n    element: 'session',\n    fields: {\n        // draft-cridland-xmpp-session-01\n        //\n        // The <optional /> child is not yet standardized, but is\n        // still widely deployed to reduce client start times.\n        optional: childBoolean(null, 'optional')\n    },\n    namespace: NS_SESSION\n};\n\n// ====================================================================\nconst _Stream = {\n    defaultType: 'stream',\n    element: 'stream',\n    fields: {\n        from: attribute('from'),\n        id: attribute('id'),\n        lang: languageAttribute(),\n        to: attribute('to'),\n        version: attribute('version')\n    },\n    namespace: NS_STREAM,\n    path: 'stream',\n    type: 'stream',\n    typeField: 'action'\n};\nconst _StreamFeatures = {\n    element: 'features',\n    namespace: NS_STREAM,\n    path: 'features'\n};\nconst _StreamError = {\n    element: 'error',\n    fields: {\n        alternateLanguageText: childAlternateLanguageText(NS_STREAMS, 'text'),\n        condition: childEnum(NS_STREAMS, toList(StreamErrorCondition), StreamErrorCondition.UndefinedCondition),\n        seeOtherHost: childText(NS_STREAMS, StreamErrorCondition.SeeOtherHost),\n        text: childText(NS_STREAMS, 'text')\n    },\n    namespace: NS_STREAM,\n    path: 'streamError'\n};\n// --------------------------------------------------------------------\nconst _StanzaError = Object.values(StreamType).map(streamNS => ({\n    aliases: ['stanzaError', 'message.error', 'presence.error', 'iq.error'],\n    defaultType: NS_CLIENT,\n    element: 'error',\n    fields: {\n        alternateLanguageText: childAlternateLanguageText(NS_STANZAS, 'text'),\n        by: JIDAttribute('by'),\n        condition: childEnum(NS_STANZAS, toList(StanzaErrorCondition), StanzaErrorCondition.UndefinedCondition),\n        gone: childText(NS_STANZAS, StanzaErrorCondition.Gone),\n        redirect: childText(NS_STANZAS, StanzaErrorCondition.Redirect),\n        text: childText(NS_STANZAS, 'text'),\n        type: attribute('type')\n    },\n    namespace: streamNS,\n    type: streamNS,\n    typeField: 'streamType'\n}));\n// --------------------------------------------------------------------\nconst baseIQFields = new Set(['from', 'id', 'lang', 'to', 'type', 'payloadType', 'error']);\nconst _IQ = Object.values(StreamType).map(streamNS => ({\n    defaultType: NS_CLIENT,\n    element: 'iq',\n    fields: {\n        from: JIDAttribute('from'),\n        id: attribute('id'),\n        lang: languageAttribute(),\n        payloadType: {\n            order: -10000,\n            importer(xml, context) {\n                if (context.data.type !== 'get' && context.data.type !== 'set') {\n                    return;\n                }\n                const childCount = xml.children.filter(child => typeof child !== 'string').length;\n                if (childCount !== 1) {\n                    return 'invalid-payload-count';\n                }\n                const extensions = Object.keys(context.data).filter(key => !baseIQFields.has(key));\n                if (extensions.length !== 1) {\n                    return 'unknown-payload';\n                }\n                return extensions[0];\n            }\n        },\n        to: JIDAttribute('to'),\n        type: attribute('type')\n    },\n    namespace: streamNS,\n    path: 'iq',\n    type: streamNS,\n    typeField: 'streamType'\n}));\n// --------------------------------------------------------------------\nconst _Message = Object.values(StreamType).map(streamNS => ({\n    defaultType: NS_CLIENT,\n    element: 'message',\n    fields: {\n        from: JIDAttribute('from'),\n        id: attribute('id'),\n        lang: languageAttribute(),\n        to: JIDAttribute('to')\n    },\n    namespace: streamNS,\n    path: 'message',\n    type: streamNS,\n    typeField: 'streamType'\n}));\n// --------------------------------------------------------------------\nconst _Presence = Object.values(StreamType).map(streamNS => ({\n    defaultType: NS_CLIENT,\n    element: 'presence',\n    fields: {\n        from: JIDAttribute('from'),\n        id: attribute('id'),\n        lang: languageAttribute(),\n        to: JIDAttribute('to')\n    },\n    namespace: streamNS,\n    path: 'presence',\n    type: streamNS,\n    typeField: 'streamType'\n}));\n// --------------------------------------------------------------------\nconst _SASL = [\n    {\n        element: 'mechanisms',\n        fields: {\n            mechanisms: multipleChildText(null, 'mechanism')\n        },\n        namespace: NS_SASL,\n        path: 'features.sasl'\n    },\n    {\n        element: 'abort',\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'abort',\n        typeField: 'type'\n    },\n    {\n        element: 'auth',\n        fields: {\n            mechanism: attribute('mechanism'),\n            value: textBuffer('base64')\n        },\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'auth',\n        typeField: 'type'\n    },\n    {\n        element: 'challenge',\n        fields: {\n            value: textBuffer('base64')\n        },\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'challenge',\n        typeField: 'type'\n    },\n    {\n        element: 'response',\n        fields: {\n            value: textBuffer('base64')\n        },\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'response',\n        typeField: 'type'\n    },\n    {\n        element: 'success',\n        fields: {\n            value: textBuffer('base64')\n        },\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'success',\n        typeField: 'type'\n    },\n    {\n        element: 'failure',\n        fields: {\n            alternateLanguageText: childAlternateLanguageText(NS_SASL, 'text'),\n            condition: childEnum(NS_SASL, toList(SASLFailureCondition)),\n            text: childText(NS_SASL, 'text')\n        },\n        namespace: NS_SASL,\n        path: 'sasl',\n        type: 'failure',\n        typeField: 'type'\n    }\n];\n// --------------------------------------------------------------------\nconst _STARTTLS = [\n    {\n        aliases: ['features.tls'],\n        defaultType: 'start',\n        element: 'starttls',\n        fields: {\n            required: childBoolean(null, 'required')\n        },\n        namespace: NS_STARTTLS,\n        path: 'tls',\n        type: 'start',\n        typeField: 'type'\n    },\n    {\n        element: 'proceed',\n        namespace: NS_STARTTLS,\n        path: 'tls',\n        type: 'proceed',\n        typeField: 'type'\n    },\n    {\n        element: 'failure',\n        namespace: NS_STARTTLS,\n        path: 'tls',\n        type: 'failure',\n        typeField: 'type'\n    }\n];\n// --------------------------------------------------------------------\nconst _Bind = {\n    aliases: ['features.bind', 'iq.bind'],\n    element: 'bind',\n    fields: {\n        jid: childText(null, 'jid'),\n        resource: childText(null, 'resource')\n    },\n    namespace: NS_BIND\n};\n// --------------------------------------------------------------------\nconst Protocol$1 = [\n    _Stream,\n    _StreamFeatures,\n    _StreamError,\n    ..._StanzaError,\n    ..._SASL,\n    ..._STARTTLS,\n    ..._IQ,\n    ..._Message,\n    ..._Presence,\n    _Bind\n];\n\n// ====================================================================\nconst Protocol$2 = [\n    extendStreamFeatures({\n        rosterPreApproval: childBoolean(NS_SUBSCRIPTION_PREAPPROVAL, 'sub'),\n        rosterVersioning: childBoolean(NS_ROSTER_VERSIONING, 'ver')\n    }),\n    extendMessage({\n        alternateLanguageBodies: childAlternateLanguageText(null, 'body'),\n        alternateLanguageSubjects: childAlternateLanguageText(null, 'subject'),\n        body: childText(null, 'body'),\n        hasSubject: childBoolean(null, 'subject'),\n        parentThread: childAttribute(null, 'thread', 'parent'),\n        subject: childText(null, 'subject'),\n        thread: childText(null, 'thread'),\n        type: attribute('type')\n    }),\n    extendPresence({\n        alternateLanguageStatuses: childAlternateLanguageText(null, 'status'),\n        priority: childInteger(null, 'priority', 0),\n        show: childText(null, 'show'),\n        status: childText(null, 'status'),\n        type: attribute('type')\n    }),\n    {\n        element: 'query',\n        fields: {\n            version: attribute('ver', undefined, { emitEmpty: true })\n        },\n        namespace: NS_ROSTER,\n        path: 'iq.roster'\n    },\n    {\n        aliases: [{ path: 'iq.roster.items', multiple: true }],\n        element: 'item',\n        fields: {\n            groups: multipleChildText(null, 'group'),\n            jid: JIDAttribute('jid'),\n            name: attribute('name'),\n            pending: attribute('ask'),\n            preApproved: booleanAttribute('approved'),\n            subscription: attribute('subscription')\n        },\n        namespace: NS_ROSTER\n    }\n];\n\n// ====================================================================\nconst Protocol$3 = [\n    {\n        element: 'open',\n        fields: {\n            from: attribute('from'),\n            id: attribute('id'),\n            lang: languageAttribute(),\n            to: attribute('to'),\n            version: attribute('version')\n        },\n        namespace: NS_FRAMING,\n        path: 'stream',\n        type: 'open'\n    },\n    {\n        element: 'close',\n        fields: {\n            seeOtherURI: attribute('see-other-uri')\n        },\n        namespace: NS_FRAMING,\n        path: 'stream',\n        type: 'close'\n    }\n];\n\n// ====================================================================\nconst Protocol$4 = [\n    {\n        aliases: [{ path: 'message.forms', multiple: true }],\n        element: 'x',\n        fields: {\n            instructions: Object.assign(Object.assign({}, multipleChildText(null, 'instructions')), { exportOrder: 2 }),\n            reported: Object.assign(Object.assign({}, splicePath(null, 'reported', 'dataformField', true)), { exportOrder: 3 }),\n            title: Object.assign(Object.assign({}, childText(null, 'title')), { exportOrder: 1 }),\n            type: attribute('type')\n        },\n        namespace: NS_DATAFORM,\n        optionalNamespaces: {\n            xdv: NS_DATAFORM_VALIDATION\n        },\n        path: 'dataform'\n    },\n    {\n        aliases: [\n            { path: 'dataform.fields', multiple: true },\n            { path: 'dataform.items.fields', multiple: true }\n        ],\n        element: 'field',\n        fields: {\n            description: childText(null, 'desc'),\n            label: attribute('label'),\n            name: attribute('var'),\n            rawValues: Object.assign(Object.assign({}, multipleChildText(null, 'value')), { exporter: () => null }),\n            required: childBoolean(null, 'required'),\n            type: attribute('type'),\n            value: {\n                importer(xml, context) {\n                    const fieldType = xml.getAttribute('type');\n                    const converter = multipleChildText(NS_DATAFORM, 'value');\n                    const rawValues = converter.importer(xml, context);\n                    const singleValue = rawValues[0];\n                    switch (fieldType) {\n                        case DataFormFieldType.TextMultiple:\n                        case DataFormFieldType.ListMultiple:\n                        case DataFormFieldType.JIDMultiple:\n                            return rawValues;\n                        case DataFormFieldType.Hidden:\n                        case DataFormFieldType.Fixed:\n                            if (rawValues.length === 1) {\n                                return singleValue;\n                            }\n                            return rawValues;\n                        case DataFormFieldType.Boolean:\n                            if (singleValue) {\n                                return singleValue === '1' || singleValue === 'true';\n                            }\n                            break;\n                        default:\n                            return singleValue;\n                    }\n                },\n                exporter(xml, data, context) {\n                    const converter = multipleChildText(null, 'value');\n                    let outputData = [];\n                    const rawData = context.data && context.data.rawValues\n                        ? context.data.rawValues[0]\n                        : undefined;\n                    if (typeof data === 'boolean') {\n                        if (rawData === 'true' || rawData === 'false') {\n                            outputData = [rawData];\n                        }\n                        else {\n                            outputData = [data ? '1' : '0'];\n                        }\n                    }\n                    else if (!Array.isArray(data)) {\n                        outputData = [data.toString()];\n                    }\n                    else {\n                        for (const value of data) {\n                            outputData.push(value.toString());\n                        }\n                    }\n                    converter.exporter(xml, outputData, Object.assign({}, context, {\n                        namespace: NS_DATAFORM\n                    }));\n                }\n            }\n        },\n        namespace: NS_DATAFORM,\n        path: 'dataformField'\n    },\n    {\n        aliases: [{ path: 'dataform.fields.options', multiple: true }],\n        element: 'option',\n        fields: {\n            label: attribute('label'),\n            value: childText(null, 'value')\n        },\n        namespace: NS_DATAFORM\n    },\n    {\n        aliases: [{ path: 'dataform.items', multiple: true }],\n        element: 'item',\n        namespace: NS_DATAFORM\n    },\n    // ----------------------------------------------------------------\n    // XEP-0122: Data Forms Validation\n    // ----------------------------------------------------------------\n    {\n        element: 'validate',\n        fields: {\n            listMax: childIntegerAttribute(null, 'list-range', 'max'),\n            listMin: childIntegerAttribute(null, 'list-range', 'min'),\n            method: childEnum(null, ['basic', 'open', 'range', 'regex'], 'basic'),\n            rangeMax: childAttribute(null, 'range', 'max'),\n            rangeMin: childAttribute(null, 'range', 'min'),\n            regex: childText(null, 'regex'),\n            type: attribute('datatype', 'xs:string')\n        },\n        namespace: NS_DATAFORM_VALIDATION,\n        path: 'dataform.fields.validation'\n    }\n];\n\n// ====================================================================\nconst Protocol$5 = [\n    {\n        aliases: ['presence.legacyLastActivity', 'iq.lastActivity'],\n        element: 'query',\n        fields: {\n            seconds: integerAttribute('seconds'),\n            status: text()\n        },\n        namespace: NS_LAST_ACTIVITY\n    }\n];\n\n// ====================================================================\nconst Protocol$6 = [\n    {\n        element: 'query',\n        fields: {\n            activeList: childAttribute(null, 'active', 'name'),\n            defaultList: childAttribute(null, 'default', 'name')\n        },\n        namespace: NS_PRIVACY,\n        path: 'iq.privacy'\n    },\n    {\n        aliases: [{ path: 'iq.privacy.lists', multiple: true }],\n        element: 'list',\n        fields: {\n            name: attribute('name')\n        },\n        namespace: NS_PRIVACY\n    },\n    {\n        aliases: [{ path: 'iq.privacy.lists.items', multiple: true }],\n        element: 'item',\n        fields: {\n            action: attribute('action'),\n            incomingPresence: childBoolean(null, 'presence-in'),\n            iq: childBoolean(null, 'iq'),\n            messages: childBoolean(null, 'message'),\n            order: integerAttribute('order'),\n            outgoingPresence: childBoolean(null, 'presence-out'),\n            type: attribute('type'),\n            value: attribute('value')\n        },\n        namespace: NS_PRIVACY\n    }\n];\n\n// ====================================================================\nconst Protocol$7 = [\n    {\n        aliases: ['iq.disco', 'message.disco', 'features.disco'],\n        childrenExportOrder: {\n            identities: 100\n        },\n        element: 'query',\n        fields: {\n            features: multipleChildAttribute(null, 'feature', 'var'),\n            node: attribute('node')\n        },\n        namespace: NS_DISCO_INFO,\n        path: 'disco',\n        type: 'info',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ path: 'disco.identities', selector: 'info', multiple: true }],\n        element: 'identity',\n        fields: {\n            category: attribute('category'),\n            lang: languageAttribute(),\n            name: attribute('name'),\n            type: attribute('type')\n        },\n        namespace: NS_DISCO_INFO\n    },\n    {\n        aliases: [{ path: 'disco.items', multiple: true, selector: 'items' }],\n        element: 'item',\n        fields: {\n            jid: JIDAttribute('jid'),\n            name: attribute('name'),\n            node: attribute('node')\n        },\n        namespace: NS_DISCO_ITEMS\n    },\n    {\n        aliases: [{ path: 'disco.items', multiple: true, selector: 'info' }],\n        element: 'item',\n        fields: {\n            category: JIDAttribute('category'),\n            lang: languageAttribute(),\n            name: attribute('name'),\n            type: attribute('type')\n        },\n        namespace: NS_DISCO_INFO\n    },\n    addAlias(NS_DATAFORM, 'x', [\n        // XEP-0128\n        { path: 'disco.extensions', multiple: true, selector: 'info' }\n    ]),\n    addAlias(NS_RSM, 'set', [{ path: 'disco.paging', selector: 'items' }]),\n    {\n        aliases: ['iq.disco', 'message.disco', 'features.disco'],\n        element: 'query',\n        fields: {\n            node: attribute('node')\n        },\n        namespace: NS_DISCO_ITEMS,\n        path: 'disco',\n        type: 'items',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$8 = [\n    extendMessage({\n        addresses: splicePath(NS_ADDRESS, 'addresses', 'extendedAddress', true)\n    }),\n    extendPresence({\n        addresses: splicePath(NS_ADDRESS, 'addresses', 'extendedAddress', true)\n    }),\n    {\n        element: 'address',\n        fields: {\n            alternateLanguageDescriptions: childAlternateLanguageText(null, 'desc'),\n            delivered: booleanAttribute('delivered'),\n            description: attribute('desc'),\n            jid: JIDAttribute('jid'),\n            node: attribute('node'),\n            type: attribute('type'),\n            uri: attribute('uri')\n        },\n        namespace: NS_ADDRESS,\n        path: 'extendedAddress'\n    }\n];\n\n// ====================================================================\nconst Protocol$9 = [\n    addAlias(NS_DATAFORM, 'x', [{ path: 'iq.muc.form', selector: 'configure' }]),\n    {\n        defaultType: 'info',\n        element: 'x',\n        fields: {\n            password: childText(null, 'password')\n        },\n        namespace: NS_MUC,\n        path: 'presence.muc',\n        type: 'join',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ path: 'presence.muc.history', selector: 'join' }],\n        element: 'history',\n        fields: {\n            maxCharacters: integerAttribute('maxchars'),\n            maxStanzas: integerAttribute('maxstanzas'),\n            seconds: integerAttribute('seconds'),\n            since: dateAttribute('since')\n        },\n        namespace: NS_MUC\n    },\n    {\n        aliases: ['presence.muc', 'message.muc'],\n        defaultType: 'info',\n        element: 'x',\n        fields: {\n            action: childEnum(null, ['invite', 'decline', 'destroy']),\n            actor: splicePath(null, 'item', 'mucactor'),\n            affiliation: childAttribute(null, 'item', 'affiliation'),\n            jid: childJIDAttribute(null, 'item', 'jid'),\n            nick: childAttribute(null, 'item', 'nick'),\n            password: childText(null, 'password'),\n            reason: deepChildText([\n                { namespace: null, element: 'item' },\n                { namespace: null, element: 'reason' }\n            ]),\n            role: childAttribute(null, 'item', 'role'),\n            statusCodes: multipleChildAttribute(null, 'status', 'code')\n        },\n        namespace: NS_MUC_USER,\n        type: 'info',\n        typeField: 'type',\n        typeOrder: 1\n    },\n    {\n        element: 'actor',\n        fields: {\n            jid: JIDAttribute('jid'),\n            nick: attribute('nick')\n        },\n        namespace: NS_MUC_USER,\n        path: 'mucactor'\n    },\n    {\n        element: 'destroy',\n        fields: {\n            jid: JIDAttribute('jid'),\n            reason: childText(null, 'reason')\n        },\n        namespace: NS_MUC_USER,\n        path: 'presence.muc.destroy'\n    },\n    {\n        aliases: [{ path: 'message.muc.invite', multiple: true }],\n        element: 'invite',\n        fields: {\n            continue: childBoolean(null, 'continue'),\n            from: JIDAttribute('from'),\n            reason: childText(null, 'reason'),\n            thread: childAttribute(null, 'continue', 'thread'),\n            to: JIDAttribute('to')\n        },\n        namespace: NS_MUC_USER\n    },\n    {\n        element: 'decline',\n        fields: {\n            from: JIDAttribute('from'),\n            reason: childText(null, 'reason'),\n            to: JIDAttribute('to')\n        },\n        namespace: NS_MUC_USER,\n        path: 'message.muc',\n        type: 'decline'\n    },\n    {\n        element: 'query',\n        namespace: NS_MUC_ADMIN,\n        path: 'iq.muc',\n        type: 'user-list',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ path: 'iq.muc.users', multiple: true, selector: 'user-list' }],\n        element: 'item',\n        fields: {\n            affiliation: attribute('affiliation'),\n            jid: JIDAttribute('jid'),\n            nick: attribute('nick'),\n            reason: childText(null, 'reason'),\n            role: attribute('role')\n        },\n        namespace: NS_MUC_ADMIN\n    },\n    {\n        aliases: ['iq.muc.users.actor'],\n        element: 'actor',\n        fields: {\n            jid: JIDAttribute('jid'),\n            nick: attribute('nick')\n        },\n        namespace: NS_MUC_ADMIN\n    },\n    {\n        element: 'query',\n        namespace: NS_MUC_OWNER,\n        path: 'iq.muc',\n        type: 'configure',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ path: 'iq.muc.destroy', selector: 'configure' }],\n        element: 'destroy',\n        fields: {\n            jid: JIDAttribute('jid'),\n            password: childText(null, 'password'),\n            reason: childText(null, 'reason')\n        },\n        namespace: NS_MUC_OWNER\n    },\n    // XEP-0249\n    {\n        element: 'x',\n        fields: {\n            action: staticValue('invite'),\n            continue: booleanAttribute('continue'),\n            jid: JIDAttribute('jid'),\n            legacyReason: text(),\n            password: attribute('password'),\n            reason: attribute('reason'),\n            thread: attribute('thread')\n        },\n        namespace: NS_MUC_DIRECT_INVITE,\n        path: 'message.muc',\n        type: 'direct-invite',\n        typeOrder: 2\n    },\n    // XEP-0307\n    {\n        element: 'unique',\n        fields: {\n            name: text()\n        },\n        namespace: NS_MUC_UNIQUE,\n        path: 'iq.muc',\n        type: 'unique'\n    },\n    extendMessage({\n        legacyMUC: {\n            exporter(xml, value, context) {\n                const out = context.registry\n                    ? context.registry.export('message.muc', Object.assign(Object.assign({}, value), { type: 'direct-invite' }))\n                    : undefined;\n                if (out) {\n                    xml.appendChild(out);\n                }\n            },\n            exportOrder: 100001,\n            importer(xml, context) {\n                const mucElement = findAll(xml, NS_MUC_USER, 'x')[0];\n                if (!mucElement) {\n                    return;\n                }\n                const confElement = findAll(xml, NS_MUC_DIRECT_INVITE, 'x')[0];\n                if (!confElement) {\n                    return;\n                }\n                return context.registry\n                    ? context.registry.import(confElement, Object.assign(Object.assign({}, context), { path: 'message' }))\n                    : undefined;\n            },\n            importOrder: -1\n        }\n    })\n];\n\n// ====================================================================\nconst Protocol$a = [\n    {\n        aliases: ['iq.ibb', 'message.ibb'],\n        element: 'open',\n        fields: {\n            ack: {\n                importer(xml, context) {\n                    const stanza = attribute('stanza', 'iq').importer(xml, context);\n                    return stanza !== 'message';\n                },\n                exporter(xml, data, context) {\n                    attribute('stanza').exporter(xml, data ? 'iq' : 'message', context);\n                }\n            },\n            blockSize: integerAttribute('block-size'),\n            sid: attribute('sid')\n        },\n        namespace: NS_IBB,\n        type: 'open',\n        typeField: 'action'\n    },\n    {\n        aliases: ['iq.ibb', 'message.ibb'],\n        element: 'close',\n        fields: {\n            sid: attribute('sid')\n        },\n        namespace: NS_IBB,\n        type: 'close',\n        typeField: 'action'\n    },\n    {\n        aliases: ['iq.ibb', 'message.ibb'],\n        element: 'data',\n        fields: {\n            data: textBuffer('base64'),\n            seq: integerAttribute('seq'),\n            sid: attribute('sid')\n        },\n        namespace: NS_IBB,\n        type: 'data',\n        typeField: 'action'\n    }\n];\n\n// ====================================================================\nconst Protocol$b = [\n    {\n        aliases: [\n            { path: 'bookmarkStorage', impliedType: true },\n            { path: 'iq.privateStorage.bookmarks', impliedType: true },\n            ...pubsubItemContentAliases()\n        ],\n        element: 'storage',\n        namespace: NS_BOOKMARKS,\n        type: NS_BOOKMARKS,\n        typeField: 'itemType'\n    },\n    {\n        aliases: [{ path: 'bookmarkStorage.rooms', multiple: true }],\n        element: 'conference',\n        fields: {\n            autoJoin: booleanAttribute('autojoin'),\n            jid: JIDAttribute('jid'),\n            name: attribute('name'),\n            nick: childText(null, 'nick'),\n            password: childText(null, 'password')\n        },\n        namespace: NS_BOOKMARKS\n    }\n];\n\n// ====================================================================\n// tslint:enable\nconst Protocol$c = {\n    element: 'query',\n    namespace: NS_PRIVATE,\n    path: 'iq.privateStorage'\n};\n\n// ====================================================================\nconst Protocol$d = [\n    addAlias(NS_DATAFORM, 'x', ['iq.command.form']),\n    extendStanzaError({\n        commandError: childEnum(NS_ADHOC_COMMANDS, [\n            'bad-action',\n            'bad-locale',\n            'bad-payload',\n            'bad-sessionid',\n            'malformed-action',\n            'session-expired'\n        ])\n    }),\n    {\n        element: 'command',\n        fields: {\n            action: attribute('action'),\n            node: attribute('node'),\n            sid: attribute('sessionid'),\n            status: attribute('status')\n        },\n        namespace: NS_ADHOC_COMMANDS,\n        path: 'iq.command'\n    },\n    {\n        element: 'actions',\n        fields: {\n            complete: childBoolean(null, 'complete'),\n            execute: attribute('execute'),\n            next: childBoolean(null, 'next'),\n            prev: childBoolean(null, 'prev')\n        },\n        namespace: NS_ADHOC_COMMANDS,\n        path: 'iq.command.availableActions'\n    },\n    {\n        aliases: [{ path: 'iq.command.notes', multiple: true }],\n        element: 'note',\n        fields: {\n            type: attribute('type'),\n            value: text()\n        },\n        namespace: NS_ADHOC_COMMANDS\n    }\n];\n\n// ====================================================================\nconst path = 'vcardTemp.records';\nfunction vcardField(element, type) {\n    return {\n        aliases: [{ multiple: true, path }],\n        element,\n        fields: {\n            value: text()\n        },\n        namespace: NS_VCARD_TEMP,\n        type,\n        typeField: 'type'\n    };\n}\nconst Protocol$e = [\n    {\n        aliases: [{ path: 'iq.vcard' }],\n        defaultType: NS_VCARD_TEMP,\n        element: 'vCard',\n        fields: {\n            fullName: childText(null, 'FN')\n        },\n        namespace: NS_VCARD_TEMP,\n        path: 'vcardTemp',\n        type: NS_VCARD_TEMP,\n        typeField: 'format'\n    },\n    {\n        element: 'N',\n        fields: {\n            additional: Object.assign(Object.assign({}, childText(null, 'MIDDLE')), { order: 3 }),\n            family: Object.assign(Object.assign({}, childText(null, 'FAMILY')), { order: 1 }),\n            given: Object.assign(Object.assign({}, childText(null, 'GIVEN')), { order: 2 }),\n            prefix: Object.assign(Object.assign({}, childText(null, 'PREFIX')), { order: 4 }),\n            suffix: Object.assign(Object.assign({}, childText(null, 'SUFFIX')), { order: 5 })\n        },\n        namespace: NS_VCARD_TEMP,\n        path: 'vcardTemp.name'\n    },\n    vcardField('NICKNAME', 'nickname'),\n    vcardField('BDAY', 'birthday'),\n    vcardField('JABBERID', 'jid'),\n    vcardField('TZ', 'timezone'),\n    vcardField('TITLE', 'title'),\n    vcardField('ROLE', 'role'),\n    vcardField('URL', 'url'),\n    vcardField('NOTE', 'note'),\n    vcardField('SORT-STRING', 'sort'),\n    vcardField('UID', 'uid'),\n    vcardField('REV', 'revision'),\n    vcardField('PRODID', 'productId'),\n    vcardField('DESC', 'description'),\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'EMAIL',\n        fields: {\n            preferred: childBoolean(null, 'PREF'),\n            types: multipleChildEnum(null, [\n                ['home', 'HOME'],\n                ['work', 'WORK'],\n                ['internet', 'INTERNET']\n            ]),\n            value: childText(null, 'USERID')\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'email'\n    },\n    {\n        aliases: [{ path, multiple: true }],\n        element: 'ORG',\n        fields: {\n            units: Object.assign(Object.assign({}, multipleChildText(null, 'ORGUNIT')), { order: 2 }),\n            value: Object.assign(Object.assign({}, childText(null, 'ORGNAME')), { order: 1 })\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'organization',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'ADR',\n        fields: {\n            city: childText(null, 'LOCALITY'),\n            code: childText(null, 'PCODE'),\n            country: childText(null, 'CTRY'),\n            pobox: childText(null, 'POBOX'),\n            preferred: childBoolean(null, 'PREF'),\n            region: childText(null, 'REGION'),\n            street: childText(null, 'STREET'),\n            street2: childText(null, 'EXTADD'),\n            types: multipleChildEnum(null, [\n                ['home', 'HOME'],\n                ['work', 'WORK'],\n                ['domestic', 'DOM'],\n                ['international', 'INTL'],\n                ['postal', 'POSTAL'],\n                ['parcel', 'PARCEL']\n            ])\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'address',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'LABEL',\n        fields: {\n            lines: multipleChildText(null, 'LINE'),\n            preferred: childBoolean(null, 'PREF'),\n            types: multipleChildEnum(null, [['home', 'HOME'], ['work', 'WORK']])\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'addressLabel',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'TEL',\n        fields: {\n            preferred: childBoolean(null, 'PREF'),\n            types: multipleChildEnum(null, [\n                ['home', 'HOME'],\n                ['work', 'WORK'],\n                ['cell', 'CELL'],\n                ['fax', 'FAX'],\n                ['voice', 'VOICE'],\n                ['msg', 'MSG']\n            ]),\n            value: childText(null, 'NUMBER', '')\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'tel',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'PHOTO',\n        fields: {\n            data: childText(null, 'BINVAL'),\n            mediaType: childText(null, 'TYPE'),\n            url: childText(null, 'EXTVAL')\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'photo',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'LOGO',\n        fields: {\n            data: childText(null, 'BINVAL'),\n            mediaType: childText(null, 'TYPE'),\n            url: childText(null, 'EXTVAL')\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'logo',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path }],\n        element: 'CATEGORIES',\n        fields: {\n            value: multipleChildText(null, 'KEYWORD')\n        },\n        namespace: NS_VCARD_TEMP,\n        type: 'categories',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$f = [\n    addAlias(NS_DATAFORM, 'x', ['iq.search.form']),\n    {\n        element: 'query',\n        fields: {\n            email: childText(null, 'email'),\n            familyName: childText(null, 'last'),\n            givenName: childText(null, 'first'),\n            instructions: childText(null, 'instructions'),\n            nick: childText(null, 'nick')\n        },\n        namespace: NS_SEARCH,\n        path: 'iq.search'\n    },\n    {\n        aliases: [{ path: 'iq.search.items', multiple: true }],\n        element: 'item',\n        fields: {\n            email: childText(null, 'email'),\n            familyName: childText(null, 'last'),\n            givenName: childText(null, 'first'),\n            jid: JIDAttribute('jid'),\n            nick: childText(null, 'nick')\n        },\n        namespace: NS_SEARCH\n    }\n];\n\n// ====================================================================\nconst Protocol$g = {\n    aliases: ['iq.pubsub.paging'],\n    element: 'set',\n    fields: {\n        after: childText(null, 'after'),\n        before: childText(null, 'before'),\n        count: childInteger(null, 'count'),\n        first: childText(null, 'first'),\n        firstIndex: childIntegerAttribute(null, 'first', 'index'),\n        index: childInteger(null, 'index'),\n        last: childText(null, 'last'),\n        max: childInteger(null, 'max')\n    },\n    namespace: NS_RSM,\n    path: 'paging'\n};\n\n// ====================================================================\nconst dateOrPresenceAttribute = (name) => ({\n    importer(xml) {\n        const data = xml.getAttribute(name);\n        if (data === 'presence') {\n            return data;\n        }\n        if (data) {\n            return new Date(data);\n        }\n    },\n    exporter(xml, value) {\n        let data;\n        if (typeof value === 'string') {\n            data = value;\n        }\n        else {\n            data = value.toISOString();\n        }\n        xml.setAttribute(name, data);\n    }\n});\nconst SubscriptionFields = {\n    configurable: childBoolean(null, 'subscribe-options'),\n    configurationRequired: deepChildBoolean([\n        { namespace: null, element: 'subscribe-options' },\n        { namespace: null, element: 'required' }\n    ]),\n    jid: JIDAttribute('jid'),\n    node: attribute('node'),\n    state: attribute('subscription'),\n    subid: attribute('subid')\n};\nconst NodeOnlyField = {\n    node: attribute('node')\n};\nconst Protocol$h = [\n    {\n        aliases: ['pubsub', 'iq.pubsub', 'message.pubsub'],\n        childrenExportOrder: {\n            configure: 0,\n            create: 100,\n            publish: 100,\n            subscribe: 100,\n            subscriptionOptions: 0\n        },\n        defaultType: 'user',\n        element: 'pubsub',\n        fields: {\n            publishOptions: splicePath(null, 'publish-options', 'dataform')\n        },\n        namespace: NS_PUBSUB,\n        type: 'user',\n        typeField: 'context'\n    },\n    {\n        aliases: ['pubsub', 'iq.pubsub', 'message.pubsub'],\n        defaultType: 'user',\n        element: 'pubsub',\n        fields: {\n            purge: childAttribute(null, 'purge', 'node')\n        },\n        namespace: NS_PUBSUB_OWNER,\n        type: 'owner',\n        typeField: 'context'\n    },\n    addAlias(NS_DATAFORM, 'x', [\n        'iq.pubsub.configure.form',\n        'iq.pubsub.defaultConfiguration.form',\n        'iq.pubsub.defaultSubscriptionOptions.form',\n        'iq.pubsub.subscriptionOptions.forms',\n        'message.pubsub.configuration.form'\n    ]),\n    addAlias(NS_RSM, 'set', ['iq.pubsub.fetch.paging']),\n    extendStanzaError({\n        pubsubError: childEnum(NS_PUBSUB_ERRORS, toList(PubsubErrorCondition)),\n        pubsubUnsupportedFeature: childAttribute(NS_PUBSUB_ERRORS, 'unsupported', 'feature')\n    }),\n    {\n        element: 'subscribe',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.subscribe'\n    },\n    {\n        element: 'unsubscribe',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node'),\n            subid: attribute('subid')\n        },\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.unsubscribe'\n    },\n    {\n        element: 'options',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node'),\n            subid: attribute('subid')\n        },\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.subscriptionOptions'\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.subscriptions', selector: 'user', impliedType: true }],\n        element: 'subscriptions',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB,\n        type: 'user'\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.subscriptions', selector: 'owner', impliedType: true }],\n        element: 'subscriptions',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB_OWNER,\n        type: 'owner'\n    },\n    {\n        aliases: [\n            'iq.pubsub.subscription',\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.pubsub.subscriptions.items',\n                selector: 'user'\n            }\n        ],\n        element: 'subscription',\n        fields: SubscriptionFields,\n        namespace: NS_PUBSUB\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.pubsub.subscriptions.items',\n                selector: 'owner'\n            }\n        ],\n        element: 'subscription',\n        fields: SubscriptionFields,\n        namespace: NS_PUBSUB_OWNER\n    },\n    {\n        aliases: [\n            { path: 'iq.pubsub.affiliations', selector: 'user', impliedType: true },\n            { path: 'message.pubsub.affiliations', selector: 'user', impliedType: true }\n        ],\n        element: 'affiliations',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB,\n        type: 'user'\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.affiliations', selector: 'owner', impliedType: true }],\n        element: 'affiliations',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB_OWNER,\n        type: 'owner'\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.pubsub.affiliations.items',\n                selector: 'user'\n            },\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'message.pubsub.affiliations.items',\n                selector: 'user'\n            }\n        ],\n        element: 'affiliation',\n        fields: {\n            affiliation: attribute('affiliation'),\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB,\n        type: 'user'\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.pubsub.affiliations.items',\n                selector: 'owner'\n            }\n        ],\n        element: 'affiliation',\n        fields: {\n            affiliation: attribute('affiliation'),\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB_OWNER,\n        type: 'owner'\n    },\n    {\n        element: 'create',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.create'\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.destroy', selector: 'owner' }],\n        element: 'delete',\n        fields: {\n            node: attribute('node'),\n            redirect: childAttribute(null, 'redirect', 'uri')\n        },\n        namespace: NS_PUBSUB_OWNER\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.configure', selector: 'owner', impliedType: true }],\n        element: 'configure',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB_OWNER,\n        type: 'owner'\n    },\n    {\n        aliases: [{ path: 'iq.pubsub.configure', selector: 'user', impliedType: true }],\n        element: 'configure',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB,\n        type: 'user'\n    },\n    {\n        element: 'default',\n        fields: {},\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.defaultSubscriptionOptions'\n    },\n    {\n        element: 'default',\n        fields: {},\n        namespace: NS_PUBSUB_OWNER,\n        path: 'iq.pubsub.defaultConfiguration'\n    },\n    {\n        element: 'publish',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.publish'\n    },\n    {\n        element: 'retract',\n        fields: {\n            id: childAttribute(null, 'item', 'id'),\n            node: attribute('node'),\n            notify: booleanAttribute('notify')\n        },\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.retract'\n    },\n    {\n        element: 'items',\n        fields: {\n            max: integerAttribute('max_items'),\n            node: attribute('node')\n        },\n        namespace: NS_PUBSUB,\n        path: 'iq.pubsub.fetch'\n    },\n    {\n        aliases: [\n            'pubsubitem',\n            'iq.pubsub.publish.item',\n            { multiple: true, path: 'iq.pubsub.fetch.items' }\n        ],\n        element: 'item',\n        fields: {\n            id: attribute('id'),\n            publisher: JIDAttribute('publisher')\n        },\n        namespace: NS_PUBSUB\n    },\n    {\n        element: 'event',\n        fields: {\n            eventType: childEnum(null, [\n                'purge',\n                'delete',\n                'subscription',\n                'configuration',\n                'items'\n            ])\n        },\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub',\n        type: 'event',\n        typeField: 'context'\n    },\n    {\n        aliases: [{ path: 'message.pubsub.items.published', multiple: true }],\n        element: 'item',\n        fields: {\n            id: attribute('id'),\n            publisher: JIDAttribute('publisher')\n        },\n        namespace: NS_PUBSUB_EVENT,\n        path: 'pubsubeventitem'\n    },\n    {\n        element: 'purge',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub.purge'\n    },\n    {\n        element: 'delete',\n        fields: {\n            node: attribute('node'),\n            redirect: childAttribute(null, 'redirect', 'uri')\n        },\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub.delete'\n    },\n    {\n        element: 'subscription',\n        fields: {\n            expires: dateOrPresenceAttribute('expiry'),\n            jid: JIDAttribute('jid'),\n            node: attribute('node'),\n            subid: attribute('subid'),\n            type: attribute('subscription')\n        },\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub.subscription'\n    },\n    {\n        element: 'configuration',\n        fields: NodeOnlyField,\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub.configuration'\n    },\n    {\n        element: 'items',\n        fields: {\n            node: attribute('node'),\n            retracted: multipleChildAttribute(null, 'retracted', 'id')\n        },\n        namespace: NS_PUBSUB_EVENT,\n        path: 'message.pubsub.items'\n    }\n];\n\n// ====================================================================\nconst Protocol$i = [\n    {\n        element: 'query',\n        fields: {\n            activate: childText(null, 'activate'),\n            address: attribute('dstaddr'),\n            candidateUsed: childJIDAttribute(null, 'streamhost-used', 'jid'),\n            mode: attribute('mode', 'tcp'),\n            sid: attribute('sid'),\n            udpSuccess: childAttribute(null, 'udpsuccess', 'dstaddr')\n        },\n        namespace: NS_SOCKS5,\n        path: 'iq.socks5'\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.socks5.candidates'\n            }\n        ],\n        element: 'streamhost',\n        fields: {\n            host: attribute('host'),\n            jid: JIDAttribute('jid'),\n            port: integerAttribute('port'),\n            uri: attribute('uri')\n        },\n        namespace: NS_SOCKS5\n    }\n];\n\n// ====================================================================\nconst Protocol$j = [\n    {\n        aliases: [{ multiple: true, path: 'message.links' }],\n        element: 'x',\n        fields: {\n            description: childText(null, 'desc'),\n            url: childText(null, 'url')\n        },\n        namespace: NS_OOB\n    },\n    {\n        element: 'query',\n        fields: {\n            description: childText(null, 'desc'),\n            url: childText(null, 'url')\n        },\n        namespace: NS_OOB_TRANSFER,\n        path: 'iq.transferLink'\n    }\n];\n\n// ====================================================================\nconst Protocol$k = {\n    element: 'html',\n    fields: {\n        alternateLanguageBodies: childAlternateLanguageRawElement(NS_XHTML, 'body', 'xhtmlim'),\n        body: childLanguageRawElement(NS_XHTML, 'body', 'xhtmlim')\n    },\n    namespace: NS_XHTML_IM,\n    path: 'message.html'\n};\n\n// ====================================================================\nconst Protocol$l = [\n    extendStreamFeatures({\n        inbandRegistration: childBoolean(NS_INBAND_REGISTRATION, 'register')\n    }),\n    addAlias(NS_DATAFORM, 'x', ['iq.account.form']),\n    addAlias(NS_OOB, 'x', ['iq.account.registrationLink']),\n    {\n        element: 'query',\n        fields: {\n            address: childText(null, 'address'),\n            date: childDate(null, 'date'),\n            email: childText(null, 'email'),\n            familyName: childText(null, 'last'),\n            fullName: childText(null, 'name'),\n            givenName: childText(null, 'first'),\n            instructions: childText(null, 'instructions'),\n            key: childText(null, 'key'),\n            locality: childText(null, 'city'),\n            misc: childText(null, 'misc'),\n            nick: childText(null, 'nick'),\n            password: childText(null, 'password'),\n            phone: childText(null, 'phone'),\n            postalCode: childText(null, 'zip'),\n            region: childText(null, 'state'),\n            registered: childBoolean(null, 'registered'),\n            remove: childBoolean(null, 'remove'),\n            text: childText(null, 'text'),\n            uri: childText(null, 'uri'),\n            username: childText(null, 'username')\n        },\n        namespace: NS_REGISTER,\n        path: 'iq.account'\n    }\n];\n\n// ====================================================================\nconst Protocol$m = {\n    aliases: [\n        { path: 'message.geoloc', impliedType: true },\n        { path: 'dataform.fields.geoloc', impliedType: true },\n        ...pubsubItemContentAliases()\n    ],\n    element: 'geoloc',\n    fields: {\n        accuracy: childFloat(null, 'accuracy'),\n        altitude: childFloat(null, 'alt'),\n        altitudeAccuracy: childFloat(null, 'altaccuracy'),\n        area: childText(null, 'area'),\n        building: childText(null, 'building'),\n        country: childText(null, 'country'),\n        countryCode: childText(null, 'countrycode'),\n        datum: childText(null, 'datum'),\n        description: childText(null, 'description'),\n        error: childFloat(null, 'error'),\n        floor: childText(null, 'floor'),\n        heading: childFloat(null, 'bearing'),\n        lang: languageAttribute(),\n        latitude: childFloat(null, 'lat'),\n        locality: childText(null, 'locality'),\n        longitude: childFloat(null, 'lon'),\n        postalCode: childText(null, 'postalcode'),\n        region: childText(null, 'region'),\n        room: childText(null, 'room'),\n        speed: childFloat(null, 'speed'),\n        street: childText(null, 'street'),\n        text: childText(null, 'text'),\n        timestamp: childDate(null, 'timestamp'),\n        tzo: childTimezoneOffset(null, 'tzo'),\n        uri: childText(null, 'uri')\n    },\n    namespace: NS_GEOLOC,\n    type: NS_GEOLOC\n};\n\n// ====================================================================\nconst Protocol$n = [\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'data',\n        fields: {\n            data: textBuffer('base64')\n        },\n        namespace: NS_AVATAR_DATA,\n        path: 'avatar',\n        type: NS_AVATAR_DATA,\n        typeField: 'itemType'\n    },\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'metadata',\n        namespace: NS_AVATAR_METADATA,\n        path: 'avatar',\n        type: NS_AVATAR_METADATA,\n        typeField: 'itemType'\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'avatar.versions',\n                selector: NS_AVATAR_METADATA\n            }\n        ],\n        element: 'info',\n        fields: {\n            bytes: integerAttribute('bytes'),\n            height: integerAttribute('height'),\n            id: attribute('id'),\n            mediaType: attribute('type'),\n            uri: attribute('url'),\n            width: integerAttribute('width')\n        },\n        namespace: NS_AVATAR_METADATA\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'avatar.pointers',\n                selector: NS_AVATAR_METADATA\n            }\n        ],\n        element: 'pointer',\n        fields: {\n            bytes: integerAttribute('bytes'),\n            height: integerAttribute('height'),\n            id: attribute('id'),\n            mediaType: attribute('type'),\n            uri: attribute('url'),\n            width: integerAttribute('width')\n        },\n        namespace: NS_AVATAR_METADATA\n    }\n];\n\n// ====================================================================\nvar XEP0085 = extendMessage({\n    chatState: childEnum(NS_CHAT_STATES, toList(ChatState))\n});\n\n// ====================================================================\nconst Protocol$o = {\n    element: 'query',\n    fields: {\n        name: childText(null, 'name'),\n        os: childText(null, 'os'),\n        version: childText(null, 'version')\n    },\n    namespace: NS_VERSION,\n    path: 'iq.softwareVersion'\n};\n\n// ====================================================================\nconst Protocol$p = {\n    aliases: [{ path: 'message.mood', impliedType: true }, ...pubsubItemContentAliases()],\n    element: 'mood',\n    fields: {\n        alternateLanguageText: childAlternateLanguageText(null, 'text'),\n        text: childText(null, 'text'),\n        value: childEnum(null, USER_MOODS)\n    },\n    namespace: NS_MOOD,\n    type: NS_MOOD\n};\n\n// ====================================================================\nconst Protocol$q = {\n    aliases: [{ path: 'activity', impliedType: true }, ...pubsubItemContentAliases()],\n    element: 'activity',\n    fields: {\n        activity: childDoubleEnum(null, USER_ACTIVITY_GENERAL, USER_ACTIVITY_SPECIFIC),\n        alternateLanguageText: childAlternateLanguageText(null, 'text'),\n        text: childText(null, 'text')\n    },\n    namespace: NS_ACTIVITY,\n    type: NS_ACTIVITY\n};\n\n// ====================================================================\nconst Protocol$r = {\n    element: 'handshake',\n    fields: {\n        value: textBuffer('hex')\n    },\n    namespace: NS_COMPONENT,\n    path: 'handshake'\n};\n\n// ====================================================================\nconst Protocol$s = {\n    aliases: [\n        { path: 'presence.legacyCapabilities', multiple: true },\n        { path: 'features.legacyCapabilities', multiple: true }\n    ],\n    element: 'c',\n    fields: {\n        algorithm: attribute('hash'),\n        legacy: staticValue(true),\n        node: attribute('node'),\n        value: attribute('ver')\n    },\n    namespace: NS_DISCO_LEGACY_CAPS\n};\n\n// ====================================================================\nconst Protocol$t = {\n    aliases: [\n        {\n            impliedType: true,\n            path: 'tune'\n        },\n        ...pubsubItemContentAliases()\n    ],\n    element: 'tune',\n    fields: {\n        artist: childText(null, 'artist'),\n        length: childInteger(null, 'length'),\n        rating: childInteger(null, 'rating'),\n        source: childText(null, 'source'),\n        title: childText(null, 'title'),\n        track: childText(null, 'track'),\n        uri: childText(null, 'uri')\n    },\n    namespace: NS_TUNE,\n    type: NS_TUNE\n};\n\n// ====================================================================\nconst aliases = [\n    'dataformLayout',\n    {\n        multiple: true,\n        path: 'dataformLayout.contents'\n    },\n    {\n        multiple: true,\n        path: 'dataform.layout.contents'\n    }\n];\nconst Protocol$u = [\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'dataform.layout'\n            }\n        ],\n        element: 'page',\n        fields: {\n            label: attribute('label')\n        },\n        namespace: NS_DATAFORM_LAYOUT\n    },\n    {\n        aliases,\n        element: 'section',\n        fields: {\n            label: attribute('label')\n        },\n        namespace: NS_DATAFORM_LAYOUT,\n        type: 'section',\n        typeField: 'type'\n    },\n    {\n        aliases,\n        element: 'text',\n        fields: {\n            value: text()\n        },\n        namespace: NS_DATAFORM_LAYOUT,\n        type: 'text',\n        typeField: 'type'\n    },\n    {\n        aliases,\n        element: 'fieldref',\n        fields: {\n            field: attribute('var')\n        },\n        namespace: NS_DATAFORM_LAYOUT,\n        type: 'fieldref',\n        typeField: 'type'\n    },\n    {\n        aliases,\n        element: 'reportedref',\n        namespace: NS_DATAFORM_LAYOUT,\n        type: 'reportedref',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$v = {\n    element: 'body',\n    fields: {\n        acceptMediaTypes: attribute('accept'),\n        ack: integerAttribute('ack'),\n        authId: attribute('authid'),\n        characterSets: attribute('charsets'),\n        condition: attribute('condition'),\n        from: JIDAttribute('from'),\n        key: attribute('key'),\n        lang: languageAttribute(),\n        maxClientRequests: integerAttribute('requests'),\n        maxHoldOpen: integerAttribute('hold'),\n        maxInactivityTime: integerAttribute('inactivity'),\n        maxSessionPause: integerAttribute('maxpause'),\n        maxWaitTime: integerAttribute('wait'),\n        mediaType: attribute('content'),\n        minPollingInterval: integerAttribute('polling'),\n        newKey: attribute('newkey'),\n        pauseSession: integerAttribute('pause'),\n        report: integerAttribute('report'),\n        rid: integerAttribute('rid'),\n        route: attribute('string'),\n        seeOtherURI: childText(null, 'uri'),\n        sid: attribute('sid'),\n        stream: attribute('stream'),\n        time: integerAttribute('time'),\n        to: JIDAttribute('to'),\n        type: attribute('type'),\n        version: attribute('ver'),\n        // XEP-0206\n        xmppRestart: namespacedBooleanAttribute('xmpp', NS_BOSH_XMPP, 'restart'),\n        xmppRestartLogic: namespacedBooleanAttribute('xmpp', NS_BOSH_XMPP, 'restartlogic'),\n        xmppVersion: namespacedAttribute('xmpp', NS_BOSH_XMPP, 'version')\n    },\n    namespace: NS_BOSH,\n    path: 'bosh'\n};\n\n// ====================================================================\nconst Protocol$w = [\n    extendMessage({\n        headers: splicePath(NS_SHIM, 'headers', 'header', true)\n    }),\n    extendPresence({\n        headers: splicePath(NS_SHIM, 'headers', 'header', true)\n    }),\n    {\n        element: 'header',\n        fields: {\n            name: attribute('name'),\n            value: text()\n        },\n        namespace: NS_SHIM,\n        path: 'header'\n    }\n];\n\n// ====================================================================\nconst Protocol$x = [\n    {\n        element: 'compression',\n        fields: {\n            methods: multipleChildText(null, 'method')\n        },\n        namespace: NS_COMPRESSION_FEATURE,\n        path: 'features.compression'\n    },\n    {\n        element: 'compress',\n        fields: {\n            method: childText(null, 'method')\n        },\n        namespace: NS_COMPRESSION,\n        path: 'compression',\n        type: 'start',\n        typeField: 'type'\n    },\n    {\n        aliases: ['error.compressionError'],\n        element: 'failure',\n        fields: {\n            condition: childEnum(null, ['unsupported-method', 'setup-failed', 'processing-failed'])\n        },\n        namespace: NS_COMPRESSION,\n        path: 'compression',\n        type: 'failure',\n        typeField: 'type'\n    },\n    {\n        element: 'compressed',\n        namespace: NS_COMPRESSION,\n        path: 'compression',\n        type: 'success',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$y = [\n    extendMessage({\n        rosterExchange: splicePath(NS_ROSTER_EXCHANGE, 'x', 'rosterExchange', true)\n    }),\n    extendIQ({\n        rosterExchange: splicePath(NS_ROSTER_EXCHANGE, 'x', 'rosterExchange', true)\n    }),\n    {\n        element: 'item',\n        fields: {\n            action: attribute('action'),\n            groups: multipleChildText(null, 'group'),\n            jid: JIDAttribute('jid'),\n            name: attribute('name')\n        },\n        namespace: NS_ROSTER_EXCHANGE,\n        path: 'rosterExchange'\n    }\n];\n\n// ====================================================================\nvar XEP0153 = extendPresence({\n    vcardAvatar: {\n        importer(xml) {\n            const update = findAll(xml, NS_VCARD_TEMP_UPDATE, 'x');\n            if (!update.length) {\n                return;\n            }\n            const photo = findAll(update[0], NS_VCARD_TEMP_UPDATE, 'photo');\n            if (photo.length) {\n                return photo[0].getText();\n            }\n            else {\n                return true;\n            }\n        },\n        exporter(xml, value) {\n            const update = findOrCreate(xml, NS_VCARD_TEMP_UPDATE, 'x');\n            if (value === '') {\n                findOrCreate(update, NS_VCARD_TEMP_UPDATE, 'photo');\n            }\n            else if (value === true) {\n                return;\n            }\n            else if (value) {\n                const photo = findOrCreate(update, NS_VCARD_TEMP_UPDATE, 'photo');\n                photo.children.push(value);\n            }\n        }\n    }\n});\n\n// ====================================================================\nconst Protocol$z = [\n    extendMessage({\n        captcha: splicePath(NS_CAPTCHA, 'captcha', 'dataform')\n    }),\n    extendIQ({\n        captcha: splicePath(NS_CAPTCHA, 'captcha', 'dataform')\n    })\n];\n\n// ====================================================================\nconst Protocol$A = [\n    extendStanzaError({\n        jingleError: childEnum(NS_JINGLE_ERRORS_1, toList(JingleErrorCondition))\n    }),\n    {\n        element: 'jingle',\n        fields: {\n            action: attribute('action'),\n            initiator: JIDAttribute('initiator'),\n            responder: JIDAttribute('responder'),\n            sid: attribute('sid')\n        },\n        namespace: NS_JINGLE_1,\n        path: 'iq.jingle'\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents'\n            }\n        ],\n        element: 'content',\n        fields: {\n            creator: attribute('creator'),\n            disposition: attribute('disposition', 'session'),\n            name: attribute('name'),\n            senders: attribute('senders', 'both')\n        },\n        namespace: NS_JINGLE_1\n    },\n    {\n        element: 'reason',\n        fields: {\n            alternativeSession: childText(null, 'alternative-session'),\n            condition: childEnum(null, toList(JingleReasonCondition)),\n            text: childText(null, 'text')\n        },\n        namespace: NS_JINGLE_1,\n        path: 'iq.jingle.reason'\n    }\n];\n\n// ====================================================================\nfunction rtcpFeedback() {\n    return {\n        importer(xml, context) {\n            let existing = findAll(xml, NS_JINGLE_RTP_RTCP_FB_0, 'rtcp-fb');\n            const typeImporter = attribute('type').importer;\n            const subtypeImporter = attribute('subtype').importer;\n            const valueImporter = attribute('value').importer;\n            const result = [];\n            for (const child of existing) {\n                const type = typeImporter(child, context);\n                const parameter = subtypeImporter(child, context);\n                result.push(parameter ? { type, parameter } : { type });\n            }\n            existing = findAll(xml, NS_JINGLE_RTP_RTCP_FB_0, 'rtcp-fb-trr-int');\n            for (const child of existing) {\n                const parameter = valueImporter(child, context);\n                result.push(parameter ? { type: 'trr-int', parameter } : { type: 'trr-int' });\n            }\n            return result;\n        },\n        exporter(xml, values, context) {\n            const typeExporter = attribute('type').exporter;\n            const subtypeExporter = attribute('subtype').exporter;\n            const valueExporter = attribute('value').exporter;\n            for (const fb of values) {\n                let child;\n                if (fb.type === 'trr-int') {\n                    child = createElement(NS_JINGLE_RTP_RTCP_FB_0, 'rtcp-fb-trr-int', context.namespace, xml);\n                    if (fb.parameter) {\n                        valueExporter(child, fb.parameter, context);\n                    }\n                }\n                else {\n                    child = createElement(NS_JINGLE_RTP_RTCP_FB_0, 'rtcp-fb', context.namespace, xml);\n                    typeExporter(child, fb.type, context);\n                    if (fb.parameter) {\n                        subtypeExporter(child, fb.parameter, context);\n                    }\n                }\n                xml.appendChild(child);\n            }\n        }\n    };\n}\nconst info = 'iq.jingle.info';\nconst Protocol$B = [\n    {\n        aliases: ['iq.jingle.contents.application'],\n        childrenExportOrder: {\n            codecs: 4,\n            encryption: 5,\n            headerExtensions: 6,\n            sourceGroups: 8,\n            sources: 7,\n            streams: 9\n        },\n        element: 'description',\n        fields: {\n            media: attribute('media'),\n            rtcpFeedback: Object.assign(Object.assign({}, rtcpFeedback()), { exportOrder: 3 }),\n            rtcpMux: Object.assign(Object.assign({}, childBoolean(null, 'rtcp-mux')), { exportOrder: 1 }),\n            rtcpReducedSize: Object.assign(Object.assign({}, childBoolean(null, 'rtcp-reduced-size')), { exportOrder: 2 }),\n            ssrc: attribute('ssrc')\n        },\n        namespace: NS_JINGLE_RTP_1,\n        optionalNamespaces: {\n            rtcpf: NS_JINGLE_RTP_RTCP_FB_0,\n            rtph: NS_JINGLE_RTP_HDREXT_0\n        },\n        type: NS_JINGLE_RTP_1\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.headerExtensions',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'rtp-hdrext',\n        fields: {\n            id: integerAttribute('id'),\n            senders: attribute('senders'),\n            uri: attribute('uri')\n        },\n        namespace: NS_JINGLE_RTP_HDREXT_0\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.codecs',\n                selector: NS_JINGLE_RTP_1\n            },\n            'rtpcodec'\n        ],\n        element: 'payload-type',\n        fields: {\n            channels: integerAttribute('channels'),\n            clockRate: integerAttribute('clockrate'),\n            id: attribute('id'),\n            maxptime: integerAttribute('maxptime'),\n            name: attribute('name'),\n            parameters: parameterMap(NS_JINGLE_RTP_1, 'parameter', 'name', 'value'),\n            ptime: integerAttribute('ptime'),\n            rtcpFeedback: rtcpFeedback()\n        },\n        namespace: NS_JINGLE_RTP_1\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.sources',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'source',\n        fields: {\n            parameters: parameterMap(NS_JINGLE_RTP_SSMA_0, 'parameter', 'name', 'value'),\n            ssrc: attribute('ssrc')\n        },\n        namespace: NS_JINGLE_RTP_SSMA_0\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.sourceGroups',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'ssrc-group',\n        fields: {\n            semantics: attribute('semantics'),\n            sources: multipleChildAttribute(null, 'source', 'ssrc')\n        },\n        namespace: NS_JINGLE_RTP_SSMA_0\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.streams',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'stream',\n        fields: {\n            id: attribute('id'),\n            track: attribute('track')\n        },\n        namespace: NS_JINGLE_RTP_MSID_0\n    },\n    {\n        aliases: [{ path: 'iq.jingle.contents.application.encryption', selector: NS_JINGLE_RTP_1 }],\n        element: 'encryption',\n        fields: {\n            required: booleanAttribute('required')\n        },\n        namespace: NS_JINGLE_RTP_1\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.application.encryption.sdes',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'crypto',\n        fields: {\n            cryptoSuite: attribute('crypto-suite'),\n            keyParameters: attribute('key-params'),\n            sessionParameters: attribute('session-params'),\n            tag: integerAttribute('tag')\n        },\n        namespace: NS_JINGLE_RTP_1\n    },\n    {\n        aliases: [\n            {\n                path: 'iq.jingle.contents.application.encryption.zrtp',\n                selector: NS_JINGLE_RTP_1\n            }\n        ],\n        element: 'zrtp-hash',\n        fields: {\n            value: textBuffer('hex'),\n            version: attribute('version')\n        },\n        namespace: NS_JINGLE_RTP_1\n    },\n    {\n        element: 'mute',\n        fields: {\n            creator: attribute('creator'),\n            name: attribute('name')\n        },\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_MUTE\n    },\n    {\n        element: 'unmute',\n        fields: {\n            creator: attribute('creator'),\n            name: attribute('name')\n        },\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_UNMUTE\n    },\n    {\n        element: 'hold',\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_HOLD\n    },\n    {\n        element: 'unhold',\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_UNHOLD\n    },\n    {\n        element: 'active',\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_ACTIVE\n    },\n    {\n        element: 'ringing',\n        namespace: NS_JINGLE_RTP_INFO_1,\n        path: info,\n        type: JINGLE_INFO_RINGING\n    }\n];\n\n// ====================================================================\nconst Protocol$C = [\n    extendMessage({\n        nick: childText(NS_NICK, 'nick')\n    }),\n    extendPresence({\n        nick: childText(NS_NICK, 'nick')\n    }),\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'nick',\n        fields: {\n            nick: text()\n        },\n        namespace: NS_NICK,\n        type: NS_NICK\n    }\n];\n\n// ====================================================================\nconst ice = (transportType) => [\n    {\n        element: 'transport',\n        fields: {\n            gatheringComplete: childBoolean(null, 'gathering-complete'),\n            password: attribute('pwd'),\n            usernameFragment: attribute('ufrag')\n        },\n        namespace: transportType,\n        path: 'iq.jingle.contents.transport',\n        type: transportType,\n        typeField: 'transportType'\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                path: 'iq.jingle.contents.transport.remoteCandidate',\n                selector: transportType\n            }\n        ],\n        element: 'remote-candidate',\n        fields: {\n            component: integerAttribute('component'),\n            ip: attribute('ip'),\n            port: integerAttribute('port')\n        },\n        namespace: transportType,\n        type: transportType,\n        typeField: 'transportType'\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.jingle.contents.transport.candidates',\n                selector: transportType\n            }\n        ],\n        element: 'candidate',\n        fields: {\n            component: integerAttribute('component'),\n            foundation: attribute('foundation'),\n            generation: integerAttribute('generation'),\n            id: attribute('id'),\n            ip: attribute('ip'),\n            network: integerAttribute('network'),\n            port: integerAttribute('port'),\n            priority: integerAttribute('priority'),\n            protocol: attribute('protocol'),\n            relatedAddress: attribute('rel-addr'),\n            relatedPort: attribute('rel-port'),\n            tcpType: attribute('tcptype'),\n            type: attribute('type')\n        },\n        namespace: transportType,\n        type: transportType,\n        typeField: 'transportType'\n    }\n];\nconst Protocol$D = [...ice(NS_JINGLE_ICE_0), ...ice(NS_JINGLE_ICE_UDP_1)];\n\n// ====================================================================\nconst Protocol$E = [\n    {\n        element: 'transport',\n        fields: {\n            gatheringComplete: childBoolean(null, 'gathering-complete'),\n            password: attribute('pwd'),\n            usernameFragment: attribute('ufrag')\n        },\n        namespace: NS_JINGLE_RAW_UDP_1,\n        path: 'iq.jingle.contents.transport',\n        type: NS_JINGLE_RAW_UDP_1,\n        typeField: 'transportType'\n    },\n    {\n        aliases: [\n            {\n                impliedType: true,\n                multiple: true,\n                path: 'iq.jingle.contents.transport.candidates',\n                selector: NS_JINGLE_RAW_UDP_1\n            }\n        ],\n        element: 'candidate',\n        fields: {\n            component: integerAttribute('component'),\n            foundation: attribute('foundation'),\n            generation: integerAttribute('generation'),\n            id: attribute('id'),\n            ip: attribute('ip'),\n            port: integerAttribute('port'),\n            type: attribute('type')\n        },\n        namespace: NS_JINGLE_RAW_UDP_1,\n        type: NS_JINGLE_RAW_UDP_1,\n        typeField: 'transportType'\n    }\n];\n\n// ====================================================================\nconst Protocol$F = [\n    {\n        element: 'request',\n        namespace: NS_RECEIPTS,\n        path: 'message.receipt',\n        type: 'request',\n        typeField: 'type'\n    },\n    {\n        element: 'received',\n        fields: {\n            id: attribute('id')\n        },\n        namespace: NS_RECEIPTS,\n        path: 'message.receipt',\n        type: 'received',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$G = [\n    {\n        element: 'invisible',\n        fields: {\n            probe: booleanAttribute('probe')\n        },\n        namespace: NS_INVISIBLE_0,\n        path: 'iq.visibility',\n        type: 'invisible',\n        typeField: 'type'\n    },\n    {\n        element: 'visible',\n        namespace: NS_INVISIBLE_0,\n        path: 'iq.visibility',\n        type: 'visible'\n    }\n];\n\n// ====================================================================\nconst Protocol$H = [\n    extendStanzaError({\n        blocked: childBoolean(NS_BLOCKING_ERRORS, 'blocked')\n    }),\n    {\n        element: 'blocklist',\n        fields: {\n            jids: multipleChildAttribute(null, 'item', 'jid')\n        },\n        namespace: NS_BLOCKING,\n        path: 'iq.blockList',\n        type: 'list',\n        typeField: 'action'\n    },\n    {\n        element: 'block',\n        fields: {\n            jids: multipleChildAttribute(null, 'item', 'jid')\n        },\n        namespace: NS_BLOCKING,\n        path: 'iq.blockList',\n        type: 'block',\n        typeField: 'action'\n    },\n    {\n        element: 'unblock',\n        fields: {\n            jids: multipleChildAttribute(null, 'item', 'jid')\n        },\n        namespace: NS_BLOCKING,\n        path: 'iq.blockList',\n        type: 'unblock',\n        typeField: 'action'\n    }\n];\n\n// ====================================================================\nconst Protocol$I = [\n    extendStreamFeatures({\n        streamManagement: childBoolean(NS_SMACKS_3, 'sm')\n    }),\n    {\n        element: 'a',\n        fields: {\n            handled: integerAttribute('h', 0)\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'ack',\n        typeField: 'type'\n    },\n    {\n        element: 'r',\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'request',\n        typeField: 'type'\n    },\n    {\n        element: 'enable',\n        fields: {\n            allowResumption: booleanAttribute('resume')\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'enable',\n        typeField: 'type'\n    },\n    {\n        element: 'enabled',\n        fields: {\n            id: attribute('id'),\n            resume: booleanAttribute('resume')\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'enabled',\n        typeField: 'type'\n    },\n    {\n        element: 'resume',\n        fields: {\n            handled: integerAttribute('h', 0),\n            previousSession: attribute('previd')\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'resume',\n        typeField: 'type'\n    },\n    {\n        element: 'resumed',\n        fields: {\n            handled: integerAttribute('h', 0),\n            previousSession: attribute('previd')\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'resumed',\n        typeField: 'type'\n    },\n    {\n        element: 'failed',\n        fields: {\n            handled: integerAttribute('h', 0)\n        },\n        namespace: NS_SMACKS_3,\n        path: 'sm',\n        type: 'failed',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nvar XEP0199 = extendIQ({\n    ping: childBoolean(NS_PING, 'ping')\n});\n\n// ====================================================================\nconst Protocol$J = {\n    element: 'time',\n    fields: {\n        tzo: childTimezoneOffset(null, 'tzo'),\n        utc: childDate(null, 'utc')\n    },\n    namespace: NS_TIME,\n    path: 'iq.time'\n};\n\n// ====================================================================\nconst Protocol$K = {\n    aliases: ['message.delay', 'presence.delay'],\n    element: 'delay',\n    fields: {\n        from: JIDAttribute('from'),\n        reason: text(),\n        timestamp: dateAttribute('stamp')\n    },\n    namespace: NS_DELAY\n};\n\n// ====================================================================\nconst Protocol$L = [\n    {\n        aliases: ['iq.externalServiceCredentials'],\n        defaultType: '1',\n        element: 'credentials',\n        fields: {\n            expires: childDateAttribute(null, 'service', 'expires'),\n            host: childAttribute(null, 'service', 'host'),\n            name: childAttribute(null, 'service', 'name'),\n            password: childAttribute(null, 'service', 'password'),\n            port: childIntegerAttribute(null, 'service', 'port'),\n            restricuted: childBooleanAttribute(null, 'service', 'restricted'),\n            transport: childAttribute(null, 'service', 'transport'),\n            type: childAttribute(null, 'service', 'type'),\n            username: childAttribute(null, 'service', 'username')\n        },\n        namespace: NS_DISCO_EXTERNAL_1,\n        type: '1',\n        typeField: 'version'\n    },\n    {\n        aliases: ['iq.externalServices'],\n        defaultType: '1',\n        element: 'services',\n        fields: {\n            type: attribute('type')\n        },\n        namespace: NS_DISCO_EXTERNAL_1,\n        type: '1',\n        typeField: 'version'\n    },\n    {\n        aliases: [{ path: 'iq.externalServices.services', multiple: true }],\n        defaultType: '1',\n        element: 'service',\n        fields: {\n            expires: dateAttribute('expires'),\n            host: attribute('host'),\n            name: attribute('name'),\n            password: attribute('password'),\n            port: integerAttribute('port'),\n            restricuted: booleanAttribute('restricted'),\n            transport: attribute('transport'),\n            type: attribute('type'),\n            username: attribute('username')\n        },\n        namespace: NS_DISCO_EXTERNAL_1,\n        type: '1',\n        typeField: 'version'\n    }\n];\n\n// ====================================================================\nconst Protocol$M = [\n    {\n        element: 'media',\n        fields: {\n            height: integerAttribute('height'),\n            width: integerAttribute('width')\n        },\n        namespace: NS_DATAFORM_MEDIA,\n        path: 'dataform.fields.media'\n    },\n    {\n        aliases: [{ multiple: true, path: 'dataform.fields.media.sources' }],\n        element: 'uri',\n        fields: {\n            mediaType: attribute('type'),\n            uri: text()\n        },\n        namespace: NS_DATAFORM_MEDIA\n    }\n];\n\n// ====================================================================\nvar XEP0224 = extendMessage({\n    requestingAttention: childBoolean(NS_ATTENTION_0, 'attention')\n});\n\n// ====================================================================\nconst Protocol$N = {\n    aliases: [\n        'iq.bits',\n        { path: 'message.bits', multiple: true },\n        { path: 'presence.bits', multiple: true },\n        { path: 'iq.jingle.bits', multiple: true }\n    ],\n    element: 'data',\n    fields: {\n        cid: attribute('cid'),\n        data: textBuffer('base64'),\n        maxAge: integerAttribute('max-age'),\n        mediaType: attribute('type')\n    },\n    namespace: NS_BOB\n};\n\n// ====================================================================\nconst Protocol$O = [\n    addAlias(NS_HASHES_2, 'hash', [{ path: 'file.hashes', multiple: true }]),\n    addAlias(NS_HASHES_2, 'hash-used', [{ path: 'file.hashesUsed', multiple: true }]),\n    addAlias(NS_THUMBS_1, 'thumbnail', [{ path: 'file.thumbnails', multiple: true }]),\n    {\n        aliases: [\n            'file',\n            {\n                path: 'iq.jingle.contents.application.file',\n                selector: NS_JINGLE_FILE_TRANSFER_5\n            },\n            {\n                path: 'iq.jingle.info.file',\n                selector: `{${NS_JINGLE_FILE_TRANSFER_5}}checksum`\n            }\n        ],\n        element: 'file',\n        fields: {\n            date: childDate(null, 'date'),\n            description: childText(null, 'desc'),\n            mediaType: childText(null, 'media-type'),\n            name: childText(null, 'name'),\n            size: childInteger(null, 'size')\n        },\n        namespace: NS_JINGLE_FILE_TRANSFER_5\n    },\n    {\n        element: 'range',\n        fields: {\n            length: integerAttribute('length'),\n            offset: integerAttribute('offset', 0)\n        },\n        namespace: NS_JINGLE_FILE_TRANSFER_5,\n        path: 'file.range'\n    },\n    {\n        element: 'description',\n        namespace: NS_JINGLE_FILE_TRANSFER_5,\n        path: 'iq.jingle.contents.application',\n        type: NS_JINGLE_FILE_TRANSFER_5,\n        typeField: 'applicationType'\n    },\n    {\n        element: 'received',\n        fields: {\n            creator: attribute('creator'),\n            name: attribute('name')\n        },\n        namespace: NS_JINGLE_FILE_TRANSFER_5,\n        path: 'iq.jingle.info',\n        type: `{${NS_JINGLE_FILE_TRANSFER_5}}received`,\n        typeField: 'infoType'\n    },\n    {\n        element: 'checksum',\n        fields: {\n            creator: attribute('creator'),\n            name: attribute('name')\n        },\n        namespace: NS_JINGLE_FILE_TRANSFER_5,\n        path: 'iq.jingle.info',\n        type: `{${NS_JINGLE_FILE_TRANSFER_5}}checksum`,\n        typeField: 'infoType'\n    }\n];\n\n// ====================================================================\nconst Protocol$P = {\n    element: 'description',\n    namespace: NS_JINGLE_XML_0,\n    path: 'iq.jingle.contents.application',\n    type: NS_JINGLE_XML_0,\n    typeField: 'applicationType'\n};\n\n// ====================================================================\nconst Protocol$Q = [\n    {\n        element: 'transport',\n        fields: {\n            activated: childAttribute(null, 'activated', 'cid'),\n            address: attribute('dstaddr'),\n            candidateError: childBoolean(null, 'candidate-error'),\n            candidateUsed: childAttribute(null, 'candidate-used', 'cid'),\n            mode: attribute('mode', 'tcp'),\n            proxyError: childBoolean(null, 'proxy-error'),\n            sid: attribute('sid')\n        },\n        namespace: NS_JINGLE_SOCKS5_1,\n        path: 'iq.jingle.contents.transport',\n        type: NS_JINGLE_SOCKS5_1,\n        typeField: 'transportType'\n    },\n    {\n        aliases: [\n            {\n                multiple: true,\n                path: 'iq.jingle.contents.transport.candidates',\n                selector: NS_JINGLE_SOCKS5_1\n            }\n        ],\n        element: 'candidate',\n        fields: {\n            cid: attribute('cid'),\n            host: attribute('host'),\n            jid: JIDAttribute('jid'),\n            port: integerAttribute('port'),\n            priority: integerAttribute('priority'),\n            type: attribute('type'),\n            uri: attribute('uri')\n        },\n        namespace: NS_JINGLE_SOCKS5_1\n    }\n];\n\n// ====================================================================\nconst Protocol$R = {\n    element: 'transport',\n    fields: {\n        ack: {\n            importer(xml, context) {\n                const stanza = attribute('stanza', 'iq').importer(xml, context);\n                return stanza !== 'message';\n            },\n            exporter(xml, data, context) {\n                attribute('stanza').exporter(xml, data ? 'iq' : 'message', context);\n            }\n        },\n        blockSize: integerAttribute('block-size'),\n        sid: attribute('sid')\n    },\n    namespace: NS_JINGLE_IBB_1,\n    path: 'iq.jingle.contents.transport',\n    type: NS_JINGLE_IBB_1,\n    typeField: 'transportType'\n};\n\n// ====================================================================\nconst Protocol$S = [\n    addAlias(NS_BOB, 'data', [{ path: 'iq.jingle.bits', multiple: true }]),\n    {\n        element: 'thumbnail',\n        fields: {\n            height: integerAttribute('height'),\n            mediaType: attribute('media-type'),\n            uri: attribute('uri'),\n            width: integerAttribute('width')\n        },\n        namespace: NS_THUMBS_1,\n        path: 'thumbnail'\n    }\n];\n\n// ====================================================================\nconst Protocol$T = [\n    addAlias(NS_FORWARD_0, 'forwarded', ['message.carbon.forward']),\n    {\n        element: 'enable',\n        namespace: NS_CARBONS_2,\n        path: 'iq.carbons',\n        type: 'enable',\n        typeField: 'action'\n    },\n    {\n        element: 'disable',\n        namespace: NS_CARBONS_2,\n        path: 'iq.carbons',\n        type: 'disable',\n        typeField: 'action'\n    },\n    {\n        element: 'sent',\n        namespace: NS_CARBONS_2,\n        path: 'message.carbon',\n        type: 'sent',\n        typeField: 'type'\n    },\n    {\n        element: 'received',\n        namespace: NS_CARBONS_2,\n        path: 'message.carbon',\n        type: 'received',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nconst Protocol$U = [\n    ...Object.values(StreamType).map(streamNS => addAlias(streamNS, 'message', ['forward.message'])),\n    ...Object.values(StreamType).map(streamNS => addAlias(streamNS, 'presence', ['forward.presence'])),\n    ...Object.values(StreamType).map(streamNS => addAlias(streamNS, 'iq', ['forward.iq'])),\n    addAlias(NS_DELAY, 'delay', ['forward.delay']),\n    {\n        aliases: ['message.forward'],\n        element: 'forwarded',\n        namespace: NS_FORWARD_0,\n        path: 'forward'\n    }\n];\n\n// ====================================================================\nconst Protocol$V = [\n    {\n        defaultType: '2',\n        element: 'hash',\n        fields: {\n            algorithm: attribute('algo'),\n            value: textBuffer('base64'),\n            version: staticValue('2')\n        },\n        namespace: NS_HASHES_2,\n        path: 'hash',\n        typeField: 'version'\n    },\n    {\n        element: 'hash-used',\n        fields: {\n            algorithm: attribute('algo'),\n            version: staticValue('2')\n        },\n        namespace: NS_HASHES_2,\n        path: 'hashUsed'\n    },\n    {\n        element: 'hash',\n        fields: {\n            algorithm: attribute('algo'),\n            value: textBuffer('hex'),\n            version: staticValue('1')\n        },\n        namespace: NS_HASHES_1,\n        path: 'hash',\n        typeField: 'version'\n    }\n];\n\n// ====================================================================\nconst Protocol$W = [\n    {\n        element: 'rtt',\n        fields: {\n            event: attribute('event', 'edit'),\n            id: attribute('id'),\n            seq: integerAttribute('seq')\n        },\n        namespace: NS_RTT_0,\n        path: 'message.rtt'\n    },\n    {\n        aliases: [{ path: 'message.rtt.actions', multiple: true }],\n        element: 't',\n        fields: {\n            position: integerAttribute('p'),\n            text: text()\n        },\n        namespace: NS_RTT_0,\n        type: 'insert',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ path: 'message.rtt.actions', multiple: true }],\n        element: 'e',\n        fields: {\n            length: integerAttribute('n', 1),\n            position: integerAttribute('p')\n        },\n        namespace: NS_RTT_0,\n        type: 'erase',\n        typeField: 'type'\n    },\n    {\n        aliases: [{ multiple: true, path: 'message.rtt.actions' }],\n        element: 'w',\n        fields: {\n            duration: integerAttribute('n', 0)\n        },\n        namespace: NS_RTT_0,\n        type: 'wait',\n        typeField: 'type'\n    }\n];\n\n// ====================================================================\nvar XEP0308 = extendMessage({\n    replace: childAttribute(NS_CORRECTION_0, 'replace', 'id')\n});\n\n// ====================================================================\nconst Protocol$X = [\n    addAlias(NS_DATAFORM, 'x', ['iq.archive.form']),\n    addAlias(NS_FORWARD_0, 'forwarded', ['message.archive.item']),\n    addAlias(NS_RSM, 'set', ['iq.archive.paging']),\n    {\n        defaultType: 'query',\n        element: 'query',\n        fields: {\n            queryId: attribute('queryid')\n        },\n        namespace: NS_MAM_2,\n        path: 'iq.archive',\n        type: 'query',\n        typeField: 'type'\n    },\n    {\n        element: 'fin',\n        fields: {\n            complete: booleanAttribute('complete'),\n            stable: booleanAttribute('stable')\n        },\n        namespace: NS_MAM_2,\n        path: 'iq.archive',\n        type: 'result'\n    },\n    {\n        element: 'prefs',\n        fields: {\n            default: attribute('default')\n        },\n        namespace: NS_MAM_2,\n        path: 'iq.archive',\n        type: 'preferences'\n    },\n    {\n        element: 'result',\n        fields: {\n            id: attribute('id'),\n            queryId: attribute('queryid')\n        },\n        namespace: NS_MAM_2,\n        path: 'message.archive'\n    }\n];\n\n// ====================================================================\nconst Protocol$Y = [\n    extendPresence({\n        hats: splicePath(NS_HATS_0, 'hats', 'hat', true)\n    }),\n    {\n        element: 'hat',\n        fields: {\n            id: attribute('name'),\n            name: attribute('displayName')\n        },\n        namespace: NS_HATS_0,\n        path: 'hat'\n    }\n];\n\n// ====================================================================\nvar XEP0319 = extendPresence({\n    idleSince: childDate(NS_IDLE_1, 'since')\n});\n\n// ====================================================================\nconst Protocol$Z = {\n    aliases: [\n        {\n            multiple: true,\n            path: 'iq.jingle.contents.transport.fingerprints',\n            selector: NS_JINGLE_ICE_UDP_1\n        },\n        {\n            multiple: true,\n            path: 'iq.jingle.contents.transport.fingerprints',\n            selector: NS_JINGLE_ICE_0\n        },\n        {\n            multiple: true,\n            path: 'iq.jingle.contents.application.encryption.dtls',\n            selector: NS_JINGLE_RTP_1\n        }\n    ],\n    element: 'fingerprint',\n    fields: {\n        algorithm: attribute('hash'),\n        setup: attribute('setup'),\n        value: text()\n    },\n    namespace: NS_JINGLE_DTLS_0\n};\n\n// ====================================================================\nconst path$1 = 'message.marker';\nconst Protocol$_ = [\n    {\n        element: 'markable',\n        namespace: NS_CHAT_MARKERS_0,\n        path: path$1,\n        type: 'markable',\n        typeField: 'type'\n    },\n    {\n        element: 'received',\n        fields: {\n            id: attribute('id')\n        },\n        namespace: NS_CHAT_MARKERS_0,\n        path: path$1,\n        type: 'received'\n    },\n    {\n        element: 'displayed',\n        fields: {\n            id: attribute('id')\n        },\n        namespace: NS_CHAT_MARKERS_0,\n        path: path$1,\n        type: 'displayed'\n    },\n    {\n        element: 'acknowledged',\n        fields: {\n            id: attribute('id')\n        },\n        namespace: NS_CHAT_MARKERS_0,\n        path: path$1,\n        type: 'acknowledged'\n    }\n];\n\n// ====================================================================\nfunction processingHints() {\n    return {\n        importer(xml) {\n            const results = {};\n            let found = false;\n            for (const child of xml.children) {\n                if (typeof child === 'string') {\n                    continue;\n                }\n                if (child.getNamespace() !== NS_HINTS) {\n                    continue;\n                }\n                switch (child.getName()) {\n                    case 'no-copy':\n                        results.noCopy = true;\n                        found = true;\n                        break;\n                    case 'no-permanent-store':\n                        results.noPermanentStore = true;\n                        found = true;\n                        break;\n                    case 'no-store':\n                        results.noStore = true;\n                        found = true;\n                        break;\n                    case 'store':\n                        results.store = true;\n                        found = true;\n                        break;\n                }\n            }\n            return found ? results : undefined;\n        },\n        exporter(xml, value, context) {\n            if (value.noCopy) {\n                xml.appendChild(createElement(NS_HINTS, 'no-copy', context.namespace, xml));\n            }\n            if (value.noPermanentStore) {\n                xml.appendChild(createElement(NS_HINTS, 'no-permanent-store', context.namespace, xml));\n            }\n            if (value.noStore) {\n                xml.appendChild(createElement(NS_HINTS, 'no-store', context.namespace, xml));\n            }\n            if (value.store) {\n                xml.appendChild(createElement(NS_HINTS, 'store', context.namespace, xml));\n            }\n        }\n    };\n}\nvar XEP0334 = extendMessage({\n    processingHints: processingHints()\n});\n\n// ====================================================================\nconst Protocol$$ = [\n    extendMessage({\n        json: childJSON(NS_JSON_0, 'json')\n    }),\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'json',\n        fields: {\n            json: textJSON()\n        },\n        namespace: NS_JSON_0,\n        type: NS_JSON_0\n    }\n];\n\n// ====================================================================\nconst Protocol$10 = [\n    {\n        aliases: [{ path: 'iq.jingle.groups', multiple: true }],\n        element: 'group',\n        fields: {\n            contents: multipleChildAttribute(null, 'content', 'name'),\n            semantics: attribute('semantics')\n        },\n        namespace: NS_JINGLE_GROUPING_0\n    }\n];\n\n// ====================================================================\nconst Protocol$11 = {\n    aliases: [\n        {\n            path: 'iq.jingle.contents.transport.sctp',\n            selector: NS_JINGLE_ICE_UDP_1\n        },\n        {\n            path: 'iq.jingle.contents.transport.sctp',\n            selector: NS_JINGLE_ICE_0\n        }\n    ],\n    element: 'sctpmap',\n    fields: {\n        port: integerAttribute('number'),\n        protocol: attribute('protocol'),\n        streams: attribute('streams')\n    },\n    namespace: NS_JINGLE_DTLS_SCTP_1\n};\n\n// ====================================================================\nconst Protocol$12 = [\n    {\n        element: 'active',\n        namespace: NS_CSI_0,\n        path: 'csi',\n        type: 'active',\n        typeField: 'state'\n    },\n    {\n        element: 'inactive',\n        namespace: NS_CSI_0,\n        path: 'csi',\n        type: 'inactive',\n        typeField: 'state'\n    }\n];\n\n// ====================================================================\nconst Protocol$13 = [\n    addAlias(NS_DATAFORM, 'x', ['iq.push.form', 'pushNotification.form']),\n    {\n        element: 'enable',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUSH_0,\n        path: 'iq.push',\n        type: 'enable',\n        typeField: 'action'\n    },\n    {\n        element: 'disable',\n        fields: {\n            jid: JIDAttribute('jid'),\n            node: attribute('node')\n        },\n        namespace: NS_PUSH_0,\n        path: 'iq.push',\n        type: 'disable',\n        typeField: 'action'\n    },\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'notification',\n        namespace: NS_PUSH_0,\n        path: 'pushNotification',\n        type: NS_PUSH_0,\n        typeField: 'itemType'\n    }\n];\n\n// ====================================================================\nconst Protocol$14 = [\n    extendMessage({\n        originId: childAttribute(NS_SID_0, 'origin-id', 'id')\n    }),\n    {\n        aliases: [{ path: 'message.stanzaIds', multiple: true }],\n        element: 'stanza-id',\n        fields: {\n            by: JIDAttribute('by'),\n            id: attribute('id')\n        },\n        namespace: NS_SID_0\n    }\n];\n\n// ====================================================================\nconst Protocol$15 = [\n    extendStanzaError({\n        httpUploadError: childEnum(NS_HTTP_UPLOAD_0, ['file-too-large', 'retry']),\n        httpUploadMaxFileSize: deepChildInteger([\n            { namespace: NS_HTTP_UPLOAD_0, element: 'file-too-large' },\n            { namespace: NS_HTTP_UPLOAD_0, element: 'max-file-size' }\n        ]),\n        httpUploadRetry: childDateAttribute(NS_HTTP_UPLOAD_0, 'retry', 'stamp')\n    }),\n    {\n        element: 'request',\n        fields: {\n            mediaType: attribute('content-type'),\n            name: attribute('filename'),\n            size: integerAttribute('size')\n        },\n        namespace: NS_HTTP_UPLOAD_0,\n        path: 'iq.httpUpload',\n        type: 'request',\n        typeField: 'type'\n    },\n    {\n        element: 'slot',\n        fields: {\n            download: childAttribute(null, 'get', 'url')\n        },\n        namespace: NS_HTTP_UPLOAD_0,\n        path: 'iq.httpUpload',\n        type: 'slot'\n    },\n    {\n        aliases: [{ path: 'iq.httpUpload.upload', selector: 'slot' }],\n        element: 'put',\n        fields: {\n            url: attribute('url')\n        },\n        namespace: NS_HTTP_UPLOAD_0\n    },\n    {\n        aliases: [{ path: 'iq.httpUpload.upload.headers', multiple: true }],\n        element: 'header',\n        fields: {\n            name: attribute('name'),\n            value: text()\n        },\n        namespace: NS_HTTP_UPLOAD_0\n    }\n];\n\n// ====================================================================\nconst Protocol$16 = {\n    element: 'encryption',\n    fields: {\n        id: attribute('namespace'),\n        name: attribute('name')\n    },\n    namespace: NS_EME_0,\n    path: 'message.encryptionMethod'\n};\n\n// ====================================================================\nconst Protocol$17 = [\n    {\n        aliases: ['message.omemo'],\n        element: 'encrypted',\n        fields: {\n            payload: childTextBuffer(null, 'payload', 'base64')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        path: 'omemo'\n    },\n    {\n        element: 'header',\n        fields: {\n            iv: childTextBuffer(null, 'iv', 'base64'),\n            sid: integerAttribute('sid')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        path: 'omemo.header'\n    },\n    {\n        aliases: [{ path: 'omemo.header.keys', multiple: true }],\n        element: 'key',\n        fields: {\n            preKey: booleanAttribute('prekey'),\n            rid: integerAttribute('rid'),\n            value: textBuffer('base64')\n        },\n        namespace: NS_OMEMO_AXOLOTL\n    },\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'list',\n        fields: {\n            devices: multipleChildIntegerAttribute(null, 'device', 'id')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        type: NS_OMEMO_AXOLOTL_DEVICELIST,\n        typeField: 'itemType'\n    },\n    {\n        element: 'preKeyPublic',\n        fields: {\n            id: integerAttribute('preKeyId'),\n            value: textBuffer('base64')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        path: 'omemoPreKey'\n    },\n    {\n        element: 'signedPreKeyPublic',\n        fields: {\n            id: integerAttribute('signedPreKeyId'),\n            value: textBuffer('base64')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        path: 'omemoDevice.signedPreKeyPublic'\n    },\n    {\n        aliases: pubsubItemContentAliases(),\n        element: 'bundle',\n        fields: {\n            identityKey: childTextBuffer(null, 'identityKey', 'base64'),\n            preKeys: splicePath(null, 'prekeys', 'omemoPreKey', true),\n            signedPreKeySignature: childTextBuffer(null, 'signedPreKeySignature', 'base64')\n        },\n        namespace: NS_OMEMO_AXOLOTL,\n        path: 'omemoDevice',\n        type: NS_OMEMO_AXOLOTL_BUNDLES,\n        typeField: 'itemType'\n    }\n];\n\n// ====================================================================\nconst Protocol$18 = [\n    {\n        element: 'XRD',\n        fields: {\n            subject: childText(null, 'Subject')\n        },\n        namespace: NS_XRD,\n        path: 'xrd'\n    },\n    {\n        aliases: [{ path: 'xrd.links', multiple: true }],\n        element: 'Link',\n        fields: {\n            href: attribute('href'),\n            rel: attribute('rel'),\n            type: attribute('type')\n        },\n        namespace: NS_XRD\n    }\n];\n\nconst Protocol$19 = [\n    Protocol,\n    Protocol$1,\n    Protocol$2,\n    Protocol$3,\n    Protocol$4,\n    Protocol$5,\n    Protocol$6,\n    Protocol$7,\n    Protocol$8,\n    Protocol$9,\n    Protocol$a,\n    Protocol$b,\n    Protocol$c,\n    Protocol$d,\n    Protocol$e,\n    Protocol$f,\n    Protocol$g,\n    Protocol$h,\n    Protocol$i,\n    Protocol$j,\n    Protocol$k,\n    Protocol$l,\n    Protocol$m,\n    Protocol$n,\n    XEP0085,\n    Protocol$o,\n    Protocol$p,\n    Protocol$q,\n    Protocol$r,\n    Protocol$s,\n    Protocol$t,\n    Protocol$v,\n    Protocol$w,\n    Protocol$x,\n    Protocol$u,\n    Protocol$y,\n    XEP0153,\n    Protocol$z,\n    Protocol$A,\n    Protocol$B,\n    Protocol$C,\n    Protocol$D,\n    Protocol$E,\n    Protocol$F,\n    Protocol$G,\n    Protocol$H,\n    Protocol$I,\n    XEP0199,\n    Protocol$J,\n    Protocol$K,\n    Protocol$L,\n    Protocol$M,\n    XEP0224,\n    Protocol$N,\n    Protocol$O,\n    Protocol$P,\n    Protocol$Q,\n    Protocol$R,\n    Protocol$S,\n    Protocol$T,\n    Protocol$U,\n    Protocol$V,\n    Protocol$W,\n    XEP0308,\n    Protocol$X,\n    Protocol$Y,\n    XEP0319,\n    Protocol$Z,\n    Protocol$_,\n    XEP0334,\n    Protocol$$,\n    Protocol$10,\n    Protocol$11,\n    Protocol$12,\n    Protocol$13,\n    Protocol$14,\n    Protocol$15,\n    Protocol$16,\n    Protocol$17,\n    Protocol$18\n];\n\nvar index$3 = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    'default': Protocol$19\n});\n\nconst MAX_SEQ = Math.pow(2, 32);\nconst mod = (v, n) => ((v % n) + n) % n;\nclass StreamManagement {\n    constructor(client) {\n        this.allowResume = true;\n        this.lastAck = 0;\n        this.handled = 0;\n        this.windowSize = 1;\n        this.unacked = [];\n        this.pendingAck = false;\n        this.inboundStarted = false;\n        this.outboundStarted = false;\n        this.client = client;\n        this.id = undefined;\n        this.allowResume = true;\n        this.started = false;\n        this.cacheHandler = () => null;\n        this._reset();\n    }\n    get started() {\n        return this.outboundStarted && this.inboundStarted;\n    }\n    set started(value) {\n        if (!value) {\n            this.outboundStarted = false;\n            this.inboundStarted = false;\n        }\n    }\n    load(opts) {\n        this.id = opts.id;\n        this.allowResume = true;\n        this.handled = opts.handled;\n        this.lastAck = opts.lastAck;\n        this.unacked = opts.unacked;\n        if (opts.jid) {\n            this.client.jid = opts.jid;\n            this.client.emit('session:bound', opts.jid);\n        }\n    }\n    cache(handler) {\n        this.cacheHandler = handler;\n    }\n    enable() {\n        this.client.send('sm', {\n            allowResumption: this.allowResume,\n            type: 'enable'\n        });\n        this.handled = 0;\n        this.pendingAck = false;\n        this.outboundStarted = true;\n    }\n    resume() {\n        this.client.send('sm', {\n            handled: this.handled,\n            previousSession: this.id,\n            type: 'resume'\n        });\n        this.pendingAck = false;\n        this.outboundStarted = true;\n    }\n    enabled(resp) {\n        this.id = resp.id;\n        this.handled = 0;\n        this.inboundStarted = true;\n        this._cache();\n    }\n    resumed(resp) {\n        this.id = resp.previousSession;\n        if (resp.handled !== undefined) {\n            this.process(resp, true);\n        }\n        this.inboundStarted = true;\n        this._cache();\n    }\n    failed(resp) {\n        // Resumption might fail, but the server can still tell us how far\n        // the old session progressed.\n        if (resp.handled !== undefined) {\n            this.process(resp);\n        }\n        // We alert that any remaining unacked stanzas failed to send. It has\n        // been too long for auto-retrying these to be the right thing to do.\n        for (const [kind, stanza] of this.unacked) {\n            this.client.emit('stanza:failed', { kind, stanza });\n        }\n        this._reset();\n        this._cache();\n    }\n    ack() {\n        this.client.send('sm', {\n            handled: this.handled,\n            type: 'ack'\n        });\n    }\n    request() {\n        this.pendingAck = true;\n        this.client.send('sm', {\n            type: 'request'\n        });\n    }\n    process(ack, resend = false) {\n        if (ack.handled === undefined) {\n            return;\n        }\n        const numAcked = mod(ack.handled - this.lastAck, MAX_SEQ);\n        this.pendingAck = false;\n        for (let i = 0; i < numAcked && this.unacked.length > 0; i++) {\n            const [kind, stanza] = this.unacked.shift();\n            this.client.emit('stanza:acked', { kind, stanza });\n        }\n        this.lastAck = ack.handled;\n        if (resend) {\n            const resendUnacked = this.unacked;\n            this.unacked = [];\n            for (const [kind, stanza] of resendUnacked) {\n                this.client.send(kind, stanza);\n            }\n        }\n        this._cache();\n        if (this.needAck()) {\n            this.request();\n        }\n    }\n    track(kind, stanza) {\n        if (kind !== 'message' && kind !== 'presence' && kind !== 'iq') {\n            return;\n        }\n        if (this.outboundStarted) {\n            this.unacked.push([kind, stanza]);\n            this._cache();\n            if (this.needAck()) {\n                this.request();\n            }\n        }\n    }\n    handle() {\n        if (this.inboundStarted) {\n            this.handled = mod(this.handled + 1, MAX_SEQ);\n            this._cache();\n        }\n    }\n    needAck() {\n        return !this.pendingAck && this.unacked.length >= this.windowSize;\n    }\n    _cache() {\n        this.cacheHandler({\n            handled: this.handled,\n            id: this.id,\n            jid: this.client.jid,\n            lastAck: this.lastAck,\n            unacked: this.unacked\n        });\n    }\n    _reset() {\n        this.inboundStarted = false;\n        this.outboundStarted = false;\n        this.lastAck = 0;\n        this.handled = 0;\n        this.unacked = [];\n        this.pendingAck = false;\n    }\n}\n\nfunction retryRequest(url, opts, timeout, allowedRetries = 5) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let attempt = 0;\n        while (attempt <= allowedRetries) {\n            try {\n                const resp = yield timeoutPromise(nativeFetch(url, opts), timeout * 1000, () => {\n                    return new Error('Request timed out');\n                });\n                if (!resp.ok) {\n                    throw new Error('HTTP Status Error: ' + resp.status);\n                }\n                return resp.text();\n            }\n            catch (err) {\n                attempt += 1;\n                if (attempt > allowedRetries) {\n                    throw err;\n                }\n            }\n            yield sleep(Math.pow(attempt, 2) * 1000);\n        }\n        throw new Error('Request failed');\n    });\n}\nclass BOSHConnection {\n    constructor(client, sm, stanzas) {\n        this.maxRequests = 2;\n        this.maxHoldOpen = 1;\n        this.minPollingInterval = 5;\n        this.client = client;\n        this.sm = sm;\n        this.stanzas = stanzas;\n        this.sendBuffer = [];\n        this.requests = new Set();\n        this.authenticated = false;\n        this.lastResponseTime = Date.now();\n        this.pollingInterval = setInterval(() => {\n            if (this.authenticated &&\n                this.requests.size === 0 &&\n                this.sendBuffer.length === 0 &&\n                Date.now() - this.lastResponseTime >= this.minPollingInterval * 1000) {\n                this.longPoll();\n            }\n        }, 1000);\n    }\n    connect(opts) {\n        this.config = Object.assign({ maxRetries: 5, rid: Math.ceil(Math.random() * 9999999999), wait: 30 }, opts);\n        this.hasStream = false;\n        this.sm.started = false;\n        this.url = this.config.url;\n        this.sid = this.config.sid;\n        this.rid = this.config.rid;\n        this.requests.clear();\n        if (this.sid) {\n            this.hasStream = true;\n            this.stream = {};\n            this.client.emit('connected');\n            this.client.emit('session:prebind', this.config.jid);\n            this.client.emit('session:started');\n            return;\n        }\n        this.rid++;\n        this.request({\n            lang: this.config.lang,\n            maxHoldOpen: 1,\n            maxWaitTime: this.config.wait,\n            to: this.config.server,\n            version: '1.6',\n            xmppVersion: '1.0'\n        });\n    }\n    disconnect() {\n        clearInterval(this.pollingInterval);\n        if (this.hasStream) {\n            this.rid++;\n            this.request({\n                type: 'terminate'\n            });\n        }\n        else {\n            this.stream = undefined;\n            this.sid = undefined;\n            this.rid = undefined;\n            this.client.emit('disconnected', undefined);\n        }\n    }\n    restart() {\n        this.hasStream = false;\n        this.rid++;\n        this.request({\n            lang: this.config.lang,\n            to: this.config.server,\n            xmppRestart: true\n        });\n    }\n    send(dataOrName, data) {\n        if (data) {\n            const output = this.stanzas.export(dataOrName, data);\n            if (output) {\n                this.sendBuffer.push(output.toString());\n            }\n        }\n        else {\n            this.sendBuffer.push(dataOrName);\n        }\n        this.longPoll();\n    }\n    longPoll() {\n        const canReceive = !this.maxRequests || this.requests.size < this.maxRequests;\n        const canSend = !this.maxRequests ||\n            (this.sendBuffer.length > 0 && this.requests.size < this.maxRequests);\n        if (!this.sid || (!canReceive && !canSend)) {\n            return;\n        }\n        const stanzas = this.sendBuffer;\n        this.sendBuffer = [];\n        this.rid++;\n        this.request({}, stanzas);\n    }\n    request(meta, payloads = []) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const rid = this.rid;\n            this.requests.add(rid);\n            meta.rid = this.rid;\n            meta.sid = this.sid;\n            const bosh = this.stanzas.export('bosh', meta);\n            const body = [bosh.openTag(), ...payloads, bosh.closeTag()].join('');\n            this.client.emit('raw', 'outgoing', body);\n            try {\n                const respBody = yield retryRequest(this.url, {\n                    body,\n                    headers: {\n                        'Content-Type': 'text/xml'\n                    },\n                    method: 'POST'\n                }, this.config.wait * 1.1, this.config.maxRetries);\n                this.requests.delete(rid);\n                this.lastResponseTime = Date.now();\n                if (respBody) {\n                    const rawData = Buffer.from(respBody, 'utf8')\n                        .toString()\n                        .trim();\n                    if (rawData === '') {\n                        return;\n                    }\n                    this.client.emit('raw', 'incoming', rawData);\n                    const parser = new StreamParser({\n                        acceptLanguages: this.config.acceptLanguages,\n                        allowComments: false,\n                        lang: this.config.lang,\n                        registry: this.stanzas,\n                        rootKey: 'bosh',\n                        wrappedStream: true\n                    });\n                    parser.on('error', (err) => {\n                        const streamError = {\n                            condition: StreamErrorCondition.InvalidXML\n                        };\n                        this.client.emit('stream:error', streamError, err);\n                        this.send('error', streamError);\n                        return this.disconnect();\n                    });\n                    parser.on('data', (e) => {\n                        if (e.event === 'stream-start') {\n                            if (e.stanza.type === 'terminate') {\n                                this.hasStream = false;\n                                this.rid = undefined;\n                                this.sid = undefined;\n                                this.client.emit('bosh:terminate', e.stanza);\n                                this.client.emit('stream:end');\n                                this.client.emit('disconnected', undefined);\n                                return;\n                            }\n                            if (!this.hasStream) {\n                                this.hasStream = true;\n                                this.stream = e.stanza;\n                                this.sid = e.stanza.sid || this.sid;\n                                this.maxHoldOpen = e.stanza.maxHoldOpen || this.maxHoldOpen;\n                                this.maxRequests = e.stanza.maxRequests || this.maxRequests;\n                                this.minPollingInterval =\n                                    e.stanza.minPollingInterval || this.minPollingInterval;\n                                this.client.emit('stream:start', e.stanza);\n                            }\n                            return;\n                        }\n                        if (!e.event) {\n                            this.client.emit('stream:data', e.stanza, e.kind);\n                        }\n                    });\n                    parser.write(rawData);\n                }\n                if (meta.type === 'terminate') {\n                    this.closing = true;\n                }\n                // do not (re)start long polling if terminating, or request is pending, or before authentication\n                if (this.hasStream &&\n                    !this.closing &&\n                    this.authenticated &&\n                    (!this.requests.size || this.sendBuffer.length)) {\n                    clearTimeout(this.idleTimeout);\n                    this.idleTimeout = setTimeout(() => {\n                        this.longPoll();\n                    }, 100);\n                }\n            }\n            catch (err) {\n                this.hasStream = false;\n                this.client.emit('stream:error', {\n                    condition: 'connection-timeout'\n                }, err);\n                this.disconnect();\n            }\n        });\n    }\n}\n\nconst WS_OPEN = 1;\nclass WSConnection {\n    constructor(client, sm, stanzas) {\n        this.sm = sm;\n        this.stanzas = stanzas;\n        this.closing = false;\n        this.client = client;\n        this.sendQueue = priorityQueue((data, cb) => {\n            if (this.conn) {\n                data = Buffer.from(data, 'utf8').toString();\n                this.client.emit('raw', 'outgoing', data);\n                if (this.conn.readyState === WS_OPEN) {\n                    this.conn.send(data);\n                }\n            }\n            cb();\n        }, 1);\n    }\n    connect(opts) {\n        this.config = opts;\n        this.hasStream = false;\n        this.closing = false;\n        this.parser = new StreamParser({\n            acceptLanguages: this.config.acceptLanguages,\n            allowComments: false,\n            lang: this.config.lang,\n            registry: this.stanzas,\n            wrappedStream: false\n        });\n        this.parser.on('data', (e) => {\n            const name = e.kind;\n            const stanzaObj = e.stanza;\n            if (name === 'stream') {\n                if (stanzaObj.action === 'open') {\n                    this.hasStream = true;\n                    this.stream = stanzaObj;\n                    return this.client.emit('stream:start', stanzaObj);\n                }\n                if (stanzaObj.action === 'close') {\n                    this.client.emit('stream:end');\n                    return this.disconnect();\n                }\n            }\n            this.client.emit('stream:data', stanzaObj, name);\n        });\n        this.parser.on('error', (err) => {\n            const streamError = {\n                condition: StreamErrorCondition.InvalidXML\n            };\n            this.client.emit('stream:error', streamError, err);\n            this.send(this.stanzas.export('error', streamError).toString());\n            return this.disconnect();\n        });\n        this.conn = new nativeWS(opts.url, 'xmpp');\n        this.conn.onerror = (e) => {\n            if (e.preventDefault) {\n                e.preventDefault();\n            }\n            console.error(e);\n        };\n        this.conn.onclose = (e) => {\n            this.client.emit('disconnected', e);\n        };\n        this.conn.onopen = () => {\n            this.sm.started = false;\n            this.client.emit('connected');\n            this.send(this.startHeader());\n        };\n        this.conn.onmessage = wsMsg => {\n            const data = Buffer.from(wsMsg.data, 'utf8').toString();\n            this.client.emit('raw', 'incoming', data);\n            if (this.parser) {\n                this.parser.write(data);\n            }\n        };\n    }\n    disconnect() {\n        if (this.conn && !this.closing && this.hasStream) {\n            this.closing = true;\n            this.send(this.closeHeader());\n        }\n        else {\n            this.hasStream = false;\n            this.stream = undefined;\n            if (this.conn && this.conn.readyState === WS_OPEN) {\n                this.conn.close();\n            }\n            this.conn = undefined;\n        }\n    }\n    send(dataOrName, data) {\n        if (data) {\n            const output = this.stanzas.export(dataOrName, data);\n            if (output) {\n                this.sendQueue.push(output.toString(), 0);\n            }\n        }\n        else {\n            this.sendQueue.push(dataOrName, 0);\n        }\n    }\n    restart() {\n        this.hasStream = false;\n        this.send(this.startHeader());\n    }\n    startHeader() {\n        const header = this.stanzas.export('stream', {\n            action: 'open',\n            lang: this.config.lang,\n            to: this.config.server,\n            version: '1.0'\n        });\n        return header.toString();\n    }\n    closeHeader() {\n        const header = this.stanzas.export('stream', {\n            action: 'close'\n        });\n        return header.toString();\n    }\n}\n\nclass Client extends EventEmitter {\n    constructor(opts = {}) {\n        super();\n        this.setMaxListeners(100);\n        // Some EventEmitter shims don't include off()\n        this.off = this.removeListener;\n        this._initConfig(opts);\n        this.jid = '';\n        this.sasl = new Factory();\n        this.sasl.register('EXTERNAL', EXTERNAL, 1000);\n        this.sasl.register('SCRAM-SHA-256-PLUS', SCRAM, 350);\n        this.sasl.register('SCRAM-SHA-256', SCRAM, 300);\n        this.sasl.register('SCRAM-SHA-1-PLUS', SCRAM, 250);\n        this.sasl.register('SCRAM-SHA-1', SCRAM, 200);\n        this.sasl.register('DIGEST-MD5', DIGEST, 100);\n        this.sasl.register('X-OAUTH2', OAUTH, 100);\n        this.sasl.register('PLAIN', PLAIN, 1);\n        this.sasl.register('ANONYMOUS', ANONYMOUS, 0);\n        this.stanzas = new Registry();\n        this.stanzas.define(Protocol$19);\n        this.use(core);\n        this.sm = new StreamManagement(this);\n        this.transports = {\n            bosh: BOSHConnection,\n            websocket: WSConnection\n        };\n        this.on('stream:data', (json, kind) => {\n            this.emit(kind, json);\n            if (kind === 'message' || kind === 'presence' || kind === 'iq') {\n                this.sm.handle();\n                this.emit('stanza', json);\n            }\n            else if (kind === 'sm') {\n                if (json.type === 'ack') {\n                    this.emit('stream:management:ack', json);\n                    this.sm.process(json);\n                }\n                if (json.type === 'request') {\n                    this.sm.ack();\n                }\n                return;\n            }\n            if (json.id) {\n                this.emit((kind + ':id:' + json.id), json);\n            }\n        });\n        this.on('disconnected', () => {\n            if (this.transport) {\n                delete this.transport;\n            }\n        });\n        this.on('auth:success', () => {\n            if (this.transport) {\n                this.transport.authenticated = true;\n            }\n        });\n        this.on('iq', (iq) => {\n            const iqType = iq.type;\n            const payloadType = iq.payloadType;\n            const iqEvent = 'iq:' + iqType + ':' + payloadType;\n            if (iqType === 'get' || iqType === 'set') {\n                if (payloadType === 'invalid-payload-count') {\n                    return this.sendIQError(iq, {\n                        error: {\n                            condition: 'bad-request',\n                            type: 'modify'\n                        }\n                    });\n                }\n                if (payloadType === 'unknown-payload' || this.listenerCount(iqEvent) === 0) {\n                    return this.sendIQError(iq, {\n                        error: {\n                            condition: 'service-unavailable',\n                            type: 'cancel'\n                        }\n                    });\n                }\n                this.emit(iqEvent, iq);\n            }\n        });\n        this.on('message', msg => {\n            const isChat = (msg.alternateLanguageBodies && msg.alternateLanguageBodies.length) ||\n                (msg.links && msg.links.length);\n            const isMarker = msg.marker && msg.marker.type !== 'markable';\n            if (isChat && !isMarker) {\n                if (msg.type === 'chat' || msg.type === 'normal') {\n                    this.emit('chat', msg);\n                }\n                else if (msg.type === 'groupchat') {\n                    this.emit('groupchat', msg);\n                }\n            }\n            if (msg.type === 'error') {\n                this.emit('message:error', msg);\n            }\n        });\n        this.on('presence', (pres) => {\n            let presType = pres.type || 'available';\n            if (presType === 'error') {\n                presType = 'presence:error';\n            }\n            this.emit(presType, pres);\n        });\n    }\n    get stream() {\n        return this.transport ? this.transport.stream : undefined;\n    }\n    emit(name, ...args) {\n        // Continue supporting the most common and useful wildcard events\n        const res = super.emit(name, ...args);\n        if (name === 'raw') {\n            super.emit(`raw:${args[0]}`, args[1]);\n            super.emit('raw:*', `raw:${args[0]}`, args[1]);\n            super.emit('*', `raw:${args[0]}`, args[1]);\n        }\n        else {\n            super.emit('*', name, ...args);\n        }\n        return res;\n    }\n    use(pluginInit) {\n        if (typeof pluginInit !== 'function') {\n            return;\n        }\n        pluginInit(this, this.stanzas, this.config);\n    }\n    nextId() {\n        return uuid();\n    }\n    getCredentials() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._getConfiguredCredentials();\n        });\n    }\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const transportPref = ['websocket', 'bosh'];\n            let endpoints;\n            for (const name of transportPref) {\n                let conf = this.config.transports[name];\n                if (!conf) {\n                    continue;\n                }\n                if (typeof conf === 'string') {\n                    conf = { url: conf };\n                }\n                else if (conf === true) {\n                    if (!endpoints) {\n                        try {\n                            endpoints = yield this.discoverBindings(this.config.server);\n                        }\n                        catch (err) {\n                            console.error(err);\n                            continue;\n                        }\n                    }\n                    endpoints[name] = (endpoints[name] || []).filter(url => url.startsWith('wss:') || url.startsWith('https:'));\n                    if (!endpoints[name] || !endpoints[name].length) {\n                        continue;\n                    }\n                    conf = { url: endpoints[name][0] };\n                }\n                this.transport = new this.transports[name](this, this.sm, this.stanzas);\n                this.transport.connect(Object.assign({ acceptLanguages: this.config.acceptLanguages || ['en'], jid: this.config.jid, lang: this.config.lang || 'en', server: this.config.server, url: conf.url }, conf));\n                return;\n            }\n            console.error('No endpoints found for the requested transports.');\n            return this.disconnect();\n        });\n    }\n    disconnect() {\n        if (this.sessionStarted && !this.sm.started) {\n            // Only emit session:end if we had a session, and we aren't using\n            // stream management to keep the session alive.\n            this.emit('session:end');\n        }\n        this.sessionStarted = false;\n        if (this.transport) {\n            this.transport.disconnect();\n        }\n        else {\n            this.emit('disconnected');\n        }\n    }\n    send(name, data) {\n        this.sm.track(name, data);\n        if (this.transport) {\n            this.transport.send(name, data);\n        }\n    }\n    sendMessage(data) {\n        const id = data.id || this.nextId();\n        const msg = Object.assign({ id, originId: id }, data);\n        this.emit('message:sent', msg, false);\n        this.send('message', msg);\n        return msg.id;\n    }\n    sendPresence(data = {}) {\n        const pres = Object.assign({ id: this.nextId() }, data);\n        this.send('presence', pres);\n        return pres.id;\n    }\n    sendIQ(data) {\n        const iq = Object.assign({ id: this.nextId() }, data);\n        const allowed = allowedResponders(this.jid, data.to);\n        const respEvent = 'iq:id:' + iq.id;\n        const request = new Promise((resolve, reject) => {\n            const handler = (res) => {\n                // Only process result from the correct responder\n                if (!allowed.has(res.from)) {\n                    return;\n                }\n                // Only process result or error responses, if the responder\n                // happened to send us a request using the same ID value at\n                // the same time.\n                if (res.type !== 'result' && res.type !== 'error') {\n                    return;\n                }\n                this.off(respEvent, handler);\n                if (res.type === 'result') {\n                    resolve(res);\n                }\n                else {\n                    reject(res);\n                }\n            };\n            this.on(respEvent, handler);\n        });\n        this.send('iq', iq);\n        return timeoutPromise(request, (this.config.timeout || 15) * 1000, () => ({\n            error: {\n                condition: 'timeout'\n            },\n            id: iq.id,\n            type: 'error'\n        }));\n    }\n    sendIQResult(original, reply) {\n        this.send('iq', Object.assign(Object.assign({}, reply), { id: original.id, to: original.from, type: 'result' }));\n    }\n    sendIQError(original, error) {\n        this.send('iq', Object.assign(Object.assign({}, error), { id: original.id, to: original.from, type: 'error' }));\n    }\n    sendStreamError(error) {\n        this.emit('stream:error', error);\n        this.send('error', error);\n        this.disconnect();\n    }\n    _getConfiguredCredentials() {\n        const creds = this.config.credentials || {};\n        const requestedJID = parse(this.config.jid || '');\n        const username = creds.username || requestedJID.local;\n        const server = creds.host || requestedJID.domain;\n        return Object.assign({ host: server, password: this.config.password, realm: server, serviceName: server, serviceType: 'xmpp', username }, creds);\n    }\n    _initConfig(opts = {}) {\n        const currConfig = this.config || {};\n        this.config = Object.assign(Object.assign({ jid: '', transports: {\n                bosh: true,\n                websocket: true\n            }, useStreamManagement: true }, currConfig), opts);\n        if (!this.config.server) {\n            this.config.server = getDomain(this.config.jid);\n        }\n        if (this.config.password) {\n            this.config.credentials = this.config.credentials || {};\n            this.config.credentials.password = this.config.password;\n            delete this.config.password;\n        }\n    }\n}\n\n/**\n * Calculate the erase and insert actions needed to describe the user's edit operation.\n *\n * Based on the code point buffers before and after the edit, we find the single erase\n * and insert actions needed to describe the full change. We are minimizing the number\n * of deltas, not minimizing the number of affected code points.\n *\n * @param oldText The original buffer of Unicode code points before the user's edit action.\n * @param newText The new buffer of Unicode code points after the user's edit action.\n */\nfunction diff(oldText, newText) {\n    const oldLen = oldText.length;\n    const newLen = newText.length;\n    const searchLen = Math.min(oldLen, newLen);\n    let prefixSize = 0;\n    for (prefixSize = 0; prefixSize < searchLen; prefixSize++) {\n        if (oldText[prefixSize] !== newText[prefixSize]) {\n            break;\n        }\n    }\n    let suffixSize = 0;\n    for (suffixSize = 0; suffixSize < searchLen - prefixSize; suffixSize++) {\n        if (oldText[oldLen - suffixSize - 1] !== newText[newLen - suffixSize - 1]) {\n            break;\n        }\n    }\n    const matchedSize = prefixSize + suffixSize;\n    const events = [];\n    if (matchedSize < oldLen) {\n        events.push({\n            length: oldLen - matchedSize,\n            position: oldLen - suffixSize,\n            type: 'erase'\n        });\n    }\n    if (matchedSize < newLen) {\n        const insertedText = newText.slice(prefixSize, prefixSize + newLen - matchedSize);\n        events.push({\n            position: prefixSize,\n            text: Punycode.ucs2.encode(insertedText),\n            type: 'insert'\n        });\n    }\n    return events;\n}\n/**\n * Class for processing RTT events and providing a renderable string of the resulting text.\n */\nclass DisplayBuffer {\n    constructor(onStateChange, ignoreWaits = false) {\n        this.synced = false;\n        this.cursorPosition = 0;\n        this.sequenceNumber = 0;\n        this.ignoreWaits = false;\n        this.onStateChange =\n            onStateChange ||\n                function noop() {\n                    return;\n                };\n        this.ignoreWaits = ignoreWaits;\n        this.buffer = [];\n        this.resetActionQueue();\n    }\n    /**\n     * The encoded Unicode string to display.\n     */\n    get text() {\n        return Punycode.ucs2.encode(this.buffer.slice());\n    }\n    /**\n     * Mark the RTT message as completed and reset state.\n     */\n    commit() {\n        this.resetActionQueue();\n    }\n    /**\n     * Accept an RTT event for processing.\n     *\n     * A single event can contain multiple edit actions, including\n     * wait pauses.\n     *\n     * Events must be processed in order of their `seq` value in order\n     * to stay in sync.\n     *\n     * @param event {RTTEvent} The RTT event to process.\n     */\n    process(event) {\n        if (event.event === 'cancel' || event.event === 'init') {\n            this.resetActionQueue();\n        }\n        else if (event.event === 'reset' || event.event === 'new') {\n            this.resetActionQueue();\n            if (event.seq) {\n                this.sequenceNumber = event.seq;\n            }\n        }\n        else if (event.seq !== this.sequenceNumber) {\n            this.synced = false;\n        }\n        if (event.actions) {\n            const baseTime = Date.now();\n            let accumulatedWait = 0;\n            for (const action of event.actions) {\n                action.baseTime = baseTime + accumulatedWait;\n                if (action.type === 'wait') {\n                    accumulatedWait += action.duration;\n                }\n                this.actionQueue.push(action, 0);\n            }\n        }\n        this.sequenceNumber = this.sequenceNumber + 1;\n    }\n    /**\n     * Insert text into the Unicode code point buffer\n     *\n     * By default, the insertion position is the end of the buffer.\n     *\n     * @param text The raw text to insert\n     * @param position The position to start the insertion\n     */\n    insert(text = '', position = this.buffer.length) {\n        if (text.normalize) {\n            text = text.normalize('NFC');\n        }\n        const insertedText = Punycode.ucs2.decode(text);\n        this.buffer.splice(position, 0, ...insertedText);\n        this.cursorPosition = position + insertedText.length;\n        this.emitState();\n    }\n    /**\n     * Erase text from the Unicode code point buffer\n     *\n     * By default, the erased text length is `1`, and the position is the end of the buffer.\n     *\n     * @param length The number of code points to erase from the buffer, starting at {position} and erasing to the left.\n     * @param position The position to start erasing code points. Erasing continues to the left.\n     */\n    erase(length = 1, position = this.buffer.length) {\n        position = Math.max(Math.min(position, this.buffer.length), 0);\n        length = Math.max(Math.min(length, this.text.length), 0);\n        this.buffer.splice(Math.max(position - length, 0), length);\n        this.cursorPosition = Math.max(position - length, 0);\n        this.emitState();\n    }\n    emitState(additional = {}) {\n        this.onStateChange(Object.assign({ cursorPosition: this.cursorPosition, synced: this.synced, text: this.text }, additional));\n    }\n    /**\n     * Reset the processing state and queue.\n     *\n     * Used when 'init', 'new', 'reset', and 'cancel' RTT events are processed.\n     */\n    resetActionQueue() {\n        if (this.actionQueue) {\n            this.actionQueue.kill();\n        }\n        this.sequenceNumber = 0;\n        this.synced = true;\n        this.buffer = [];\n        this.emitState();\n        this.actionQueue = priorityQueue((action, done) => {\n            const currentTime = Date.now();\n            if (action.type === 'insert') {\n                this.insert(action.text, action.position);\n                return done();\n            }\n            else if (action.type === 'erase') {\n                this.erase(action.length, action.position);\n                return done();\n            }\n            else if (action.type === 'wait') {\n                if (this.ignoreWaits) {\n                    return done();\n                }\n                if (action.duration > 700) {\n                    action.duration = 700;\n                }\n                if (currentTime >= action.baseTime + action.duration) {\n                    return done();\n                }\n                else {\n                    setTimeout(() => done(), action.duration);\n                }\n            }\n            else {\n                return done();\n            }\n        }, 1);\n    }\n}\n/**\n * Class for tracking changes in a source text, and generating RTT events based on those changes.\n */\nclass InputBuffer {\n    constructor(onStateChange, ignoreWaits = false) {\n        this.resetInterval = 10000;\n        this.ignoreWaits = false;\n        this.isStarting = false;\n        this.isReset = false;\n        this.changedBetweenResets = false;\n        this.onStateChange =\n            onStateChange ||\n                function noop() {\n                    return;\n                };\n        this.ignoreWaits = ignoreWaits;\n        this.buffer = [];\n        this.actionQueue = [];\n        this.sequenceNumber = 0;\n    }\n    get text() {\n        return Punycode.ucs2.encode(this.buffer.slice());\n    }\n    /**\n     * Generate action deltas based on the new full state of the source text.\n     *\n     * The text provided here is the _entire_ source text, not a diff.\n     *\n     * @param text The new state of the user's text.\n     */\n    update(text) {\n        let actions = [];\n        if (text !== undefined) {\n            if (text.normalize) {\n                text = text.normalize('NFC');\n            }\n            const newBuffer = Punycode.ucs2.decode(text || '');\n            actions = diff(this.buffer, newBuffer.slice());\n            this.buffer = newBuffer;\n            this.emitState();\n        }\n        const now = Date.now();\n        if (this.changedBetweenResets && now - this.lastResetTime > this.resetInterval) {\n            this.actionQueue = [];\n            this.actionQueue.push({\n                position: 0,\n                text: this.text,\n                type: 'insert'\n            });\n            this.isReset = true;\n            this.lastActionTime = now;\n            this.lastResetTime = now;\n            this.changedBetweenResets = false;\n        }\n        else if (actions.length) {\n            const wait = now - (this.lastActionTime || now);\n            if (wait > 0 && !this.ignoreWaits) {\n                this.actionQueue.push({\n                    duration: wait,\n                    type: 'wait'\n                });\n            }\n            for (const action of actions) {\n                this.actionQueue.push(action);\n            }\n            this.lastActionTime = now;\n            this.changedBetweenResets = true;\n        }\n    }\n    /**\n     * Formally start an RTT session.\n     *\n     * Generates a random starting event sequence number.\n     *\n     * @param resetInterval {Milliseconds} Time to wait between using RTT reset events during editing.\n     */\n    start(resetInterval = this.resetInterval) {\n        this.commit();\n        this.isStarting = true;\n        this.resetInterval = resetInterval;\n        this.sequenceNumber = Math.floor(Math.random() * 10000 + 1);\n        return {\n            event: 'init'\n        };\n    }\n    /**\n     * Formally stops the RTT session.\n     */\n    stop() {\n        this.commit();\n        return {\n            event: 'cancel'\n        };\n    }\n    /**\n     * Generate an RTT event based on queued edit actions.\n     *\n     * The edit actions included in the event are all those made since the last\n     * time a diff was requested.\n     */\n    diff() {\n        this.update();\n        if (!this.actionQueue.length) {\n            return null;\n        }\n        const event = {\n            actions: this.actionQueue,\n            seq: this.sequenceNumber++\n        };\n        if (this.isStarting) {\n            event.event = 'new';\n            this.isStarting = false;\n            this.lastResetTime = Date.now();\n        }\n        else if (this.isReset) {\n            event.event = 'reset';\n            this.isReset = false;\n        }\n        this.actionQueue = [];\n        return event;\n    }\n    /**\n     * Reset the RTT session state to prepare for a new message text.\n     */\n    commit() {\n        this.sequenceNumber = 0;\n        this.lastActionTime = 0;\n        this.actionQueue = [];\n        this.buffer = [];\n    }\n    emitState() {\n        this.onStateChange({\n            text: this.text\n        });\n    }\n}\n\nvar RTT = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    diff: diff,\n    DisplayBuffer: DisplayBuffer,\n    InputBuffer: InputBuffer\n});\n\nconst VERSION$1 = VERSION;\nfunction createClient(opts) {\n    const client = new Client(opts);\n    client.use(Plugins);\n    return client;\n}\n\nexport { Client, Constants, JID, index as JXT, index$2 as Jingle, Namespaces, RTT, index$1 as SASL, index$3 as Stanzas, Utils, VERSION$1 as VERSION, core, createClient, getHostMeta };\n","/*!\r\n * js-logger - http://github.com/jonnyreeves/js-logger\r\n * Jonny Reeves, http://jonnyreeves.co.uk/\r\n * js-logger may be freely distributed under the MIT license.\r\n */\r\n(function (global) {\r\n\t\"use strict\";\r\n\r\n\t// Top level module for the global, static logger instance.\r\n\tvar Logger = { };\r\n\r\n\t// For those that are at home that are keeping score.\r\n\tLogger.VERSION = \"1.6.0\";\r\n\r\n\t// Function which handles all incoming log messages.\r\n\tvar logHandler;\r\n\r\n\t// Map of ContextualLogger instances by name; used by Logger.get() to return the same named instance.\r\n\tvar contextualLoggersByNameMap = {};\r\n\r\n\t// Polyfill for ES5's Function.bind.\r\n\tvar bind = function(scope, func) {\r\n\t\treturn function() {\r\n\t\t\treturn func.apply(scope, arguments);\r\n\t\t};\r\n\t};\r\n\r\n\t// Super exciting object merger-matron 9000 adding another 100 bytes to your download.\r\n\tvar merge = function () {\r\n\t\tvar args = arguments, target = args[0], key, i;\r\n\t\tfor (i = 1; i < args.length; i++) {\r\n\t\t\tfor (key in args[i]) {\r\n\t\t\t\tif (!(key in target) && args[i].hasOwnProperty(key)) {\r\n\t\t\t\t\ttarget[key] = args[i][key];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn target;\r\n\t};\r\n\r\n\t// Helper to define a logging level object; helps with optimisation.\r\n\tvar defineLogLevel = function(value, name) {\r\n\t\treturn { value: value, name: name };\r\n\t};\r\n\r\n\t// Predefined logging levels.\r\n\tLogger.TRACE = defineLogLevel(1, 'TRACE');\r\n\tLogger.DEBUG = defineLogLevel(2, 'DEBUG');\r\n\tLogger.INFO = defineLogLevel(3, 'INFO');\r\n\tLogger.TIME = defineLogLevel(4, 'TIME');\r\n\tLogger.WARN = defineLogLevel(5, 'WARN');\r\n\tLogger.ERROR = defineLogLevel(8, 'ERROR');\r\n\tLogger.OFF = defineLogLevel(99, 'OFF');\r\n\r\n\t// Inner class which performs the bulk of the work; ContextualLogger instances can be configured independently\r\n\t// of each other.\r\n\tvar ContextualLogger = function(defaultContext) {\r\n\t\tthis.context = defaultContext;\r\n\t\tthis.setLevel(defaultContext.filterLevel);\r\n\t\tthis.log = this.info;  // Convenience alias.\r\n\t};\r\n\r\n\tContextualLogger.prototype = {\r\n\t\t// Changes the current logging level for the logging instance.\r\n\t\tsetLevel: function (newLevel) {\r\n\t\t\t// Ensure the supplied Level object looks valid.\r\n\t\t\tif (newLevel && \"value\" in newLevel) {\r\n\t\t\t\tthis.context.filterLevel = newLevel;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// Gets the current logging level for the logging instance\r\n\t\tgetLevel: function () {\r\n\t\t\treturn this.context.filterLevel;\r\n\t\t},\r\n\r\n\t\t// Is the logger configured to output messages at the supplied level?\r\n\t\tenabledFor: function (lvl) {\r\n\t\t\tvar filterLevel = this.context.filterLevel;\r\n\t\t\treturn lvl.value >= filterLevel.value;\r\n\t\t},\r\n\r\n\t\ttrace: function () {\r\n\t\t\tthis.invoke(Logger.TRACE, arguments);\r\n\t\t},\r\n\r\n\t\tdebug: function () {\r\n\t\t\tthis.invoke(Logger.DEBUG, arguments);\r\n\t\t},\r\n\r\n\t\tinfo: function () {\r\n\t\t\tthis.invoke(Logger.INFO, arguments);\r\n\t\t},\r\n\r\n\t\twarn: function () {\r\n\t\t\tthis.invoke(Logger.WARN, arguments);\r\n\t\t},\r\n\r\n\t\terror: function () {\r\n\t\t\tthis.invoke(Logger.ERROR, arguments);\r\n\t\t},\r\n\r\n\t\ttime: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'start' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttimeEnd: function (label) {\r\n\t\t\tif (typeof label === 'string' && label.length > 0) {\r\n\t\t\t\tthis.invoke(Logger.TIME, [ label, 'end' ]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Invokes the logger callback if it's not being filtered.\r\n\t\tinvoke: function (level, msgArgs) {\r\n\t\t\tif (logHandler && this.enabledFor(level)) {\r\n\t\t\t\tlogHandler(msgArgs, merge({ level: level }, this.context));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Protected instance which all calls to the to level `Logger` module will be routed through.\r\n\tvar globalLogger = new ContextualLogger({ filterLevel: Logger.OFF });\r\n\r\n\t// Configure the global Logger instance.\r\n\t(function() {\r\n\t\t// Shortcut for optimisers.\r\n\t\tvar L = Logger;\r\n\r\n\t\tL.enabledFor = bind(globalLogger, globalLogger.enabledFor);\r\n\t\tL.trace = bind(globalLogger, globalLogger.trace);\r\n\t\tL.debug = bind(globalLogger, globalLogger.debug);\r\n\t\tL.time = bind(globalLogger, globalLogger.time);\r\n\t\tL.timeEnd = bind(globalLogger, globalLogger.timeEnd);\r\n\t\tL.info = bind(globalLogger, globalLogger.info);\r\n\t\tL.warn = bind(globalLogger, globalLogger.warn);\r\n\t\tL.error = bind(globalLogger, globalLogger.error);\r\n\r\n\t\t// Don't forget the convenience alias!\r\n\t\tL.log = L.info;\r\n\t}());\r\n\r\n\t// Set the global logging handler.  The supplied function should expect two arguments, the first being an arguments\r\n\t// object with the supplied log messages and the second being a context object which contains a hash of stateful\r\n\t// parameters which the logging function can consume.\r\n\tLogger.setHandler = function (func) {\r\n\t\tlogHandler = func;\r\n\t};\r\n\r\n\t// Sets the global logging filter level which applies to *all* previously registered, and future Logger instances.\r\n\t// (note that named loggers (retrieved via `Logger.get`) can be configured independently if required).\r\n\tLogger.setLevel = function(level) {\r\n\t\t// Set the globalLogger's level.\r\n\t\tglobalLogger.setLevel(level);\r\n\r\n\t\t// Apply this level to all registered contextual loggers.\r\n\t\tfor (var key in contextualLoggersByNameMap) {\r\n\t\t\tif (contextualLoggersByNameMap.hasOwnProperty(key)) {\r\n\t\t\t\tcontextualLoggersByNameMap[key].setLevel(level);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Gets the global logging filter level\r\n\tLogger.getLevel = function() {\r\n\t\treturn globalLogger.getLevel();\r\n\t};\r\n\r\n\t// Retrieve a ContextualLogger instance.  Note that named loggers automatically inherit the global logger's level,\r\n\t// default context and log handler.\r\n\tLogger.get = function (name) {\r\n\t\t// All logger instances are cached so they can be configured ahead of use.\r\n\t\treturn contextualLoggersByNameMap[name] ||\r\n\t\t\t(contextualLoggersByNameMap[name] = new ContextualLogger(merge({ name: name }, globalLogger.context)));\r\n\t};\r\n\r\n\t// CreateDefaultHandler returns a handler function which can be passed to `Logger.setHandler()` which will\r\n\t// write to the window's console object (if present); the optional options object can be used to customise the\r\n\t// formatter used to format each log message.\r\n\tLogger.createDefaultHandler = function (options) {\r\n\t\toptions = options || {};\r\n\r\n\t\toptions.formatter = options.formatter || function defaultMessageFormatter(messages, context) {\r\n\t\t\t// Prepend the logger's name to the log message for easy identification.\r\n\t\t\tif (context.name) {\r\n\t\t\t\tmessages.unshift(\"[\" + context.name + \"]\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Map of timestamps by timer labels used to track `#time` and `#timeEnd()` invocations in environments\r\n\t\t// that don't offer a native console method.\r\n\t\tvar timerStartTimeByLabelMap = {};\r\n\r\n\t\t// Support for IE8+ (and other, slightly more sane environments)\r\n\t\tvar invokeConsoleMethod = function (hdlr, messages) {\r\n\t\t\tFunction.prototype.apply.call(hdlr, console, messages);\r\n\t\t};\r\n\r\n\t\t// Check for the presence of a logger.\r\n\t\tif (typeof console === \"undefined\") {\r\n\t\t\treturn function () { /* no console */ };\r\n\t\t}\r\n\r\n\t\treturn function(messages, context) {\r\n\t\t\t// Convert arguments object to Array.\r\n\t\t\tmessages = Array.prototype.slice.call(messages);\r\n\r\n\t\t\tvar hdlr = console.log;\r\n\t\t\tvar timerLabel;\r\n\r\n\t\t\tif (context.level === Logger.TIME) {\r\n\t\t\t\ttimerLabel = (context.name ? '[' + context.name + '] ' : '') + messages[0];\r\n\r\n\t\t\t\tif (messages[1] === 'start') {\r\n\t\t\t\t\tif (console.time) {\r\n\t\t\t\t\t\tconsole.time(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttimerStartTimeByLabelMap[timerLabel] = new Date().getTime();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (console.timeEnd) {\r\n\t\t\t\t\t\tconsole.timeEnd(timerLabel);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tinvokeConsoleMethod(hdlr, [ timerLabel + ': ' +\r\n\t\t\t\t\t\t\t(new Date().getTime() - timerStartTimeByLabelMap[timerLabel]) + 'ms' ]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Delegate through to custom warn/error loggers if present on the console.\r\n\t\t\t\tif (context.level === Logger.WARN && console.warn) {\r\n\t\t\t\t\thdlr = console.warn;\r\n\t\t\t\t} else if (context.level === Logger.ERROR && console.error) {\r\n\t\t\t\t\thdlr = console.error;\r\n\t\t\t\t} else if (context.level === Logger.INFO && console.info) {\r\n\t\t\t\t\thdlr = console.info;\r\n\t\t\t\t} else if (context.level === Logger.DEBUG && console.debug) {\r\n\t\t\t\t\thdlr = console.debug;\r\n\t\t\t\t} else if (context.level === Logger.TRACE && console.trace) {\r\n\t\t\t\t\thdlr = console.trace;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.formatter(messages, context);\r\n\t\t\t\tinvokeConsoleMethod(hdlr, messages);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\t// Configure and example a Default implementation which writes to the `window.console` (if present).  The\r\n\t// `options` hash can be used to configure the default logLevel and provide a custom message formatter.\r\n\tLogger.useDefaults = function(options) {\r\n\t\tLogger.setLevel(options && options.defaultLevel || Logger.DEBUG);\r\n\t\tLogger.setHandler(Logger.createDefaultHandler(options));\r\n\t};\r\n\r\n\t// Export to popular environments boilerplate.\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(Logger);\r\n\t}\r\n\telse if (typeof module !== 'undefined' && module.exports) {\r\n\t\tmodule.exports = Logger;\r\n\t}\r\n\telse {\r\n\t\tLogger._prevLogger = global.Logger;\r\n\r\n\t\tLogger.noConflict = function () {\r\n\t\t\tglobal.Logger = Logger._prevLogger;\r\n\t\t\treturn Logger;\r\n\t\t};\r\n\r\n\t\tglobal.Logger = Logger;\r\n\t}\r\n}(this));\r\n","// This file replaces `index.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nif (process.env.NODE_ENV !== 'production') {\n  // All bundlers will remove this block in production bundle\n  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    throw new Error(\n      'React Native does not have a built-in secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use `nanoid/non-secure`. ' +\n      'For secure ID install `expo-random` locally and use `nanoid/async`.'\n    )\n  }\n  if (typeof self === 'undefined' || (!self.crypto && !self.msCrypto)) {\n    throw new Error(\n      'Your browser does not have secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use nanoid/non-secure.'\n    )\n  }\n}\n\nvar crypto = self.crypto || self.msCrypto\n\n// This alphabet uses a-z A-Z 0-9 _- symbols.\n// Symbols are generated for smaller size.\n// -_zyxwvutsrqponmlkjihgfedcba9876543210ZYXWVUTSRQPONMLKJIHGFEDCBA\nvar url = '-_'\n// Loop from 36 to 0 (from z to a and 9 to 0 in Base36).\nvar i = 36\nwhile (i--) {\n  // 36 is radix. Number.prototype.toString(36) returns number\n  // in Base36 representation. Base36 is like hex, but it uses 09 and a-z.\n  url += i.toString(36)\n}\n// Loop from 36 to 10 (from Z to A in Base36).\ni = 36\nwhile (i-- - 10) {\n  url += i.toString(36).toUpperCase()\n}\n\nmodule.exports = function (size) {\n  var id = ''\n  var bytes = crypto.getRandomValues(new Uint8Array(size || 21))\n  i = size || 21\n\n  // Compact alternative for `for (var i = 0; i < size; i++)`\n  while (i--) {\n    // We cant use bytes bigger than the alphabet. 63 is 00111111 bitmask.\n    // This mask reduces random byte 0-255 to 0-63 values.\n    // There is no need in `|| ''` and `* 1.6` hacks in here,\n    // because bitmask trim bytes exact to alphabet size.\n    id += url[bytes[i] & 63]\n  }\n  return id\n}\n","/* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? '/' + headerExtension.direction\n        : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n    'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n      mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n        mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(parts) {\n      return parts.attribute === 'cname';\n    });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n    .map(function(line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function(part) {\n        return parseInt(part, 10);\n      });\n    });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(obj) {\n      return obj.attribute === 'cname';\n    })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n    .map(function(line) {\n      return SDPUtils.parseSsrcMedia(line);\n    })\n    .filter(function(msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// SCTP\n// parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n// to draft-ietf-mmusic-sctp-sdp-05\nSDPUtils.parseSctpDescription = function(mediaSection) {\n  var mline = SDPUtils.parseMLine(mediaSection);\n  var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n  var maxMessageSize;\n  if (maxSizeLine.length > 0) {\n    maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n  }\n  if (isNaN(maxMessageSize)) {\n    maxMessageSize = 65536;\n  }\n  var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n  if (sctpPort.length > 0) {\n    return {\n      port: parseInt(sctpPort[0].substr(12), 10),\n      protocol: mline.fmt,\n      maxMessageSize: maxMessageSize\n    };\n  }\n  var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n  if (sctpMapLines.length > 0) {\n    var parts = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:')[0]\n      .substr(10)\n      .split(' ');\n    return {\n      port: parseInt(parts[0], 10),\n      protocol: parts[1],\n      maxMessageSize: maxMessageSize\n    };\n  }\n};\n\n// SCTP\n// outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n// support by now receiving in this format, unless we originally parsed\n// as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n// protocol of DTLS/SCTP -- without UDP/ or TCP/)\nSDPUtils.writeSctpDescription = function(media, sctp) {\n  var output = [];\n  if (media.protocol !== 'DTLS/SCTP') {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctp-port:' + sctp.port + '\\r\\n'\n    ];\n  } else {\n    output = [\n      'm=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n',\n      'c=IN IP4 0.0.0.0\\r\\n',\n      'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'\n    ];\n  }\n  if (sctp.maxMessageSize !== undefined) {\n    output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n  }\n  return output.join('');\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n    transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n    transceiver.dtlsTransport.getLocalParameters(),\n    type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*!\n * Bowser - a browser detector\n * https://github.com/ded/bowser\n * MIT License | (c) Dustin Diaz 2015\n */\n\n!function (root, name, definition) {\n  if (typeof module != 'undefined' && module.exports) module.exports = definition()\n  else if (typeof define == 'function' && define.amd) define(name, definition)\n  else root[name] = definition()\n}(this, 'bowser', function () {\n  /**\n    * See useragents.js for examples of navigator.userAgent\n    */\n\n  var t = true\n\n  function detect(ua) {\n\n    function getFirstMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[1]) || '';\n    }\n\n    function getSecondMatch(regex) {\n      var match = ua.match(regex);\n      return (match && match.length > 1 && match[2]) || '';\n    }\n\n    var iosdevice = getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase()\n      , likeAndroid = /like android/i.test(ua)\n      , android = !likeAndroid && /android/i.test(ua)\n      , nexusMobile = /nexus\\s*[0-6]\\s*/i.test(ua)\n      , nexusTablet = !nexusMobile && /nexus\\s*[0-9]+/i.test(ua)\n      , chromeos = /CrOS/.test(ua)\n      , silk = /silk/i.test(ua)\n      , sailfish = /sailfish/i.test(ua)\n      , tizen = /tizen/i.test(ua)\n      , webos = /(web|hpw)(o|0)s/i.test(ua)\n      , windowsphone = /windows phone/i.test(ua)\n      , samsungBrowser = /SamsungBrowser/i.test(ua)\n      , windows = !windowsphone && /windows/i.test(ua)\n      , mac = !iosdevice && !silk && /macintosh/i.test(ua)\n      , linux = !android && !sailfish && !tizen && !webos && /linux/i.test(ua)\n      , edgeVersion = getSecondMatch(/edg([ea]|ios)\\/(\\d+(\\.\\d+)?)/i)\n      , versionIdentifier = getFirstMatch(/version\\/(\\d+(\\.\\d+)?)/i)\n      , tablet = /tablet/i.test(ua) && !/tablet pc/i.test(ua)\n      , mobile = !tablet && /[^-]mobi/i.test(ua)\n      , xbox = /xbox/i.test(ua)\n      , result\n\n    if (/opera/i.test(ua)) {\n      //  an old Opera\n      result = {\n        name: 'Opera'\n      , opera: t\n      , version: versionIdentifier || getFirstMatch(/(?:opera|opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/opr\\/|opios/i.test(ua)) {\n      // a new Opera\n      result = {\n        name: 'Opera'\n        , opera: t\n        , version: getFirstMatch(/(?:opr|opios)[\\s\\/](\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/SamsungBrowser/i.test(ua)) {\n      result = {\n        name: 'Samsung Internet for Android'\n        , samsungBrowser: t\n        , version: versionIdentifier || getFirstMatch(/(?:SamsungBrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/Whale/i.test(ua)) {\n      result = {\n        name: 'NAVER Whale browser'\n        , whale: t\n        , version: getFirstMatch(/(?:whale)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/MZBrowser/i.test(ua)) {\n      result = {\n        name: 'MZ Browser'\n        , mzbrowser: t\n        , version: getFirstMatch(/(?:MZBrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/coast/i.test(ua)) {\n      result = {\n        name: 'Opera Coast'\n        , coast: t\n        , version: versionIdentifier || getFirstMatch(/(?:coast)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/focus/i.test(ua)) {\n      result = {\n        name: 'Focus'\n        , focus: t\n        , version: getFirstMatch(/(?:focus)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/yabrowser/i.test(ua)) {\n      result = {\n        name: 'Yandex Browser'\n      , yandexbrowser: t\n      , version: versionIdentifier || getFirstMatch(/(?:yabrowser)[\\s\\/](\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/ucbrowser/i.test(ua)) {\n      result = {\n          name: 'UC Browser'\n        , ucbrowser: t\n        , version: getFirstMatch(/(?:ucbrowser)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/mxios/i.test(ua)) {\n      result = {\n        name: 'Maxthon'\n        , maxthon: t\n        , version: getFirstMatch(/(?:mxios)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/epiphany/i.test(ua)) {\n      result = {\n        name: 'Epiphany'\n        , epiphany: t\n        , version: getFirstMatch(/(?:epiphany)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/puffin/i.test(ua)) {\n      result = {\n        name: 'Puffin'\n        , puffin: t\n        , version: getFirstMatch(/(?:puffin)[\\s\\/](\\d+(?:\\.\\d+)?)/i)\n      }\n    }\n    else if (/sleipnir/i.test(ua)) {\n      result = {\n        name: 'Sleipnir'\n        , sleipnir: t\n        , version: getFirstMatch(/(?:sleipnir)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (/k-meleon/i.test(ua)) {\n      result = {\n        name: 'K-Meleon'\n        , kMeleon: t\n        , version: getFirstMatch(/(?:k-meleon)[\\s\\/](\\d+(?:\\.\\d+)+)/i)\n      }\n    }\n    else if (windowsphone) {\n      result = {\n        name: 'Windows Phone'\n      , osname: 'Windows Phone'\n      , windowsphone: t\n      }\n      if (edgeVersion) {\n        result.msedge = t\n        result.version = edgeVersion\n      }\n      else {\n        result.msie = t\n        result.version = getFirstMatch(/iemobile\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/msie|trident/i.test(ua)) {\n      result = {\n        name: 'Internet Explorer'\n      , msie: t\n      , version: getFirstMatch(/(?:msie |rv:)(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (chromeos) {\n      result = {\n        name: 'Chrome'\n      , osname: 'Chrome OS'\n      , chromeos: t\n      , chromeBook: t\n      , chrome: t\n      , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    } else if (/edg([ea]|ios)/i.test(ua)) {\n      result = {\n        name: 'Microsoft Edge'\n      , msedge: t\n      , version: edgeVersion\n      }\n    }\n    else if (/vivaldi/i.test(ua)) {\n      result = {\n        name: 'Vivaldi'\n        , vivaldi: t\n        , version: getFirstMatch(/vivaldi\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (sailfish) {\n      result = {\n        name: 'Sailfish'\n      , osname: 'Sailfish OS'\n      , sailfish: t\n      , version: getFirstMatch(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/seamonkey\\//i.test(ua)) {\n      result = {\n        name: 'SeaMonkey'\n      , seamonkey: t\n      , version: getFirstMatch(/seamonkey\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/firefox|iceweasel|fxios/i.test(ua)) {\n      result = {\n        name: 'Firefox'\n      , firefox: t\n      , version: getFirstMatch(/(?:firefox|iceweasel|fxios)[ \\/](\\d+(\\.\\d+)?)/i)\n      }\n      if (/\\((mobile|tablet);[^\\)]*rv:[\\d\\.]+\\)/i.test(ua)) {\n        result.firefoxos = t\n        result.osname = 'Firefox OS'\n      }\n    }\n    else if (silk) {\n      result =  {\n        name: 'Amazon Silk'\n      , silk: t\n      , version : getFirstMatch(/silk\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/phantom/i.test(ua)) {\n      result = {\n        name: 'PhantomJS'\n      , phantom: t\n      , version: getFirstMatch(/phantomjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/slimerjs/i.test(ua)) {\n      result = {\n        name: 'SlimerJS'\n        , slimer: t\n        , version: getFirstMatch(/slimerjs\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (/blackberry|\\bbb\\d+/i.test(ua) || /rim\\stablet/i.test(ua)) {\n      result = {\n        name: 'BlackBerry'\n      , osname: 'BlackBerry OS'\n      , blackberry: t\n      , version: versionIdentifier || getFirstMatch(/blackberry[\\d]+\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (webos) {\n      result = {\n        name: 'WebOS'\n      , osname: 'WebOS'\n      , webos: t\n      , version: versionIdentifier || getFirstMatch(/w(?:eb)?osbrowser\\/(\\d+(\\.\\d+)?)/i)\n      };\n      /touchpad\\//i.test(ua) && (result.touchpad = t)\n    }\n    else if (/bada/i.test(ua)) {\n      result = {\n        name: 'Bada'\n      , osname: 'Bada'\n      , bada: t\n      , version: getFirstMatch(/dolfin\\/(\\d+(\\.\\d+)?)/i)\n      };\n    }\n    else if (tizen) {\n      result = {\n        name: 'Tizen'\n      , osname: 'Tizen'\n      , tizen: t\n      , version: getFirstMatch(/(?:tizen\\s?)?browser\\/(\\d+(\\.\\d+)?)/i) || versionIdentifier\n      };\n    }\n    else if (/qupzilla/i.test(ua)) {\n      result = {\n        name: 'QupZilla'\n        , qupzilla: t\n        , version: getFirstMatch(/(?:qupzilla)[\\s\\/](\\d+(?:\\.\\d+)+)/i) || versionIdentifier\n      }\n    }\n    else if (/chromium/i.test(ua)) {\n      result = {\n        name: 'Chromium'\n        , chromium: t\n        , version: getFirstMatch(/(?:chromium)[\\s\\/](\\d+(?:\\.\\d+)?)/i) || versionIdentifier\n      }\n    }\n    else if (/chrome|crios|crmo/i.test(ua)) {\n      result = {\n        name: 'Chrome'\n        , chrome: t\n        , version: getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.\\d+)?)/i)\n      }\n    }\n    else if (android) {\n      result = {\n        name: 'Android'\n        , version: versionIdentifier\n      }\n    }\n    else if (/safari|applewebkit/i.test(ua)) {\n      result = {\n        name: 'Safari'\n      , safari: t\n      }\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if (iosdevice) {\n      result = {\n        name : iosdevice == 'iphone' ? 'iPhone' : iosdevice == 'ipad' ? 'iPad' : 'iPod'\n      }\n      // WTF: version is not part of user agent in web apps\n      if (versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    }\n    else if(/googlebot/i.test(ua)) {\n      result = {\n        name: 'Googlebot'\n      , googlebot: t\n      , version: getFirstMatch(/googlebot\\/(\\d+(\\.\\d+))/i) || versionIdentifier\n      }\n    }\n    else {\n      result = {\n        name: getFirstMatch(/^(.*)\\/(.*) /),\n        version: getSecondMatch(/^(.*)\\/(.*) /)\n     };\n   }\n\n    // set webkit or gecko flag for browsers based on these engines\n    if (!result.msedge && /(apple)?webkit/i.test(ua)) {\n      if (/(apple)?webkit\\/537\\.36/i.test(ua)) {\n        result.name = result.name || \"Blink\"\n        result.blink = t\n      } else {\n        result.name = result.name || \"Webkit\"\n        result.webkit = t\n      }\n      if (!result.version && versionIdentifier) {\n        result.version = versionIdentifier\n      }\n    } else if (!result.opera && /gecko\\//i.test(ua)) {\n      result.name = result.name || \"Gecko\"\n      result.gecko = t\n      result.version = result.version || getFirstMatch(/gecko\\/(\\d+(\\.\\d+)?)/i)\n    }\n\n    // set OS flags for platforms that have multiple browsers\n    if (!result.windowsphone && (android || result.silk)) {\n      result.android = t\n      result.osname = 'Android'\n    } else if (!result.windowsphone && iosdevice) {\n      result[iosdevice] = t\n      result.ios = t\n      result.osname = 'iOS'\n    } else if (mac) {\n      result.mac = t\n      result.osname = 'macOS'\n    } else if (xbox) {\n      result.xbox = t\n      result.osname = 'Xbox'\n    } else if (windows) {\n      result.windows = t\n      result.osname = 'Windows'\n    } else if (linux) {\n      result.linux = t\n      result.osname = 'Linux'\n    }\n\n    function getWindowsVersion (s) {\n      switch (s) {\n        case 'NT': return 'NT'\n        case 'XP': return 'XP'\n        case 'NT 5.0': return '2000'\n        case 'NT 5.1': return 'XP'\n        case 'NT 5.2': return '2003'\n        case 'NT 6.0': return 'Vista'\n        case 'NT 6.1': return '7'\n        case 'NT 6.2': return '8'\n        case 'NT 6.3': return '8.1'\n        case 'NT 10.0': return '10'\n        default: return undefined\n      }\n    }\n\n    // OS version extraction\n    var osVersion = '';\n    if (result.windows) {\n      osVersion = getWindowsVersion(getFirstMatch(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i))\n    } else if (result.windowsphone) {\n      osVersion = getFirstMatch(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i);\n    } else if (result.mac) {\n      osVersion = getFirstMatch(/Mac OS X (\\d+([_\\.\\s]\\d+)*)/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (iosdevice) {\n      osVersion = getFirstMatch(/os (\\d+([_\\s]\\d+)*) like mac os x/i);\n      osVersion = osVersion.replace(/[_\\s]/g, '.');\n    } else if (android) {\n      osVersion = getFirstMatch(/android[ \\/-](\\d+(\\.\\d+)*)/i);\n    } else if (result.webos) {\n      osVersion = getFirstMatch(/(?:web|hpw)os\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.blackberry) {\n      osVersion = getFirstMatch(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i);\n    } else if (result.bada) {\n      osVersion = getFirstMatch(/bada\\/(\\d+(\\.\\d+)*)/i);\n    } else if (result.tizen) {\n      osVersion = getFirstMatch(/tizen[\\/\\s](\\d+(\\.\\d+)*)/i);\n    }\n    if (osVersion) {\n      result.osversion = osVersion;\n    }\n\n    // device type extraction\n    var osMajorVersion = !result.windows && osVersion.split('.')[0];\n    if (\n         tablet\n      || nexusTablet\n      || iosdevice == 'ipad'\n      || (android && (osMajorVersion == 3 || (osMajorVersion >= 4 && !mobile)))\n      || result.silk\n    ) {\n      result.tablet = t\n    } else if (\n         mobile\n      || iosdevice == 'iphone'\n      || iosdevice == 'ipod'\n      || android\n      || nexusMobile\n      || result.blackberry\n      || result.webos\n      || result.bada\n    ) {\n      result.mobile = t\n    }\n\n    // Graded Browser Support\n    // http://developer.yahoo.com/yui/articles/gbs\n    if (result.msedge ||\n        (result.msie && result.version >= 10) ||\n        (result.yandexbrowser && result.version >= 15) ||\n\t\t    (result.vivaldi && result.version >= 1.0) ||\n        (result.chrome && result.version >= 20) ||\n        (result.samsungBrowser && result.version >= 4) ||\n        (result.whale && compareVersions([result.version, '1.0']) === 1) ||\n        (result.mzbrowser && compareVersions([result.version, '6.0']) === 1) ||\n        (result.focus && compareVersions([result.version, '1.0']) === 1) ||\n        (result.firefox && result.version >= 20.0) ||\n        (result.safari && result.version >= 6) ||\n        (result.opera && result.version >= 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] >= 6) ||\n        (result.blackberry && result.version >= 10.1)\n        || (result.chromium && result.version >= 20)\n        ) {\n      result.a = t;\n    }\n    else if ((result.msie && result.version < 10) ||\n        (result.chrome && result.version < 20) ||\n        (result.firefox && result.version < 20.0) ||\n        (result.safari && result.version < 6) ||\n        (result.opera && result.version < 10.0) ||\n        (result.ios && result.osversion && result.osversion.split(\".\")[0] < 6)\n        || (result.chromium && result.version < 20)\n        ) {\n      result.c = t\n    } else result.x = t\n\n    return result\n  }\n\n  var bowser = detect(typeof navigator !== 'undefined' ? navigator.userAgent || '' : '')\n\n  bowser.test = function (browserList) {\n    for (var i = 0; i < browserList.length; ++i) {\n      var browserItem = browserList[i];\n      if (typeof browserItem=== 'string') {\n        if (browserItem in bowser) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get version precisions count\n   *\n   * @example\n   *   getVersionPrecision(\"1.10.3\") // 3\n   *\n   * @param  {string} version\n   * @return {number}\n   */\n  function getVersionPrecision(version) {\n    return version.split(\".\").length;\n  }\n\n  /**\n   * Array::map polyfill\n   *\n   * @param  {Array} arr\n   * @param  {Function} iterator\n   * @return {Array}\n   */\n  function map(arr, iterator) {\n    var result = [], i;\n    if (Array.prototype.map) {\n      return Array.prototype.map.call(arr, iterator);\n    }\n    for (i = 0; i < arr.length; i++) {\n      result.push(iterator(arr[i]));\n    }\n    return result;\n  }\n\n  /**\n   * Calculate browser version weight\n   *\n   * @example\n   *   compareVersions(['1.10.2.1',  '1.8.2.1.90'])    // 1\n   *   compareVersions(['1.010.2.1', '1.09.2.1.90']);  // 1\n   *   compareVersions(['1.10.2.1',  '1.10.2.1']);     // 0\n   *   compareVersions(['1.10.2.1',  '1.0800.2']);     // -1\n   *\n   * @param  {Array<String>} versions versions to compare\n   * @return {Number} comparison result\n   */\n  function compareVersions(versions) {\n    // 1) get common precision for both versions, for example for \"10.0\" and \"9\" it should be 2\n    var precision = Math.max(getVersionPrecision(versions[0]), getVersionPrecision(versions[1]));\n    var chunks = map(versions, function (version) {\n      var delta = precision - getVersionPrecision(version);\n\n      // 2) \"9\" -> \"9.0\" (for precision = 2)\n      version = version + new Array(delta + 1).join(\".0\");\n\n      // 3) \"9.0\" -> [\"000000000\"\", \"000000009\"]\n      return map(version.split(\".\"), function (chunk) {\n        return new Array(20 - chunk.length).join(\"0\") + chunk;\n      }).reverse();\n    });\n\n    // iterate in reverse order by reversed chunks array\n    while (--precision >= 0) {\n      // 4) compare: \"000000009\" > \"000000010\" = false (but \"9\" > \"10\" = true)\n      if (chunks[0][precision] > chunks[1][precision]) {\n        return 1;\n      }\n      else if (chunks[0][precision] === chunks[1][precision]) {\n        if (precision === 0) {\n          // all version chunks are same\n          return 0;\n        }\n      }\n      else {\n        return -1;\n      }\n    }\n  }\n\n  /**\n   * Check if browser is unsupported\n   *\n   * @example\n   *   bowser.isUnsupportedBrowser({\n   *     msie: \"10\",\n   *     firefox: \"23\",\n   *     chrome: \"29\",\n   *     safari: \"5.1\",\n   *     opera: \"16\",\n   *     phantom: \"534\"\n   *   });\n   *\n   * @param  {Object}  minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function isUnsupportedBrowser(minVersions, strictMode, ua) {\n    var _bowser = bowser;\n\n    // make strictMode param optional with ua param usage\n    if (typeof strictMode === 'string') {\n      ua = strictMode;\n      strictMode = void(0);\n    }\n\n    if (strictMode === void(0)) {\n      strictMode = false;\n    }\n    if (ua) {\n      _bowser = detect(ua);\n    }\n\n    var version = \"\" + _bowser.version;\n    for (var browser in minVersions) {\n      if (minVersions.hasOwnProperty(browser)) {\n        if (_bowser[browser]) {\n          if (typeof minVersions[browser] !== 'string') {\n            throw new Error('Browser version in the minVersion map should be a string: ' + browser + ': ' + String(minVersions));\n          }\n\n          // browser version and min supported version.\n          return compareVersions([version, minVersions[browser]]) < 0;\n        }\n      }\n    }\n\n    return strictMode; // not found\n  }\n\n  /**\n   * Check if browser is supported\n   *\n   * @param  {Object} minVersions map of minimal version to browser\n   * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map\n   * @param  {String}  [ua] user agent string\n   * @return {Boolean}\n   */\n  function check(minVersions, strictMode, ua) {\n    return !isUnsupportedBrowser(minVersions, strictMode, ua);\n  }\n\n  bowser.isUnsupportedBrowser = isUnsupportedBrowser;\n  bowser.compareVersions = compareVersions;\n  bowser.check = check;\n\n  /*\n   * Set our detect method to the main bowser object so we can\n   * reuse it to test other user agents.\n   * This is needed to implement future tests.\n   */\n  bowser._detect = detect;\n\n  /*\n   * Set our detect public method to the main bowser object\n   * This is needed to implement bowser in server side\n   */\n  bowser.detect = detect;\n  return bowser\n});\n","/*! https://mths.be/punycode v1.4.1 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports &&\n\t\t!exports.nodeType && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\t!module.nodeType && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (\n\t\tfreeGlobal.global === freeGlobal ||\n\t\tfreeGlobal.window === freeGlobal ||\n\t\tfreeGlobal.self === freeGlobal\n\t) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^\\x20-\\x7E]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow new RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\tvar result = [];\n\t\twhile (length--) {\n\t\t\tresult[length] = fn(array[length]);\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings or email\n\t * addresses.\n\t * @private\n\t * @param {String} domain The domain name or email address.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\tvar parts = string.split('@');\n\t\tvar result = '';\n\t\tif (parts.length > 1) {\n\t\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t\t// the local part (i.e. everything up to `@`) intact.\n\t\t\tresult = parts[0] + '@';\n\t\t\tstring = parts[1];\n\t\t}\n\t\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\t\tstring = string.replace(regexSeparators, '\\x2E');\n\t\tvar labels = string.split('.');\n\t\tvar encoded = map(labels, fn).join('.');\n\t\treturn result + encoded;\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * https://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols (e.g. a domain name label) to a\n\t * Punycode string of ASCII-only symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name or an email address\n\t * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n\t * it doesn't matter if you call it on a string that has already been\n\t * converted to Unicode.\n\t * @memberOf punycode\n\t * @param {String} input The Punycoded domain name or email address to\n\t * convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name or an email address to\n\t * Punycode. Only the non-ASCII parts of the domain name will be converted,\n\t * i.e. it doesn't matter if you call it with a domain that's already in\n\t * ASCII.\n\t * @memberOf punycode\n\t * @param {String} input The domain name or email address to convert, as a\n\t * Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name or\n\t * email address.\n\t */\n\tfunction toASCII(input) {\n\t\treturn mapDomain(input, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.4.1',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && freeModule) {\n\t\tif (module.exports == freeExports) {\n\t\t\t// in Node.js, io.js, or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else {\n\t\t\t// in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\nfunction log(...args) {\n\t// This hackery is required for IE8/9, where\n\t// the `console.log` function doesn't have 'apply'\n\treturn typeof console === 'object' &&\n\t\tconsole.log &&\n\t\tconsole.log(...args);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","'use strict';\nvar strictUriEncode = require('strict-uri-encode');\nvar objectAssign = require('object-assign');\n\nfunction encoderForArrayFormat(opts) {\n\tswitch (opts.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn function (key, value, index) {\n\t\t\t\treturn value === null ? [\n\t\t\t\t\tencode(key, opts),\n\t\t\t\t\t'[',\n\t\t\t\t\tindex,\n\t\t\t\t\t']'\n\t\t\t\t].join('') : [\n\t\t\t\t\tencode(key, opts),\n\t\t\t\t\t'[',\n\t\t\t\t\tencode(index, opts),\n\t\t\t\t\t']=',\n\t\t\t\t\tencode(value, opts)\n\t\t\t\t].join('');\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn function (key, value) {\n\t\t\t\treturn value === null ? encode(key, opts) : [\n\t\t\t\t\tencode(key, opts),\n\t\t\t\t\t'[]=',\n\t\t\t\t\tencode(value, opts)\n\t\t\t\t].join('');\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn function (key, value) {\n\t\t\t\treturn value === null ? encode(key, opts) : [\n\t\t\t\t\tencode(key, opts),\n\t\t\t\t\t'=',\n\t\t\t\t\tencode(value, opts)\n\t\t\t\t].join('');\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(opts) {\n\tvar result;\n\n\tswitch (opts.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn function (key, value, accumulator) {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn function (key, value, accumulator) {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t} else if (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn function (key, value, accumulator) {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction encode(value, opts) {\n\tif (opts.encode) {\n\t\treturn opts.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t} else if (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input)).sort(function (a, b) {\n\t\t\treturn Number(a) - Number(b);\n\t\t}).map(function (key) {\n\t\t\treturn input[key];\n\t\t});\n\t}\n\n\treturn input;\n}\n\nexports.extract = function (str) {\n\treturn str.split('?')[1] || '';\n};\n\nexports.parse = function (str, opts) {\n\topts = objectAssign({arrayFormat: 'none'}, opts);\n\n\tvar formatter = parserForArrayFormat(opts);\n\n\t// Create an object with no prototype\n\t// https://github.com/sindresorhus/query-string/issues/47\n\tvar ret = Object.create(null);\n\n\tif (typeof str !== 'string') {\n\t\treturn ret;\n\t}\n\n\tstr = str.trim().replace(/^(\\?|#|&)/, '');\n\n\tif (!str) {\n\t\treturn ret;\n\t}\n\n\tstr.split('&').forEach(function (param) {\n\t\tvar parts = param.replace(/\\+/g, ' ').split('=');\n\t\t// Firefox (pre 40) decodes `%3D` to `=`\n\t\t// https://github.com/sindresorhus/query-string/pull/37\n\t\tvar key = parts.shift();\n\t\tvar val = parts.length > 0 ? parts.join('=') : undefined;\n\n\t\t// missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tval = val === undefined ? null : decodeURIComponent(val);\n\n\t\tformatter(decodeURIComponent(key), val, ret);\n\t});\n\n\treturn Object.keys(ret).sort().reduce(function (result, key) {\n\t\tvar val = ret[key];\n\t\tif (Boolean(val) && typeof val === 'object' && !Array.isArray(val)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(val);\n\t\t} else {\n\t\t\tresult[key] = val;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n};\n\nexports.stringify = function (obj, opts) {\n\tvar defaults = {\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none'\n\t};\n\n\topts = objectAssign(defaults, opts);\n\n\tvar formatter = encoderForArrayFormat(opts);\n\n\treturn obj ? Object.keys(obj).sort().map(function (key) {\n\t\tvar val = obj[key];\n\n\t\tif (val === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (val === null) {\n\t\t\treturn encode(key, opts);\n\t\t}\n\n\t\tif (Array.isArray(val)) {\n\t\t\tvar result = [];\n\n\t\t\tval.slice().forEach(function (val2) {\n\t\t\t\tif (val2 === undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tresult.push(formatter(key, val2, result.length));\n\t\t\t});\n\n\t\t\treturn result.join('&');\n\t\t}\n\n\t\treturn encode(key, opts) + '=' + encode(val, opts);\n\t}).filter(function (x) {\n\t\treturn x.length > 0;\n\t}).join('&') : '';\n};\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","exports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = exports;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    keys.push(key);\n  }return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\n\nutil.inherits(Duplex, Readable);\n\n{\n  // avoid scope creep, the keys array can then be collected\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\n\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n\n  Readable.call(this, options);\n  Writable.call(this, options);\n\n  if (options && options.readable === false) this.readable = false;\n\n  if (options && options.writable === false) this.writable = false;\n\n  this.allowHalfOpen = true;\n  if (options && options.allowHalfOpen === false) this.allowHalfOpen = false;\n\n  this.once('end', onend);\n}\n\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // if we allow half-open state, or if the writable side ended,\n  // then we're ok.\n  if (this.allowHalfOpen || this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  pna.nextTick(onEndNT, this);\n}\n\nfunction onEndNT(self) {\n  self.end();\n}\n\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  get: function () {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});\n\nDuplex.prototype._destroy = function (err, cb) {\n  this.push(null);\n  this.end();\n\n  pna.nextTick(cb, err);\n};","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  var args = [].slice.call(arguments, 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * Module dependencies.\n */\n\nvar keys = require('./keys');\nvar hasBinary = require('has-binary2');\nvar sliceBuffer = require('arraybuffer.slice');\nvar after = require('after');\nvar utf8 = require('./utf8');\n\nvar base64encoder;\nif (typeof ArrayBuffer !== 'undefined') {\n  base64encoder = require('base64-arraybuffer');\n}\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = typeof navigator !== 'undefined' && /Android/i.test(navigator.userAgent);\n\n/**\n * Check if we are running in PhantomJS.\n * Uploading a Blob with PhantomJS does not work correctly, as reported here:\n * https://github.com/ariya/phantomjs/issues/11395\n * @type boolean\n */\nvar isPhantomJS = typeof navigator !== 'undefined' && /PhantomJS/i.test(navigator.userAgent);\n\n/**\n * When true, avoids using Blobs to encode payloads.\n * @type boolean\n */\nvar dontSendBlobs = isAndroid || isPhantomJS;\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = require('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if (typeof utf8encode === 'function') {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (typeof Blob !== 'undefined' && data instanceof Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // might be an object with { base64: true, data: dataAsBase64String }\n  if (data && data.base64) {\n    return encodeBase64Object(packet, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\nfunction encodeBase64Object(packet, callback) {\n  // packet data is an object { base64: true, data: dataAsBase64String }\n  var message = 'b' + exports.packets[packet.type] + packet.data.data;\n  return callback(message);\n}\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    exports.encodePacket({ type: packet.type, data: fr.result }, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (dontSendBlobs) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (typeof Blob !== 'undefined' && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  if (data === undefined) {\n    return err;\n  }\n  // String data\n  if (typeof data === 'string') {\n    if (data.charAt(0) === 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      data = tryDecode(data);\n      if (data === false) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\nfunction tryDecode(data) {\n  try {\n    data = utf8.decode(data, { strict: false });\n  } catch (e) {\n    return false;\n  }\n  return data;\n}\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!base64encoder) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  var isBinary = hasBinary(packets);\n\n  if (supportsBinary && isBinary) {\n    if (Blob && !dontSendBlobs) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, !isBinary ? false : supportsBinary, false, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data !== 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data === '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = '', n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (chr !== ':') {\n      length += chr;\n      continue;\n    }\n\n    if (length === '' || (length != (n = Number(length)))) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    msg = data.substr(i + 1, n);\n\n    if (length != msg.length) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    if (msg.length) {\n      packet = exports.decodePacket(msg, binaryType, false);\n\n      if (err.type === packet.type && err.data === packet.data) {\n        // parser error in individual packet - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      var ret = callback(packet, i + n, l);\n      if (false === ret) return;\n    }\n\n    // advance cursor\n    i += n;\n    length = '';\n  }\n\n  if (length !== '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] === 255) break;\n\n      // 310 = char length of Number.MAX_VALUE\n      if (msgLength.length > 310) {\n        return callback(err, 0, 1);\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\n\nfunction isArray(arg) {\n  if (Array.isArray) {\n    return Array.isArray(arg);\n  }\n  return objectToString(arg) === '[object Array]';\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = Buffer.isBuffer;\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\n\nif (typeof process === 'undefined' ||\n    !process.version ||\n    process.version.indexOf('v0.') === 0 ||\n    process.version.indexOf('v1.') === 0 && process.version.indexOf('v1.8.') !== 0) {\n  module.exports = { nextTick: nextTick };\n} else {\n  module.exports = process\n}\n\nfunction nextTick(fn, arg1, arg2, arg3) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('\"callback\" argument must be a function');\n  }\n  var len = arguments.length;\n  var args, i;\n  switch (len) {\n  case 0:\n  case 1:\n    return process.nextTick(fn);\n  case 2:\n    return process.nextTick(function afterTickOne() {\n      fn.call(null, arg1);\n    });\n  case 3:\n    return process.nextTick(function afterTickTwo() {\n      fn.call(null, arg1, arg2);\n    });\n  case 4:\n    return process.nextTick(function afterTickThree() {\n      fn.call(null, arg1, arg2, arg3);\n    });\n  default:\n    args = new Array(len - 1);\n    i = 0;\n    while (i < args.length) {\n      args[i++] = arguments[i];\n    }\n    return process.nextTick(function afterTick() {\n      fn.apply(null, args);\n    });\n  }\n}\n\n","/**\r\n * Compiles a querystring\r\n * Returns string representation of the object\r\n *\r\n * @param {Object}\r\n * @api private\r\n */\r\n\r\nexports.encode = function (obj) {\r\n  var str = '';\r\n\r\n  for (var i in obj) {\r\n    if (obj.hasOwnProperty(i)) {\r\n      if (str.length) str += '&';\r\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\r\n    }\r\n  }\r\n\r\n  return str;\r\n};\r\n\r\n/**\r\n * Parses a simple querystring into an object\r\n *\r\n * @param {String} qs\r\n * @api private\r\n */\r\n\r\nexports.decode = function(qs){\r\n  var qry = {};\r\n  var pairs = qs.split('&');\r\n  for (var i = 0, l = pairs.length; i < l; i++) {\r\n    var pair = pairs[i].split('=');\r\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\r\n  }\r\n  return qry;\r\n};\r\n","\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","\n/**\n * Module dependencies.\n */\n\nvar url = require('./url');\nvar parser = require('socket.io-parser');\nvar Manager = require('./manager');\nvar debug = require('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup (uri, opts) {\n  if (typeof uri === 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var path = parsed.path;\n  var sameNamespace = cache[id] && path in cache[id].nsps;\n  var newConnection = opts.forceNew || opts['force new connection'] ||\n                      false === opts.multiplex || sameNamespace;\n\n  var io;\n\n  if (newConnection) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n  if (parsed.query && !opts.query) {\n    opts.query = parsed.query;\n  }\n  return io.socket(parsed.path, opts);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = require('./manager');\nexports.Socket = require('./socket');\n","\"use strict\";\n;\n;\n;\nvar isWebSocket = function (constructor) {\n    return constructor && constructor.CLOSING === 2;\n};\nvar isGlobalWebSocket = function () {\n    return typeof WebSocket !== 'undefined' && isWebSocket(WebSocket);\n};\nvar getDefaultOptions = function () { return ({\n    constructor: isGlobalWebSocket() ? WebSocket : null,\n    maxReconnectionDelay: 10000,\n    minReconnectionDelay: 1500,\n    reconnectionDelayGrowFactor: 1.3,\n    connectionTimeout: 4000,\n    maxRetries: Infinity,\n    debug: false,\n}); };\nvar bypassProperty = function (src, dst, name) {\n    Object.defineProperty(dst, name, {\n        get: function () { return src[name]; },\n        set: function (value) { src[name] = value; },\n        enumerable: true,\n        configurable: true,\n    });\n};\nvar initReconnectionDelay = function (config) {\n    return (config.minReconnectionDelay + Math.random() * config.minReconnectionDelay);\n};\nvar updateReconnectionDelay = function (config, previousDelay) {\n    var newDelay = previousDelay * config.reconnectionDelayGrowFactor;\n    return (newDelay > config.maxReconnectionDelay)\n        ? config.maxReconnectionDelay\n        : newDelay;\n};\nvar LEVEL_0_EVENTS = ['onopen', 'onclose', 'onmessage', 'onerror'];\nvar reassignEventListeners = function (ws, oldWs, listeners) {\n    Object.keys(listeners).forEach(function (type) {\n        listeners[type].forEach(function (_a) {\n            var listener = _a[0], options = _a[1];\n            ws.addEventListener(type, listener, options);\n        });\n    });\n    if (oldWs) {\n        LEVEL_0_EVENTS.forEach(function (name) {\n            ws[name] = oldWs[name];\n        });\n    }\n};\nvar ReconnectingWebsocket = function (url, protocols, options) {\n    var _this = this;\n    if (options === void 0) { options = {}; }\n    var ws;\n    var connectingTimeout;\n    var reconnectDelay = 0;\n    var retriesCount = 0;\n    var shouldRetry = true;\n    var savedOnClose = null;\n    var listeners = {};\n    // require new to construct\n    if (!(this instanceof ReconnectingWebsocket)) {\n        throw new TypeError(\"Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator\");\n    }\n    // Set config. Not using `Object.assign` because of IE11\n    var config = getDefaultOptions();\n    Object.keys(config)\n        .filter(function (key) { return options.hasOwnProperty(key); })\n        .forEach(function (key) { return config[key] = options[key]; });\n    if (!isWebSocket(config.constructor)) {\n        throw new TypeError('Invalid WebSocket constructor. Set `options.constructor`');\n    }\n    var log = config.debug ? function () {\n        var params = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            params[_i] = arguments[_i];\n        }\n        return console.log.apply(console, ['RWS:'].concat(params));\n    } : function () { };\n    /**\n     * Not using dispatchEvent, otherwise we must use a DOM Event object\n     * Deferred because we want to handle the close event before this\n     */\n    var emitError = function (code, msg) { return setTimeout(function () {\n        var err = new Error(msg);\n        err.code = code;\n        if (Array.isArray(listeners.error)) {\n            listeners.error.forEach(function (_a) {\n                var fn = _a[0];\n                return fn(err);\n            });\n        }\n        if (ws.onerror) {\n            ws.onerror(err);\n        }\n    }, 0); };\n    var handleClose = function () {\n        log('handleClose', { shouldRetry: shouldRetry });\n        retriesCount++;\n        log('retries count:', retriesCount);\n        if (retriesCount > config.maxRetries) {\n            emitError('EHOSTDOWN', 'Too many failed connection attempts');\n            return;\n        }\n        if (!reconnectDelay) {\n            reconnectDelay = initReconnectionDelay(config);\n        }\n        else {\n            reconnectDelay = updateReconnectionDelay(config, reconnectDelay);\n        }\n        log('handleClose - reconnectDelay:', reconnectDelay);\n        if (shouldRetry) {\n            setTimeout(connect, reconnectDelay);\n        }\n    };\n    var connect = function () {\n        if (!shouldRetry) {\n            return;\n        }\n        log('connect');\n        var oldWs = ws;\n        var wsUrl = (typeof url === 'function') ? url() : url;\n        ws = new config.constructor(wsUrl, protocols);\n        connectingTimeout = setTimeout(function () {\n            log('timeout');\n            ws.close();\n            emitError('ETIMEDOUT', 'Connection timeout');\n        }, config.connectionTimeout);\n        log('bypass properties');\n        for (var key in ws) {\n            // @todo move to constant\n            if (['addEventListener', 'removeEventListener', 'close', 'send'].indexOf(key) < 0) {\n                bypassProperty(ws, _this, key);\n            }\n        }\n        ws.addEventListener('open', function () {\n            clearTimeout(connectingTimeout);\n            log('open');\n            reconnectDelay = initReconnectionDelay(config);\n            log('reconnectDelay:', reconnectDelay);\n            retriesCount = 0;\n        });\n        ws.addEventListener('close', handleClose);\n        reassignEventListeners(ws, oldWs, listeners);\n        // because when closing with fastClose=true, it is saved and set to null to avoid double calls\n        ws.onclose = ws.onclose || savedOnClose;\n        savedOnClose = null;\n    };\n    log('init');\n    connect();\n    this.close = function (code, reason, _a) {\n        if (code === void 0) { code = 1000; }\n        if (reason === void 0) { reason = ''; }\n        var _b = _a === void 0 ? {} : _a, _c = _b.keepClosed, keepClosed = _c === void 0 ? false : _c, _d = _b.fastClose, fastClose = _d === void 0 ? true : _d, _e = _b.delay, delay = _e === void 0 ? 0 : _e;\n        log('close - params:', { reason: reason, keepClosed: keepClosed, fastClose: fastClose, delay: delay, retriesCount: retriesCount, maxRetries: config.maxRetries });\n        shouldRetry = !keepClosed && retriesCount <= config.maxRetries;\n        if (delay) {\n            reconnectDelay = delay;\n        }\n        ws.close(code, reason);\n        if (fastClose) {\n            var fakeCloseEvent_1 = {\n                code: code,\n                reason: reason,\n                wasClean: true,\n            };\n            // execute close listeners soon with a fake closeEvent\n            // and remove them from the WS instance so they\n            // don't get fired on the real close.\n            handleClose();\n            ws.removeEventListener('close', handleClose);\n            // run and remove level2\n            if (Array.isArray(listeners.close)) {\n                listeners.close.forEach(function (_a) {\n                    var listener = _a[0], options = _a[1];\n                    listener(fakeCloseEvent_1);\n                    ws.removeEventListener('close', listener, options);\n                });\n            }\n            // run and remove level0\n            if (ws.onclose) {\n                savedOnClose = ws.onclose;\n                ws.onclose(fakeCloseEvent_1);\n                ws.onclose = null;\n            }\n        }\n    };\n    this.send = function (data) {\n        ws.send(data);\n    };\n    this.addEventListener = function (type, listener, options) {\n        if (Array.isArray(listeners[type])) {\n            if (!listeners[type].some(function (_a) {\n                var l = _a[0];\n                return l === listener;\n            })) {\n                listeners[type].push([listener, options]);\n            }\n        }\n        else {\n            listeners[type] = [[listener, options]];\n        }\n        ws.addEventListener(type, listener, options);\n    };\n    this.removeEventListener = function (type, listener, options) {\n        if (Array.isArray(listeners[type])) {\n            listeners[type] = listeners[type].filter(function (_a) {\n                var l = _a[0];\n                return l !== listener;\n            });\n        }\n        ws.removeEventListener(type, listener, options);\n    };\n};\nmodule.exports = ReconnectingWebsocket;\n","/**\n * Creates a continuation function with some arguments already applied.\n *\n * Useful as a shorthand when combined with other control flow functions. Any\n * arguments passed to the returned function are added to the arguments\n * originally passed to apply.\n *\n * @name apply\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {Function} fn - The function you want to eventually apply all\n * arguments to. Invokes with (arguments...).\n * @param {...*} arguments... - Any number of arguments to automatically apply\n * when the continuation is called.\n * @returns {Function} the partially-applied function\n * @example\n *\n * // using apply\n * async.parallel([\n *     async.apply(fs.writeFile, 'testfile1', 'test1'),\n *     async.apply(fs.writeFile, 'testfile2', 'test2')\n * ]);\n *\n *\n * // the same process without using apply\n * async.parallel([\n *     function(callback) {\n *         fs.writeFile('testfile1', 'test1', callback);\n *     },\n *     function(callback) {\n *         fs.writeFile('testfile2', 'test2', callback);\n *     }\n * ]);\n *\n * // It's possible to pass any number of additional arguments when calling the\n * // continuation:\n *\n * node> var fn = async.apply(sys.puts, 'one');\n * node> fn('two', 'three');\n * one\n * two\n * three\n */\nfunction apply(fn, ...args) {\n    return (...callArgs) => fn(...args,...callArgs);\n}\n\nfunction initialParams (fn) {\n    return function (...args/*, callback*/) {\n        var callback = args.pop();\n        return fn.call(this, args, callback);\n    };\n}\n\n/* istanbul ignore file */\n\nvar hasSetImmediate = typeof setImmediate === 'function' && setImmediate;\nvar hasNextTick = typeof process === 'object' && typeof process.nextTick === 'function';\n\nfunction fallback(fn) {\n    setTimeout(fn, 0);\n}\n\nfunction wrap(defer) {\n    return (fn, ...args) => defer(() => fn(...args));\n}\n\nvar _defer;\n\nif (hasSetImmediate) {\n    _defer = setImmediate;\n} else if (hasNextTick) {\n    _defer = process.nextTick;\n} else {\n    _defer = fallback;\n}\n\nvar setImmediate$1 = wrap(_defer);\n\n/**\n * Take a sync function and make it async, passing its return value to a\n * callback. This is useful for plugging sync functions into a waterfall,\n * series, or other async functions. Any arguments passed to the generated\n * function will be passed to the wrapped function (except for the final\n * callback argument). Errors thrown will be passed to the callback.\n *\n * If the function passed to `asyncify` returns a Promise, that promises's\n * resolved/rejected state will be used to call the callback, rather than simply\n * the synchronous return value.\n *\n * This also means you can asyncify ES2017 `async` functions.\n *\n * @name asyncify\n * @static\n * @memberOf module:Utils\n * @method\n * @alias wrapSync\n * @category Util\n * @param {Function} func - The synchronous function, or Promise-returning\n * function to convert to an {@link AsyncFunction}.\n * @returns {AsyncFunction} An asynchronous wrapper of the `func`. To be\n * invoked with `(args..., callback)`.\n * @example\n *\n * // passing a regular synchronous function\n * async.waterfall([\n *     async.apply(fs.readFile, filename, \"utf8\"),\n *     async.asyncify(JSON.parse),\n *     function (data, next) {\n *         // data is the result of parsing the text.\n *         // If there was a parsing error, it would have been caught.\n *     }\n * ], callback);\n *\n * // passing a function returning a promise\n * async.waterfall([\n *     async.apply(fs.readFile, filename, \"utf8\"),\n *     async.asyncify(function (contents) {\n *         return db.model.create(contents);\n *     }),\n *     function (model, next) {\n *         // `model` is the instantiated model object.\n *         // If there was an error, this function would be skipped.\n *     }\n * ], callback);\n *\n * // es2017 example, though `asyncify` is not needed if your JS environment\n * // supports async functions out of the box\n * var q = async.queue(async.asyncify(async function(file) {\n *     var intermediateStep = await processFile(file);\n *     return await somePromise(intermediateStep)\n * }));\n *\n * q.push(files);\n */\nfunction asyncify(func) {\n    if (isAsync(func)) {\n        return function (...args/*, callback*/) {\n            const callback = args.pop();\n            const promise = func.apply(this, args);\n            return handlePromise(promise, callback)\n        }\n    }\n\n    return initialParams(function (args, callback) {\n        var result;\n        try {\n            result = func.apply(this, args);\n        } catch (e) {\n            return callback(e);\n        }\n        // if result is Promise object\n        if (result && typeof result.then === 'function') {\n            return handlePromise(result, callback)\n        } else {\n            callback(null, result);\n        }\n    });\n}\n\nfunction handlePromise(promise, callback) {\n    return promise.then(value => {\n        invokeCallback(callback, null, value);\n    }, err => {\n        invokeCallback(callback, err && err.message ? err : new Error(err));\n    });\n}\n\nfunction invokeCallback(callback, error, value) {\n    try {\n        callback(error, value);\n    } catch (err) {\n        setImmediate$1(e => { throw e }, err);\n    }\n}\n\nfunction isAsync(fn) {\n    return fn[Symbol.toStringTag] === 'AsyncFunction';\n}\n\nfunction isAsyncGenerator(fn) {\n    return fn[Symbol.toStringTag] === 'AsyncGenerator';\n}\n\nfunction isAsyncIterable(obj) {\n    return typeof obj[Symbol.asyncIterator] === 'function';\n}\n\nfunction wrapAsync(asyncFn) {\n    if (typeof asyncFn !== 'function') throw new Error('expected a function')\n    return isAsync(asyncFn) ? asyncify(asyncFn) : asyncFn;\n}\n\n// conditionally promisify a function.\n// only return a promise if a callback is omitted\nfunction awaitify (asyncFn, arity = asyncFn.length) {\n    if (!arity) throw new Error('arity is undefined')\n    function awaitable (...args) {\n        if (typeof args[arity - 1] === 'function') {\n            return asyncFn.apply(this, args)\n        }\n\n        return new Promise((resolve, reject) => {\n            args[arity - 1] = (err, ...cbArgs) => {\n                if (err) return reject(err)\n                resolve(cbArgs.length > 1 ? cbArgs : cbArgs[0]);\n            };\n            asyncFn.apply(this, args);\n        })\n    }\n\n    Object.defineProperty(awaitable, 'name', {\n        value: `awaitable(${asyncFn.name})`\n    });\n\n    return awaitable\n}\n\nfunction applyEach (eachfn) {\n    return function applyEach(fns, ...callArgs) {\n        const go = awaitify(function (callback) {\n            var that = this;\n            return eachfn(fns, (fn, cb) => {\n                wrapAsync(fn).apply(that, callArgs.concat(cb));\n            }, callback);\n        });\n        return go;\n    };\n}\n\nfunction _asyncMap(eachfn, arr, iteratee, callback) {\n    arr = arr || [];\n    var results = [];\n    var counter = 0;\n    var _iteratee = wrapAsync(iteratee);\n\n    return eachfn(arr, (value, _, iterCb) => {\n        var index = counter++;\n        _iteratee(value, (err, v) => {\n            results[index] = v;\n            iterCb(err);\n        });\n    }, err => {\n        callback(err, results);\n    });\n}\n\nfunction isArrayLike(value) {\n    return value &&\n        typeof value.length === 'number' &&\n        value.length >= 0 &&\n        value.length % 1 === 0;\n}\n\n// A temporary value used to identify if the loop should be broken.\n// See #1064, #1293\nconst breakLoop = {};\n\nfunction once(fn) {\n    function wrapper (...args) {\n        if (fn === null) return;\n        var callFn = fn;\n        fn = null;\n        callFn.apply(this, args);\n    }\n    Object.assign(wrapper, fn);\n    return wrapper\n}\n\nfunction getIterator (coll) {\n    return coll[Symbol.iterator] && coll[Symbol.iterator]();\n}\n\nfunction createArrayIterator(coll) {\n    var i = -1;\n    var len = coll.length;\n    return function next() {\n        return ++i < len ? {value: coll[i], key: i} : null;\n    }\n}\n\nfunction createES2015Iterator(iterator) {\n    var i = -1;\n    return function next() {\n        var item = iterator.next();\n        if (item.done)\n            return null;\n        i++;\n        return {value: item.value, key: i};\n    }\n}\n\nfunction createObjectIterator(obj) {\n    var okeys = obj ? Object.keys(obj) : [];\n    var i = -1;\n    var len = okeys.length;\n    return function next() {\n        var key = okeys[++i];\n        return i < len ? {value: obj[key], key} : null;\n    };\n}\n\nfunction createIterator(coll) {\n    if (isArrayLike(coll)) {\n        return createArrayIterator(coll);\n    }\n\n    var iterator = getIterator(coll);\n    return iterator ? createES2015Iterator(iterator) : createObjectIterator(coll);\n}\n\nfunction onlyOnce(fn) {\n    return function (...args) {\n        if (fn === null) throw new Error(\"Callback was already called.\");\n        var callFn = fn;\n        fn = null;\n        callFn.apply(this, args);\n    };\n}\n\n// for async generators\nfunction asyncEachOfLimit(generator, limit, iteratee, callback) {\n    let done = false;\n    let canceled = false;\n    let awaiting = false;\n    let running = 0;\n    let idx = 0;\n\n    function replenish() {\n        //console.log('replenish')\n        if (running >= limit || awaiting || done) return\n        //console.log('replenish awaiting')\n        awaiting = true;\n        generator.next().then(({value, done: iterDone}) => {\n            //console.log('got value', value)\n            if (canceled || done) return\n            awaiting = false;\n            if (iterDone) {\n                done = true;\n                if (running <= 0) {\n                    //console.log('done nextCb')\n                    callback(null);\n                }\n                return;\n            }\n            running++;\n            iteratee(value, idx, iterateeCallback);\n            idx++;\n            replenish();\n        }).catch(handleError);\n    }\n\n    function iterateeCallback(err, result) {\n        //console.log('iterateeCallback')\n        running -= 1;\n        if (canceled) return\n        if (err) return handleError(err)\n\n        if (err === false) {\n            done = true;\n            canceled = true;\n            return\n        }\n\n        if (result === breakLoop || (done && running <= 0)) {\n            done = true;\n            //console.log('done iterCb')\n            return callback(null);\n        }\n        replenish();\n    }\n\n    function handleError(err) {\n        if (canceled) return\n        awaiting = false;\n        done = true;\n        callback(err);\n    }\n\n    replenish();\n}\n\nvar eachOfLimit = (limit) => {\n    return (obj, iteratee, callback) => {\n        callback = once(callback);\n        if (limit <= 0) {\n            throw new RangeError('concurrency limit cannot be less than 1')\n        }\n        if (!obj) {\n            return callback(null);\n        }\n        if (isAsyncGenerator(obj)) {\n            return asyncEachOfLimit(obj, limit, iteratee, callback)\n        }\n        if (isAsyncIterable(obj)) {\n            return asyncEachOfLimit(obj[Symbol.asyncIterator](), limit, iteratee, callback)\n        }\n        var nextElem = createIterator(obj);\n        var done = false;\n        var canceled = false;\n        var running = 0;\n        var looping = false;\n\n        function iterateeCallback(err, value) {\n            if (canceled) return\n            running -= 1;\n            if (err) {\n                done = true;\n                callback(err);\n            }\n            else if (err === false) {\n                done = true;\n                canceled = true;\n            }\n            else if (value === breakLoop || (done && running <= 0)) {\n                done = true;\n                return callback(null);\n            }\n            else if (!looping) {\n                replenish();\n            }\n        }\n\n        function replenish () {\n            looping = true;\n            while (running < limit && !done) {\n                var elem = nextElem();\n                if (elem === null) {\n                    done = true;\n                    if (running <= 0) {\n                        callback(null);\n                    }\n                    return;\n                }\n                running += 1;\n                iteratee(elem.value, elem.key, onlyOnce(iterateeCallback));\n            }\n            looping = false;\n        }\n\n        replenish();\n    };\n};\n\n/**\n * The same as [`eachOf`]{@link module:Collections.eachOf} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name eachOfLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.eachOf]{@link module:Collections.eachOf}\n * @alias forEachOfLimit\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async function to apply to each\n * item in `coll`. The `key` is the item's key, or index in the case of an\n * array.\n * Invoked with (item, key, callback).\n * @param {Function} [callback] - A callback which is called when all\n * `iteratee` functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n */\nfunction eachOfLimit$1(coll, limit, iteratee, callback) {\n    return eachOfLimit(limit)(coll, wrapAsync(iteratee), callback);\n}\n\nvar eachOfLimit$2 = awaitify(eachOfLimit$1, 4);\n\n// eachOf implementation optimized for array-likes\nfunction eachOfArrayLike(coll, iteratee, callback) {\n    callback = once(callback);\n    var index = 0,\n        completed = 0,\n        {length} = coll,\n        canceled = false;\n    if (length === 0) {\n        callback(null);\n    }\n\n    function iteratorCallback(err, value) {\n        if (err === false) {\n            canceled = true;\n        }\n        if (canceled === true) return\n        if (err) {\n            callback(err);\n        } else if ((++completed === length) || value === breakLoop) {\n            callback(null);\n        }\n    }\n\n    for (; index < length; index++) {\n        iteratee(coll[index], index, onlyOnce(iteratorCallback));\n    }\n}\n\n// a generic version of eachOf which can handle array, object, and iterator cases.\nfunction eachOfGeneric (coll, iteratee, callback) {\n    return eachOfLimit$2(coll, Infinity, iteratee, callback);\n}\n\n/**\n * Like [`each`]{@link module:Collections.each}, except that it passes the key (or index) as the second argument\n * to the iteratee.\n *\n * @name eachOf\n * @static\n * @memberOf module:Collections\n * @method\n * @alias forEachOf\n * @category Collection\n * @see [async.each]{@link module:Collections.each}\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A function to apply to each\n * item in `coll`.\n * The `key` is the item's key, or index in the case of an array.\n * Invoked with (item, key, callback).\n * @param {Function} [callback] - A callback which is called when all\n * `iteratee` functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n * @example\n *\n * var obj = {dev: \"/dev.json\", test: \"/test.json\", prod: \"/prod.json\"};\n * var configs = {};\n *\n * async.forEachOf(obj, function (value, key, callback) {\n *     fs.readFile(__dirname + value, \"utf8\", function (err, data) {\n *         if (err) return callback(err);\n *         try {\n *             configs[key] = JSON.parse(data);\n *         } catch (e) {\n *             return callback(e);\n *         }\n *         callback();\n *     });\n * }, function (err) {\n *     if (err) console.error(err.message);\n *     // configs is now a map of JSON data\n *     doSomethingWith(configs);\n * });\n */\nfunction eachOf(coll, iteratee, callback) {\n    var eachOfImplementation = isArrayLike(coll) ? eachOfArrayLike : eachOfGeneric;\n    return eachOfImplementation(coll, wrapAsync(iteratee), callback);\n}\n\nvar eachOf$1 = awaitify(eachOf, 3);\n\n/**\n * Produces a new collection of values by mapping each value in `coll` through\n * the `iteratee` function. The `iteratee` is called with an item from `coll`\n * and a callback for when it has finished processing. Each of these callback\n * takes 2 arguments: an `error`, and the transformed item from `coll`. If\n * `iteratee` passes an error to its callback, the main `callback` (for the\n * `map` function) is immediately called with the error.\n *\n * Note, that since this function applies the `iteratee` to each item in\n * parallel, there is no guarantee that the `iteratee` functions will complete\n * in order. However, the results array will be in the same order as the\n * original `coll`.\n *\n * If `map` is passed an Object, the results will be an Array.  The results\n * will roughly be in the order of the original Objects' keys (but this can\n * vary across JavaScript engines).\n *\n * @name map\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with the transformed item.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Results is an Array of the\n * transformed items from the `coll`. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * async.map(['file1','file2','file3'], fs.stat, function(err, results) {\n *     // results is now an array of stats for each file\n * });\n */\nfunction map (coll, iteratee, callback) {\n    return _asyncMap(eachOf$1, coll, iteratee, callback)\n}\nvar map$1 = awaitify(map, 3);\n\n/**\n * Applies the provided arguments to each function in the array, calling\n * `callback` after all functions have completed. If you only provide the first\n * argument, `fns`, then it will return a function which lets you pass in the\n * arguments as if it were a single function call. If more arguments are\n * provided, `callback` is required while `args` is still optional. The results\n * for each of the applied async functions are passed to the final callback\n * as an array.\n *\n * @name applyEach\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} fns - A collection of {@link AsyncFunction}s\n * to all call with the same arguments\n * @param {...*} [args] - any number of separate arguments to pass to the\n * function.\n * @param {Function} [callback] - the final argument should be the callback,\n * called when all functions have completed processing.\n * @returns {AsyncFunction} - Returns a function that takes no args other than\n * an optional callback, that is the result of applying the `args` to each\n * of the functions.\n * @example\n *\n * const appliedFn = async.applyEach([enableSearch, updateSchema], 'bucket')\n *\n * appliedFn((err, results) => {\n *     // results[0] is the results for `enableSearch`\n *     // results[1] is the results for `updateSchema`\n * });\n *\n * // partial application example:\n * async.each(\n *     buckets,\n *     async (bucket) => async.applyEach([enableSearch, updateSchema], bucket)(),\n *     callback\n * );\n */\nvar applyEach$1 = applyEach(map$1);\n\n/**\n * The same as [`eachOf`]{@link module:Collections.eachOf} but runs only a single async operation at a time.\n *\n * @name eachOfSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.eachOf]{@link module:Collections.eachOf}\n * @alias forEachOfSeries\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * Invoked with (item, key, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n */\nfunction eachOfSeries(coll, iteratee, callback) {\n    return eachOfLimit$2(coll, 1, iteratee, callback)\n}\nvar eachOfSeries$1 = awaitify(eachOfSeries, 3);\n\n/**\n * The same as [`map`]{@link module:Collections.map} but runs only a single async operation at a time.\n *\n * @name mapSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.map]{@link module:Collections.map}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with the transformed item.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Results is an array of the\n * transformed items from the `coll`. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction mapSeries (coll, iteratee, callback) {\n    return _asyncMap(eachOfSeries$1, coll, iteratee, callback)\n}\nvar mapSeries$1 = awaitify(mapSeries, 3);\n\n/**\n * The same as [`applyEach`]{@link module:ControlFlow.applyEach} but runs only a single async operation at a time.\n *\n * @name applyEachSeries\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.applyEach]{@link module:ControlFlow.applyEach}\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} fns - A collection of {@link AsyncFunction}s to all\n * call with the same arguments\n * @param {...*} [args] - any number of separate arguments to pass to the\n * function.\n * @param {Function} [callback] - the final argument should be the callback,\n * called when all functions have completed processing.\n * @returns {AsyncFunction} - A function, that when called, is the result of\n * appling the `args` to the list of functions.  It takes no args, other than\n * a callback.\n */\nvar applyEachSeries = applyEach(mapSeries$1);\n\nconst PROMISE_SYMBOL = Symbol('promiseCallback');\n\nfunction promiseCallback () {\n    let resolve, reject;\n    function callback (err, ...args) {\n        if (err) return reject(err)\n        resolve(args.length > 1 ? args : args[0]);\n    }\n\n    callback[PROMISE_SYMBOL] = new Promise((res, rej) => {\n        resolve = res,\n        reject = rej;\n    });\n\n    return callback\n}\n\n/**\n * Determines the best order for running the {@link AsyncFunction}s in `tasks`, based on\n * their requirements. Each function can optionally depend on other functions\n * being completed first, and each function is run as soon as its requirements\n * are satisfied.\n *\n * If any of the {@link AsyncFunction}s pass an error to their callback, the `auto` sequence\n * will stop. Further tasks will not execute (so any other functions depending\n * on it will not run), and the main `callback` is immediately called with the\n * error.\n *\n * {@link AsyncFunction}s also receive an object containing the results of functions which\n * have completed so far as the first argument, if they have dependencies. If a\n * task function has no dependencies, it will only be passed a callback.\n *\n * @name auto\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Object} tasks - An object. Each of its properties is either a\n * function or an array of requirements, with the {@link AsyncFunction} itself the last item\n * in the array. The object's key of a property serves as the name of the task\n * defined by that property, i.e. can be used when specifying requirements for\n * other tasks. The function receives one or two arguments:\n * * a `results` object, containing the results of the previously executed\n *   functions, only passed if the task has any dependencies,\n * * a `callback(err, result)` function, which must be called when finished,\n *   passing an `error` (which can be `null`) and the result of the function's\n *   execution.\n * @param {number} [concurrency=Infinity] - An optional `integer` for\n * determining the maximum number of tasks that can be run in parallel. By\n * default, as many as possible.\n * @param {Function} [callback] - An optional callback which is called when all\n * the tasks have been completed. It receives the `err` argument if any `tasks`\n * pass an error to their callback. Results are always returned; however, if an\n * error occurs, no further `tasks` will be performed, and the results object\n * will only contain partial results. Invoked with (err, results).\n * @returns {Promise} a promise, if a callback is not passed\n * @example\n *\n * async.auto({\n *     // this function will just be passed a callback\n *     readData: async.apply(fs.readFile, 'data.txt', 'utf-8'),\n *     showData: ['readData', function(results, cb) {\n *         // results.readData is the file's contents\n *         // ...\n *     }]\n * }, callback);\n *\n * async.auto({\n *     get_data: function(callback) {\n *         console.log('in get_data');\n *         // async code to get some data\n *         callback(null, 'data', 'converted to array');\n *     },\n *     make_folder: function(callback) {\n *         console.log('in make_folder');\n *         // async code to create a directory to store a file in\n *         // this is run at the same time as getting the data\n *         callback(null, 'folder');\n *     },\n *     write_file: ['get_data', 'make_folder', function(results, callback) {\n *         console.log('in write_file', JSON.stringify(results));\n *         // once there is some data and the directory exists,\n *         // write the data to a file in the directory\n *         callback(null, 'filename');\n *     }],\n *     email_link: ['write_file', function(results, callback) {\n *         console.log('in email_link', JSON.stringify(results));\n *         // once the file is written let's email a link to it...\n *         // results.write_file contains the filename returned by write_file.\n *         callback(null, {'file':results.write_file, 'email':'user@example.com'});\n *     }]\n * }, function(err, results) {\n *     console.log('err = ', err);\n *     console.log('results = ', results);\n * });\n */\nfunction auto(tasks, concurrency, callback) {\n    if (typeof concurrency !== 'number') {\n        // concurrency is optional, shift the args.\n        callback = concurrency;\n        concurrency = null;\n    }\n    callback = once(callback || promiseCallback());\n    var numTasks = Object.keys(tasks).length;\n    if (!numTasks) {\n        return callback(null);\n    }\n    if (!concurrency) {\n        concurrency = numTasks;\n    }\n\n    var results = {};\n    var runningTasks = 0;\n    var canceled = false;\n    var hasError = false;\n\n    var listeners = Object.create(null);\n\n    var readyTasks = [];\n\n    // for cycle detection:\n    var readyToCheck = []; // tasks that have been identified as reachable\n    // without the possibility of returning to an ancestor task\n    var uncheckedDependencies = {};\n\n    Object.keys(tasks).forEach(key => {\n        var task = tasks[key];\n        if (!Array.isArray(task)) {\n            // no dependencies\n            enqueueTask(key, [task]);\n            readyToCheck.push(key);\n            return;\n        }\n\n        var dependencies = task.slice(0, task.length - 1);\n        var remainingDependencies = dependencies.length;\n        if (remainingDependencies === 0) {\n            enqueueTask(key, task);\n            readyToCheck.push(key);\n            return;\n        }\n        uncheckedDependencies[key] = remainingDependencies;\n\n        dependencies.forEach(dependencyName => {\n            if (!tasks[dependencyName]) {\n                throw new Error('async.auto task `' + key +\n                    '` has a non-existent dependency `' +\n                    dependencyName + '` in ' +\n                    dependencies.join(', '));\n            }\n            addListener(dependencyName, () => {\n                remainingDependencies--;\n                if (remainingDependencies === 0) {\n                    enqueueTask(key, task);\n                }\n            });\n        });\n    });\n\n    checkForDeadlocks();\n    processQueue();\n\n    function enqueueTask(key, task) {\n        readyTasks.push(() => runTask(key, task));\n    }\n\n    function processQueue() {\n        if (canceled) return\n        if (readyTasks.length === 0 && runningTasks === 0) {\n            return callback(null, results);\n        }\n        while(readyTasks.length && runningTasks < concurrency) {\n            var run = readyTasks.shift();\n            run();\n        }\n\n    }\n\n    function addListener(taskName, fn) {\n        var taskListeners = listeners[taskName];\n        if (!taskListeners) {\n            taskListeners = listeners[taskName] = [];\n        }\n\n        taskListeners.push(fn);\n    }\n\n    function taskComplete(taskName) {\n        var taskListeners = listeners[taskName] || [];\n        taskListeners.forEach(fn => fn());\n        processQueue();\n    }\n\n\n    function runTask(key, task) {\n        if (hasError) return;\n\n        var taskCallback = onlyOnce((err, ...result) => {\n            runningTasks--;\n            if (err === false) {\n                canceled = true;\n                return\n            }\n            if (result.length < 2) {\n                [result] = result;\n            }\n            if (err) {\n                var safeResults = {};\n                Object.keys(results).forEach(rkey => {\n                    safeResults[rkey] = results[rkey];\n                });\n                safeResults[key] = result;\n                hasError = true;\n                listeners = Object.create(null);\n                if (canceled) return\n                callback(err, safeResults);\n            } else {\n                results[key] = result;\n                taskComplete(key);\n            }\n        });\n\n        runningTasks++;\n        var taskFn = wrapAsync(task[task.length - 1]);\n        if (task.length > 1) {\n            taskFn(results, taskCallback);\n        } else {\n            taskFn(taskCallback);\n        }\n    }\n\n    function checkForDeadlocks() {\n        // Kahn's algorithm\n        // https://en.wikipedia.org/wiki/Topological_sorting#Kahn.27s_algorithm\n        // http://connalle.blogspot.com/2013/10/topological-sortingkahn-algorithm.html\n        var currentTask;\n        var counter = 0;\n        while (readyToCheck.length) {\n            currentTask = readyToCheck.pop();\n            counter++;\n            getDependents(currentTask).forEach(dependent => {\n                if (--uncheckedDependencies[dependent] === 0) {\n                    readyToCheck.push(dependent);\n                }\n            });\n        }\n\n        if (counter !== numTasks) {\n            throw new Error(\n                'async.auto cannot execute tasks due to a recursive dependency'\n            );\n        }\n    }\n\n    function getDependents(taskName) {\n        var result = [];\n        Object.keys(tasks).forEach(key => {\n            const task = tasks[key];\n            if (Array.isArray(task) && task.indexOf(taskName) >= 0) {\n                result.push(key);\n            }\n        });\n        return result;\n    }\n\n    return callback[PROMISE_SYMBOL]\n}\n\nvar FN_ARGS = /^(?:async\\s+)?(?:function)?\\s*\\w*\\s*\\(\\s*([^)]+)\\s*\\)(?:\\s*{)/;\nvar ARROW_FN_ARGS = /^(?:async\\s+)?\\(?\\s*([^)=]+)\\s*\\)?(?:\\s*=>)/;\nvar FN_ARG_SPLIT = /,/;\nvar FN_ARG = /(=.+)?(\\s*)$/;\nvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\n\nfunction parseParams(func) {\n    const src = func.toString().replace(STRIP_COMMENTS, '');\n    let match = src.match(FN_ARGS);\n    if (!match) {\n        match = src.match(ARROW_FN_ARGS);\n    }\n    if (!match) throw new Error('could not parse args in autoInject\\nSource:\\n' + src)\n    let [, args] = match;\n    return args\n        .replace(/\\s/g, '')\n        .split(FN_ARG_SPLIT)\n        .map((arg) => arg.replace(FN_ARG, '').trim());\n}\n\n/**\n * A dependency-injected version of the [async.auto]{@link module:ControlFlow.auto} function. Dependent\n * tasks are specified as parameters to the function, after the usual callback\n * parameter, with the parameter names matching the names of the tasks it\n * depends on. This can provide even more readable task graphs which can be\n * easier to maintain.\n *\n * If a final callback is specified, the task results are similarly injected,\n * specified as named parameters after the initial error parameter.\n *\n * The autoInject function is purely syntactic sugar and its semantics are\n * otherwise equivalent to [async.auto]{@link module:ControlFlow.auto}.\n *\n * @name autoInject\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.auto]{@link module:ControlFlow.auto}\n * @category Control Flow\n * @param {Object} tasks - An object, each of whose properties is an {@link AsyncFunction} of\n * the form 'func([dependencies...], callback). The object's key of a property\n * serves as the name of the task defined by that property, i.e. can be used\n * when specifying requirements for other tasks.\n * * The `callback` parameter is a `callback(err, result)` which must be called\n *   when finished, passing an `error` (which can be `null`) and the result of\n *   the function's execution. The remaining parameters name other tasks on\n *   which the task is dependent, and the results from those tasks are the\n *   arguments of those parameters.\n * @param {Function} [callback] - An optional callback which is called when all\n * the tasks have been completed. It receives the `err` argument if any `tasks`\n * pass an error to their callback, and a `results` object with any completed\n * task results, similar to `auto`.\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * //  The example from `auto` can be rewritten as follows:\n * async.autoInject({\n *     get_data: function(callback) {\n *         // async code to get some data\n *         callback(null, 'data', 'converted to array');\n *     },\n *     make_folder: function(callback) {\n *         // async code to create a directory to store a file in\n *         // this is run at the same time as getting the data\n *         callback(null, 'folder');\n *     },\n *     write_file: function(get_data, make_folder, callback) {\n *         // once there is some data and the directory exists,\n *         // write the data to a file in the directory\n *         callback(null, 'filename');\n *     },\n *     email_link: function(write_file, callback) {\n *         // once the file is written let's email a link to it...\n *         // write_file contains the filename returned by write_file.\n *         callback(null, {'file':write_file, 'email':'user@example.com'});\n *     }\n * }, function(err, results) {\n *     console.log('err = ', err);\n *     console.log('email_link = ', results.email_link);\n * });\n *\n * // If you are using a JS minifier that mangles parameter names, `autoInject`\n * // will not work with plain functions, since the parameter names will be\n * // collapsed to a single letter identifier.  To work around this, you can\n * // explicitly specify the names of the parameters your task function needs\n * // in an array, similar to Angular.js dependency injection.\n *\n * // This still has an advantage over plain `auto`, since the results a task\n * // depends on are still spread into arguments.\n * async.autoInject({\n *     //...\n *     write_file: ['get_data', 'make_folder', function(get_data, make_folder, callback) {\n *         callback(null, 'filename');\n *     }],\n *     email_link: ['write_file', function(write_file, callback) {\n *         callback(null, {'file':write_file, 'email':'user@example.com'});\n *     }]\n *     //...\n * }, function(err, results) {\n *     console.log('err = ', err);\n *     console.log('email_link = ', results.email_link);\n * });\n */\nfunction autoInject(tasks, callback) {\n    var newTasks = {};\n\n    Object.keys(tasks).forEach(key => {\n        var taskFn = tasks[key];\n        var params;\n        var fnIsAsync = isAsync(taskFn);\n        var hasNoDeps =\n            (!fnIsAsync && taskFn.length === 1) ||\n            (fnIsAsync && taskFn.length === 0);\n\n        if (Array.isArray(taskFn)) {\n            params = [...taskFn];\n            taskFn = params.pop();\n\n            newTasks[key] = params.concat(params.length > 0 ? newTask : taskFn);\n        } else if (hasNoDeps) {\n            // no dependencies, use the function as-is\n            newTasks[key] = taskFn;\n        } else {\n            params = parseParams(taskFn);\n            if ((taskFn.length === 0 && !fnIsAsync) && params.length === 0) {\n                throw new Error(\"autoInject task functions require explicit parameters.\");\n            }\n\n            // remove callback param\n            if (!fnIsAsync) params.pop();\n\n            newTasks[key] = params.concat(newTask);\n        }\n\n        function newTask(results, taskCb) {\n            var newArgs = params.map(name => results[name]);\n            newArgs.push(taskCb);\n            wrapAsync(taskFn)(...newArgs);\n        }\n    });\n\n    return auto(newTasks, callback);\n}\n\n// Simple doubly linked list (https://en.wikipedia.org/wiki/Doubly_linked_list) implementation\n// used for queues. This implementation assumes that the node provided by the user can be modified\n// to adjust the next and last properties. We implement only the minimal functionality\n// for queue support.\nclass DLL {\n    constructor() {\n        this.head = this.tail = null;\n        this.length = 0;\n    }\n\n    removeLink(node) {\n        if (node.prev) node.prev.next = node.next;\n        else this.head = node.next;\n        if (node.next) node.next.prev = node.prev;\n        else this.tail = node.prev;\n\n        node.prev = node.next = null;\n        this.length -= 1;\n        return node;\n    }\n\n    empty () {\n        while(this.head) this.shift();\n        return this;\n    }\n\n    insertAfter(node, newNode) {\n        newNode.prev = node;\n        newNode.next = node.next;\n        if (node.next) node.next.prev = newNode;\n        else this.tail = newNode;\n        node.next = newNode;\n        this.length += 1;\n    }\n\n    insertBefore(node, newNode) {\n        newNode.prev = node.prev;\n        newNode.next = node;\n        if (node.prev) node.prev.next = newNode;\n        else this.head = newNode;\n        node.prev = newNode;\n        this.length += 1;\n    }\n\n    unshift(node) {\n        if (this.head) this.insertBefore(this.head, node);\n        else setInitial(this, node);\n    }\n\n    push(node) {\n        if (this.tail) this.insertAfter(this.tail, node);\n        else setInitial(this, node);\n    }\n\n    shift() {\n        return this.head && this.removeLink(this.head);\n    }\n\n    pop() {\n        return this.tail && this.removeLink(this.tail);\n    }\n\n    toArray() {\n        return [...this]\n    }\n\n    *[Symbol.iterator] () {\n        var cur = this.head;\n        while (cur) {\n            yield cur.data;\n            cur = cur.next;\n        }\n    }\n\n    remove (testFn) {\n        var curr = this.head;\n        while(curr) {\n            var {next} = curr;\n            if (testFn(curr)) {\n                this.removeLink(curr);\n            }\n            curr = next;\n        }\n        return this;\n    }\n}\n\nfunction setInitial(dll, node) {\n    dll.length = 1;\n    dll.head = dll.tail = node;\n}\n\nfunction queue(worker, concurrency, payload) {\n    if (concurrency == null) {\n        concurrency = 1;\n    }\n    else if(concurrency === 0) {\n        throw new RangeError('Concurrency must not be zero');\n    }\n\n    var _worker = wrapAsync(worker);\n    var numRunning = 0;\n    var workersList = [];\n    const events = {\n        error: [],\n        drain: [],\n        saturated: [],\n        unsaturated: [],\n        empty: []\n    };\n\n    function on (event, handler) {\n        events[event].push(handler);\n    }\n\n    function once (event, handler) {\n        const handleAndRemove = (...args) => {\n            off(event, handleAndRemove);\n            handler(...args);\n        };\n        events[event].push(handleAndRemove);\n    }\n\n    function off (event, handler) {\n        if (!event) return Object.keys(events).forEach(ev => events[ev] = [])\n        if (!handler) return events[event] = []\n        events[event] = events[event].filter(ev => ev !== handler);\n    }\n\n    function trigger (event, ...args) {\n        events[event].forEach(handler => handler(...args));\n    }\n\n    var processingScheduled = false;\n    function _insert(data, insertAtFront, rejectOnError, callback) {\n        if (callback != null && typeof callback !== 'function') {\n            throw new Error('task callback must be a function');\n        }\n        q.started = true;\n\n        var res, rej;\n        function promiseCallback (err, ...args) {\n            // we don't care about the error, let the global error handler\n            // deal with it\n            if (err) return rejectOnError ? rej(err) : res()\n            if (args.length <= 1) return res(args[0])\n            res(args);\n        }\n\n        var item = {\n            data,\n            callback: rejectOnError ?\n                promiseCallback :\n                (callback || promiseCallback)\n        };\n\n        if (insertAtFront) {\n            q._tasks.unshift(item);\n        } else {\n            q._tasks.push(item);\n        }\n\n        if (!processingScheduled) {\n            processingScheduled = true;\n            setImmediate$1(() => {\n                processingScheduled = false;\n                q.process();\n            });\n        }\n\n        if (rejectOnError || !callback) {\n            return new Promise((resolve, reject) => {\n                res = resolve;\n                rej = reject;\n            })\n        }\n    }\n\n    function _createCB(tasks) {\n        return function (err, ...args) {\n            numRunning -= 1;\n\n            for (var i = 0, l = tasks.length; i < l; i++) {\n                var task = tasks[i];\n\n                var index = workersList.indexOf(task);\n                if (index === 0) {\n                    workersList.shift();\n                } else if (index > 0) {\n                    workersList.splice(index, 1);\n                }\n\n                task.callback(err, ...args);\n\n                if (err != null) {\n                    trigger('error', err, task.data);\n                }\n            }\n\n            if (numRunning <= (q.concurrency - q.buffer) ) {\n                trigger('unsaturated');\n            }\n\n            if (q.idle()) {\n                trigger('drain');\n            }\n            q.process();\n        };\n    }\n\n    function _maybeDrain(data) {\n        if (data.length === 0 && q.idle()) {\n            // call drain immediately if there are no tasks\n            setImmediate$1(() => trigger('drain'));\n            return true\n        }\n        return false\n    }\n\n    const eventMethod = (name) => (handler) => {\n        if (!handler) {\n            return new Promise((resolve, reject) => {\n                once(name, (err, data) => {\n                    if (err) return reject(err)\n                    resolve(data);\n                });\n            })\n        }\n        off(name);\n        on(name, handler);\n\n    };\n\n    var isProcessing = false;\n    var q = {\n        _tasks: new DLL(),\n        *[Symbol.iterator] () {\n            yield* q._tasks[Symbol.iterator]();\n        },\n        concurrency,\n        payload,\n        buffer: concurrency / 4,\n        started: false,\n        paused: false,\n        push (data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return\n                return data.map(datum => _insert(datum, false, false, callback))\n            }\n            return _insert(data, false, false, callback);\n        },\n        pushAsync (data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return\n                return data.map(datum => _insert(datum, false, true, callback))\n            }\n            return _insert(data, false, true, callback);\n        },\n        kill () {\n            off();\n            q._tasks.empty();\n        },\n        unshift (data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return\n                return data.map(datum => _insert(datum, true, false, callback))\n            }\n            return _insert(data, true, false, callback);\n        },\n        unshiftAsync (data, callback) {\n            if (Array.isArray(data)) {\n                if (_maybeDrain(data)) return\n                return data.map(datum => _insert(datum, true, true, callback))\n            }\n            return _insert(data, true, true, callback);\n        },\n        remove (testFn) {\n            q._tasks.remove(testFn);\n        },\n        process () {\n            // Avoid trying to start too many processing operations. This can occur\n            // when callbacks resolve synchronously (#1267).\n            if (isProcessing) {\n                return;\n            }\n            isProcessing = true;\n            while(!q.paused && numRunning < q.concurrency && q._tasks.length){\n                var tasks = [], data = [];\n                var l = q._tasks.length;\n                if (q.payload) l = Math.min(l, q.payload);\n                for (var i = 0; i < l; i++) {\n                    var node = q._tasks.shift();\n                    tasks.push(node);\n                    workersList.push(node);\n                    data.push(node.data);\n                }\n\n                numRunning += 1;\n\n                if (q._tasks.length === 0) {\n                    trigger('empty');\n                }\n\n                if (numRunning === q.concurrency) {\n                    trigger('saturated');\n                }\n\n                var cb = onlyOnce(_createCB(tasks));\n                _worker(data, cb);\n            }\n            isProcessing = false;\n        },\n        length () {\n            return q._tasks.length;\n        },\n        running () {\n            return numRunning;\n        },\n        workersList () {\n            return workersList;\n        },\n        idle() {\n            return q._tasks.length + numRunning === 0;\n        },\n        pause () {\n            q.paused = true;\n        },\n        resume () {\n            if (q.paused === false) { return; }\n            q.paused = false;\n            setImmediate$1(q.process);\n        }\n    };\n    // define these as fixed properties, so people get useful errors when updating\n    Object.defineProperties(q, {\n        saturated: {\n            writable: false,\n            value: eventMethod('saturated')\n        },\n        unsaturated: {\n            writable: false,\n            value: eventMethod('unsaturated')\n        },\n        empty: {\n            writable: false,\n            value: eventMethod('empty')\n        },\n        drain: {\n            writable: false,\n            value: eventMethod('drain')\n        },\n        error: {\n            writable: false,\n            value: eventMethod('error')\n        },\n    });\n    return q;\n}\n\n/**\n * Creates a `cargo` object with the specified payload. Tasks added to the\n * cargo will be processed altogether (up to the `payload` limit). If the\n * `worker` is in progress, the task is queued until it becomes available. Once\n * the `worker` has completed some tasks, each callback of those tasks is\n * called. Check out [these](https://camo.githubusercontent.com/6bbd36f4cf5b35a0f11a96dcd2e97711ffc2fb37/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130382f62626330636662302d356632392d313165322d393734662d3333393763363464633835382e676966) [animations](https://camo.githubusercontent.com/f4810e00e1c5f5f8addbe3e9f49064fd5d102699/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130312f38346339323036362d356632392d313165322d383134662d3964336430323431336266642e676966)\n * for how `cargo` and `queue` work.\n *\n * While [`queue`]{@link module:ControlFlow.queue} passes only one task to one of a group of workers\n * at a time, cargo passes an array of tasks to a single worker, repeating\n * when the worker is finished.\n *\n * @name cargo\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.queue]{@link module:ControlFlow.queue}\n * @category Control Flow\n * @param {AsyncFunction} worker - An asynchronous function for processing an array\n * of queued tasks. Invoked with `(tasks, callback)`.\n * @param {number} [payload=Infinity] - An optional `integer` for determining\n * how many tasks should be processed per round; if omitted, the default is\n * unlimited.\n * @returns {module:ControlFlow.QueueObject} A cargo object to manage the tasks. Callbacks can\n * attached as certain properties to listen for specific events during the\n * lifecycle of the cargo and inner queue.\n * @example\n *\n * // create a cargo object with payload 2\n * var cargo = async.cargo(function(tasks, callback) {\n *     for (var i=0; i<tasks.length; i++) {\n *         console.log('hello ' + tasks[i].name);\n *     }\n *     callback();\n * }, 2);\n *\n * // add some items\n * cargo.push({name: 'foo'}, function(err) {\n *     console.log('finished processing foo');\n * });\n * cargo.push({name: 'bar'}, function(err) {\n *     console.log('finished processing bar');\n * });\n * await cargo.push({name: 'baz'});\n * console.log('finished processing baz');\n */\nfunction cargo(worker, payload) {\n    return queue(worker, 1, payload);\n}\n\n/**\n * Creates a `cargoQueue` object with the specified payload. Tasks added to the\n * cargoQueue will be processed together (up to the `payload` limit) in `concurrency` parallel workers.\n * If the all `workers` are in progress, the task is queued until one becomes available. Once\n * a `worker` has completed some tasks, each callback of those tasks is\n * called. Check out [these](https://camo.githubusercontent.com/6bbd36f4cf5b35a0f11a96dcd2e97711ffc2fb37/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130382f62626330636662302d356632392d313165322d393734662d3333393763363464633835382e676966) [animations](https://camo.githubusercontent.com/f4810e00e1c5f5f8addbe3e9f49064fd5d102699/68747470733a2f2f662e636c6f75642e6769746875622e636f6d2f6173736574732f313637363837312f36383130312f38346339323036362d356632392d313165322d383134662d3964336430323431336266642e676966)\n * for how `cargo` and `queue` work.\n *\n * While [`queue`]{@link module:ControlFlow.queue} passes only one task to one of a group of workers\n * at a time, and [`cargo`]{@link module:ControlFlow.cargo} passes an array of tasks to a single worker,\n * the cargoQueue passes an array of tasks to multiple parallel workers.\n *\n * @name cargoQueue\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.queue]{@link module:ControlFlow.queue}\n * @see [async.cargo]{@link module:ControlFLow.cargo}\n * @category Control Flow\n * @param {AsyncFunction} worker - An asynchronous function for processing an array\n * of queued tasks. Invoked with `(tasks, callback)`.\n * @param {number} [concurrency=1] - An `integer` for determining how many\n * `worker` functions should be run in parallel.  If omitted, the concurrency\n * defaults to `1`.  If the concurrency is `0`, an error is thrown.\n * @param {number} [payload=Infinity] - An optional `integer` for determining\n * how many tasks should be processed per round; if omitted, the default is\n * unlimited.\n * @returns {module:ControlFlow.CargoObject} A cargoQueue object to manage the tasks. Callbacks can\n * attached as certain properties to listen for specific events during the\n * lifecycle of the cargoQueue and inner queue.\n * @example\n *\n * // create a cargoQueue object with payload 2 and concurrency 2\n * var cargoQueue = async.cargoQueue(function(tasks, callback) {\n *     for (var i=0; i<tasks.length; i++) {\n *         console.log('hello ' + tasks[i].name);\n *     }\n *     callback();\n * }, 2, 2);\n *\n * // add some items\n * cargoQueue.push({name: 'foo'}, function(err) {\n *     console.log('finished processing foo');\n * });\n * cargoQueue.push({name: 'bar'}, function(err) {\n *     console.log('finished processing bar');\n * });\n * cargoQueue.push({name: 'baz'}, function(err) {\n *     console.log('finished processing baz');\n * });\n * cargoQueue.push({name: 'boo'}, function(err) {\n *     console.log('finished processing boo');\n * });\n */\nfunction cargo$1(worker, concurrency, payload) {\n    return queue(worker, concurrency, payload);\n}\n\n/**\n * Reduces `coll` into a single value using an async `iteratee` to return each\n * successive step. `memo` is the initial state of the reduction. This function\n * only operates in series.\n *\n * For performance reasons, it may make sense to split a call to this function\n * into a parallel map, and then use the normal `Array.prototype.reduce` on the\n * results. This function is for situations where each step in the reduction\n * needs to be async; if you can get the data before reducing it, then it's\n * probably a good idea to do so.\n *\n * @name reduce\n * @static\n * @memberOf module:Collections\n * @method\n * @alias inject\n * @alias foldl\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {*} memo - The initial state of the reduction.\n * @param {AsyncFunction} iteratee - A function applied to each item in the\n * array to produce the next step in the reduction.\n * The `iteratee` should complete with the next state of the reduction.\n * If the iteratee complete with an error, the reduction is stopped and the\n * main `callback` is immediately called with the error.\n * Invoked with (memo, item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result is the reduced value. Invoked with\n * (err, result).\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * async.reduce([1,2,3], 0, function(memo, item, callback) {\n *     // pointless async:\n *     process.nextTick(function() {\n *         callback(null, memo + item)\n *     });\n * }, function(err, result) {\n *     // result is now equal to the last value of memo, which is 6\n * });\n */\nfunction reduce(coll, memo, iteratee, callback) {\n    callback = once(callback);\n    var _iteratee = wrapAsync(iteratee);\n    return eachOfSeries$1(coll, (x, i, iterCb) => {\n        _iteratee(memo, x, (err, v) => {\n            memo = v;\n            iterCb(err);\n        });\n    }, err => callback(err, memo));\n}\nvar reduce$1 = awaitify(reduce, 4);\n\n/**\n * Version of the compose function that is more natural to read. Each function\n * consumes the return value of the previous function. It is the equivalent of\n * [compose]{@link module:ControlFlow.compose} with the arguments reversed.\n *\n * Each function is executed with the `this` binding of the composed function.\n *\n * @name seq\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.compose]{@link module:ControlFlow.compose}\n * @category Control Flow\n * @param {...AsyncFunction} functions - the asynchronous functions to compose\n * @returns {Function} a function that composes the `functions` in order\n * @example\n *\n * // Requires lodash (or underscore), express3 and dresende's orm2.\n * // Part of an app, that fetches cats of the logged user.\n * // This example uses `seq` function to avoid overnesting and error\n * // handling clutter.\n * app.get('/cats', function(request, response) {\n *     var User = request.models.User;\n *     async.seq(\n *         _.bind(User.get, User),  // 'User.get' has signature (id, callback(err, data))\n *         function(user, fn) {\n *             user.getCats(fn);      // 'getCats' has signature (callback(err, data))\n *         }\n *     )(req.session.user_id, function (err, cats) {\n *         if (err) {\n *             console.error(err);\n *             response.json({ status: 'error', message: err.message });\n *         } else {\n *             response.json({ status: 'ok', message: 'Cats found', data: cats });\n *         }\n *     });\n * });\n */\nfunction seq(...functions) {\n    var _functions = functions.map(wrapAsync);\n    return function (...args) {\n        var that = this;\n\n        var cb = args[args.length - 1];\n        if (typeof cb == 'function') {\n            args.pop();\n        } else {\n            cb = promiseCallback();\n        }\n\n        reduce$1(_functions, args, (newargs, fn, iterCb) => {\n            fn.apply(that, newargs.concat((err, ...nextargs) => {\n                iterCb(err, nextargs);\n            }));\n        },\n        (err, results) => cb(err, ...results));\n\n        return cb[PROMISE_SYMBOL]\n    };\n}\n\n/**\n * Creates a function which is a composition of the passed asynchronous\n * functions. Each function consumes the return value of the function that\n * follows. Composing functions `f()`, `g()`, and `h()` would produce the result\n * of `f(g(h()))`, only this version uses callbacks to obtain the return values.\n *\n * If the last argument to the composed function is not a function, a promise\n * is returned when you call it.\n *\n * Each function is executed with the `this` binding of the composed function.\n *\n * @name compose\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {...AsyncFunction} functions - the asynchronous functions to compose\n * @returns {Function} an asynchronous function that is the composed\n * asynchronous `functions`\n * @example\n *\n * function add1(n, callback) {\n *     setTimeout(function () {\n *         callback(null, n + 1);\n *     }, 10);\n * }\n *\n * function mul3(n, callback) {\n *     setTimeout(function () {\n *         callback(null, n * 3);\n *     }, 10);\n * }\n *\n * var add1mul3 = async.compose(mul3, add1);\n * add1mul3(4, function (err, result) {\n *     // result now equals 15\n * });\n */\nfunction compose(...args) {\n    return seq(...args.reverse());\n}\n\n/**\n * The same as [`map`]{@link module:Collections.map} but runs a maximum of `limit` async operations at a time.\n *\n * @name mapLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.map]{@link module:Collections.map}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with the transformed item.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Results is an array of the\n * transformed items from the `coll`. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction mapLimit (coll, limit, iteratee, callback) {\n    return _asyncMap(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar mapLimit$1 = awaitify(mapLimit, 4);\n\n/**\n * The same as [`concat`]{@link module:Collections.concat} but runs a maximum of `limit` async operations at a time.\n *\n * @name concatLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.concat]{@link module:Collections.concat}\n * @category Collection\n * @alias flatMapLimit\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`,\n * which should use an array as its result. Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished, or an error occurs. Results is an array\n * containing the concatenated results of the `iteratee` function. Invoked with\n * (err, results).\n * @returns A Promise, if no callback is passed\n */\nfunction concatLimit(coll, limit, iteratee, callback) {\n    var _iteratee = wrapAsync(iteratee);\n    return mapLimit$1(coll, limit, (val, iterCb) => {\n        _iteratee(val, (err, ...args) => {\n            if (err) return iterCb(err);\n            return iterCb(err, args);\n        });\n    }, (err, mapResults) => {\n        var result = [];\n        for (var i = 0; i < mapResults.length; i++) {\n            if (mapResults[i]) {\n                result = result.concat(...mapResults[i]);\n            }\n        }\n\n        return callback(err, result);\n    });\n}\nvar concatLimit$1 = awaitify(concatLimit, 4);\n\n/**\n * Applies `iteratee` to each item in `coll`, concatenating the results. Returns\n * the concatenated list. The `iteratee`s are called in parallel, and the\n * results are concatenated as they return. The results array will be returned in\n * the original order of `coll` passed to the `iteratee` function.\n *\n * @name concat\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @alias flatMap\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`,\n * which should use an array as its result. Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished, or an error occurs. Results is an array\n * containing the concatenated results of the `iteratee` function. Invoked with\n * (err, results).\n * @returns A Promise, if no callback is passed\n * @example\n *\n * async.concat(['dir1','dir2','dir3'], fs.readdir, function(err, files) {\n *     // files is now a list of filenames that exist in the 3 directories\n * });\n */\nfunction concat(coll, iteratee, callback) {\n    return concatLimit$1(coll, Infinity, iteratee, callback)\n}\nvar concat$1 = awaitify(concat, 3);\n\n/**\n * The same as [`concat`]{@link module:Collections.concat} but runs only a single async operation at a time.\n *\n * @name concatSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.concat]{@link module:Collections.concat}\n * @category Collection\n * @alias flatMapSeries\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A function to apply to each item in `coll`.\n * The iteratee should complete with an array an array of results.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished, or an error occurs. Results is an array\n * containing the concatenated results of the `iteratee` function. Invoked with\n * (err, results).\n * @returns A Promise, if no callback is passed\n */\nfunction concatSeries(coll, iteratee, callback) {\n    return concatLimit$1(coll, 1, iteratee, callback)\n}\nvar concatSeries$1 = awaitify(concatSeries, 3);\n\n/**\n * Returns a function that when called, calls-back with the values provided.\n * Useful as the first function in a [`waterfall`]{@link module:ControlFlow.waterfall}, or for plugging values in to\n * [`auto`]{@link module:ControlFlow.auto}.\n *\n * @name constant\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {...*} arguments... - Any number of arguments to automatically invoke\n * callback with.\n * @returns {AsyncFunction} Returns a function that when invoked, automatically\n * invokes the callback with the previous given arguments.\n * @example\n *\n * async.waterfall([\n *     async.constant(42),\n *     function (value, next) {\n *         // value === 42\n *     },\n *     //...\n * ], callback);\n *\n * async.waterfall([\n *     async.constant(filename, \"utf8\"),\n *     fs.readFile,\n *     function (fileData, next) {\n *         //...\n *     }\n *     //...\n * ], callback);\n *\n * async.auto({\n *     hostname: async.constant(\"https://server.net/\"),\n *     port: findFreePort,\n *     launchServer: [\"hostname\", \"port\", function (options, cb) {\n *         startServer(options, cb);\n *     }],\n *     //...\n * }, callback);\n */\nfunction constant(...args) {\n    return function (...ignoredArgs/*, callback*/) {\n        var callback = ignoredArgs.pop();\n        return callback(null, ...args);\n    };\n}\n\nfunction _createTester(check, getResult) {\n    return (eachfn, arr, _iteratee, cb) => {\n        var testPassed = false;\n        var testResult;\n        const iteratee = wrapAsync(_iteratee);\n        eachfn(arr, (value, _, callback) => {\n            iteratee(value, (err, result) => {\n                if (err || err === false) return callback(err);\n\n                if (check(result) && !testResult) {\n                    testPassed = true;\n                    testResult = getResult(true, value);\n                    return callback(null, breakLoop);\n                }\n                callback();\n            });\n        }, err => {\n            if (err) return cb(err);\n            cb(null, testPassed ? testResult : getResult(false));\n        });\n    };\n}\n\n/**\n * Returns the first value in `coll` that passes an async truth test. The\n * `iteratee` is applied in parallel, meaning the first iteratee to return\n * `true` will fire the detect `callback` with that result. That means the\n * result might not be the first item in the original `coll` (in terms of order)\n * that passes the test.\n\n * If order within the original `coll` is important, then look at\n * [`detectSeries`]{@link module:Collections.detectSeries}.\n *\n * @name detect\n * @static\n * @memberOf module:Collections\n * @method\n * @alias find\n * @category Collections\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.\n * The iteratee must complete with a boolean value as its result.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the `iteratee` functions have finished.\n * Result will be the first item in the array that passes the truth test\n * (iteratee) or the value `undefined` if none passed. Invoked with\n * (err, result).\n * @returns A Promise, if no callback is passed\n * @example\n *\n * async.detect(['file1','file2','file3'], function(filePath, callback) {\n *     fs.access(filePath, function(err) {\n *         callback(null, !err)\n *     });\n * }, function(err, result) {\n *     // result now equals the first file in the list that exists\n * });\n */\nfunction detect(coll, iteratee, callback) {\n    return _createTester(bool => bool, (res, item) => item)(eachOf$1, coll, iteratee, callback)\n}\nvar detect$1 = awaitify(detect, 3);\n\n/**\n * The same as [`detect`]{@link module:Collections.detect} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name detectLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.detect]{@link module:Collections.detect}\n * @alias findLimit\n * @category Collections\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.\n * The iteratee must complete with a boolean value as its result.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the `iteratee` functions have finished.\n * Result will be the first item in the array that passes the truth test\n * (iteratee) or the value `undefined` if none passed. Invoked with\n * (err, result).\n * @returns a Promise if no callback is passed\n */\nfunction detectLimit(coll, limit, iteratee, callback) {\n    return _createTester(bool => bool, (res, item) => item)(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar detectLimit$1 = awaitify(detectLimit, 4);\n\n/**\n * The same as [`detect`]{@link module:Collections.detect} but runs only a single async operation at a time.\n *\n * @name detectSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.detect]{@link module:Collections.detect}\n * @alias findSeries\n * @category Collections\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A truth test to apply to each item in `coll`.\n * The iteratee must complete with a boolean value as its result.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the `iteratee` functions have finished.\n * Result will be the first item in the array that passes the truth test\n * (iteratee) or the value `undefined` if none passed. Invoked with\n * (err, result).\n * @returns a Promise if no callback is passed\n */\nfunction detectSeries(coll, iteratee, callback) {\n    return _createTester(bool => bool, (res, item) => item)(eachOfLimit(1), coll, iteratee, callback)\n}\n\nvar detectSeries$1 = awaitify(detectSeries, 3);\n\nfunction consoleFunc(name) {\n    return (fn, ...args) => wrapAsync(fn)(...args, (err, ...resultArgs) => {\n        if (typeof console === 'object') {\n            if (err) {\n                if (console.error) {\n                    console.error(err);\n                }\n            } else if (console[name]) {\n                resultArgs.forEach(x => console[name](x));\n            }\n        }\n    })\n}\n\n/**\n * Logs the result of an [`async` function]{@link AsyncFunction} to the\n * `console` using `console.dir` to display the properties of the resulting object.\n * Only works in Node.js or in browsers that support `console.dir` and\n * `console.error` (such as FF and Chrome).\n * If multiple arguments are returned from the async function,\n * `console.dir` is called on each argument in order.\n *\n * @name dir\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} function - The function you want to eventually apply\n * all arguments to.\n * @param {...*} arguments... - Any number of arguments to apply to the function.\n * @example\n *\n * // in a module\n * var hello = function(name, callback) {\n *     setTimeout(function() {\n *         callback(null, {hello: name});\n *     }, 1000);\n * };\n *\n * // in the node repl\n * node> async.dir(hello, 'world');\n * {hello: 'world'}\n */\nvar dir = consoleFunc('dir');\n\n/**\n * The post-check version of [`whilst`]{@link module:ControlFlow.whilst}. To reflect the difference in\n * the order of operations, the arguments `test` and `iteratee` are switched.\n *\n * `doWhilst` is to `whilst` as `do while` is to `while` in plain JavaScript.\n *\n * @name doWhilst\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.whilst]{@link module:ControlFlow.whilst}\n * @category Control Flow\n * @param {AsyncFunction} iteratee - A function which is called each time `test`\n * passes. Invoked with (callback).\n * @param {AsyncFunction} test - asynchronous truth test to perform after each\n * execution of `iteratee`. Invoked with (...args, callback), where `...args` are the\n * non-error args from the previous callback of `iteratee`.\n * @param {Function} [callback] - A callback which is called after the test\n * function has failed and repeated execution of `iteratee` has stopped.\n * `callback` will be passed an error and any arguments passed to the final\n * `iteratee`'s callback. Invoked with (err, [results]);\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction doWhilst(iteratee, test, callback) {\n    callback = onlyOnce(callback);\n    var _fn = wrapAsync(iteratee);\n    var _test = wrapAsync(test);\n    var results;\n\n    function next(err, ...args) {\n        if (err) return callback(err);\n        if (err === false) return;\n        results = args;\n        _test(...args, check);\n    }\n\n    function check(err, truth) {\n        if (err) return callback(err);\n        if (err === false) return;\n        if (!truth) return callback(null, ...results);\n        _fn(next);\n    }\n\n    return check(null, true);\n}\n\nvar doWhilst$1 = awaitify(doWhilst, 3);\n\n/**\n * Like ['doWhilst']{@link module:ControlFlow.doWhilst}, except the `test` is inverted. Note the\n * argument ordering differs from `until`.\n *\n * @name doUntil\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.doWhilst]{@link module:ControlFlow.doWhilst}\n * @category Control Flow\n * @param {AsyncFunction} iteratee - An async function which is called each time\n * `test` fails. Invoked with (callback).\n * @param {AsyncFunction} test - asynchronous truth test to perform after each\n * execution of `iteratee`. Invoked with (...args, callback), where `...args` are the\n * non-error args from the previous callback of `iteratee`\n * @param {Function} [callback] - A callback which is called after the test\n * function has passed and repeated execution of `iteratee` has stopped. `callback`\n * will be passed an error and any arguments passed to the final `iteratee`'s\n * callback. Invoked with (err, [results]);\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction doUntil(iteratee, test, callback) {\n    const _test = wrapAsync(test);\n    return doWhilst$1(iteratee, (...args) => {\n        const cb = args.pop();\n        _test(...args, (err, truth) => cb (err, !truth));\n    }, callback);\n}\n\nfunction _withoutIndex(iteratee) {\n    return (value, index, callback) => iteratee(value, callback);\n}\n\n/**\n * Applies the function `iteratee` to each item in `coll`, in parallel.\n * The `iteratee` is called with an item from the list, and a callback for when\n * it has finished. If the `iteratee` passes an error to its `callback`, the\n * main `callback` (for the `each` function) is immediately called with the\n * error.\n *\n * Note, that since this function applies `iteratee` to each item in parallel,\n * there is no guarantee that the iteratee functions will complete in order.\n *\n * @name each\n * @static\n * @memberOf module:Collections\n * @method\n * @alias forEach\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to\n * each item in `coll`. Invoked with (item, callback).\n * The array index is not passed to the iteratee.\n * If you need the index, use `eachOf`.\n * @param {Function} [callback] - A callback which is called when all\n * `iteratee` functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n * @example\n *\n * // assuming openFiles is an array of file names and saveFile is a function\n * // to save the modified contents of that file:\n *\n * async.each(openFiles, saveFile, function(err){\n *   // if any of the saves produced an error, err would equal that error\n * });\n *\n * // assuming openFiles is an array of file names\n * async.each(openFiles, function(file, callback) {\n *\n *     // Perform operation on file here.\n *     console.log('Processing file ' + file);\n *\n *     if( file.length > 32 ) {\n *       console.log('This file name is too long');\n *       callback('File name too long');\n *     } else {\n *       // Do work to process file here\n *       console.log('File processed');\n *       callback();\n *     }\n * }, function(err) {\n *     // if any of the file processing produced an error, err would equal that error\n *     if( err ) {\n *       // One of the iterations produced an error.\n *       // All processing will now stop.\n *       console.log('A file failed to process');\n *     } else {\n *       console.log('All files have been processed successfully');\n *     }\n * });\n */\nfunction eachLimit(coll, iteratee, callback) {\n    return eachOf$1(coll, _withoutIndex(wrapAsync(iteratee)), callback);\n}\n\nvar each = awaitify(eachLimit, 3);\n\n/**\n * The same as [`each`]{@link module:Collections.each} but runs a maximum of `limit` async operations at a time.\n *\n * @name eachLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.each]{@link module:Collections.each}\n * @alias forEachLimit\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The array index is not passed to the iteratee.\n * If you need the index, use `eachOfLimit`.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called when all\n * `iteratee` functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n */\nfunction eachLimit$1(coll, limit, iteratee, callback) {\n    return eachOfLimit(limit)(coll, _withoutIndex(wrapAsync(iteratee)), callback);\n}\nvar eachLimit$2 = awaitify(eachLimit$1, 4);\n\n/**\n * The same as [`each`]{@link module:Collections.each} but runs only a single async operation at a time.\n *\n * Note, that unlike [`each`]{@link module:Collections.each}, this function applies iteratee to each item\n * in series and therefore the iteratee functions will complete in order.\n\n * @name eachSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.each]{@link module:Collections.each}\n * @alias forEachSeries\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each\n * item in `coll`.\n * The array index is not passed to the iteratee.\n * If you need the index, use `eachOfSeries`.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called when all\n * `iteratee` functions have finished, or an error occurs. Invoked with (err).\n * @returns {Promise} a promise, if a callback is omitted\n */\nfunction eachSeries(coll, iteratee, callback) {\n    return eachLimit$2(coll, 1, iteratee, callback)\n}\nvar eachSeries$1 = awaitify(eachSeries, 3);\n\n/**\n * Wrap an async function and ensure it calls its callback on a later tick of\n * the event loop.  If the function already calls its callback on a next tick,\n * no extra deferral is added. This is useful for preventing stack overflows\n * (`RangeError: Maximum call stack size exceeded`) and generally keeping\n * [Zalgo](http://blog.izs.me/post/59142742143/designing-apis-for-asynchrony)\n * contained. ES2017 `async` functions are returned as-is -- they are immune\n * to Zalgo's corrupting influences, as they always resolve on a later tick.\n *\n * @name ensureAsync\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} fn - an async function, one that expects a node-style\n * callback as its last argument.\n * @returns {AsyncFunction} Returns a wrapped function with the exact same call\n * signature as the function passed in.\n * @example\n *\n * function sometimesAsync(arg, callback) {\n *     if (cache[arg]) {\n *         return callback(null, cache[arg]); // this would be synchronous!!\n *     } else {\n *         doSomeIO(arg, callback); // this IO would be asynchronous\n *     }\n * }\n *\n * // this has a risk of stack overflows if many results are cached in a row\n * async.mapSeries(args, sometimesAsync, done);\n *\n * // this will defer sometimesAsync's callback if necessary,\n * // preventing stack overflows\n * async.mapSeries(args, async.ensureAsync(sometimesAsync), done);\n */\nfunction ensureAsync(fn) {\n    if (isAsync(fn)) return fn;\n    return function (...args/*, callback*/) {\n        var callback = args.pop();\n        var sync = true;\n        args.push((...innerArgs) => {\n            if (sync) {\n                setImmediate$1(() => callback(...innerArgs));\n            } else {\n                callback(...innerArgs);\n            }\n        });\n        fn.apply(this, args);\n        sync = false;\n    };\n}\n\n/**\n * Returns `true` if every element in `coll` satisfies an async test. If any\n * iteratee call returns `false`, the main `callback` is immediately called.\n *\n * @name every\n * @static\n * @memberOf module:Collections\n * @method\n * @alias all\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collection in parallel.\n * The iteratee must complete with a boolean result value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result will be either `true` or `false`\n * depending on the values of the async tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n * @example\n *\n * async.every(['file1','file2','file3'], function(filePath, callback) {\n *     fs.access(filePath, function(err) {\n *         callback(null, !err)\n *     });\n * }, function(err, result) {\n *     // if result is true then every file exists\n * });\n */\nfunction every(coll, iteratee, callback) {\n    return _createTester(bool => !bool, res => !res)(eachOf$1, coll, iteratee, callback)\n}\nvar every$1 = awaitify(every, 3);\n\n/**\n * The same as [`every`]{@link module:Collections.every} but runs a maximum of `limit` async operations at a time.\n *\n * @name everyLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.every]{@link module:Collections.every}\n * @alias allLimit\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collection in parallel.\n * The iteratee must complete with a boolean result value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result will be either `true` or `false`\n * depending on the values of the async tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n */\nfunction everyLimit(coll, limit, iteratee, callback) {\n    return _createTester(bool => !bool, res => !res)(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar everyLimit$1 = awaitify(everyLimit, 4);\n\n/**\n * The same as [`every`]{@link module:Collections.every} but runs only a single async operation at a time.\n *\n * @name everySeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.every]{@link module:Collections.every}\n * @alias allSeries\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collection in series.\n * The iteratee must complete with a boolean result value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result will be either `true` or `false`\n * depending on the values of the async tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n */\nfunction everySeries(coll, iteratee, callback) {\n    return _createTester(bool => !bool, res => !res)(eachOfSeries$1, coll, iteratee, callback)\n}\nvar everySeries$1 = awaitify(everySeries, 3);\n\nfunction filterArray(eachfn, arr, iteratee, callback) {\n    var truthValues = new Array(arr.length);\n    eachfn(arr, (x, index, iterCb) => {\n        iteratee(x, (err, v) => {\n            truthValues[index] = !!v;\n            iterCb(err);\n        });\n    }, err => {\n        if (err) return callback(err);\n        var results = [];\n        for (var i = 0; i < arr.length; i++) {\n            if (truthValues[i]) results.push(arr[i]);\n        }\n        callback(null, results);\n    });\n}\n\nfunction filterGeneric(eachfn, coll, iteratee, callback) {\n    var results = [];\n    eachfn(coll, (x, index, iterCb) => {\n        iteratee(x, (err, v) => {\n            if (err) return iterCb(err);\n            if (v) {\n                results.push({index, value: x});\n            }\n            iterCb(err);\n        });\n    }, err => {\n        if (err) return callback(err);\n        callback(null, results\n            .sort((a, b) => a.index - b.index)\n            .map(v => v.value));\n    });\n}\n\nfunction _filter(eachfn, coll, iteratee, callback) {\n    var filter = isArrayLike(coll) ? filterArray : filterGeneric;\n    return filter(eachfn, coll, wrapAsync(iteratee), callback);\n}\n\n/**\n * Returns a new array of all the values in `coll` which pass an async truth\n * test. This operation is performed in parallel, but the results array will be\n * in the same order as the original.\n *\n * @name filter\n * @static\n * @memberOf module:Collections\n * @method\n * @alias select\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {Function} iteratee - A truth test to apply to each item in `coll`.\n * The `iteratee` is passed a `callback(err, truthValue)`, which must be called\n * with a boolean argument once it has completed. Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback provided\n * @example\n *\n * async.filter(['file1','file2','file3'], function(filePath, callback) {\n *     fs.access(filePath, function(err) {\n *         callback(null, !err)\n *     });\n * }, function(err, results) {\n *     // results now equals an array of the existing files\n * });\n */\nfunction filter (coll, iteratee, callback) {\n    return _filter(eachOf$1, coll, iteratee, callback)\n}\nvar filter$1 = awaitify(filter, 3);\n\n/**\n * The same as [`filter`]{@link module:Collections.filter} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name filterLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.filter]{@link module:Collections.filter}\n * @alias selectLimit\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {Function} iteratee - A truth test to apply to each item in `coll`.\n * The `iteratee` is passed a `callback(err, truthValue)`, which must be called\n * with a boolean argument once it has completed. Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback provided\n */\nfunction filterLimit (coll, limit, iteratee, callback) {\n    return _filter(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar filterLimit$1 = awaitify(filterLimit, 4);\n\n/**\n * The same as [`filter`]{@link module:Collections.filter} but runs only a single async operation at a time.\n *\n * @name filterSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.filter]{@link module:Collections.filter}\n * @alias selectSeries\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {Function} iteratee - A truth test to apply to each item in `coll`.\n * The `iteratee` is passed a `callback(err, truthValue)`, which must be called\n * with a boolean argument once it has completed. Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results)\n * @returns {Promise} a promise, if no callback provided\n */\nfunction filterSeries (coll, iteratee, callback) {\n    return _filter(eachOfSeries$1, coll, iteratee, callback)\n}\nvar filterSeries$1 = awaitify(filterSeries, 3);\n\n/**\n * Calls the asynchronous function `fn` with a callback parameter that allows it\n * to call itself again, in series, indefinitely.\n\n * If an error is passed to the callback then `errback` is called with the\n * error, and execution stops, otherwise it will never be called.\n *\n * @name forever\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {AsyncFunction} fn - an async function to call repeatedly.\n * Invoked with (next).\n * @param {Function} [errback] - when `fn` passes an error to it's callback,\n * this function will be called, and execution stops. Invoked with (err).\n * @returns {Promise} a promise that rejects if an error occurs and an errback\n * is not passed\n * @example\n *\n * async.forever(\n *     function(next) {\n *         // next is suitable for passing to things that need a callback(err [, whatever]);\n *         // it will result in this function being called again.\n *     },\n *     function(err) {\n *         // if next is called with a value in its first parameter, it will appear\n *         // in here as 'err', and execution will stop.\n *     }\n * );\n */\nfunction forever(fn, errback) {\n    var done = onlyOnce(errback);\n    var task = wrapAsync(ensureAsync(fn));\n\n    function next(err) {\n        if (err) return done(err);\n        if (err === false) return;\n        task(next);\n    }\n    return next();\n}\nvar forever$1 = awaitify(forever, 2);\n\n/**\n * The same as [`groupBy`]{@link module:Collections.groupBy} but runs a maximum of `limit` async operations at a time.\n *\n * @name groupByLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.groupBy]{@link module:Collections.groupBy}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with a `key` to group the value under.\n * Invoked with (value, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Result is an `Object` whoses\n * properties are arrays of values which returned the corresponding key.\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction groupByLimit(coll, limit, iteratee, callback) {\n    var _iteratee = wrapAsync(iteratee);\n    return mapLimit$1(coll, limit, (val, iterCb) => {\n        _iteratee(val, (err, key) => {\n            if (err) return iterCb(err);\n            return iterCb(err, {key, val});\n        });\n    }, (err, mapResults) => {\n        var result = {};\n        // from MDN, handle object having an `hasOwnProperty` prop\n        var {hasOwnProperty} = Object.prototype;\n\n        for (var i = 0; i < mapResults.length; i++) {\n            if (mapResults[i]) {\n                var {key} = mapResults[i];\n                var {val} = mapResults[i];\n\n                if (hasOwnProperty.call(result, key)) {\n                    result[key].push(val);\n                } else {\n                    result[key] = [val];\n                }\n            }\n        }\n\n        return callback(err, result);\n    });\n}\n\nvar groupByLimit$1 = awaitify(groupByLimit, 4);\n\n/**\n * Returns a new object, where each value corresponds to an array of items, from\n * `coll`, that returned the corresponding key. That is, the keys of the object\n * correspond to the values passed to the `iteratee` callback.\n *\n * Note: Since this function applies the `iteratee` to each item in parallel,\n * there is no guarantee that the `iteratee` functions will complete in order.\n * However, the values for each key in the `result` will be in the same order as\n * the original `coll`. For Objects, the values will roughly be in the order of\n * the original Objects' keys (but this can vary across JavaScript engines).\n *\n * @name groupBy\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with a `key` to group the value under.\n * Invoked with (value, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Result is an `Object` whoses\n * properties are arrays of values which returned the corresponding key.\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * async.groupBy(['userId1', 'userId2', 'userId3'], function(userId, callback) {\n *     db.findById(userId, function(err, user) {\n *         if (err) return callback(err);\n *         return callback(null, user.age);\n *     });\n * }, function(err, result) {\n *     // result is object containing the userIds grouped by age\n *     // e.g. { 30: ['userId1', 'userId3'], 42: ['userId2']};\n * });\n */\nfunction groupBy (coll, iteratee, callback) {\n    return groupByLimit$1(coll, Infinity, iteratee, callback)\n}\n\n/**\n * The same as [`groupBy`]{@link module:Collections.groupBy} but runs only a single async operation at a time.\n *\n * @name groupBySeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.groupBy]{@link module:Collections.groupBy}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with a `key` to group the value under.\n * Invoked with (value, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. Result is an `Object` whoses\n * properties are arrays of values which returned the corresponding key.\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction groupBySeries (coll, iteratee, callback) {\n    return groupByLimit$1(coll, 1, iteratee, callback)\n}\n\n/**\n * Logs the result of an `async` function to the `console`. Only works in\n * Node.js or in browsers that support `console.log` and `console.error` (such\n * as FF and Chrome). If multiple arguments are returned from the async\n * function, `console.log` is called on each argument in order.\n *\n * @name log\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} function - The function you want to eventually apply\n * all arguments to.\n * @param {...*} arguments... - Any number of arguments to apply to the function.\n * @example\n *\n * // in a module\n * var hello = function(name, callback) {\n *     setTimeout(function() {\n *         callback(null, 'hello ' + name);\n *     }, 1000);\n * };\n *\n * // in the node repl\n * node> async.log(hello, 'world');\n * 'hello world'\n */\nvar log = consoleFunc('log');\n\n/**\n * The same as [`mapValues`]{@link module:Collections.mapValues} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name mapValuesLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.mapValues]{@link module:Collections.mapValues}\n * @category Collection\n * @param {Object} obj - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - A function to apply to each value and key\n * in `coll`.\n * The iteratee should complete with the transformed value as its result.\n * Invoked with (value, key, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. `result` is a new object consisting\n * of each key from `obj`, with each transformed value on the right-hand side.\n * Invoked with (err, result).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction mapValuesLimit(obj, limit, iteratee, callback) {\n    callback = once(callback);\n    var newObj = {};\n    var _iteratee = wrapAsync(iteratee);\n    return eachOfLimit(limit)(obj, (val, key, next) => {\n        _iteratee(val, key, (err, result) => {\n            if (err) return next(err);\n            newObj[key] = result;\n            next(err);\n        });\n    }, err => callback(err, newObj));\n}\n\nvar mapValuesLimit$1 = awaitify(mapValuesLimit, 4);\n\n/**\n * A relative of [`map`]{@link module:Collections.map}, designed for use with objects.\n *\n * Produces a new Object by mapping each value of `obj` through the `iteratee`\n * function. The `iteratee` is called each `value` and `key` from `obj` and a\n * callback for when it has finished processing. Each of these callbacks takes\n * two arguments: an `error`, and the transformed item from `obj`. If `iteratee`\n * passes an error to its callback, the main `callback` (for the `mapValues`\n * function) is immediately called with the error.\n *\n * Note, the order of the keys in the result is not guaranteed.  The keys will\n * be roughly in the order they complete, (but this is very engine-specific)\n *\n * @name mapValues\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @param {Object} obj - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A function to apply to each value and key\n * in `coll`.\n * The iteratee should complete with the transformed value as its result.\n * Invoked with (value, key, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. `result` is a new object consisting\n * of each key from `obj`, with each transformed value on the right-hand side.\n * Invoked with (err, result).\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * async.mapValues({\n *     f1: 'file1',\n *     f2: 'file2',\n *     f3: 'file3'\n * }, function (file, key, callback) {\n *   fs.stat(file, callback);\n * }, function(err, result) {\n *     // result is now a map of stats for each file, e.g.\n *     // {\n *     //     f1: [stats for file1],\n *     //     f2: [stats for file2],\n *     //     f3: [stats for file3]\n *     // }\n * });\n */\nfunction mapValues(obj, iteratee, callback) {\n    return mapValuesLimit$1(obj, Infinity, iteratee, callback)\n}\n\n/**\n * The same as [`mapValues`]{@link module:Collections.mapValues} but runs only a single async operation at a time.\n *\n * @name mapValuesSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.mapValues]{@link module:Collections.mapValues}\n * @category Collection\n * @param {Object} obj - A collection to iterate over.\n * @param {AsyncFunction} iteratee - A function to apply to each value and key\n * in `coll`.\n * The iteratee should complete with the transformed value as its result.\n * Invoked with (value, key, callback).\n * @param {Function} [callback] - A callback which is called when all `iteratee`\n * functions have finished, or an error occurs. `result` is a new object consisting\n * of each key from `obj`, with each transformed value on the right-hand side.\n * Invoked with (err, result).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction mapValuesSeries(obj, iteratee, callback) {\n    return mapValuesLimit$1(obj, 1, iteratee, callback)\n}\n\n/**\n * Caches the results of an async function. When creating a hash to store\n * function results against, the callback is omitted from the hash and an\n * optional hash function can be used.\n *\n * **Note: if the async function errs, the result will not be cached and\n * subsequent calls will call the wrapped function.**\n *\n * If no hash function is specified, the first argument is used as a hash key,\n * which may work reasonably if it is a string or a data type that converts to a\n * distinct string. Note that objects and arrays will not behave reasonably.\n * Neither will cases where the other arguments are significant. In such cases,\n * specify your own hash function.\n *\n * The cache of results is exposed as the `memo` property of the function\n * returned by `memoize`.\n *\n * @name memoize\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} fn - The async function to proxy and cache results from.\n * @param {Function} hasher - An optional function for generating a custom hash\n * for storing results. It has all the arguments applied to it apart from the\n * callback, and must be synchronous.\n * @returns {AsyncFunction} a memoized version of `fn`\n * @example\n *\n * var slow_fn = function(name, callback) {\n *     // do something\n *     callback(null, result);\n * };\n * var fn = async.memoize(slow_fn);\n *\n * // fn can now be used as if it were slow_fn\n * fn('some name', function() {\n *     // callback\n * });\n */\nfunction memoize(fn, hasher = v => v) {\n    var memo = Object.create(null);\n    var queues = Object.create(null);\n    var _fn = wrapAsync(fn);\n    var memoized = initialParams((args, callback) => {\n        var key = hasher(...args);\n        if (key in memo) {\n            setImmediate$1(() => callback(null, ...memo[key]));\n        } else if (key in queues) {\n            queues[key].push(callback);\n        } else {\n            queues[key] = [callback];\n            _fn(...args, (err, ...resultArgs) => {\n                // #1465 don't memoize if an error occurred\n                if (!err) {\n                    memo[key] = resultArgs;\n                }\n                var q = queues[key];\n                delete queues[key];\n                for (var i = 0, l = q.length; i < l; i++) {\n                    q[i](err, ...resultArgs);\n                }\n            });\n        }\n    });\n    memoized.memo = memo;\n    memoized.unmemoized = fn;\n    return memoized;\n}\n\n/**\n * Calls `callback` on a later loop around the event loop. In Node.js this just\n * calls `process.nextTick`.  In the browser it will use `setImmediate` if\n * available, otherwise `setTimeout(callback, 0)`, which means other higher\n * priority events may precede the execution of `callback`.\n *\n * This is used internally for browser-compatibility purposes.\n *\n * @name nextTick\n * @static\n * @memberOf module:Utils\n * @method\n * @see [async.setImmediate]{@link module:Utils.setImmediate}\n * @category Util\n * @param {Function} callback - The function to call on a later loop around\n * the event loop. Invoked with (args...).\n * @param {...*} args... - any number of additional arguments to pass to the\n * callback on the next tick.\n * @example\n *\n * var call_order = [];\n * async.nextTick(function() {\n *     call_order.push('two');\n *     // call_order now equals ['one','two']\n * });\n * call_order.push('one');\n *\n * async.setImmediate(function (a, b, c) {\n *     // a, b, and c equal 1, 2, and 3\n * }, 1, 2, 3);\n */\nvar _defer$1;\n\nif (hasNextTick) {\n    _defer$1 = process.nextTick;\n} else if (hasSetImmediate) {\n    _defer$1 = setImmediate;\n} else {\n    _defer$1 = fallback;\n}\n\nvar nextTick = wrap(_defer$1);\n\nvar _parallel = awaitify((eachfn, tasks, callback) => {\n    var results = isArrayLike(tasks) ? [] : {};\n\n    eachfn(tasks, (task, key, taskCb) => {\n        wrapAsync(task)((err, ...result) => {\n            if (result.length < 2) {\n                [result] = result;\n            }\n            results[key] = result;\n            taskCb(err);\n        });\n    }, err => callback(err, results));\n}, 3);\n\n/**\n * Run the `tasks` collection of functions in parallel, without waiting until\n * the previous function has completed. If any of the functions pass an error to\n * its callback, the main `callback` is immediately called with the value of the\n * error. Once the `tasks` have completed, the results are passed to the final\n * `callback` as an array.\n *\n * **Note:** `parallel` is about kicking-off I/O tasks in parallel, not about\n * parallel execution of code.  If your tasks do not use any timers or perform\n * any I/O, they will actually be executed in series.  Any synchronous setup\n * sections for each task will happen one after the other.  JavaScript remains\n * single-threaded.\n *\n * **Hint:** Use [`reflect`]{@link module:Utils.reflect} to continue the\n * execution of other tasks when a task fails.\n *\n * It is also possible to use an object instead of an array. Each property will\n * be run as a function and the results will be passed to the final `callback`\n * as an object instead of an array. This can be a more readable way of handling\n * results from {@link async.parallel}.\n *\n * @name parallel\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} tasks - A collection of\n * [async functions]{@link AsyncFunction} to run.\n * Each async function can complete with any number of optional `result` values.\n * @param {Function} [callback] - An optional callback to run once all the\n * functions have completed successfully. This function gets a results array\n * (or object) containing all the result arguments passed to the task callbacks.\n * Invoked with (err, results).\n * @returns {Promise} a promise, if a callback is not passed\n *\n * @example\n * async.parallel([\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'one');\n *         }, 200);\n *     },\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'two');\n *         }, 100);\n *     }\n * ],\n * // optional callback\n * function(err, results) {\n *     // the results array will equal ['one','two'] even though\n *     // the second function had a shorter timeout.\n * });\n *\n * // an example using an object instead of an array\n * async.parallel({\n *     one: function(callback) {\n *         setTimeout(function() {\n *             callback(null, 1);\n *         }, 200);\n *     },\n *     two: function(callback) {\n *         setTimeout(function() {\n *             callback(null, 2);\n *         }, 100);\n *     }\n * }, function(err, results) {\n *     // results is now equals to: {one: 1, two: 2}\n * });\n */\nfunction parallel(tasks, callback) {\n    return _parallel(eachOf$1, tasks, callback);\n}\n\n/**\n * The same as [`parallel`]{@link module:ControlFlow.parallel} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name parallelLimit\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.parallel]{@link module:ControlFlow.parallel}\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} tasks - A collection of\n * [async functions]{@link AsyncFunction} to run.\n * Each async function can complete with any number of optional `result` values.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {Function} [callback] - An optional callback to run once all the\n * functions have completed successfully. This function gets a results array\n * (or object) containing all the result arguments passed to the task callbacks.\n * Invoked with (err, results).\n * @returns {Promise} a promise, if a callback is not passed\n */\nfunction parallelLimit(tasks, limit, callback) {\n    return _parallel(eachOfLimit(limit), tasks, callback);\n}\n\n/**\n * A queue of tasks for the worker function to complete.\n * @typedef {Iterable} QueueObject\n * @memberOf module:ControlFlow\n * @property {Function} length - a function returning the number of items\n * waiting to be processed. Invoke with `queue.length()`.\n * @property {boolean} started - a boolean indicating whether or not any\n * items have been pushed and processed by the queue.\n * @property {Function} running - a function returning the number of items\n * currently being processed. Invoke with `queue.running()`.\n * @property {Function} workersList - a function returning the array of items\n * currently being processed. Invoke with `queue.workersList()`.\n * @property {Function} idle - a function returning false if there are items\n * waiting or being processed, or true if not. Invoke with `queue.idle()`.\n * @property {number} concurrency - an integer for determining how many `worker`\n * functions should be run in parallel. This property can be changed after a\n * `queue` is created to alter the concurrency on-the-fly.\n * @property {number} payload - an integer that specifies how many items are\n * passed to the worker function at a time. only applies if this is a\n * [cargo]{@link module:ControlFlow.cargo} object\n * @property {AsyncFunction} push - add a new task to the `queue`. Calls `callback`\n * once the `worker` has finished processing the task. Instead of a single task,\n * a `tasks` array can be submitted. The respective callback is used for every\n * task in the list. Invoke with `queue.push(task, [callback])`,\n * @property {AsyncFunction} unshift - add a new task to the front of the `queue`.\n * Invoke with `queue.unshift(task, [callback])`.\n * @property {AsyncFunction} pushAsync - the same as `q.push`, except this returns\n * a promise that rejects if an error occurs.\n * @property {AsyncFunction} unshirtAsync - the same as `q.unshift`, except this returns\n * a promise that rejects if an error occurs.\n * @property {Function} remove - remove items from the queue that match a test\n * function.  The test function will be passed an object with a `data` property,\n * and a `priority` property, if this is a\n * [priorityQueue]{@link module:ControlFlow.priorityQueue} object.\n * Invoked with `queue.remove(testFn)`, where `testFn` is of the form\n * `function ({data, priority}) {}` and returns a Boolean.\n * @property {Function} saturated - a function that sets a callback that is\n * called when the number of running workers hits the `concurrency` limit, and\n * further tasks will be queued.  If the callback is omitted, `q.saturated()`\n * returns a promise for the next occurrence.\n * @property {Function} unsaturated - a function that sets a callback that is\n * called when the number of running workers is less than the `concurrency` &\n * `buffer` limits, and further tasks will not be queued. If the callback is\n * omitted, `q.unsaturated()` returns a promise for the next occurrence.\n * @property {number} buffer - A minimum threshold buffer in order to say that\n * the `queue` is `unsaturated`.\n * @property {Function} empty - a function that sets a callback that is called\n * when the last item from the `queue` is given to a `worker`. If the callback\n * is omitted, `q.empty()` returns a promise for the next occurrence.\n * @property {Function} drain - a function that sets a callback that is called\n * when the last item from the `queue` has returned from the `worker`. If the\n * callback is omitted, `q.drain()` returns a promise for the next occurrence.\n * @property {Function} error - a function that sets a callback that is called\n * when a task errors. Has the signature `function(error, task)`. If the\n * callback is omitted, `error()` returns a promise that rejects on the next\n * error.\n * @property {boolean} paused - a boolean for determining whether the queue is\n * in a paused state.\n * @property {Function} pause - a function that pauses the processing of tasks\n * until `resume()` is called. Invoke with `queue.pause()`.\n * @property {Function} resume - a function that resumes the processing of\n * queued tasks when the queue is paused. Invoke with `queue.resume()`.\n * @property {Function} kill - a function that removes the `drain` callback and\n * empties remaining tasks from the queue forcing it to go idle. No more tasks\n * should be pushed to the queue after calling this function. Invoke with `queue.kill()`.\n *\n * @example\n * const q = aync.queue(worker, 2)\n * q.push(item1)\n * q.push(item2)\n * q.push(item3)\n * // queues are iterable, spread into an array to inspect\n * const items = [...q] // [item1, item2, item3]\n * // or use for of\n * for (let item of q) {\n *     console.log(item)\n * }\n *\n * q.drain(() => {\n *     console.log('all done')\n * })\n * // or\n * await q.drain()\n */\n\n/**\n * Creates a `queue` object with the specified `concurrency`. Tasks added to the\n * `queue` are processed in parallel (up to the `concurrency` limit). If all\n * `worker`s are in progress, the task is queued until one becomes available.\n * Once a `worker` completes a `task`, that `task`'s callback is called.\n *\n * @name queue\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {AsyncFunction} worker - An async function for processing a queued task.\n * If you want to handle errors from an individual task, pass a callback to\n * `q.push()`. Invoked with (task, callback).\n * @param {number} [concurrency=1] - An `integer` for determining how many\n * `worker` functions should be run in parallel.  If omitted, the concurrency\n * defaults to `1`.  If the concurrency is `0`, an error is thrown.\n * @returns {module:ControlFlow.QueueObject} A queue object to manage the tasks. Callbacks can be\n * attached as certain properties to listen for specific events during the\n * lifecycle of the queue.\n * @example\n *\n * // create a queue object with concurrency 2\n * var q = async.queue(function(task, callback) {\n *     console.log('hello ' + task.name);\n *     callback();\n * }, 2);\n *\n * // assign a callback\n * q.drain(function() {\n *     console.log('all items have been processed');\n * });\n * // or await the end\n * await q.drain()\n *\n * // assign an error callback\n * q.error(function(err, task) {\n *     console.error('task experienced an error');\n * });\n *\n * // add some items to the queue\n * q.push({name: 'foo'}, function(err) {\n *     console.log('finished processing foo');\n * });\n * // callback is optional\n * q.push({name: 'bar'});\n *\n * // add some items to the queue (batch-wise)\n * q.push([{name: 'baz'},{name: 'bay'},{name: 'bax'}], function(err) {\n *     console.log('finished processing item');\n * });\n *\n * // add some items to the front of the queue\n * q.unshift({name: 'bar'}, function (err) {\n *     console.log('finished processing bar');\n * });\n */\nfunction queue$1 (worker, concurrency) {\n    var _worker = wrapAsync(worker);\n    return queue((items, cb) => {\n        _worker(items[0], cb);\n    }, concurrency, 1);\n}\n\n// Binary min-heap implementation used for priority queue.\n// Implementation is stable, i.e. push time is considered for equal priorities\nclass Heap {\n    constructor() {\n        this.heap = [];\n        this.pushCount = Number.MIN_SAFE_INTEGER;\n    }\n\n    get length() {\n        return this.heap.length;\n    }\n\n    empty () {\n        this.heap = [];\n        return this;\n    }\n\n    percUp(index) {\n        let p;\n\n        while (index > 0 && smaller(this.heap[index], this.heap[p=parent(index)])) {\n            let t = this.heap[index];\n            this.heap[index] = this.heap[p];\n            this.heap[p] = t;\n\n            index = p;\n        }\n    }\n\n    percDown(index) {\n        let l;\n\n        while ((l=leftChi(index)) < this.heap.length) {\n            if (l+1 < this.heap.length && smaller(this.heap[l+1], this.heap[l])) {\n                l = l+1;\n            }\n\n            if (smaller(this.heap[index], this.heap[l])) {\n                break;\n            }\n\n            let t = this.heap[index];\n            this.heap[index] = this.heap[l];\n            this.heap[l] = t;\n\n            index = l;\n        }\n    }\n\n    push(node) {\n        node.pushCount = ++this.pushCount;\n        this.heap.push(node);\n        this.percUp(this.heap.length-1);\n    }\n\n    unshift(node) {\n        return this.heap.push(node);\n    }\n\n    shift() {\n        let [top] = this.heap;\n\n        this.heap[0] = this.heap[this.heap.length-1];\n        this.heap.pop();\n        this.percDown(0);\n\n        return top;\n    }\n\n    toArray() {\n        return [...this];\n    }\n\n    *[Symbol.iterator] () {\n        for (let i = 0; i < this.heap.length; i++) {\n            yield this.heap[i].data;\n        }\n    }\n\n    remove (testFn) {\n        let j = 0;\n        for (let i = 0; i < this.heap.length; i++) {\n            if (!testFn(this.heap[i])) {\n                this.heap[j] = this.heap[i];\n                j++;\n            }\n        }\n\n        this.heap.splice(j);\n\n        for (let i = parent(this.heap.length-1); i >= 0; i--) {\n            this.percDown(i);\n        }\n\n        return this;\n    }\n}\n\nfunction leftChi(i) {\n    return (i<<1)+1;\n}\n\nfunction parent(i) {\n    return ((i+1)>>1)-1;\n}\n\nfunction smaller(x, y) {\n    if (x.priority !== y.priority) {\n        return x.priority < y.priority;\n    }\n    else {\n        return x.pushCount < y.pushCount;\n    }\n}\n\n/**\n * The same as [async.queue]{@link module:ControlFlow.queue} only tasks are assigned a priority and\n * completed in ascending priority order.\n *\n * @name priorityQueue\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.queue]{@link module:ControlFlow.queue}\n * @category Control Flow\n * @param {AsyncFunction} worker - An async function for processing a queued task.\n * If you want to handle errors from an individual task, pass a callback to\n * `q.push()`.\n * Invoked with (task, callback).\n * @param {number} concurrency - An `integer` for determining how many `worker`\n * functions should be run in parallel.  If omitted, the concurrency defaults to\n * `1`.  If the concurrency is `0`, an error is thrown.\n * @returns {module:ControlFlow.QueueObject} A priorityQueue object to manage the tasks. There are two\n * differences between `queue` and `priorityQueue` objects:\n * * `push(task, priority, [callback])` - `priority` should be a number. If an\n *   array of `tasks` is given, all tasks will be assigned the same priority.\n * * The `unshift` method was removed.\n */\nfunction priorityQueue(worker, concurrency) {\n    // Start with a normal queue\n    var q = queue$1(worker, concurrency);\n\n    q._tasks = new Heap();\n\n    // Override push to accept second parameter representing priority\n    q.push = function(data, priority = 0, callback = () => {}) {\n        if (typeof callback !== 'function') {\n            throw new Error('task callback must be a function');\n        }\n        q.started = true;\n        if (!Array.isArray(data)) {\n            data = [data];\n        }\n        if (data.length === 0 && q.idle()) {\n            // call drain immediately if there are no tasks\n            return setImmediate$1(() => q.drain());\n        }\n\n        for (var i = 0, l = data.length; i < l; i++) {\n            var item = {\n                data: data[i],\n                priority,\n                callback\n            };\n\n            q._tasks.push(item);\n        }\n\n        setImmediate$1(q.process);\n    };\n\n    // Remove unshift function\n    delete q.unshift;\n\n    return q;\n}\n\n/**\n * Runs the `tasks` array of functions in parallel, without waiting until the\n * previous function has completed. Once any of the `tasks` complete or pass an\n * error to its callback, the main `callback` is immediately called. It's\n * equivalent to `Promise.race()`.\n *\n * @name race\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array} tasks - An array containing [async functions]{@link AsyncFunction}\n * to run. Each function can complete with an optional `result` value.\n * @param {Function} callback - A callback to run once any of the functions have\n * completed. This function gets an error or result from the first function that\n * completed. Invoked with (err, result).\n * @returns undefined\n * @example\n *\n * async.race([\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'one');\n *         }, 200);\n *     },\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'two');\n *         }, 100);\n *     }\n * ],\n * // main callback\n * function(err, result) {\n *     // the result will be equal to 'two' as it finishes earlier\n * });\n */\nfunction race(tasks, callback) {\n    callback = once(callback);\n    if (!Array.isArray(tasks)) return callback(new TypeError('First argument to race must be an array of functions'));\n    if (!tasks.length) return callback();\n    for (var i = 0, l = tasks.length; i < l; i++) {\n        wrapAsync(tasks[i])(callback);\n    }\n}\n\nvar race$1 = awaitify(race, 2);\n\n/**\n * Same as [`reduce`]{@link module:Collections.reduce}, only operates on `array` in reverse order.\n *\n * @name reduceRight\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.reduce]{@link module:Collections.reduce}\n * @alias foldr\n * @category Collection\n * @param {Array} array - A collection to iterate over.\n * @param {*} memo - The initial state of the reduction.\n * @param {AsyncFunction} iteratee - A function applied to each item in the\n * array to produce the next step in the reduction.\n * The `iteratee` should complete with the next state of the reduction.\n * If the iteratee complete with an error, the reduction is stopped and the\n * main `callback` is immediately called with the error.\n * Invoked with (memo, item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result is the reduced value. Invoked with\n * (err, result).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction reduceRight (array, memo, iteratee, callback) {\n    var reversed = [...array].reverse();\n    return reduce$1(reversed, memo, iteratee, callback);\n}\n\n/**\n * Wraps the async function in another function that always completes with a\n * result object, even when it errors.\n *\n * The result object has either the property `error` or `value`.\n *\n * @name reflect\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} fn - The async function you want to wrap\n * @returns {Function} - A function that always passes null to it's callback as\n * the error. The second argument to the callback will be an `object` with\n * either an `error` or a `value` property.\n * @example\n *\n * async.parallel([\n *     async.reflect(function(callback) {\n *         // do some stuff ...\n *         callback(null, 'one');\n *     }),\n *     async.reflect(function(callback) {\n *         // do some more stuff but error ...\n *         callback('bad stuff happened');\n *     }),\n *     async.reflect(function(callback) {\n *         // do some more stuff ...\n *         callback(null, 'two');\n *     })\n * ],\n * // optional callback\n * function(err, results) {\n *     // values\n *     // results[0].value = 'one'\n *     // results[1].error = 'bad stuff happened'\n *     // results[2].value = 'two'\n * });\n */\nfunction reflect(fn) {\n    var _fn = wrapAsync(fn);\n    return initialParams(function reflectOn(args, reflectCallback) {\n        args.push((error, ...cbArgs) => {\n            let retVal = {};\n            if (error) {\n                retVal.error = error;\n            }\n            if (cbArgs.length > 0){\n                var value = cbArgs;\n                if (cbArgs.length <= 1) {\n                    [value] = cbArgs;\n                }\n                retVal.value = value;\n            }\n            reflectCallback(null, retVal);\n        });\n\n        return _fn.apply(this, args);\n    });\n}\n\n/**\n * A helper function that wraps an array or an object of functions with `reflect`.\n *\n * @name reflectAll\n * @static\n * @memberOf module:Utils\n * @method\n * @see [async.reflect]{@link module:Utils.reflect}\n * @category Util\n * @param {Array|Object|Iterable} tasks - The collection of\n * [async functions]{@link AsyncFunction} to wrap in `async.reflect`.\n * @returns {Array} Returns an array of async functions, each wrapped in\n * `async.reflect`\n * @example\n *\n * let tasks = [\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'one');\n *         }, 200);\n *     },\n *     function(callback) {\n *         // do some more stuff but error ...\n *         callback(new Error('bad stuff happened'));\n *     },\n *     function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'two');\n *         }, 100);\n *     }\n * ];\n *\n * async.parallel(async.reflectAll(tasks),\n * // optional callback\n * function(err, results) {\n *     // values\n *     // results[0].value = 'one'\n *     // results[1].error = Error('bad stuff happened')\n *     // results[2].value = 'two'\n * });\n *\n * // an example using an object instead of an array\n * let tasks = {\n *     one: function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'one');\n *         }, 200);\n *     },\n *     two: function(callback) {\n *         callback('two');\n *     },\n *     three: function(callback) {\n *         setTimeout(function() {\n *             callback(null, 'three');\n *         }, 100);\n *     }\n * };\n *\n * async.parallel(async.reflectAll(tasks),\n * // optional callback\n * function(err, results) {\n *     // values\n *     // results.one.value = 'one'\n *     // results.two.error = 'two'\n *     // results.three.value = 'three'\n * });\n */\nfunction reflectAll(tasks) {\n    var results;\n    if (Array.isArray(tasks)) {\n        results = tasks.map(reflect);\n    } else {\n        results = {};\n        Object.keys(tasks).forEach(key => {\n            results[key] = reflect.call(this, tasks[key]);\n        });\n    }\n    return results;\n}\n\nfunction reject(eachfn, arr, _iteratee, callback) {\n    const iteratee = wrapAsync(_iteratee);\n    return _filter(eachfn, arr, (value, cb) => {\n        iteratee(value, (err, v) => {\n            cb(err, !v);\n        });\n    }, callback);\n}\n\n/**\n * The opposite of [`filter`]{@link module:Collections.filter}. Removes values that pass an `async` truth test.\n *\n * @name reject\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.filter]{@link module:Collections.filter}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {Function} iteratee - An async truth test to apply to each item in\n * `coll`.\n * The should complete with a boolean value as its `result`.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * async.reject(['file1','file2','file3'], function(filePath, callback) {\n *     fs.access(filePath, function(err) {\n *         callback(null, !err)\n *     });\n * }, function(err, results) {\n *     // results now equals an array of missing files\n *     createFiles(results);\n * });\n */\nfunction reject$1 (coll, iteratee, callback) {\n    return reject(eachOf$1, coll, iteratee, callback)\n}\nvar reject$2 = awaitify(reject$1, 3);\n\n/**\n * The same as [`reject`]{@link module:Collections.reject} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name rejectLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.reject]{@link module:Collections.reject}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {Function} iteratee - An async truth test to apply to each item in\n * `coll`.\n * The should complete with a boolean value as its `result`.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction rejectLimit (coll, limit, iteratee, callback) {\n    return reject(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar rejectLimit$1 = awaitify(rejectLimit, 4);\n\n/**\n * The same as [`reject`]{@link module:Collections.reject} but runs only a single async operation at a time.\n *\n * @name rejectSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.reject]{@link module:Collections.reject}\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {Function} iteratee - An async truth test to apply to each item in\n * `coll`.\n * The should complete with a boolean value as its `result`.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback is passed\n */\nfunction rejectSeries (coll, iteratee, callback) {\n    return reject(eachOfSeries$1, coll, iteratee, callback)\n}\nvar rejectSeries$1 = awaitify(rejectSeries, 3);\n\nfunction constant$1(value) {\n    return function () {\n        return value;\n    }\n}\n\n/**\n * Attempts to get a successful response from `task` no more than `times` times\n * before returning an error. If the task is successful, the `callback` will be\n * passed the result of the successful task. If all attempts fail, the callback\n * will be passed the error and result (if any) of the final attempt.\n *\n * @name retry\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @see [async.retryable]{@link module:ControlFlow.retryable}\n * @param {Object|number} [opts = {times: 5, interval: 0}| 5] - Can be either an\n * object with `times` and `interval` or a number.\n * * `times` - The number of attempts to make before giving up.  The default\n *   is `5`.\n * * `interval` - The time to wait between retries, in milliseconds.  The\n *   default is `0`. The interval may also be specified as a function of the\n *   retry count (see example).\n * * `errorFilter` - An optional synchronous function that is invoked on\n *   erroneous result. If it returns `true` the retry attempts will continue;\n *   if the function returns `false` the retry flow is aborted with the current\n *   attempt's error and result being returned to the final callback.\n *   Invoked with (err).\n * * If `opts` is a number, the number specifies the number of times to retry,\n *   with the default interval of `0`.\n * @param {AsyncFunction} task - An async function to retry.\n * Invoked with (callback).\n * @param {Function} [callback] - An optional callback which is called when the\n * task has succeeded, or after the final failed attempt. It receives the `err`\n * and `result` arguments of the last attempt at completing the `task`. Invoked\n * with (err, results).\n * @returns {Promise} a promise if no callback provided\n *\n * @example\n *\n * // The `retry` function can be used as a stand-alone control flow by passing\n * // a callback, as shown below:\n *\n * // try calling apiMethod 3 times\n * async.retry(3, apiMethod, function(err, result) {\n *     // do something with the result\n * });\n *\n * // try calling apiMethod 3 times, waiting 200 ms between each retry\n * async.retry({times: 3, interval: 200}, apiMethod, function(err, result) {\n *     // do something with the result\n * });\n *\n * // try calling apiMethod 10 times with exponential backoff\n * // (i.e. intervals of 100, 200, 400, 800, 1600, ... milliseconds)\n * async.retry({\n *   times: 10,\n *   interval: function(retryCount) {\n *     return 50 * Math.pow(2, retryCount);\n *   }\n * }, apiMethod, function(err, result) {\n *     // do something with the result\n * });\n *\n * // try calling apiMethod the default 5 times no delay between each retry\n * async.retry(apiMethod, function(err, result) {\n *     // do something with the result\n * });\n *\n * // try calling apiMethod only when error condition satisfies, all other\n * // errors will abort the retry control flow and return to final callback\n * async.retry({\n *   errorFilter: function(err) {\n *     return err.message === 'Temporary error'; // only retry on a specific error\n *   }\n * }, apiMethod, function(err, result) {\n *     // do something with the result\n * });\n *\n * // to retry individual methods that are not as reliable within other\n * // control flow functions, use the `retryable` wrapper:\n * async.auto({\n *     users: api.getUsers.bind(api),\n *     payments: async.retryable(3, api.getPayments.bind(api))\n * }, function(err, results) {\n *     // do something with the results\n * });\n *\n */\nconst DEFAULT_TIMES = 5;\nconst DEFAULT_INTERVAL = 0;\n\nfunction retry(opts, task, callback) {\n    var options = {\n        times: DEFAULT_TIMES,\n        intervalFunc: constant$1(DEFAULT_INTERVAL)\n    };\n\n    if (arguments.length < 3 && typeof opts === 'function') {\n        callback = task || promiseCallback();\n        task = opts;\n    } else {\n        parseTimes(options, opts);\n        callback = callback || promiseCallback();\n    }\n\n    if (typeof task !== 'function') {\n        throw new Error(\"Invalid arguments for async.retry\");\n    }\n\n    var _task = wrapAsync(task);\n\n    var attempt = 1;\n    function retryAttempt() {\n        _task((err, ...args) => {\n            if (err === false) return\n            if (err && attempt++ < options.times &&\n                (typeof options.errorFilter != 'function' ||\n                    options.errorFilter(err))) {\n                setTimeout(retryAttempt, options.intervalFunc(attempt - 1));\n            } else {\n                callback(err, ...args);\n            }\n        });\n    }\n\n    retryAttempt();\n    return callback[PROMISE_SYMBOL]\n}\n\nfunction parseTimes(acc, t) {\n    if (typeof t === 'object') {\n        acc.times = +t.times || DEFAULT_TIMES;\n\n        acc.intervalFunc = typeof t.interval === 'function' ?\n            t.interval :\n            constant$1(+t.interval || DEFAULT_INTERVAL);\n\n        acc.errorFilter = t.errorFilter;\n    } else if (typeof t === 'number' || typeof t === 'string') {\n        acc.times = +t || DEFAULT_TIMES;\n    } else {\n        throw new Error(\"Invalid arguments for async.retry\");\n    }\n}\n\n/**\n * A close relative of [`retry`]{@link module:ControlFlow.retry}.  This method\n * wraps a task and makes it retryable, rather than immediately calling it\n * with retries.\n *\n * @name retryable\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.retry]{@link module:ControlFlow.retry}\n * @category Control Flow\n * @param {Object|number} [opts = {times: 5, interval: 0}| 5] - optional\n * options, exactly the same as from `retry`, except for a `opts.arity` that\n * is the arity of the `task` function, defaulting to `task.length`\n * @param {AsyncFunction} task - the asynchronous function to wrap.\n * This function will be passed any arguments passed to the returned wrapper.\n * Invoked with (...args, callback).\n * @returns {AsyncFunction} The wrapped function, which when invoked, will\n * retry on an error, based on the parameters specified in `opts`.\n * This function will accept the same parameters as `task`.\n * @example\n *\n * async.auto({\n *     dep1: async.retryable(3, getFromFlakyService),\n *     process: [\"dep1\", async.retryable(3, function (results, cb) {\n *         maybeProcessData(results.dep1, cb);\n *     })]\n * }, callback);\n */\nfunction retryable (opts, task) {\n    if (!task) {\n        task = opts;\n        opts = null;\n    }\n    let arity = (opts && opts.arity) || task.length;\n    if (isAsync(task)) {\n        arity += 1;\n    }\n    var _task = wrapAsync(task);\n    return initialParams((args, callback) => {\n        if (args.length < arity - 1 || callback == null) {\n            args.push(callback);\n            callback = promiseCallback();\n        }\n        function taskFn(cb) {\n            _task(...args, cb);\n        }\n\n        if (opts) retry(opts, taskFn, callback);\n        else retry(taskFn, callback);\n\n        return callback[PROMISE_SYMBOL]\n    });\n}\n\n/**\n * Run the functions in the `tasks` collection in series, each one running once\n * the previous function has completed. If any functions in the series pass an\n * error to its callback, no more functions are run, and `callback` is\n * immediately called with the value of the error. Otherwise, `callback`\n * receives an array of results when `tasks` have completed.\n *\n * It is also possible to use an object instead of an array. Each property will\n * be run as a function, and the results will be passed to the final `callback`\n * as an object instead of an array. This can be a more readable way of handling\n *  results from {@link async.series}.\n *\n * **Note** that while many implementations preserve the order of object\n * properties, the [ECMAScript Language Specification](http://www.ecma-international.org/ecma-262/5.1/#sec-8.6)\n * explicitly states that\n *\n * > The mechanics and order of enumerating the properties is not specified.\n *\n * So if you rely on the order in which your series of functions are executed,\n * and want this to work on all platforms, consider using an array.\n *\n * @name series\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} tasks - A collection containing\n * [async functions]{@link AsyncFunction} to run in series.\n * Each function can complete with any number of optional `result` values.\n * @param {Function} [callback] - An optional callback to run once all the\n * functions have completed. This function gets a results array (or object)\n * containing all the result arguments passed to the `task` callbacks. Invoked\n * with (err, result).\n * @return {Promise} a promise, if no callback is passed\n * @example\n * async.series([\n *     function(callback) {\n *         // do some stuff ...\n *         callback(null, 'one');\n *     },\n *     function(callback) {\n *         // do some more stuff ...\n *         callback(null, 'two');\n *     }\n * ],\n * // optional callback\n * function(err, results) {\n *     // results is now equal to ['one', 'two']\n * });\n *\n * async.series({\n *     one: function(callback) {\n *         setTimeout(function() {\n *             callback(null, 1);\n *         }, 200);\n *     },\n *     two: function(callback){\n *         setTimeout(function() {\n *             callback(null, 2);\n *         }, 100);\n *     }\n * }, function(err, results) {\n *     // results is now equal to: {one: 1, two: 2}\n * });\n */\nfunction series(tasks, callback) {\n    return _parallel(eachOfSeries$1, tasks, callback);\n}\n\n/**\n * Returns `true` if at least one element in the `coll` satisfies an async test.\n * If any iteratee call returns `true`, the main `callback` is immediately\n * called.\n *\n * @name some\n * @static\n * @memberOf module:Collections\n * @method\n * @alias any\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collections in parallel.\n * The iteratee should complete with a boolean `result` value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the iteratee functions have finished.\n * Result will be either `true` or `false` depending on the values of the async\n * tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n * @example\n *\n * async.some(['file1','file2','file3'], function(filePath, callback) {\n *     fs.access(filePath, function(err) {\n *         callback(null, !err)\n *     });\n * }, function(err, result) {\n *     // if result is true then at least one of the files exists\n * });\n */\nfunction some(coll, iteratee, callback) {\n    return _createTester(Boolean, res => res)(eachOf$1, coll, iteratee, callback)\n}\nvar some$1 = awaitify(some, 3);\n\n/**\n * The same as [`some`]{@link module:Collections.some} but runs a maximum of `limit` async operations at a time.\n *\n * @name someLimit\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.some]{@link module:Collections.some}\n * @alias anyLimit\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collections in parallel.\n * The iteratee should complete with a boolean `result` value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the iteratee functions have finished.\n * Result will be either `true` or `false` depending on the values of the async\n * tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n */\nfunction someLimit(coll, limit, iteratee, callback) {\n    return _createTester(Boolean, res => res)(eachOfLimit(limit), coll, iteratee, callback)\n}\nvar someLimit$1 = awaitify(someLimit, 4);\n\n/**\n * The same as [`some`]{@link module:Collections.some} but runs only a single async operation at a time.\n *\n * @name someSeries\n * @static\n * @memberOf module:Collections\n * @method\n * @see [async.some]{@link module:Collections.some}\n * @alias anySeries\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async truth test to apply to each item\n * in the collections in series.\n * The iteratee should complete with a boolean `result` value.\n * Invoked with (item, callback).\n * @param {Function} [callback] - A callback which is called as soon as any\n * iteratee returns `true`, or after all the iteratee functions have finished.\n * Result will be either `true` or `false` depending on the values of the async\n * tests. Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n */\nfunction someSeries(coll, iteratee, callback) {\n    return _createTester(Boolean, res => res)(eachOfSeries$1, coll, iteratee, callback)\n}\nvar someSeries$1 = awaitify(someSeries, 3);\n\n/**\n * Sorts a list by the results of running each `coll` value through an async\n * `iteratee`.\n *\n * @name sortBy\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {AsyncFunction} iteratee - An async function to apply to each item in\n * `coll`.\n * The iteratee should complete with a value to use as the sort criteria as\n * its `result`.\n * Invoked with (item, callback).\n * @param {Function} callback - A callback which is called after all the\n * `iteratee` functions have finished, or an error occurs. Results is the items\n * from the original `coll` sorted by the values returned by the `iteratee`\n * calls. Invoked with (err, results).\n * @returns {Promise} a promise, if no callback passed\n * @example\n *\n * async.sortBy(['file1','file2','file3'], function(file, callback) {\n *     fs.stat(file, function(err, stats) {\n *         callback(err, stats.mtime);\n *     });\n * }, function(err, results) {\n *     // results is now the original array of files sorted by\n *     // modified date\n * });\n *\n * // By modifying the callback parameter the\n * // sorting order can be influenced:\n *\n * // ascending order\n * async.sortBy([1,9,3,5], function(x, callback) {\n *     callback(null, x);\n * }, function(err,result) {\n *     // result callback\n * });\n *\n * // descending order\n * async.sortBy([1,9,3,5], function(x, callback) {\n *     callback(null, x*-1);    //<- x*-1 instead of x, turns the order around\n * }, function(err,result) {\n *     // result callback\n * });\n */\nfunction sortBy (coll, iteratee, callback) {\n    var _iteratee = wrapAsync(iteratee);\n    return map$1(coll, (x, iterCb) => {\n        _iteratee(x, (err, criteria) => {\n            if (err) return iterCb(err);\n            iterCb(err, {value: x, criteria});\n        });\n    }, (err, results) => {\n        if (err) return callback(err);\n        callback(null, results.sort(comparator).map(v => v.value));\n    });\n\n    function comparator(left, right) {\n        var a = left.criteria, b = right.criteria;\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n}\nvar sortBy$1 = awaitify(sortBy, 3);\n\n/**\n * Sets a time limit on an asynchronous function. If the function does not call\n * its callback within the specified milliseconds, it will be called with a\n * timeout error. The code property for the error object will be `'ETIMEDOUT'`.\n *\n * @name timeout\n * @static\n * @memberOf module:Utils\n * @method\n * @category Util\n * @param {AsyncFunction} asyncFn - The async function to limit in time.\n * @param {number} milliseconds - The specified time limit.\n * @param {*} [info] - Any variable you want attached (`string`, `object`, etc)\n * to timeout Error for more information..\n * @returns {AsyncFunction} Returns a wrapped function that can be used with any\n * of the control flow functions.\n * Invoke this function with the same parameters as you would `asyncFunc`.\n * @example\n *\n * function myFunction(foo, callback) {\n *     doAsyncTask(foo, function(err, data) {\n *         // handle errors\n *         if (err) return callback(err);\n *\n *         // do some stuff ...\n *\n *         // return processed data\n *         return callback(null, data);\n *     });\n * }\n *\n * var wrapped = async.timeout(myFunction, 1000);\n *\n * // call `wrapped` as you would `myFunction`\n * wrapped({ bar: 'bar' }, function(err, data) {\n *     // if `myFunction` takes < 1000 ms to execute, `err`\n *     // and `data` will have their expected values\n *\n *     // else `err` will be an Error with the code 'ETIMEDOUT'\n * });\n */\nfunction timeout(asyncFn, milliseconds, info) {\n    var fn = wrapAsync(asyncFn);\n\n    return initialParams((args, callback) => {\n        var timedOut = false;\n        var timer;\n\n        function timeoutCallback() {\n            var name = asyncFn.name || 'anonymous';\n            var error  = new Error('Callback function \"' + name + '\" timed out.');\n            error.code = 'ETIMEDOUT';\n            if (info) {\n                error.info = info;\n            }\n            timedOut = true;\n            callback(error);\n        }\n\n        args.push((...cbArgs) => {\n            if (!timedOut) {\n                callback(...cbArgs);\n                clearTimeout(timer);\n            }\n        });\n\n        // setup timer and call original function\n        timer = setTimeout(timeoutCallback, milliseconds);\n        fn(...args);\n    });\n}\n\nfunction range(size) {\n    var result = Array(size);\n    while (size--) {\n        result[size] = size;\n    }\n    return result;\n}\n\n/**\n * The same as [times]{@link module:ControlFlow.times} but runs a maximum of `limit` async operations at a\n * time.\n *\n * @name timesLimit\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.times]{@link module:ControlFlow.times}\n * @category Control Flow\n * @param {number} count - The number of times to run the function.\n * @param {number} limit - The maximum number of async operations at a time.\n * @param {AsyncFunction} iteratee - The async function to call `n` times.\n * Invoked with the iteration index and a callback: (n, next).\n * @param {Function} callback - see [async.map]{@link module:Collections.map}.\n * @returns {Promise} a promise, if no callback is provided\n */\nfunction timesLimit(count, limit, iteratee, callback) {\n    var _iteratee = wrapAsync(iteratee);\n    return mapLimit$1(range(count), limit, _iteratee, callback);\n}\n\n/**\n * Calls the `iteratee` function `n` times, and accumulates results in the same\n * manner you would use with [map]{@link module:Collections.map}.\n *\n * @name times\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.map]{@link module:Collections.map}\n * @category Control Flow\n * @param {number} n - The number of times to run the function.\n * @param {AsyncFunction} iteratee - The async function to call `n` times.\n * Invoked with the iteration index and a callback: (n, next).\n * @param {Function} callback - see {@link module:Collections.map}.\n * @returns {Promise} a promise, if no callback is provided\n * @example\n *\n * // Pretend this is some complicated async factory\n * var createUser = function(id, callback) {\n *     callback(null, {\n *         id: 'user' + id\n *     });\n * };\n *\n * // generate 5 users\n * async.times(5, function(n, next) {\n *     createUser(n, function(err, user) {\n *         next(err, user);\n *     });\n * }, function(err, users) {\n *     // we should now have 5 users\n * });\n */\nfunction times (n, iteratee, callback) {\n    return timesLimit(n, Infinity, iteratee, callback)\n}\n\n/**\n * The same as [times]{@link module:ControlFlow.times} but runs only a single async operation at a time.\n *\n * @name timesSeries\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.times]{@link module:ControlFlow.times}\n * @category Control Flow\n * @param {number} n - The number of times to run the function.\n * @param {AsyncFunction} iteratee - The async function to call `n` times.\n * Invoked with the iteration index and a callback: (n, next).\n * @param {Function} callback - see {@link module:Collections.map}.\n * @returns {Promise} a promise, if no callback is provided\n */\nfunction timesSeries (n, iteratee, callback) {\n    return timesLimit(n, 1, iteratee, callback)\n}\n\n/**\n * A relative of `reduce`.  Takes an Object or Array, and iterates over each\n * element in parallel, each step potentially mutating an `accumulator` value.\n * The type of the accumulator defaults to the type of collection passed in.\n *\n * @name transform\n * @static\n * @memberOf module:Collections\n * @method\n * @category Collection\n * @param {Array|Iterable|AsyncIterable|Object} coll - A collection to iterate over.\n * @param {*} [accumulator] - The initial state of the transform.  If omitted,\n * it will default to an empty Object or Array, depending on the type of `coll`\n * @param {AsyncFunction} iteratee - A function applied to each item in the\n * collection that potentially modifies the accumulator.\n * Invoked with (accumulator, item, key, callback).\n * @param {Function} [callback] - A callback which is called after all the\n * `iteratee` functions have finished. Result is the transformed accumulator.\n * Invoked with (err, result).\n * @returns {Promise} a promise, if no callback provided\n * @example\n *\n * async.transform([1,2,3], function(acc, item, index, callback) {\n *     // pointless async:\n *     process.nextTick(function() {\n *         acc[index] = item * 2\n *         callback(null)\n *     });\n * }, function(err, result) {\n *     // result is now equal to [2, 4, 6]\n * });\n *\n * @example\n *\n * async.transform({a: 1, b: 2, c: 3}, function (obj, val, key, callback) {\n *     setImmediate(function () {\n *         obj[key] = val * 2;\n *         callback();\n *     })\n * }, function (err, result) {\n *     // result is equal to {a: 2, b: 4, c: 6}\n * })\n */\nfunction transform (coll, accumulator, iteratee, callback) {\n    if (arguments.length <= 3 && typeof accumulator === 'function') {\n        callback = iteratee;\n        iteratee = accumulator;\n        accumulator = Array.isArray(coll) ? [] : {};\n    }\n    callback = once(callback || promiseCallback());\n    var _iteratee = wrapAsync(iteratee);\n\n    eachOf$1(coll, (v, k, cb) => {\n        _iteratee(accumulator, v, k, cb);\n    }, err => callback(err, accumulator));\n    return callback[PROMISE_SYMBOL]\n}\n\n/**\n * It runs each task in series but stops whenever any of the functions were\n * successful. If one of the tasks were successful, the `callback` will be\n * passed the result of the successful task. If all tasks fail, the callback\n * will be passed the error and result (if any) of the final attempt.\n *\n * @name tryEach\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array|Iterable|AsyncIterable|Object} tasks - A collection containing functions to\n * run, each function is passed a `callback(err, result)` it must call on\n * completion with an error `err` (which can be `null`) and an optional `result`\n * value.\n * @param {Function} [callback] - An optional callback which is called when one\n * of the tasks has succeeded, or all have failed. It receives the `err` and\n * `result` arguments of the last attempt at completing the `task`. Invoked with\n * (err, results).\n * @returns {Promise} a promise, if no callback is passed\n * @example\n * async.tryEach([\n *     function getDataFromFirstWebsite(callback) {\n *         // Try getting the data from the first website\n *         callback(err, data);\n *     },\n *     function getDataFromSecondWebsite(callback) {\n *         // First website failed,\n *         // Try getting the data from the backup website\n *         callback(err, data);\n *     }\n * ],\n * // optional callback\n * function(err, results) {\n *     Now do something with the data.\n * });\n *\n */\nfunction tryEach(tasks, callback) {\n    var error = null;\n    var result;\n    return eachSeries$1(tasks, (task, taskCb) => {\n        wrapAsync(task)((err, ...args) => {\n            if (err === false) return taskCb(err);\n\n            if (args.length < 2) {\n                [result] = args;\n            } else {\n                result = args;\n            }\n            error = err;\n            taskCb(err ? null : {});\n        });\n    }, () => callback(error, result));\n}\n\nvar tryEach$1 = awaitify(tryEach);\n\n/**\n * Undoes a [memoize]{@link module:Utils.memoize}d function, reverting it to the original,\n * unmemoized form. Handy for testing.\n *\n * @name unmemoize\n * @static\n * @memberOf module:Utils\n * @method\n * @see [async.memoize]{@link module:Utils.memoize}\n * @category Util\n * @param {AsyncFunction} fn - the memoized function\n * @returns {AsyncFunction} a function that calls the original unmemoized function\n */\nfunction unmemoize(fn) {\n    return (...args) => {\n        return (fn.unmemoized || fn)(...args);\n    };\n}\n\n/**\n * Repeatedly call `iteratee`, while `test` returns `true`. Calls `callback` when\n * stopped, or an error occurs.\n *\n * @name whilst\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {AsyncFunction} test - asynchronous truth test to perform before each\n * execution of `iteratee`. Invoked with ().\n * @param {AsyncFunction} iteratee - An async function which is called each time\n * `test` passes. Invoked with (callback).\n * @param {Function} [callback] - A callback which is called after the test\n * function has failed and repeated execution of `iteratee` has stopped. `callback`\n * will be passed an error and any arguments passed to the final `iteratee`'s\n * callback. Invoked with (err, [results]);\n * @returns {Promise} a promise, if no callback is passed\n * @example\n *\n * var count = 0;\n * async.whilst(\n *     function test(cb) { cb(null, count < 5;) },\n *     function iter(callback) {\n *         count++;\n *         setTimeout(function() {\n *             callback(null, count);\n *         }, 1000);\n *     },\n *     function (err, n) {\n *         // 5 seconds have passed, n = 5\n *     }\n * );\n */\nfunction whilst(test, iteratee, callback) {\n    callback = onlyOnce(callback);\n    var _fn = wrapAsync(iteratee);\n    var _test = wrapAsync(test);\n    var results = [];\n\n    function next(err, ...rest) {\n        if (err) return callback(err);\n        results = rest;\n        if (err === false) return;\n        _test(check);\n    }\n\n    function check(err, truth) {\n        if (err) return callback(err);\n        if (err === false) return;\n        if (!truth) return callback(null, ...results);\n        _fn(next);\n    }\n\n    return _test(check);\n}\nvar whilst$1 = awaitify(whilst, 3);\n\n/**\n * Repeatedly call `iteratee` until `test` returns `true`. Calls `callback` when\n * stopped, or an error occurs. `callback` will be passed an error and any\n * arguments passed to the final `iteratee`'s callback.\n *\n * The inverse of [whilst]{@link module:ControlFlow.whilst}.\n *\n * @name until\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @see [async.whilst]{@link module:ControlFlow.whilst}\n * @category Control Flow\n * @param {AsyncFunction} test - asynchronous truth test to perform before each\n * execution of `iteratee`. Invoked with (callback).\n * @param {AsyncFunction} iteratee - An async function which is called each time\n * `test` fails. Invoked with (callback).\n * @param {Function} [callback] - A callback which is called after the test\n * function has passed and repeated execution of `iteratee` has stopped. `callback`\n * will be passed an error and any arguments passed to the final `iteratee`'s\n * callback. Invoked with (err, [results]);\n * @returns {Promise} a promise, if a callback is not passed\n *\n * @example\n * const results = []\n * async.until(function test(page, cb) {\n *     cb(null, page.next == null)\n * }, function iter(next) {\n *     fetchPage(url, (err, body) => {\n *         if (err) return next(err)\n *         results = results.concat(body.objects)\n *         next(err, body)\n *     })\n * }, function done (err) {\n *     // all pages have been fetched\n * })\n */\nfunction until(test, iteratee, callback) {\n    const _test = wrapAsync(test);\n    return whilst$1((cb) => _test((err, truth) => cb (err, !truth)), iteratee, callback);\n}\n\n/**\n * Runs the `tasks` array of functions in series, each passing their results to\n * the next in the array. However, if any of the `tasks` pass an error to their\n * own callback, the next function is not executed, and the main `callback` is\n * immediately called with the error.\n *\n * @name waterfall\n * @static\n * @memberOf module:ControlFlow\n * @method\n * @category Control Flow\n * @param {Array} tasks - An array of [async functions]{@link AsyncFunction}\n * to run.\n * Each function should complete with any number of `result` values.\n * The `result` values will be passed as arguments, in order, to the next task.\n * @param {Function} [callback] - An optional callback to run once all the\n * functions have completed. This will be passed the results of the last task's\n * callback. Invoked with (err, [results]).\n * @returns undefined\n * @example\n *\n * async.waterfall([\n *     function(callback) {\n *         callback(null, 'one', 'two');\n *     },\n *     function(arg1, arg2, callback) {\n *         // arg1 now equals 'one' and arg2 now equals 'two'\n *         callback(null, 'three');\n *     },\n *     function(arg1, callback) {\n *         // arg1 now equals 'three'\n *         callback(null, 'done');\n *     }\n * ], function (err, result) {\n *     // result now equals 'done'\n * });\n *\n * // Or, with named functions:\n * async.waterfall([\n *     myFirstFunction,\n *     mySecondFunction,\n *     myLastFunction,\n * ], function (err, result) {\n *     // result now equals 'done'\n * });\n * function myFirstFunction(callback) {\n *     callback(null, 'one', 'two');\n * }\n * function mySecondFunction(arg1, arg2, callback) {\n *     // arg1 now equals 'one' and arg2 now equals 'two'\n *     callback(null, 'three');\n * }\n * function myLastFunction(arg1, callback) {\n *     // arg1 now equals 'three'\n *     callback(null, 'done');\n * }\n */\nfunction waterfall (tasks, callback) {\n    callback = once(callback);\n    if (!Array.isArray(tasks)) return callback(new Error('First argument to waterfall must be an array of functions'));\n    if (!tasks.length) return callback();\n    var taskIndex = 0;\n\n    function nextTask(args) {\n        var task = wrapAsync(tasks[taskIndex++]);\n        task(...args, onlyOnce(next));\n    }\n\n    function next(err, ...args) {\n        if (err === false) return\n        if (err || taskIndex === tasks.length) {\n            return callback(err, ...args);\n        }\n        nextTask(args);\n    }\n\n    nextTask([]);\n}\n\nvar waterfall$1 = awaitify(waterfall);\n\n/**\n * An \"async function\" in the context of Async is an asynchronous function with\n * a variable number of parameters, with the final parameter being a callback.\n * (`function (arg1, arg2, ..., callback) {}`)\n * The final callback is of the form `callback(err, results...)`, which must be\n * called once the function is completed.  The callback should be called with a\n * Error as its first argument to signal that an error occurred.\n * Otherwise, if no error occurred, it should be called with `null` as the first\n * argument, and any additional `result` arguments that may apply, to signal\n * successful completion.\n * The callback must be called exactly once, ideally on a later tick of the\n * JavaScript event loop.\n *\n * This type of function is also referred to as a \"Node-style async function\",\n * or a \"continuation passing-style function\" (CPS). Most of the methods of this\n * library are themselves CPS/Node-style async functions, or functions that\n * return CPS/Node-style async functions.\n *\n * Wherever we accept a Node-style async function, we also directly accept an\n * [ES2017 `async` function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function}.\n * In this case, the `async` function will not be passed a final callback\n * argument, and any thrown error will be used as the `err` argument of the\n * implicit callback, and the return value will be used as the `result` value.\n * (i.e. a `rejected` of the returned Promise becomes the `err` callback\n * argument, and a `resolved` value becomes the `result`.)\n *\n * Note, due to JavaScript limitations, we can only detect native `async`\n * functions and not transpilied implementations.\n * Your environment must have `async`/`await` support for this to work.\n * (e.g. Node > v7.6, or a recent version of a modern browser).\n * If you are using `async` functions through a transpiler (e.g. Babel), you\n * must still wrap the function with [asyncify]{@link module:Utils.asyncify},\n * because the `async function` will be compiled to an ordinary function that\n * returns a promise.\n *\n * @typedef {Function} AsyncFunction\n * @static\n */\n\nvar index = {\n    apply,\n    applyEach: applyEach$1,\n    applyEachSeries,\n    asyncify,\n    auto,\n    autoInject,\n    cargo,\n    cargoQueue: cargo$1,\n    compose,\n    concat: concat$1,\n    concatLimit: concatLimit$1,\n    concatSeries: concatSeries$1,\n    constant,\n    detect: detect$1,\n    detectLimit: detectLimit$1,\n    detectSeries: detectSeries$1,\n    dir,\n    doUntil,\n    doWhilst: doWhilst$1,\n    each,\n    eachLimit: eachLimit$2,\n    eachOf: eachOf$1,\n    eachOfLimit: eachOfLimit$2,\n    eachOfSeries: eachOfSeries$1,\n    eachSeries: eachSeries$1,\n    ensureAsync,\n    every: every$1,\n    everyLimit: everyLimit$1,\n    everySeries: everySeries$1,\n    filter: filter$1,\n    filterLimit: filterLimit$1,\n    filterSeries: filterSeries$1,\n    forever: forever$1,\n    groupBy,\n    groupByLimit: groupByLimit$1,\n    groupBySeries,\n    log,\n    map: map$1,\n    mapLimit: mapLimit$1,\n    mapSeries: mapSeries$1,\n    mapValues,\n    mapValuesLimit: mapValuesLimit$1,\n    mapValuesSeries,\n    memoize,\n    nextTick,\n    parallel,\n    parallelLimit,\n    priorityQueue,\n    queue: queue$1,\n    race: race$1,\n    reduce: reduce$1,\n    reduceRight,\n    reflect,\n    reflectAll,\n    reject: reject$2,\n    rejectLimit: rejectLimit$1,\n    rejectSeries: rejectSeries$1,\n    retry,\n    retryable,\n    seq,\n    series,\n    setImmediate: setImmediate$1,\n    some: some$1,\n    someLimit: someLimit$1,\n    someSeries: someSeries$1,\n    sortBy: sortBy$1,\n    timeout,\n    times,\n    timesLimit,\n    timesSeries,\n    transform,\n    tryEach: tryEach$1,\n    unmemoize,\n    until,\n    waterfall: waterfall$1,\n    whilst: whilst$1,\n\n    // aliases\n    all: every$1,\n    allLimit: everyLimit$1,\n    allSeries: everySeries$1,\n    any: some$1,\n    anyLimit: someLimit$1,\n    anySeries: someSeries$1,\n    find: detect$1,\n    findLimit: detectLimit$1,\n    findSeries: detectSeries$1,\n    flatMap: concat$1,\n    flatMapLimit: concatLimit$1,\n    flatMapSeries: concatSeries$1,\n    forEach: each,\n    forEachSeries: eachSeries$1,\n    forEachLimit: eachLimit$2,\n    forEachOf: eachOf$1,\n    forEachOfSeries: eachOfSeries$1,\n    forEachOfLimit: eachOfLimit$2,\n    inject: reduce$1,\n    foldl: reduce$1,\n    foldr: reduceRight,\n    select: filter$1,\n    selectLimit: filterLimit$1,\n    selectSeries: filterSeries$1,\n    wrapSync: asyncify,\n    during: whilst$1,\n    doDuring: doWhilst$1\n};\n\nexport default index;\nexport { apply, applyEach$1 as applyEach, applyEachSeries, asyncify, auto, autoInject, cargo, cargo$1 as cargoQueue, compose, concat$1 as concat, concatLimit$1 as concatLimit, concatSeries$1 as concatSeries, constant, detect$1 as detect, detectLimit$1 as detectLimit, detectSeries$1 as detectSeries, dir, doUntil, doWhilst$1 as doWhilst, each, eachLimit$2 as eachLimit, eachOf$1 as eachOf, eachOfLimit$2 as eachOfLimit, eachOfSeries$1 as eachOfSeries, eachSeries$1 as eachSeries, ensureAsync, every$1 as every, everyLimit$1 as everyLimit, everySeries$1 as everySeries, filter$1 as filter, filterLimit$1 as filterLimit, filterSeries$1 as filterSeries, forever$1 as forever, groupBy, groupByLimit$1 as groupByLimit, groupBySeries, log, map$1 as map, mapLimit$1 as mapLimit, mapSeries$1 as mapSeries, mapValues, mapValuesLimit$1 as mapValuesLimit, mapValuesSeries, memoize, nextTick, parallel, parallelLimit, priorityQueue, queue$1 as queue, race$1 as race, reduce$1 as reduce, reduceRight, reflect, reflectAll, reject$2 as reject, rejectLimit$1 as rejectLimit, rejectSeries$1 as rejectSeries, retry, retryable, seq, series, setImmediate$1 as setImmediate, some$1 as some, someLimit$1 as someLimit, someSeries$1 as someSeries, sortBy$1 as sortBy, timeout, times, timesLimit, timesSeries, transform, tryEach$1 as tryEach, unmemoize, until, waterfall$1 as waterfall, whilst$1 as whilst, every$1 as all, everyLimit$1 as allLimit, everySeries$1 as allSeries, some$1 as any, someLimit$1 as anyLimit, someSeries$1 as anySeries, detect$1 as find, detectLimit$1 as findLimit, detectSeries$1 as findSeries, concat$1 as flatMap, concatLimit$1 as flatMapLimit, concatSeries$1 as flatMapSeries, each as forEach, eachSeries$1 as forEachSeries, eachLimit$2 as forEachLimit, eachOf$1 as forEachOf, eachOfSeries$1 as forEachOfSeries, eachOfLimit$2 as forEachOfLimit, reduce$1 as inject, reduce$1 as foldl, reduceRight as foldr, filter$1 as select, filterLimit$1 as selectLimit, filterSeries$1 as selectSeries, asyncify as wrapSync, whilst$1 as during, doWhilst$1 as doDuring };\n","/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","\n/**\n * Module dependencies.\n */\n\nvar debug = require('debug')('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar binary = require('./binary');\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'ACK',\n  'ERROR',\n  'BINARY_EVENT',\n  'BINARY_ACK'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\nvar ERROR_PACKET = exports.ERROR + '\"encode error\"';\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    encodeAsBinary(obj, callback);\n  } else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n\n  // first is type\n  var str = '' + obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    str += obj.attachments + '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' !== obj.nsp) {\n    str += obj.nsp + ',';\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    var payload = tryStringify(obj.data);\n    if (payload !== false) {\n      str += payload;\n    } else {\n      return ERROR_PACKET;\n    }\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\nfunction tryStringify(str) {\n  try {\n    return JSON.stringify(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an encoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if (typeof obj === 'string') {\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT === packet.type || exports.BINARY_ACK === packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments === 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  } else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  } else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var i = 0;\n  // look up type\n  var p = {\n    type: Number(str.charAt(0))\n  };\n\n  if (null == exports.types[p.type]) {\n    return error('unknown packet type ' + p.type);\n  }\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT === p.type || exports.BINARY_ACK === p.type) {\n    var buf = '';\n    while (str.charAt(++i) !== '-') {\n      buf += str.charAt(i);\n      if (i == str.length) break;\n    }\n    if (buf != Number(buf) || str.charAt(i) !== '-') {\n      throw new Error('Illegal attachments');\n    }\n    p.attachments = Number(buf);\n  }\n\n  // look up namespace (if any)\n  if ('/' === str.charAt(i + 1)) {\n    p.nsp = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' === c) break;\n      p.nsp += c;\n      if (i === str.length) break;\n    }\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' !== next && Number(next) == next) {\n    p.id = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      p.id += str.charAt(i);\n      if (i === str.length) break;\n    }\n    p.id = Number(p.id);\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    var payload = tryParse(str.substr(i));\n    var isPayloadValid = payload !== false && (p.type === exports.ERROR || isArray(payload));\n    if (isPayloadValid) {\n      p.data = payload;\n    } else {\n      return error('invalid payload');\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length === this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(msg) {\n  return {\n    type: exports.ERROR,\n    data: 'parser error: ' + msg\n  };\n}\n","// browser shim for xmlhttprequest module\n\nvar hasCORS = require('has-cors');\n\nmodule.exports = function (opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' !== typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new self[['Active'].concat('Object').join('X')]('Microsoft.XMLHTTP');\n    } catch (e) { }\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar parser = require('engine.io-parser');\nvar Emitter = require('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n  this.forceNode = opts.forceNode;\n\n  // results of ReactNative environment detection\n  this.isReactNative = opts.isReactNative;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n  this.localAddress = opts.localAddress;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' === this.readyState || '' === this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function (packets) {\n  if ('open' === this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(){\n  \"use strict\";\n\n  var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n  // Use a lookup table to find the index.\n  var lookup = new Uint8Array(256);\n  for (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n  }\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = lookup[base64.charCodeAt(i)];\n      encoded2 = lookup[base64.charCodeAt(i+1)];\n      encoded3 = lookup[base64.charCodeAt(i+2)];\n      encoded4 = lookup[base64.charCodeAt(i+3)];\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})();\n","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nexports.__esModule = true;\nvar Semaphore_1 = require(\"./Semaphore\");\nexports[\"default\"] = Semaphore_1[\"default\"];\n__export(require(\"./Lock\"));\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar isArray = require('isarray');\n/*</replacement>*/\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\n\nvar EElistenerCount = function (emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\nvar OurUint8Array = global.Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*</replacement>*/\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug = void 0;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function () {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/BufferList');\nvar destroyImpl = require('./internal/streams/destroy');\nvar StringDecoder;\n\nutil.inherits(Readable, Stream);\n\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\n\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\n\nfunction ReadableState(options, stream) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  var isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  var hwm = options.highWaterMark;\n  var readableHwm = options.readableHighWaterMark;\n  var defaultHwm = this.objectMode ? 16 : 16 * 1024;\n\n  if (hwm || hwm === 0) this.highWaterMark = hwm;else if (isDuplex && (readableHwm || readableHwm === 0)) this.highWaterMark = readableHwm;else this.highWaterMark = defaultHwm;\n\n  // cast to ints.\n  this.highWaterMark = Math.floor(this.highWaterMark);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\n\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  this._readableState = new ReadableState(options, this);\n\n  // legacy\n  this.readable = true;\n\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n\n  Stream.call(this);\n}\n\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  get: function () {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\n\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  this.push(null);\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\n\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      stream.emit('error', er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n\n      if (addToFront) {\n        if (state.endEmitted) stream.emit('error', new Error('stream.unshift() after end event'));else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        stream.emit('error', new Error('stream.push() after EOF'));\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n    }\n  }\n\n  return needMoreData(state);\n}\n\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    stream.emit('data', chunk);\n    stream.read(0);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\n\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  return er;\n}\n\n// if it's past the high water mark, we can push in some more.\n// Also, if we have no data yet, we can stand some\n// more bytes.  This is to work around cases where hwm=0,\n// such as the repl.  Also, if the push() triggered a\n// readable event, and the user called read(largeNumber) such that\n// needReadable was set, then we ought to push more, so that another\n// 'readable' event will be triggered.\nfunction needMoreData(state) {\n  return !state.ended && (state.needReadable || state.length < state.highWaterMark || state.length === 0);\n}\n\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  this._readableState.decoder = new StringDecoder(enc);\n  this._readableState.encoding = enc;\n  return this;\n};\n\n// Don't raise the hwm > 8MB\nvar MAX_HWM = 0x800000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && (state.length >= state.highWaterMark || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n\n  if (ret === null) {\n    state.needReadable = true;\n    n = 0;\n  } else {\n    state.length -= n;\n  }\n\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n\n  if (ret !== null) this.emit('data', ret);\n\n  return ret;\n};\n\nfunction onEofChunk(stream, state) {\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n\n  // emit 'readable' now to make sure it gets picked up.\n  emitReadable(stream);\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    if (state.sync) pna.nextTick(emitReadable_, stream);else emitReadable_(stream);\n  }\n}\n\nfunction emitReadable_(stream) {\n  debug('emit readable');\n  stream.emit('readable');\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    pna.nextTick(maybeReadMore_, stream, state);\n  }\n}\n\nfunction maybeReadMore_(stream, state) {\n  var len = state.length;\n  while (!state.reading && !state.flowing && !state.ended && state.length < state.highWaterMark) {\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;else len = state.length;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  this.emit('error', new Error('_read() is not implemented'));\n};\n\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) pna.nextTick(endFn);else src.once('end', endFn);\n\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n\n  // If the user pushes more data while we're writing to dest then we'll end up\n  // in ondata again. However, we only want to increase awaitDrain once because\n  // dest will only emit one 'drain' event for the multiple writes.\n  // => Introduce a guard on increasing awaitDrain.\n  var increasedAwaitDrain = false;\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    increasedAwaitDrain = false;\n    var ret = dest.write(chunk);\n    if (false === ret && !increasedAwaitDrain) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', src._readableState.awaitDrain);\n        src._readableState.awaitDrain++;\n        increasedAwaitDrain = true;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) dest.emit('error', er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n\n  return dest;\n};\n\nfunction pipeOnDrain(src) {\n  return function () {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\n\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = { hasUnpiped: false };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n\n    for (var i = 0; i < len; i++) {\n      dests[i].emit('unpipe', this, unpipeInfo);\n    }return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n\n  dest.emit('unpipe', this, unpipeInfo);\n\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n\n  if (ev === 'data') {\n    // Start flowing on next tick if stream isn't explicitly paused\n    if (this._readableState.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    var state = this._readableState;\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.emittedReadable = false;\n      if (!state.reading) {\n        pna.nextTick(nReadingNextTick, this);\n      } else if (state.length) {\n        emitReadable(this);\n      }\n    }\n  }\n\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\n\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    state.flowing = true;\n    resume(this, state);\n  }\n  return this;\n};\n\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    pna.nextTick(resume_, stream, state);\n  }\n}\n\nfunction resume_(stream, state) {\n  if (!state.reading) {\n    debug('resume read 0');\n    stream.read(0);\n  }\n\n  state.resumeScheduled = false;\n  state.awaitDrain = 0;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\n\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (false !== this._readableState.flowing) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  return this;\n};\n\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null) {}\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n\n  var state = this._readableState;\n  var paused = false;\n\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n\n    _this.push(null);\n  });\n\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function (method) {\n        return function () {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n\n  return this;\n};\n\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._readableState.highWaterMark;\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.head.data;else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = fromListPartial(n, state.buffer, state.decoder);\n  }\n\n  return ret;\n}\n\n// Extracts only enough buffered data to satisfy the amount requested.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromListPartial(n, list, hasStrings) {\n  var ret;\n  if (n < list.head.data.length) {\n    // slice is the same for buffers and strings\n    ret = list.head.data.slice(0, n);\n    list.head.data = list.head.data.slice(n);\n  } else if (n === list.head.data.length) {\n    // first chunk is a perfect match\n    ret = list.shift();\n  } else {\n    // result spans more than one buffer\n    ret = hasStrings ? copyFromBufferString(n, list) : copyFromBuffer(n, list);\n  }\n  return ret;\n}\n\n// Copies a specified amount of characters from the list of buffered data\n// chunks.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction copyFromBufferString(n, list) {\n  var p = list.head;\n  var c = 1;\n  var ret = p.data;\n  n -= ret.length;\n  while (p = p.next) {\n    var str = p.data;\n    var nb = n > str.length ? str.length : n;\n    if (nb === str.length) ret += str;else ret += str.slice(0, n);\n    n -= nb;\n    if (n === 0) {\n      if (nb === str.length) {\n        ++c;\n        if (p.next) list.head = p.next;else list.head = list.tail = null;\n      } else {\n        list.head = p;\n        p.data = str.slice(nb);\n      }\n      break;\n    }\n    ++c;\n  }\n  list.length -= c;\n  return ret;\n}\n\n// Copies a specified amount of bytes from the list of buffered data chunks.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction copyFromBuffer(n, list) {\n  var ret = Buffer.allocUnsafe(n);\n  var p = list.head;\n  var c = 1;\n  p.data.copy(ret);\n  n -= p.data.length;\n  while (p = p.next) {\n    var buf = p.data;\n    var nb = n > buf.length ? buf.length : n;\n    buf.copy(ret, ret.length - n, 0, nb);\n    n -= nb;\n    if (n === 0) {\n      if (nb === buf.length) {\n        ++c;\n        if (p.next) list.head = p.next;else list.head = list.tail = null;\n      } else {\n        list.head = p;\n        p.data = buf.slice(nb);\n      }\n      break;\n    }\n    ++c;\n  }\n  list.length -= c;\n  return ret;\n}\n\nfunction endReadable(stream) {\n  var state = stream._readableState;\n\n  // If we get here before consuming all the bytes, then that is a\n  // bug in node.  Should never happen.\n  if (state.length > 0) throw new Error('\"endReadable()\" called on non-empty stream');\n\n  if (!state.endEmitted) {\n    state.ended = true;\n    pna.nextTick(endReadableNT, state, stream);\n  }\n}\n\nfunction endReadableNT(state, stream) {\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n  }\n}\n\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","module.exports = require('events').EventEmitter;\n","'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err && (!this._writableState || !this._writableState.errorEmitted)) {\n      pna.nextTick(emitErrorNT, this, err);\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      pna.nextTick(emitErrorNT, _this, err);\n      if (_this._writableState) {\n        _this._writableState.errorEmitted = true;\n      }\n    } else if (cb) {\n      cb(err);\n    }\n  });\n\n  return this;\n}\n\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\n\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\n\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\n/*<replacement>*/\n\nvar pna = require('process-nextick-args');\n/*</replacement>*/\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar asyncWrite = !process.browser && ['v0.10', 'v0.9.'].indexOf(process.version.slice(0, 5)) > -1 ? setImmediate : pna.nextTick;\n/*</replacement>*/\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\nvar OurUint8Array = global.Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*</replacement>*/\n\nvar destroyImpl = require('./internal/streams/destroy');\n\nutil.inherits(Writable, Stream);\n\nfunction nop() {}\n\nfunction WritableState(options, stream) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  var isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  var hwm = options.highWaterMark;\n  var writableHwm = options.writableHighWaterMark;\n  var defaultHwm = this.objectMode ? 16 : 16 * 1024;\n\n  if (hwm || hwm === 0) this.highWaterMark = hwm;else if (isDuplex && (writableHwm || writableHwm === 0)) this.highWaterMark = writableHwm;else this.highWaterMark = defaultHwm;\n\n  // cast to ints.\n  this.highWaterMark = Math.floor(this.highWaterMark);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\n\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function () {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function (object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function (object) {\n    return object instanceof this;\n  };\n}\n\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n  if (!realHasInstance.call(Writable, this) && !(this instanceof Duplex)) {\n    return new Writable(options);\n  }\n\n  this._writableState = new WritableState(options, this);\n\n  // legacy.\n  this.writable = true;\n\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n\n    if (typeof options.writev === 'function') this._writev = options.writev;\n\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  this.emit('error', new Error('Cannot pipe, not readable'));\n};\n\nfunction writeAfterEnd(stream, cb) {\n  var er = new Error('write after end');\n  // TODO: defer error events consistently everywhere, not just the cb\n  stream.emit('error', er);\n  pna.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var valid = true;\n  var er = false;\n\n  if (chunk === null) {\n    er = new TypeError('May not write null values to stream');\n  } else if (typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new TypeError('Invalid non-string/buffer chunk');\n  }\n  if (er) {\n    stream.emit('error', er);\n    pna.nextTick(cb, er);\n    valid = false;\n  }\n  return valid;\n}\n\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n\n  if (typeof cb !== 'function') cb = nop;\n\n  if (state.ended) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n\n  return ret;\n};\n\nWritable.prototype.cork = function () {\n  var state = this._writableState;\n\n  state.corked++;\n};\n\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n\n  if (state.corked) {\n    state.corked--;\n\n    if (!state.writing && !state.corked && !state.finished && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\n\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new TypeError('Unknown encoding: ' + encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\n\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\n\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function () {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n\n  state.length += len;\n\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n\n  return ret;\n}\n\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\n\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    pna.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    pna.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    stream.emit('error', er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    stream.emit('error', er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\n\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\n\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n\n  onwriteStateUpdate(state);\n\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state);\n\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n\n    if (sync) {\n      /*<replacement>*/\n      asyncWrite(afterWrite, stream, state, finished, cb);\n      /*</replacement>*/\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\n\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\n\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new Error('_write() is not implemented'));\n};\n\nWritable.prototype._writev = null;\n\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending && !state.finished) endWritable(this, state, cb);\n};\n\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      stream.emit('error', err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function') {\n      state.pendingcb++;\n      state.finalCalled = true;\n      pna.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\n\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n    }\n  }\n  return need;\n}\n\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) pna.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\n\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n  if (state.corkedRequestsFree) {\n    state.corkedRequestsFree.next = corkReq;\n  } else {\n    state.corkedRequestsFree = corkReq;\n  }\n}\n\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  get: function () {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function (value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\n\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  this.end();\n  cb(err);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\n/*</replacement>*/\n\nvar isEncoding = Buffer.isEncoding || function (encoding) {\n  encoding = '' + encoding;\n  switch (encoding && encoding.toLowerCase()) {\n    case 'hex':case 'utf8':case 'utf-8':case 'ascii':case 'binary':case 'base64':case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':case 'raw':\n      return true;\n    default:\n      return false;\n  }\n};\n\nfunction _normalizeEncoding(enc) {\n  if (!enc) return 'utf8';\n  var retried;\n  while (true) {\n    switch (enc) {\n      case 'utf8':\n      case 'utf-8':\n        return 'utf8';\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return 'utf16le';\n      case 'latin1':\n      case 'binary':\n        return 'latin1';\n      case 'base64':\n      case 'ascii':\n      case 'hex':\n        return enc;\n      default:\n        if (retried) return; // undefined\n        enc = ('' + enc).toLowerCase();\n        retried = true;\n    }\n  }\n};\n\n// Do not cache `Buffer.isEncoding` when checking encoding names as some\n// modules monkey-patch it to support additional encodings\nfunction normalizeEncoding(enc) {\n  var nenc = _normalizeEncoding(enc);\n  if (typeof nenc !== 'string' && (Buffer.isEncoding === isEncoding || !isEncoding(enc))) throw new Error('Unknown encoding: ' + enc);\n  return nenc || enc;\n}\n\n// StringDecoder provides an interface for efficiently splitting a series of\n// buffers into a series of JS strings without breaking apart multi-byte\n// characters.\nexports.StringDecoder = StringDecoder;\nfunction StringDecoder(encoding) {\n  this.encoding = normalizeEncoding(encoding);\n  var nb;\n  switch (this.encoding) {\n    case 'utf16le':\n      this.text = utf16Text;\n      this.end = utf16End;\n      nb = 4;\n      break;\n    case 'utf8':\n      this.fillLast = utf8FillLast;\n      nb = 4;\n      break;\n    case 'base64':\n      this.text = base64Text;\n      this.end = base64End;\n      nb = 3;\n      break;\n    default:\n      this.write = simpleWrite;\n      this.end = simpleEnd;\n      return;\n  }\n  this.lastNeed = 0;\n  this.lastTotal = 0;\n  this.lastChar = Buffer.allocUnsafe(nb);\n}\n\nStringDecoder.prototype.write = function (buf) {\n  if (buf.length === 0) return '';\n  var r;\n  var i;\n  if (this.lastNeed) {\n    r = this.fillLast(buf);\n    if (r === undefined) return '';\n    i = this.lastNeed;\n    this.lastNeed = 0;\n  } else {\n    i = 0;\n  }\n  if (i < buf.length) return r ? r + this.text(buf, i) : this.text(buf, i);\n  return r || '';\n};\n\nStringDecoder.prototype.end = utf8End;\n\n// Returns only complete characters in a Buffer\nStringDecoder.prototype.text = utf8Text;\n\n// Attempts to complete a partial non-UTF-8 character using bytes from a Buffer\nStringDecoder.prototype.fillLast = function (buf) {\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, buf.length);\n  this.lastNeed -= buf.length;\n};\n\n// Checks the type of a UTF-8 byte, whether it's ASCII, a leading byte, or a\n// continuation byte. If an invalid byte is detected, -2 is returned.\nfunction utf8CheckByte(byte) {\n  if (byte <= 0x7F) return 0;else if (byte >> 5 === 0x06) return 2;else if (byte >> 4 === 0x0E) return 3;else if (byte >> 3 === 0x1E) return 4;\n  return byte >> 6 === 0x02 ? -1 : -2;\n}\n\n// Checks at most 3 bytes at the end of a Buffer in order to detect an\n// incomplete multi-byte UTF-8 character. The total number of bytes (2, 3, or 4)\n// needed to complete the UTF-8 character (if applicable) are returned.\nfunction utf8CheckIncomplete(self, buf, i) {\n  var j = buf.length - 1;\n  if (j < i) return 0;\n  var nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 1;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 2;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) {\n      if (nb === 2) nb = 0;else self.lastNeed = nb - 3;\n    }\n    return nb;\n  }\n  return 0;\n}\n\n// Validates as many continuation bytes for a multi-byte UTF-8 character as\n// needed or are available. If we see a non-continuation byte where we expect\n// one, we \"replace\" the validated continuation bytes we've seen so far with\n// a single UTF-8 replacement character ('\\ufffd'), to match v8's UTF-8 decoding\n// behavior. The continuation byte check is included three times in the case\n// where all of the continuation bytes for a character exist in the same buffer.\n// It is also done this way as a slight performance increase instead of using a\n// loop.\nfunction utf8CheckExtraBytes(self, buf, p) {\n  if ((buf[0] & 0xC0) !== 0x80) {\n    self.lastNeed = 0;\n    return '\\ufffd';\n  }\n  if (self.lastNeed > 1 && buf.length > 1) {\n    if ((buf[1] & 0xC0) !== 0x80) {\n      self.lastNeed = 1;\n      return '\\ufffd';\n    }\n    if (self.lastNeed > 2 && buf.length > 2) {\n      if ((buf[2] & 0xC0) !== 0x80) {\n        self.lastNeed = 2;\n        return '\\ufffd';\n      }\n    }\n  }\n}\n\n// Attempts to complete a multi-byte UTF-8 character using bytes from a Buffer.\nfunction utf8FillLast(buf) {\n  var p = this.lastTotal - this.lastNeed;\n  var r = utf8CheckExtraBytes(this, buf, p);\n  if (r !== undefined) return r;\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, p, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, p, 0, buf.length);\n  this.lastNeed -= buf.length;\n}\n\n// Returns all complete UTF-8 characters in a Buffer. If the Buffer ended on a\n// partial character, the character's bytes are buffered until the required\n// number of bytes are available.\nfunction utf8Text(buf, i) {\n  var total = utf8CheckIncomplete(this, buf, i);\n  if (!this.lastNeed) return buf.toString('utf8', i);\n  this.lastTotal = total;\n  var end = buf.length - (total - this.lastNeed);\n  buf.copy(this.lastChar, 0, end);\n  return buf.toString('utf8', i, end);\n}\n\n// For UTF-8, a replacement character is added when ending on a partial\n// character.\nfunction utf8End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + '\\ufffd';\n  return r;\n}\n\n// UTF-16LE typically needs two bytes per character, but even if we have an even\n// number of bytes available, we need to check if we end on a leading/high\n// surrogate. In that case, we need to wait for the next two bytes in order to\n// decode the last character properly.\nfunction utf16Text(buf, i) {\n  if ((buf.length - i) % 2 === 0) {\n    var r = buf.toString('utf16le', i);\n    if (r) {\n      var c = r.charCodeAt(r.length - 1);\n      if (c >= 0xD800 && c <= 0xDBFF) {\n        this.lastNeed = 2;\n        this.lastTotal = 4;\n        this.lastChar[0] = buf[buf.length - 2];\n        this.lastChar[1] = buf[buf.length - 1];\n        return r.slice(0, -1);\n      }\n    }\n    return r;\n  }\n  this.lastNeed = 1;\n  this.lastTotal = 2;\n  this.lastChar[0] = buf[buf.length - 1];\n  return buf.toString('utf16le', i, buf.length - 1);\n}\n\n// For UTF-16LE we do not explicitly append special replacement characters if we\n// end on a partial character, we simply let v8 handle that.\nfunction utf16End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) {\n    var end = this.lastTotal - this.lastNeed;\n    return r + this.lastChar.toString('utf16le', 0, end);\n  }\n  return r;\n}\n\nfunction base64Text(buf, i) {\n  var n = (buf.length - i) % 3;\n  if (n === 0) return buf.toString('base64', i);\n  this.lastNeed = 3 - n;\n  this.lastTotal = 3;\n  if (n === 1) {\n    this.lastChar[0] = buf[buf.length - 1];\n  } else {\n    this.lastChar[0] = buf[buf.length - 2];\n    this.lastChar[1] = buf[buf.length - 1];\n  }\n  return buf.toString('base64', i, buf.length - n);\n}\n\nfunction base64End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + this.lastChar.toString('base64', 0, 3 - this.lastNeed);\n  return r;\n}\n\n// Pass bytes on through for single-byte encodings (e.g. ascii, latin1, hex)\nfunction simpleWrite(buf) {\n  return buf.toString(this.encoding);\n}\n\nfunction simpleEnd(buf) {\n  return buf && buf.length ? this.write(buf) : '';\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\n\nvar Duplex = require('./_stream_duplex');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(Transform, Duplex);\n\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n\n  var cb = ts.writecb;\n\n  if (!cb) {\n    return this.emit('error', new Error('write callback called multiple times'));\n  }\n\n  ts.writechunk = null;\n  ts.writecb = null;\n\n  if (data != null) // single equals check for both `null` and `undefined`\n    this.push(data);\n\n  cb(er);\n\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\n\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n\n  Duplex.call(this, options);\n\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\n\nfunction prefinish() {\n  var _this = this;\n\n  if (typeof this._flush === 'function') {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\n\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  throw new Error('_transform() is not implemented');\n};\n\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n\n  if (ts.writechunk !== null && ts.writecb && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\n\nTransform.prototype._destroy = function (err, cb) {\n  var _this2 = this;\n\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n    _this2.emit('close');\n  });\n};\n\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n\n  if (data != null) // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new Error('Calling transform done when ws.length != 0');\n\n  if (stream._transformState.transforming) throw new Error('Calling transform done when still transforming');\n\n  return stream.push(null);\n}","/**\r\n * Parses an URI\r\n *\r\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\r\n * @api private\r\n */\r\n\r\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\r\n\r\nvar parts = [\r\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\r\n];\r\n\r\nmodule.exports = function parseuri(str) {\r\n    var src = str,\r\n        b = str.indexOf('['),\r\n        e = str.indexOf(']');\r\n\r\n    if (b != -1 && e != -1) {\r\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\r\n    }\r\n\r\n    var m = re.exec(str || ''),\r\n        uri = {},\r\n        i = 14;\r\n\r\n    while (i--) {\r\n        uri[parts[i]] = m[i] || '';\r\n    }\r\n\r\n    if (b != -1 && e != -1) {\r\n        uri.source = src;\r\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\r\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\r\n        uri.ipv6uri = true;\r\n    }\r\n\r\n    return uri;\r\n};\r\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","\nmodule.exports = isBuf;\n\nvar withNativeBuffer = typeof Buffer === 'function' && typeof Buffer.isBuffer === 'function';\nvar withNativeArrayBuffer = typeof ArrayBuffer === 'function';\n\nvar isView = function (obj) {\n  return typeof ArrayBuffer.isView === 'function' ? ArrayBuffer.isView(obj) : (obj.buffer instanceof ArrayBuffer);\n};\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (withNativeBuffer && Buffer.isBuffer(obj)) ||\n          (withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj)));\n}\n","\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n","/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar XHR = require('./polling-xhr');\nvar JSONP = require('./polling-jsonp');\nvar websocket = require('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling (opts) {\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname !== location.hostname || port !== opts.port;\n    xs = opts.secure !== isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parseqs = require('parseqs');\nvar parser = require('engine.io-parser');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function () {\n  var XMLHttpRequest = require('xmlhttprequest-ssl');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function () {\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function (onPause) {\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause () {\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function () {\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function () {\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function () {\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function (data) {\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function (packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' === self.readyState) {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' === packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' !== this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' === this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function () {\n  var self = this;\n\n  function close () {\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' === this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n  var callbackfn = function () {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  parser.encodePayload(packets, this.supportsBinary, function (data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' === schema && Number(this.port) !== 443) ||\n     ('http' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n","/* global Blob File */\n\n/*\n * Module requirements.\n */\n\nvar isArray = require('isarray');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' ||\n                        typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' ||\n                        typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Supports Buffer, ArrayBuffer, Blob and File.\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary (obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  if (isArray(obj)) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (hasBinary(obj[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if ((typeof Buffer === 'function' && Buffer.isBuffer && Buffer.isBuffer(obj)) ||\n    (typeof ArrayBuffer === 'function' && obj instanceof ArrayBuffer) ||\n    (withNativeBlob && obj instanceof Blob) ||\n    (withNativeFile && obj instanceof File)\n  ) {\n    return true;\n  }\n\n  // see: https://github.com/Automattic/has-binary/pull/4\n  if (obj.toJSON && typeof obj.toJSON === 'function' && arguments.length === 1) {\n    return hasBinary(obj.toJSON(), true);\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","'use strict';\n\nvar alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split('')\n  , length = 64\n  , map = {}\n  , seed = 0\n  , i = 0\n  , prev;\n\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nfunction encode(num) {\n  var encoded = '';\n\n  do {\n    encoded = alphabet[num % length] + encoded;\n    num = Math.floor(num / length);\n  } while (num > 0);\n\n  return encoded;\n}\n\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nfunction decode(str) {\n  var decoded = 0;\n\n  for (i = 0; i < str.length; i++) {\n    decoded = decoded * length + map[str.charAt(i)];\n  }\n\n  return decoded;\n}\n\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nfunction yeast() {\n  var now = encode(+new Date());\n\n  if (now !== prev) return seed = 0, prev = now;\n  return now +'.'+ encode(seed++);\n}\n\n//\n// Map each character to its index.\n//\nfor (; i < length; i++) map[alphabet[i]] = i;\n\n//\n// Expose the `yeast`, `encode` and `decode` functions.\n//\nyeast.encode = encode;\nyeast.decode = decode;\nmodule.exports = yeast;\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","\n/**\n * Module dependencies.\n */\n\nvar parser = require('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar toArray = require('to-array');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:socket');\nvar parseqs = require('parseqs');\nvar hasBin = require('has-binary2');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  connecting: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1,\n  ping: 1,\n  pong: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket (io, nsp, opts) {\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n  this.flags = {};\n  if (opts && opts.query) {\n    this.query = opts.query;\n  }\n  if (this.io.autoConnect) this.open();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function () {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function () {\n  if (this.connected) return this;\n\n  this.subEvents();\n  this.io.open(); // ensure open\n  if ('open' === this.io.readyState) this.onopen();\n  this.emit('connecting');\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function () {\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  packet.options = {};\n  packet.options.compress = !this.flags || false !== this.flags.compress;\n\n  // event ack callback\n  if ('function' === typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  this.flags = {};\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function (packet) {\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function () {\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' !== this.nsp) {\n    if (this.query) {\n      var query = typeof this.query === 'object' ? parseqs.encode(this.query) : this.query;\n      debug('sending connect packet with query %s', query);\n      this.packet({type: parser.CONNECT, query: query});\n    } else {\n      this.packet({type: parser.CONNECT});\n    }\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.id;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  var sameNamespace = packet.nsp === this.nsp;\n  var rootNamespaceError = packet.type === parser.ERROR && packet.nsp === '/';\n\n  if (!sameNamespace && !rootNamespaceError) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' === typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function () {\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function () {\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function () {\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} whether the emitted data contains binary\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n","\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on (obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function () {\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n","/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t;\n    return { next: verb(0), \"throw\": verb(1), \"return\": verb(2) };\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexports.__esModule = true;\n/** Class representing a semaphore\n * Semaphores are initialized with a number of permits that get aquired and released\n * over the lifecycle of the Semaphore. These permits limit the number of simultaneous\n * executions of the code that the Semaphore synchronizes. Functions can wait and stop\n * executing until a permit becomes available.\n *\n * Locks that only allow one execution of a critical section are a special case of\n * Semaphores. To construct a lock, initialize a Semaphore with a permit count of 1.\n *\n * This Semaphore class is implemented with the help of promises that get returned\n * by functions that wait for permits to become available. This makes it possible\n * to use async/await to synchronize your code.\n */\nvar Semaphore = (function () {\n    /**\n     * Creates a semaphore.\n     * @param permits  The number of permits, i.e. things being allowed to run in parallel.\n     * To create a lock that only lets one thing run at a time, set this to 1.\n     * This number can also be negative.\n     */\n    function Semaphore(permits) {\n        this.promiseResolverQueue = [];\n        this.permits = permits;\n    }\n    /**\n     * Returns the number of available permits.\n     * @returns  The number of available permits.\n     */\n    Semaphore.prototype.getPermits = function () {\n        return this.permits;\n    };\n    /**\n     * Returns a promise used to wait for a permit to become available. This method should be awaited on.\n     * @returns  A promise that gets resolved when execution is allowed to proceed.\n     */\n    Semaphore.prototype.wait = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                if (this.permits > 0) {\n                    this.permits -= 1;\n                    return [2 /*return*/, Promise.resolve(true)];\n                }\n                // If there is no permit available, we return a promise that resolves once the semaphore gets\n                // signaled enough times that permits is equal to one.\n                return [2 /*return*/, new Promise(function (resolver) { return _this.promiseResolverQueue.push(resolver); })];\n            });\n        });\n    };\n    /**\n     * Alias for {@linkcode Semaphore.wait}.\n     * @returns  A promise that gets resolved when execution is allowed to proceed.\n     */\n    Semaphore.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.wait()];\n            });\n        });\n    };\n    /**\n     * Same as {@linkcode Semaphore.wait} except the promise returned gets resolved with false if no\n     * permit becomes available in time.\n     * @param milliseconds  The time spent waiting before the wait is aborted. This is a lower bound,\n     * don't rely on it being precise.\n     * @returns  A promise that gets resolved with true when execution is allowed to proceed or\n     * false if the time given elapses before a permit becomes available.\n     */\n    Semaphore.prototype.waitFor = function (milliseconds) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            var resolver, promise;\n            return __generator(this, function (_a) {\n                if (this.permits > 0) {\n                    this.permits -= 1;\n                    return [2 /*return*/, Promise.resolve(true)];\n                }\n                resolver = function (b) { return void (0); };\n                promise = new Promise(function (r) {\n                    resolver = r;\n                });\n                // The saved resolver gets added to our list of promise resolvers so that it gets a chance\n                // to be resolved as a result of a call to signal().\n                this.promiseResolverQueue.push(resolver);\n                setTimeout(function () {\n                    // We have to remove the promise resolver from our list. Resolving it twice would not be\n                    // an issue but signal() always takes the next resolver from the queue and resolves it which\n                    // would swallow a permit if we didn't remove it.\n                    var index = _this.promiseResolverQueue.indexOf(resolver);\n                    if (index !== -1) {\n                        _this.promiseResolverQueue.splice(index, 1);\n                    }\n                    else {\n                        // This is weird... TODO Think about what the best course of action would be at this point.\n                        // Probably do nothing.\n                    }\n                    // false because the wait was unsuccessful.\n                    resolver(false);\n                }, milliseconds);\n                return [2 /*return*/, promise];\n            });\n        });\n    };\n    /**\n     * Synchronous function that tries to acquire a permit and returns true if successful, false otherwise.\n     * @returns  Whether a permit could be acquired.\n     */\n    Semaphore.prototype.tryAcquire = function () {\n        if (this.permits > 0) {\n            this.permits -= 1;\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Acquires all permits that are currently available and returns the number of acquired permits.\n     * @returns  Number of acquired permits.\n     */\n    Semaphore.prototype.drainPermits = function () {\n        if (this.permits > 0) {\n            var permitCount = this.permits;\n            this.permits = 0;\n            return permitCount;\n        }\n        return 0;\n    };\n    /**\n     * Increases the number of permits by one. If there are other functions waiting, one of them will\n     * continue to execute in a future iteration of the event loop.\n     */\n    Semaphore.prototype.signal = function () {\n        this.permits += 1;\n        if (this.permits > 1 && this.promiseResolverQueue.length > 0) {\n            throw new Error('this.permits should never be > 0 when there is someone waiting.');\n        }\n        else if (this.permits === 1 && this.promiseResolverQueue.length > 0) {\n            // If there is someone else waiting, immediately consume the permit that was released\n            // at the beginning of this function and let the waiting function resume.\n            this.permits -= 1;\n            var nextResolver = this.promiseResolverQueue.shift();\n            if (nextResolver) {\n                nextResolver(true);\n            }\n        }\n    };\n    /**\n     * Alias for {@linkcode Semaphore.signal}.\n     */\n    Semaphore.prototype.release = function () {\n        this.signal();\n    };\n    /**\n     * Schedules func to be called once a permit becomes available.\n     * Returns a promise that resolves to the return value of func.\n     * @typeparam T  The return type of func.\n     * @param func  The function to be executed.\n     * @return  A promise that gets resolved with the return value of the function.\n     */\n    Semaphore.prototype.execute = function (func) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, this.wait()];\n                    case 1:\n                        _a.sent();\n                        _a.label = 2;\n                    case 2:\n                        _a.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, func()];\n                    case 3: return [2 /*return*/, _a.sent()];\n                    case 4:\n                        this.signal();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return Semaphore;\n}());\nexports[\"default\"] = Semaphore;\n","(function() {\n\n    var debug = false;\n\n    var root = this;\n\n    var EXIF = function(obj) {\n        if (obj instanceof EXIF) return obj;\n        if (!(this instanceof EXIF)) return new EXIF(obj);\n        this.EXIFwrapped = obj;\n    };\n\n    if (typeof exports !== 'undefined') {\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = EXIF;\n        }\n        exports.EXIF = EXIF;\n    } else {\n        root.EXIF = EXIF;\n    }\n\n    var ExifTags = EXIF.Tags = {\n\n        // version tags\n        0x9000 : \"ExifVersion\",             // EXIF version\n        0xA000 : \"FlashpixVersion\",         // Flashpix format version\n\n        // colorspace tags\n        0xA001 : \"ColorSpace\",              // Color space information tag\n\n        // image configuration\n        0xA002 : \"PixelXDimension\",         // Valid width of meaningful image\n        0xA003 : \"PixelYDimension\",         // Valid height of meaningful image\n        0x9101 : \"ComponentsConfiguration\", // Information about channels\n        0x9102 : \"CompressedBitsPerPixel\",  // Compressed bits per pixel\n\n        // user information\n        0x927C : \"MakerNote\",               // Any desired information written by the manufacturer\n        0x9286 : \"UserComment\",             // Comments by user\n\n        // related file\n        0xA004 : \"RelatedSoundFile\",        // Name of related sound file\n\n        // date and time\n        0x9003 : \"DateTimeOriginal\",        // Date and time when the original image was generated\n        0x9004 : \"DateTimeDigitized\",       // Date and time when the image was stored digitally\n        0x9290 : \"SubsecTime\",              // Fractions of seconds for DateTime\n        0x9291 : \"SubsecTimeOriginal\",      // Fractions of seconds for DateTimeOriginal\n        0x9292 : \"SubsecTimeDigitized\",     // Fractions of seconds for DateTimeDigitized\n\n        // picture-taking conditions\n        0x829A : \"ExposureTime\",            // Exposure time (in seconds)\n        0x829D : \"FNumber\",                 // F number\n        0x8822 : \"ExposureProgram\",         // Exposure program\n        0x8824 : \"SpectralSensitivity\",     // Spectral sensitivity\n        0x8827 : \"ISOSpeedRatings\",         // ISO speed rating\n        0x8828 : \"OECF\",                    // Optoelectric conversion factor\n        0x9201 : \"ShutterSpeedValue\",       // Shutter speed\n        0x9202 : \"ApertureValue\",           // Lens aperture\n        0x9203 : \"BrightnessValue\",         // Value of brightness\n        0x9204 : \"ExposureBias\",            // Exposure bias\n        0x9205 : \"MaxApertureValue\",        // Smallest F number of lens\n        0x9206 : \"SubjectDistance\",         // Distance to subject in meters\n        0x9207 : \"MeteringMode\",            // Metering mode\n        0x9208 : \"LightSource\",             // Kind of light source\n        0x9209 : \"Flash\",                   // Flash status\n        0x9214 : \"SubjectArea\",             // Location and area of main subject\n        0x920A : \"FocalLength\",             // Focal length of the lens in mm\n        0xA20B : \"FlashEnergy\",             // Strobe energy in BCPS\n        0xA20C : \"SpatialFrequencyResponse\",    //\n        0xA20E : \"FocalPlaneXResolution\",   // Number of pixels in width direction per FocalPlaneResolutionUnit\n        0xA20F : \"FocalPlaneYResolution\",   // Number of pixels in height direction per FocalPlaneResolutionUnit\n        0xA210 : \"FocalPlaneResolutionUnit\",    // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\n        0xA214 : \"SubjectLocation\",         // Location of subject in image\n        0xA215 : \"ExposureIndex\",           // Exposure index selected on camera\n        0xA217 : \"SensingMethod\",           // Image sensor type\n        0xA300 : \"FileSource\",              // Image source (3 == DSC)\n        0xA301 : \"SceneType\",               // Scene type (1 == directly photographed)\n        0xA302 : \"CFAPattern\",              // Color filter array geometric pattern\n        0xA401 : \"CustomRendered\",          // Special processing\n        0xA402 : \"ExposureMode\",            // Exposure mode\n        0xA403 : \"WhiteBalance\",            // 1 = auto white balance, 2 = manual\n        0xA404 : \"DigitalZoomRation\",       // Digital zoom ratio\n        0xA405 : \"FocalLengthIn35mmFilm\",   // Equivalent foacl length assuming 35mm film camera (in mm)\n        0xA406 : \"SceneCaptureType\",        // Type of scene\n        0xA407 : \"GainControl\",             // Degree of overall image gain adjustment\n        0xA408 : \"Contrast\",                // Direction of contrast processing applied by camera\n        0xA409 : \"Saturation\",              // Direction of saturation processing applied by camera\n        0xA40A : \"Sharpness\",               // Direction of sharpness processing applied by camera\n        0xA40B : \"DeviceSettingDescription\",    //\n        0xA40C : \"SubjectDistanceRange\",    // Distance to subject\n\n        // other tags\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0xA420 : \"ImageUniqueID\"            // Identifier assigned uniquely to each image\n    };\n\n    var TiffTags = EXIF.TiffTags = {\n        0x0100 : \"ImageWidth\",\n        0x0101 : \"ImageHeight\",\n        0x8769 : \"ExifIFDPointer\",\n        0x8825 : \"GPSInfoIFDPointer\",\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0x0102 : \"BitsPerSample\",\n        0x0103 : \"Compression\",\n        0x0106 : \"PhotometricInterpretation\",\n        0x0112 : \"Orientation\",\n        0x0115 : \"SamplesPerPixel\",\n        0x011C : \"PlanarConfiguration\",\n        0x0212 : \"YCbCrSubSampling\",\n        0x0213 : \"YCbCrPositioning\",\n        0x011A : \"XResolution\",\n        0x011B : \"YResolution\",\n        0x0128 : \"ResolutionUnit\",\n        0x0111 : \"StripOffsets\",\n        0x0116 : \"RowsPerStrip\",\n        0x0117 : \"StripByteCounts\",\n        0x0201 : \"JPEGInterchangeFormat\",\n        0x0202 : \"JPEGInterchangeFormatLength\",\n        0x012D : \"TransferFunction\",\n        0x013E : \"WhitePoint\",\n        0x013F : \"PrimaryChromaticities\",\n        0x0211 : \"YCbCrCoefficients\",\n        0x0214 : \"ReferenceBlackWhite\",\n        0x0132 : \"DateTime\",\n        0x010E : \"ImageDescription\",\n        0x010F : \"Make\",\n        0x0110 : \"Model\",\n        0x0131 : \"Software\",\n        0x013B : \"Artist\",\n        0x8298 : \"Copyright\"\n    };\n\n    var GPSTags = EXIF.GPSTags = {\n        0x0000 : \"GPSVersionID\",\n        0x0001 : \"GPSLatitudeRef\",\n        0x0002 : \"GPSLatitude\",\n        0x0003 : \"GPSLongitudeRef\",\n        0x0004 : \"GPSLongitude\",\n        0x0005 : \"GPSAltitudeRef\",\n        0x0006 : \"GPSAltitude\",\n        0x0007 : \"GPSTimeStamp\",\n        0x0008 : \"GPSSatellites\",\n        0x0009 : \"GPSStatus\",\n        0x000A : \"GPSMeasureMode\",\n        0x000B : \"GPSDOP\",\n        0x000C : \"GPSSpeedRef\",\n        0x000D : \"GPSSpeed\",\n        0x000E : \"GPSTrackRef\",\n        0x000F : \"GPSTrack\",\n        0x0010 : \"GPSImgDirectionRef\",\n        0x0011 : \"GPSImgDirection\",\n        0x0012 : \"GPSMapDatum\",\n        0x0013 : \"GPSDestLatitudeRef\",\n        0x0014 : \"GPSDestLatitude\",\n        0x0015 : \"GPSDestLongitudeRef\",\n        0x0016 : \"GPSDestLongitude\",\n        0x0017 : \"GPSDestBearingRef\",\n        0x0018 : \"GPSDestBearing\",\n        0x0019 : \"GPSDestDistanceRef\",\n        0x001A : \"GPSDestDistance\",\n        0x001B : \"GPSProcessingMethod\",\n        0x001C : \"GPSAreaInformation\",\n        0x001D : \"GPSDateStamp\",\n        0x001E : \"GPSDifferential\"\n    };\n\n     // EXIF 2.3 Spec\n    var IFD1Tags = EXIF.IFD1Tags = {\n        0x0100: \"ImageWidth\",\n        0x0101: \"ImageHeight\",\n        0x0102: \"BitsPerSample\",\n        0x0103: \"Compression\",\n        0x0106: \"PhotometricInterpretation\",\n        0x0111: \"StripOffsets\",\n        0x0112: \"Orientation\",\n        0x0115: \"SamplesPerPixel\",\n        0x0116: \"RowsPerStrip\",\n        0x0117: \"StripByteCounts\",\n        0x011A: \"XResolution\",\n        0x011B: \"YResolution\",\n        0x011C: \"PlanarConfiguration\",\n        0x0128: \"ResolutionUnit\",\n        0x0201: \"JpegIFOffset\",    // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\n        0x0202: \"JpegIFByteCount\", // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\n        0x0211: \"YCbCrCoefficients\",\n        0x0212: \"YCbCrSubSampling\",\n        0x0213: \"YCbCrPositioning\",\n        0x0214: \"ReferenceBlackWhite\"\n    };\n\n    var StringValues = EXIF.StringValues = {\n        ExposureProgram : {\n            0 : \"Not defined\",\n            1 : \"Manual\",\n            2 : \"Normal program\",\n            3 : \"Aperture priority\",\n            4 : \"Shutter priority\",\n            5 : \"Creative program\",\n            6 : \"Action program\",\n            7 : \"Portrait mode\",\n            8 : \"Landscape mode\"\n        },\n        MeteringMode : {\n            0 : \"Unknown\",\n            1 : \"Average\",\n            2 : \"CenterWeightedAverage\",\n            3 : \"Spot\",\n            4 : \"MultiSpot\",\n            5 : \"Pattern\",\n            6 : \"Partial\",\n            255 : \"Other\"\n        },\n        LightSource : {\n            0 : \"Unknown\",\n            1 : \"Daylight\",\n            2 : \"Fluorescent\",\n            3 : \"Tungsten (incandescent light)\",\n            4 : \"Flash\",\n            9 : \"Fine weather\",\n            10 : \"Cloudy weather\",\n            11 : \"Shade\",\n            12 : \"Daylight fluorescent (D 5700 - 7100K)\",\n            13 : \"Day white fluorescent (N 4600 - 5400K)\",\n            14 : \"Cool white fluorescent (W 3900 - 4500K)\",\n            15 : \"White fluorescent (WW 3200 - 3700K)\",\n            17 : \"Standard light A\",\n            18 : \"Standard light B\",\n            19 : \"Standard light C\",\n            20 : \"D55\",\n            21 : \"D65\",\n            22 : \"D75\",\n            23 : \"D50\",\n            24 : \"ISO studio tungsten\",\n            255 : \"Other\"\n        },\n        Flash : {\n            0x0000 : \"Flash did not fire\",\n            0x0001 : \"Flash fired\",\n            0x0005 : \"Strobe return light not detected\",\n            0x0007 : \"Strobe return light detected\",\n            0x0009 : \"Flash fired, compulsory flash mode\",\n            0x000D : \"Flash fired, compulsory flash mode, return light not detected\",\n            0x000F : \"Flash fired, compulsory flash mode, return light detected\",\n            0x0010 : \"Flash did not fire, compulsory flash mode\",\n            0x0018 : \"Flash did not fire, auto mode\",\n            0x0019 : \"Flash fired, auto mode\",\n            0x001D : \"Flash fired, auto mode, return light not detected\",\n            0x001F : \"Flash fired, auto mode, return light detected\",\n            0x0020 : \"No flash function\",\n            0x0041 : \"Flash fired, red-eye reduction mode\",\n            0x0045 : \"Flash fired, red-eye reduction mode, return light not detected\",\n            0x0047 : \"Flash fired, red-eye reduction mode, return light detected\",\n            0x0049 : \"Flash fired, compulsory flash mode, red-eye reduction mode\",\n            0x004D : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",\n            0x004F : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",\n            0x0059 : \"Flash fired, auto mode, red-eye reduction mode\",\n            0x005D : \"Flash fired, auto mode, return light not detected, red-eye reduction mode\",\n            0x005F : \"Flash fired, auto mode, return light detected, red-eye reduction mode\"\n        },\n        SensingMethod : {\n            1 : \"Not defined\",\n            2 : \"One-chip color area sensor\",\n            3 : \"Two-chip color area sensor\",\n            4 : \"Three-chip color area sensor\",\n            5 : \"Color sequential area sensor\",\n            7 : \"Trilinear sensor\",\n            8 : \"Color sequential linear sensor\"\n        },\n        SceneCaptureType : {\n            0 : \"Standard\",\n            1 : \"Landscape\",\n            2 : \"Portrait\",\n            3 : \"Night scene\"\n        },\n        SceneType : {\n            1 : \"Directly photographed\"\n        },\n        CustomRendered : {\n            0 : \"Normal process\",\n            1 : \"Custom process\"\n        },\n        WhiteBalance : {\n            0 : \"Auto white balance\",\n            1 : \"Manual white balance\"\n        },\n        GainControl : {\n            0 : \"None\",\n            1 : \"Low gain up\",\n            2 : \"High gain up\",\n            3 : \"Low gain down\",\n            4 : \"High gain down\"\n        },\n        Contrast : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        Saturation : {\n            0 : \"Normal\",\n            1 : \"Low saturation\",\n            2 : \"High saturation\"\n        },\n        Sharpness : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        SubjectDistanceRange : {\n            0 : \"Unknown\",\n            1 : \"Macro\",\n            2 : \"Close view\",\n            3 : \"Distant view\"\n        },\n        FileSource : {\n            3 : \"DSC\"\n        },\n\n        Components : {\n            0 : \"\",\n            1 : \"Y\",\n            2 : \"Cb\",\n            3 : \"Cr\",\n            4 : \"R\",\n            5 : \"G\",\n            6 : \"B\"\n        }\n    };\n\n    function addEvent(element, event, handler) {\n        if (element.addEventListener) {\n            element.addEventListener(event, handler, false);\n        } else if (element.attachEvent) {\n            element.attachEvent(\"on\" + event, handler);\n        }\n    }\n\n    function imageHasData(img) {\n        return !!(img.exifdata);\n    }\n\n\n    function base64ToArrayBuffer(base64, contentType) {\n        contentType = contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/mi)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\n        base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n        var binary = atob(base64);\n        var len = binary.length;\n        var buffer = new ArrayBuffer(len);\n        var view = new Uint8Array(buffer);\n        for (var i = 0; i < len; i++) {\n            view[i] = binary.charCodeAt(i);\n        }\n        return buffer;\n    }\n\n    function objectURLToBlob(url, callback) {\n        var http = new XMLHttpRequest();\n        http.open(\"GET\", url, true);\n        http.responseType = \"blob\";\n        http.onload = function(e) {\n            if (this.status == 200 || this.status === 0) {\n                callback(this.response);\n            }\n        };\n        http.send();\n    }\n\n    function getImageData(img, callback) {\n        function handleBinaryFile(binFile) {\n            var data = findEXIFinJPEG(binFile);\n            img.exifdata = data || {};\n            var iptcdata = findIPTCinJPEG(binFile);\n            img.iptcdata = iptcdata || {};\n            if (EXIF.isXmpEnabled) {\n               var xmpdata= findXMPinJPEG(binFile);\n               img.xmpdata = xmpdata || {};               \n            }\n            if (callback) {\n                callback.call(img);\n            }\n        }\n\n        if (img.src) {\n            if (/^data\\:/i.test(img.src)) { // Data URI\n                var arrayBuffer = base64ToArrayBuffer(img.src);\n                handleBinaryFile(arrayBuffer);\n\n            } else if (/^blob\\:/i.test(img.src)) { // Object URL\n                var fileReader = new FileReader();\n                fileReader.onload = function(e) {\n                    handleBinaryFile(e.target.result);\n                };\n                objectURLToBlob(img.src, function (blob) {\n                    fileReader.readAsArrayBuffer(blob);\n                });\n            } else {\n                var http = new XMLHttpRequest();\n                http.onload = function() {\n                    if (this.status == 200 || this.status === 0) {\n                        handleBinaryFile(http.response);\n                    } else {\n                        throw \"Could not load image\";\n                    }\n                    http = null;\n                };\n                http.open(\"GET\", img.src, true);\n                http.responseType = \"arraybuffer\";\n                http.send(null);\n            }\n        } else if (self.FileReader && (img instanceof self.Blob || img instanceof self.File)) {\n            var fileReader = new FileReader();\n            fileReader.onload = function(e) {\n                if (debug) console.log(\"Got file of length \" + e.target.result.byteLength);\n                handleBinaryFile(e.target.result);\n            };\n\n            fileReader.readAsArrayBuffer(img);\n        }\n    }\n\n    function findEXIFinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            marker;\n\n        while (offset < length) {\n            if (dataView.getUint8(offset) != 0xFF) {\n                if (debug) console.log(\"Not a valid marker at offset \" + offset + \", found: \" + dataView.getUint8(offset));\n                return false; // not a valid marker, something is wrong\n            }\n\n            marker = dataView.getUint8(offset + 1);\n            if (debug) console.log(marker);\n\n            // we could implement handling for other markers here,\n            // but we're only looking for 0xFFE1 for EXIF data\n\n            if (marker == 225) {\n                if (debug) console.log(\"Found 0xFFE1 marker\");\n\n                return readEXIFData(dataView, offset + 4, dataView.getUint16(offset + 2) - 2);\n\n                // offset += 2 + file.getShortAt(offset+2, true);\n\n            } else {\n                offset += 2 + dataView.getUint16(offset+2);\n            }\n\n        }\n\n    }\n\n    function findIPTCinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength;\n\n\n        var isFieldSegmentStart = function(dataView, offset){\n            return (\n                dataView.getUint8(offset) === 0x38 &&\n                dataView.getUint8(offset+1) === 0x42 &&\n                dataView.getUint8(offset+2) === 0x49 &&\n                dataView.getUint8(offset+3) === 0x4D &&\n                dataView.getUint8(offset+4) === 0x04 &&\n                dataView.getUint8(offset+5) === 0x04\n            );\n        };\n\n        while (offset < length) {\n\n            if ( isFieldSegmentStart(dataView, offset )){\n\n                // Get the length of the name header (which is padded to an even number of bytes)\n                var nameHeaderLength = dataView.getUint8(offset+7);\n                if(nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\n                // Check for pre photoshop 6 format\n                if(nameHeaderLength === 0) {\n                    // Always 4\n                    nameHeaderLength = 4;\n                }\n\n                var startOffset = offset + 8 + nameHeaderLength;\n                var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\n\n                return readIPTCData(file, startOffset, sectionLength);\n\n                break;\n\n            }\n\n\n            // Not the marker, continue searching\n            offset++;\n\n        }\n\n    }\n    var IptcFieldMap = {\n        0x78 : 'caption',\n        0x6E : 'credit',\n        0x19 : 'keywords',\n        0x37 : 'dateCreated',\n        0x50 : 'byline',\n        0x55 : 'bylineTitle',\n        0x7A : 'captionWriter',\n        0x69 : 'headline',\n        0x74 : 'copyright',\n        0x0F : 'category'\n    };\n    function readIPTCData(file, startOffset, sectionLength){\n        var dataView = new DataView(file);\n        var data = {};\n        var fieldValue, fieldName, dataSize, segmentType, segmentSize;\n        var segmentStartPos = startOffset;\n        while(segmentStartPos < startOffset+sectionLength) {\n            if(dataView.getUint8(segmentStartPos) === 0x1C && dataView.getUint8(segmentStartPos+1) === 0x02){\n                segmentType = dataView.getUint8(segmentStartPos+2);\n                if(segmentType in IptcFieldMap) {\n                    dataSize = dataView.getInt16(segmentStartPos+3);\n                    segmentSize = dataSize + 5;\n                    fieldName = IptcFieldMap[segmentType];\n                    fieldValue = getStringFromDB(dataView, segmentStartPos+5, dataSize);\n                    // Check if we already stored a value with this name\n                    if(data.hasOwnProperty(fieldName)) {\n                        // Value already stored with this name, create multivalue field\n                        if(data[fieldName] instanceof Array) {\n                            data[fieldName].push(fieldValue);\n                        }\n                        else {\n                            data[fieldName] = [data[fieldName], fieldValue];\n                        }\n                    }\n                    else {\n                        data[fieldName] = fieldValue;\n                    }\n                }\n\n            }\n            segmentStartPos++;\n        }\n        return data;\n    }\n\n\n\n    function readTags(file, tiffStart, dirStart, strings, bigEnd) {\n        var entries = file.getUint16(dirStart, !bigEnd),\n            tags = {},\n            entryOffset, tag,\n            i;\n\n        for (i=0;i<entries;i++) {\n            entryOffset = dirStart + i*12 + 2;\n            tag = strings[file.getUint16(entryOffset, !bigEnd)];\n            if (!tag && debug) console.log(\"Unknown tag: \" + file.getUint16(entryOffset, !bigEnd));\n            tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\n        }\n        return tags;\n    }\n\n\n    function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\n        var type = file.getUint16(entryOffset+2, !bigEnd),\n            numValues = file.getUint32(entryOffset+4, !bigEnd),\n            valueOffset = file.getUint32(entryOffset+8, !bigEnd) + tiffStart,\n            offset,\n            vals, val, n,\n            numerator, denominator;\n\n        switch (type) {\n            case 1: // byte, 8-bit unsigned int\n            case 7: // undefined, 8-bit byte, value depending on field\n                if (numValues == 1) {\n                    return file.getUint8(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint8(offset + n);\n                    }\n                    return vals;\n                }\n\n            case 2: // ascii, 8-bit byte\n                offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                return getStringFromDB(file, offset, numValues-1);\n\n            case 3: // short, 16 bit int\n                if (numValues == 1) {\n                    return file.getUint16(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 2 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint16(offset + 2*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 4: // long, 32 bit int\n                if (numValues == 1) {\n                    return file.getUint32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 5:    // rational = two long values, first is numerator, second is denominator\n                if (numValues == 1) {\n                    numerator = file.getUint32(valueOffset, !bigEnd);\n                    denominator = file.getUint32(valueOffset+4, !bigEnd);\n                    val = new Number(numerator / denominator);\n                    val.numerator = numerator;\n                    val.denominator = denominator;\n                    return val;\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        numerator = file.getUint32(valueOffset + 8*n, !bigEnd);\n                        denominator = file.getUint32(valueOffset+4 + 8*n, !bigEnd);\n                        vals[n] = new Number(numerator / denominator);\n                        vals[n].numerator = numerator;\n                        vals[n].denominator = denominator;\n                    }\n                    return vals;\n                }\n\n            case 9: // slong, 32 bit signed int\n                if (numValues == 1) {\n                    return file.getInt32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 10: // signed rational, two slongs, first is numerator, second is denominator\n                if (numValues == 1) {\n                    return file.getInt32(valueOffset, !bigEnd) / file.getInt32(valueOffset+4, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 8*n, !bigEnd) / file.getInt32(valueOffset+4 + 8*n, !bigEnd);\n                    }\n                    return vals;\n                }\n        }\n    }\n\n    /**\n    * Given an IFD (Image File Directory) start offset\n    * returns an offset to next IFD or 0 if it's the last IFD.\n    */\n    function getNextIFDOffset(dataView, dirStart, bigEnd){\n        //the first 2bytes means the number of directory entries contains in this IFD\n        var entries = dataView.getUint16(dirStart, !bigEnd);\n\n        // After last directory entry, there is a 4bytes of data,\n        // it means an offset to next IFD.\n        // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\n\n        return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\n    }\n\n    function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd){\n        // get the IFD1 offset\n        var IFD1OffsetPointer = getNextIFDOffset(dataView, tiffStart+firstIFDOffset, bigEnd);\n\n        if (!IFD1OffsetPointer) {\n            // console.log('******** IFD1Offset is empty, image thumb not found ********');\n            return {};\n        }\n        else if (IFD1OffsetPointer > dataView.byteLength) { // this should not happen\n            // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\n            return {};\n        }\n        // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\n\n        var thumbTags = readTags(dataView, tiffStart, tiffStart + IFD1OffsetPointer, IFD1Tags, bigEnd)\n\n        // EXIF 2.3 specification for JPEG format thumbnail\n\n        // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\n        // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\n        // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\n        // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\n        // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\n\n        if (thumbTags['Compression']) {\n            // console.log('Thumbnail image found!');\n\n            switch (thumbTags['Compression']) {\n                case 6:\n                    // console.log('Thumbnail image format is JPEG');\n                    if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\n                    // extract the thumbnail\n                        var tOffset = tiffStart + thumbTags.JpegIFOffset;\n                        var tLength = thumbTags.JpegIFByteCount;\n                        thumbTags['blob'] = new Blob([new Uint8Array(dataView.buffer, tOffset, tLength)], {\n                            type: 'image/jpeg'\n                        });\n                    }\n                break;\n\n            case 1:\n                console.log(\"Thumbnail image format is TIFF, which is not implemented.\");\n                break;\n            default:\n                console.log(\"Unknown thumbnail image format '%s'\", thumbTags['Compression']);\n            }\n        }\n        else if (thumbTags['PhotometricInterpretation'] == 2) {\n            console.log(\"Thumbnail image format is RGB, which is not implemented.\");\n        }\n        return thumbTags;\n    }\n\n    function getStringFromDB(buffer, start, length) {\n        var outstr = \"\";\n        for (n = start; n < start+length; n++) {\n            outstr += String.fromCharCode(buffer.getUint8(n));\n        }\n        return outstr;\n    }\n\n    function readEXIFData(file, start) {\n        if (getStringFromDB(file, start, 4) != \"Exif\") {\n            if (debug) console.log(\"Not valid EXIF data! \" + getStringFromDB(file, start, 4));\n            return false;\n        }\n\n        var bigEnd,\n            tags, tag,\n            exifData, gpsData,\n            tiffOffset = start + 6;\n\n        // test for TIFF validity and endianness\n        if (file.getUint16(tiffOffset) == 0x4949) {\n            bigEnd = false;\n        } else if (file.getUint16(tiffOffset) == 0x4D4D) {\n            bigEnd = true;\n        } else {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\");\n            return false;\n        }\n\n        if (file.getUint16(tiffOffset+2, !bigEnd) != 0x002A) {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x002A)\");\n            return false;\n        }\n\n        var firstIFDOffset = file.getUint32(tiffOffset+4, !bigEnd);\n\n        if (firstIFDOffset < 0x00000008) {\n            if (debug) console.log(\"Not valid TIFF data! (First offset less than 8)\", file.getUint32(tiffOffset+4, !bigEnd));\n            return false;\n        }\n\n        tags = readTags(file, tiffOffset, tiffOffset + firstIFDOffset, TiffTags, bigEnd);\n\n        if (tags.ExifIFDPointer) {\n            exifData = readTags(file, tiffOffset, tiffOffset + tags.ExifIFDPointer, ExifTags, bigEnd);\n            for (tag in exifData) {\n                switch (tag) {\n                    case \"LightSource\" :\n                    case \"Flash\" :\n                    case \"MeteringMode\" :\n                    case \"ExposureProgram\" :\n                    case \"SensingMethod\" :\n                    case \"SceneCaptureType\" :\n                    case \"SceneType\" :\n                    case \"CustomRendered\" :\n                    case \"WhiteBalance\" :\n                    case \"GainControl\" :\n                    case \"Contrast\" :\n                    case \"Saturation\" :\n                    case \"Sharpness\" :\n                    case \"SubjectDistanceRange\" :\n                    case \"FileSource\" :\n                        exifData[tag] = StringValues[tag][exifData[tag]];\n                        break;\n\n                    case \"ExifVersion\" :\n                    case \"FlashpixVersion\" :\n                        exifData[tag] = String.fromCharCode(exifData[tag][0], exifData[tag][1], exifData[tag][2], exifData[tag][3]);\n                        break;\n\n                    case \"ComponentsConfiguration\" :\n                        exifData[tag] =\n                            StringValues.Components[exifData[tag][0]] +\n                            StringValues.Components[exifData[tag][1]] +\n                            StringValues.Components[exifData[tag][2]] +\n                            StringValues.Components[exifData[tag][3]];\n                        break;\n                }\n                tags[tag] = exifData[tag];\n            }\n        }\n\n        if (tags.GPSInfoIFDPointer) {\n            gpsData = readTags(file, tiffOffset, tiffOffset + tags.GPSInfoIFDPointer, GPSTags, bigEnd);\n            for (tag in gpsData) {\n                switch (tag) {\n                    case \"GPSVersionID\" :\n                        gpsData[tag] = gpsData[tag][0] +\n                            \".\" + gpsData[tag][1] +\n                            \".\" + gpsData[tag][2] +\n                            \".\" + gpsData[tag][3];\n                        break;\n                }\n                tags[tag] = gpsData[tag];\n            }\n        }\n\n        // extract thumbnail\n        tags['thumbnail'] = readThumbnailImage(file, tiffOffset, firstIFDOffset, bigEnd);\n\n        return tags;\n    }\n\n   function findXMPinJPEG(file) {\n\n        if (!('DOMParser' in self)) {\n            // console.warn('XML parsing not supported without DOMParser');\n            return;\n        }\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n           if (debug) console.log(\"Not a valid JPEG\");\n           return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            dom = new DOMParser();\n\n        while (offset < (length-4)) {\n            if (getStringFromDB(dataView, offset, 4) == \"http\") {\n                var startOffset = offset - 1;\n                var sectionLength = dataView.getUint16(offset - 2) - 1;\n                var xmpString = getStringFromDB(dataView, startOffset, sectionLength)\n                var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\n                xmpString = xmpString.substring( xmpString.indexOf( '<x:xmpmeta' ), xmpEndIndex );\n\n                var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10\n                //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\n                //Without these namespaces, XML is thought to be invalid by parsers\n                xmpString = xmpString.slice(0, indexOfXmp)\n                            + 'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" '\n                            + 'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" '\n                            + 'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" '\n                            + 'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" '\n                            + 'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" '\n                            + 'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" '\n                            + 'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" '\n                            + 'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" '\n                            + 'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" '\n                            + 'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" '\n                            + 'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" '\n                            + xmpString.slice(indexOfXmp)\n\n                var domDocument = dom.parseFromString( xmpString, 'text/xml' );\n                return xml2Object(domDocument);\n            } else{\n             offset++;\n            }\n        }\n    }\n\n    function xml2json(xml) {\n        var json = {};\n      \n        if (xml.nodeType == 1) { // element node\n          if (xml.attributes.length > 0) {\n            json['@attributes'] = {};\n            for (var j = 0; j < xml.attributes.length; j++) {\n              var attribute = xml.attributes.item(j);\n              json['@attributes'][attribute.nodeName] = attribute.nodeValue;\n            }\n          }\n        } else if (xml.nodeType == 3) { // text node\n          return xml.nodeValue;\n        }\n      \n        // deal with children\n        if (xml.hasChildNodes()) {\n          for(var i = 0; i < xml.childNodes.length; i++) {\n            var child = xml.childNodes.item(i);\n            var nodeName = child.nodeName;\n            if (json[nodeName] == null) {\n              json[nodeName] = xml2json(child);\n            } else {\n              if (json[nodeName].push == null) {\n                var old = json[nodeName];\n                json[nodeName] = [];\n                json[nodeName].push(old);\n              }\n              json[nodeName].push(xml2json(child));\n            }\n          }\n        }\n        \n        return json;\n    }\n\n    function xml2Object(xml) {\n        try {\n            var obj = {};\n            if (xml.children.length > 0) {\n              for (var i = 0; i < xml.children.length; i++) {\n                var item = xml.children.item(i);\n                var attributes = item.attributes;\n                for(var idx in attributes) {\n                    var itemAtt = attributes[idx];\n                    var dataKey = itemAtt.nodeName;\n                    var dataValue = itemAtt.nodeValue;\n\n                    if(dataKey !== undefined) {\n                        obj[dataKey] = dataValue;\n                    }\n                }\n                var nodeName = item.nodeName;\n\n                if (typeof (obj[nodeName]) == \"undefined\") {\n                  obj[nodeName] = xml2json(item);\n                } else {\n                  if (typeof (obj[nodeName].push) == \"undefined\") {\n                    var old = obj[nodeName];\n\n                    obj[nodeName] = [];\n                    obj[nodeName].push(old);\n                  }\n                  obj[nodeName].push(xml2json(item));\n                }\n              }\n            } else {\n              obj = xml.textContent;\n            }\n            return obj;\n          } catch (e) {\n              console.log(e.message);\n          }\n    }\n\n    EXIF.enableXmp = function() {\n        EXIF.isXmpEnabled = true;\n    }\n\n    EXIF.disableXmp = function() {\n        EXIF.isXmpEnabled = false;\n    }\n\n    EXIF.getData = function(img, callback) {\n        if (((self.Image && img instanceof self.Image)\n            || (self.HTMLImageElement && img instanceof self.HTMLImageElement))\n            && !img.complete)\n            return false;\n\n        if (!imageHasData(img)) {\n            getImageData(img, callback);\n        } else {\n            if (callback) {\n                callback.call(img);\n            }\n        }\n        return true;\n    }\n\n    EXIF.getTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.exifdata[tag];\n    }\n    \n    EXIF.getIptcTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.iptcdata[tag];\n    }\n\n    EXIF.getAllTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.exifdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n    \n    EXIF.getAllIptcTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.iptcdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n\n    EXIF.pretty = function(img) {\n        if (!imageHasData(img)) return \"\";\n        var a,\n            data = img.exifdata,\n            strPretty = \"\";\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                if (typeof data[a] == \"object\") {\n                    if (data[a] instanceof Number) {\n                        strPretty += a + \" : \" + data[a] + \" [\" + data[a].numerator + \"/\" + data[a].denominator + \"]\\r\\n\";\n                    } else {\n                        strPretty += a + \" : [\" + data[a].length + \" values]\\r\\n\";\n                    }\n                } else {\n                    strPretty += a + \" : \" + data[a] + \"\\r\\n\";\n                }\n            }\n        }\n        return strPretty;\n    }\n\n    EXIF.readFromBinaryFile = function(file) {\n        return findEXIFinJPEG(file);\n    }\n\n    if (typeof define === 'function' && define.amd) {\n        define('exif-js', [], function() {\n            return EXIF;\n        });\n    }\n}.call(this));\n\n","var random = require('./random')\nvar format = require('./format')\n\n/**\n * Low-level function to change alphabet and ID size.\n *\n * Alphabet must contain 256 symbols or less. Otherwise, the generator\n * will not be secure.\n *\n * @param {string} alphabet Symbols to be used in ID.\n * @param {number} size The number of symbols in ID.\n *\n * @return {string} Unique ID.\n *\n * @example\n * const generate = require('nanoid/generate')\n * model.id = generate('0123456789', 5) //=> \"856\"\n *\n * @name generate\n * @function\n */\nmodule.exports = format.bind(null, random)\n","\"use strict\";\n/**\n * Portions of this file are derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - uuid, Copyright (c) 2010-2016 Robert Kieffer and other contributors\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// tslint:disable no-bitwise\nconst stanza_shims_1 = require(\"stanza-shims\");\nconst bth = [];\nfor (let i = 0; i < 256; ++i) {\n    bth[i] = (i + 0x100).toString(16).substr(1);\n}\nasync function timeoutPromise(target, delay, rejectValue = () => undefined) {\n    let timeoutRef;\n    const result = await Promise.race([\n        target,\n        new Promise((resolve, reject) => {\n            timeoutRef = setTimeout(() => reject(rejectValue()), delay);\n        })\n    ]);\n    if (timeoutRef) {\n        clearTimeout(timeoutRef);\n    }\n    return result;\n}\nexports.timeoutPromise = timeoutPromise;\nasync function sleep(time) {\n    return new Promise(resolve => {\n        setTimeout(() => resolve(), time);\n    });\n}\nexports.sleep = sleep;\nfunction octetCompare(str1, str2) {\n    const b1 = typeof str1 === 'string' ? Buffer.from(str1, 'utf8') : str1;\n    const b2 = typeof str2 === 'string' ? Buffer.from(str2, 'utf8') : str2;\n    return b1.compare(b2);\n}\nexports.octetCompare = octetCompare;\nfunction uuid() {\n    const buf = stanza_shims_1.randomBytes(16);\n    // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n    buf[6] = (buf[6] & 0x0f) | 0x40;\n    buf[8] = (buf[8] & 0x3f) | 0x80;\n    let i = 0;\n    return [\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        '-',\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i++]],\n        bth[buf[i]]\n    ].join('');\n}\nexports.uuid = uuid;\nconst ISO_DT = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)(?:Z|((\\+|-)([\\d|:]*)))?$/;\nfunction reviveData(key, value) {\n    if (value && typeof value === 'string' && ISO_DT.test(value)) {\n        return new Date(value);\n    }\n    if (value &&\n        typeof value === 'object' &&\n        value.type === 'Buffer' &&\n        Array.isArray(value.data)) {\n        return Buffer.from(value);\n    }\n    return value;\n}\nexports.reviveData = reviveData;\n","/**\n * jshashes - https://github.com/h2non/jshashes\n * Released under the \"New BSD\" license\n *\n * Algorithms specification:\n *\n * MD5 - http://www.ietf.org/rfc/rfc1321.txt\n * RIPEMD-160 - http://homes.esat.kuleuven.be/~bosselae/ripemd160.html\n * SHA1   - http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf\n * SHA256 - http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf\n * SHA512 - http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf\n * HMAC - http://www.ietf.org/rfc/rfc2104.txt\n */\n(function() {\n  var Hashes;\n\n  function utf8Encode(str) {\n    var x, y, output = '',\n      i = -1,\n      l;\n\n    if (str && str.length) {\n      l = str.length;\n      while ((i += 1) < l) {\n        /* Decode utf-16 surrogate pairs */\n        x = str.charCodeAt(i);\n        y = i + 1 < l ? str.charCodeAt(i + 1) : 0;\n        if (0xD800 <= x && x <= 0xDBFF && 0xDC00 <= y && y <= 0xDFFF) {\n          x = 0x10000 + ((x & 0x03FF) << 10) + (y & 0x03FF);\n          i += 1;\n        }\n        /* Encode output as utf-8 */\n        if (x <= 0x7F) {\n          output += String.fromCharCode(x);\n        } else if (x <= 0x7FF) {\n          output += String.fromCharCode(0xC0 | ((x >>> 6) & 0x1F),\n            0x80 | (x & 0x3F));\n        } else if (x <= 0xFFFF) {\n          output += String.fromCharCode(0xE0 | ((x >>> 12) & 0x0F),\n            0x80 | ((x >>> 6) & 0x3F),\n            0x80 | (x & 0x3F));\n        } else if (x <= 0x1FFFFF) {\n          output += String.fromCharCode(0xF0 | ((x >>> 18) & 0x07),\n            0x80 | ((x >>> 12) & 0x3F),\n            0x80 | ((x >>> 6) & 0x3F),\n            0x80 | (x & 0x3F));\n        }\n      }\n    }\n    return output;\n  }\n\n  function utf8Decode(str) {\n    var i, ac, c1, c2, c3, arr = [],\n      l;\n    i = ac = c1 = c2 = c3 = 0;\n\n    if (str && str.length) {\n      l = str.length;\n      str += '';\n\n      while (i < l) {\n        c1 = str.charCodeAt(i);\n        ac += 1;\n        if (c1 < 128) {\n          arr[ac] = String.fromCharCode(c1);\n          i += 1;\n        } else if (c1 > 191 && c1 < 224) {\n          c2 = str.charCodeAt(i + 1);\n          arr[ac] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\n          i += 2;\n        } else {\n          c2 = str.charCodeAt(i + 1);\n          c3 = str.charCodeAt(i + 2);\n          arr[ac] = String.fromCharCode(((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n          i += 3;\n        }\n      }\n    }\n    return arr.join('');\n  }\n\n  /**\n   * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n   * to work around bugs in some JS interpreters.\n   */\n\n  function safe_add(x, y) {\n    var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n      msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n    return (msw << 16) | (lsw & 0xFFFF);\n  }\n\n  /**\n   * Bitwise rotate a 32-bit number to the left.\n   */\n\n  function bit_rol(num, cnt) {\n    return (num << cnt) | (num >>> (32 - cnt));\n  }\n\n  /**\n   * Convert a raw string to a hex string\n   */\n\n  function rstr2hex(input, hexcase) {\n    var hex_tab = hexcase ? '0123456789ABCDEF' : '0123456789abcdef',\n      output = '',\n      x, i = 0,\n      l = input.length;\n    for (; i < l; i += 1) {\n      x = input.charCodeAt(i);\n      output += hex_tab.charAt((x >>> 4) & 0x0F) + hex_tab.charAt(x & 0x0F);\n    }\n    return output;\n  }\n\n  /**\n   * Encode a string as utf-16\n   */\n\n  function str2rstr_utf16le(input) {\n    var i, l = input.length,\n      output = '';\n    for (i = 0; i < l; i += 1) {\n      output += String.fromCharCode(input.charCodeAt(i) & 0xFF, (input.charCodeAt(i) >>> 8) & 0xFF);\n    }\n    return output;\n  }\n\n  function str2rstr_utf16be(input) {\n    var i, l = input.length,\n      output = '';\n    for (i = 0; i < l; i += 1) {\n      output += String.fromCharCode((input.charCodeAt(i) >>> 8) & 0xFF, input.charCodeAt(i) & 0xFF);\n    }\n    return output;\n  }\n\n  /**\n   * Convert an array of big-endian words to a string\n   */\n\n  function binb2rstr(input) {\n    var i, l = input.length * 32,\n      output = '';\n    for (i = 0; i < l; i += 8) {\n      output += String.fromCharCode((input[i >> 5] >>> (24 - i % 32)) & 0xFF);\n    }\n    return output;\n  }\n\n  /**\n   * Convert an array of little-endian words to a string\n   */\n\n  function binl2rstr(input) {\n    var i, l = input.length * 32,\n      output = '';\n    for (i = 0; i < l; i += 8) {\n      output += String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xFF);\n    }\n    return output;\n  }\n\n  /**\n   * Convert a raw string to an array of little-endian words\n   * Characters >255 have their high-byte silently ignored.\n   */\n\n  function rstr2binl(input) {\n    var i, l = input.length * 8,\n      output = Array(input.length >> 2),\n      lo = output.length;\n    for (i = 0; i < lo; i += 1) {\n      output[i] = 0;\n    }\n    for (i = 0; i < l; i += 8) {\n      output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (i % 32);\n    }\n    return output;\n  }\n\n  /**\n   * Convert a raw string to an array of big-endian words\n   * Characters >255 have their high-byte silently ignored.\n   */\n\n  function rstr2binb(input) {\n    var i, l = input.length * 8,\n      output = Array(input.length >> 2),\n      lo = output.length;\n    for (i = 0; i < lo; i += 1) {\n      output[i] = 0;\n    }\n    for (i = 0; i < l; i += 8) {\n      output[i >> 5] |= (input.charCodeAt(i / 8) & 0xFF) << (24 - i % 32);\n    }\n    return output;\n  }\n\n  /**\n   * Convert a raw string to an arbitrary string encoding\n   */\n\n  function rstr2any(input, encoding) {\n    var divisor = encoding.length,\n      remainders = Array(),\n      i, q, x, ld, quotient, dividend, output, full_length;\n\n    /* Convert to an array of 16-bit big-endian values, forming the dividend */\n    dividend = Array(Math.ceil(input.length / 2));\n    ld = dividend.length;\n    for (i = 0; i < ld; i += 1) {\n      dividend[i] = (input.charCodeAt(i * 2) << 8) | input.charCodeAt(i * 2 + 1);\n    }\n\n    /**\n     * Repeatedly perform a long division. The binary array forms the dividend,\n     * the length of the encoding is the divisor. Once computed, the quotient\n     * forms the dividend for the next step. We stop when the dividend is zerHashes.\n     * All remainders are stored for later use.\n     */\n    while (dividend.length > 0) {\n      quotient = Array();\n      x = 0;\n      for (i = 0; i < dividend.length; i += 1) {\n        x = (x << 16) + dividend[i];\n        q = Math.floor(x / divisor);\n        x -= q * divisor;\n        if (quotient.length > 0 || q > 0) {\n          quotient[quotient.length] = q;\n        }\n      }\n      remainders[remainders.length] = x;\n      dividend = quotient;\n    }\n\n    /* Convert the remainders to the output string */\n    output = '';\n    for (i = remainders.length - 1; i >= 0; i--) {\n      output += encoding.charAt(remainders[i]);\n    }\n\n    /* Append leading zero equivalents */\n    full_length = Math.ceil(input.length * 8 / (Math.log(encoding.length) / Math.log(2)));\n    for (i = output.length; i < full_length; i += 1) {\n      output = encoding[0] + output;\n    }\n    return output;\n  }\n\n  /**\n   * Convert a raw string to a base-64 string\n   */\n\n  function rstr2b64(input, b64pad) {\n    var tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n      output = '',\n      len = input.length,\n      i, j, triplet;\n    b64pad = b64pad || '=';\n    for (i = 0; i < len; i += 3) {\n      triplet = (input.charCodeAt(i) << 16) | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0) | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\n      for (j = 0; j < 4; j += 1) {\n        if (i * 8 + j * 6 > input.length * 8) {\n          output += b64pad;\n        } else {\n          output += tab.charAt((triplet >>> 6 * (3 - j)) & 0x3F);\n        }\n      }\n    }\n    return output;\n  }\n\n  Hashes = {\n    /**\n     * @property {String} version\n     * @readonly\n     */\n    VERSION: '1.0.6',\n    /**\n     * @member Hashes\n     * @class Base64\n     * @constructor\n     */\n    Base64: function() {\n      // private properties\n      var tab = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',\n        pad = '=', // default pad according with the RFC standard\n        url = false, // URL encoding support @todo\n        utf8 = true; // by default enable UTF-8 support encoding\n\n      // public method for encoding\n      this.encode = function(input) {\n        var i, j, triplet,\n          output = '',\n          len = input.length;\n\n        pad = pad || '=';\n        input = (utf8) ? utf8Encode(input) : input;\n\n        for (i = 0; i < len; i += 3) {\n          triplet = (input.charCodeAt(i) << 16) | (i + 1 < len ? input.charCodeAt(i + 1) << 8 : 0) | (i + 2 < len ? input.charCodeAt(i + 2) : 0);\n          for (j = 0; j < 4; j += 1) {\n            if (i * 8 + j * 6 > len * 8) {\n              output += pad;\n            } else {\n              output += tab.charAt((triplet >>> 6 * (3 - j)) & 0x3F);\n            }\n          }\n        }\n        return output;\n      };\n\n      // public method for decoding\n      this.decode = function(input) {\n        // var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var i, o1, o2, o3, h1, h2, h3, h4, bits, ac,\n          dec = '',\n          arr = [];\n        if (!input) {\n          return input;\n        }\n\n        i = ac = 0;\n        input = input.replace(new RegExp('\\\\' + pad, 'gi'), ''); // use '='\n        //input += '';\n\n        do { // unpack four hexets into three octets using index points in b64\n          h1 = tab.indexOf(input.charAt(i += 1));\n          h2 = tab.indexOf(input.charAt(i += 1));\n          h3 = tab.indexOf(input.charAt(i += 1));\n          h4 = tab.indexOf(input.charAt(i += 1));\n\n          bits = h1 << 18 | h2 << 12 | h3 << 6 | h4;\n\n          o1 = bits >> 16 & 0xff;\n          o2 = bits >> 8 & 0xff;\n          o3 = bits & 0xff;\n          ac += 1;\n\n          if (h3 === 64) {\n            arr[ac] = String.fromCharCode(o1);\n          } else if (h4 === 64) {\n            arr[ac] = String.fromCharCode(o1, o2);\n          } else {\n            arr[ac] = String.fromCharCode(o1, o2, o3);\n          }\n        } while (i < input.length);\n\n        dec = arr.join('');\n        dec = (utf8) ? utf8Decode(dec) : dec;\n\n        return dec;\n      };\n\n      // set custom pad string\n      this.setPad = function(str) {\n        pad = str || pad;\n        return this;\n      };\n      // set custom tab string characters\n      this.setTab = function(str) {\n        tab = str || tab;\n        return this;\n      };\n      this.setUTF8 = function(bool) {\n        if (typeof bool === 'boolean') {\n          utf8 = bool;\n        }\n        return this;\n      };\n    },\n\n    /**\n     * CRC-32 calculation\n     * @member Hashes\n     * @method CRC32\n     * @static\n     * @param {String} str Input String\n     * @return {String}\n     */\n    CRC32: function(str) {\n      var crc = 0,\n        x = 0,\n        y = 0,\n        table, i, iTop;\n      str = utf8Encode(str);\n\n      table = [\n        '00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 ',\n        '79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 ',\n        '84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F ',\n        '63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD ',\n        'A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC ',\n        '51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 ',\n        'B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 ',\n        '06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 ',\n        'E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 ',\n        '12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 ',\n        'D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 ',\n        '33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 ',\n        'CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 ',\n        '9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E ',\n        '7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D ',\n        '806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 ',\n        '60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA ',\n        'AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 ',\n        '5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 ',\n        'B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 ',\n        '05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 ',\n        'F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA ',\n        '11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 ',\n        'D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F ',\n        '30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E ',\n        'C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D'\n      ].join('');\n\n      crc = crc ^ (-1);\n      for (i = 0, iTop = str.length; i < iTop; i += 1) {\n        y = (crc ^ str.charCodeAt(i)) & 0xFF;\n        x = '0x' + table.substr(y * 9, 8);\n        crc = (crc >>> 8) ^ x;\n      }\n      // always return a positive number (that's what >>> 0 does)\n      return (crc ^ (-1)) >>> 0;\n    },\n    /**\n     * @member Hashes\n     * @class MD5\n     * @constructor\n     * @param {Object} [config]\n     *\n     * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n     * Digest Algorithm, as defined in RFC 1321.\n     * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n     * See <http://pajhome.org.uk/crypt/md5> for more infHashes.\n     */\n    MD5: function(options) {\n      /**\n       * Private config properties. You may need to tweak these to be compatible with\n       * the server-side, but the defaults work in most cases.\n       * See {@link Hashes.MD5#method-setUpperCase} and {@link Hashes.SHA1#method-setUpperCase}\n       */\n      var hexcase = (options && typeof options.uppercase === 'boolean') ? options.uppercase : false, // hexadecimal output case format. false - lowercase; true - uppercase\n        b64pad = (options && typeof options.pad === 'string') ? options.pad : '=', // base-64 pad character. Defaults to '=' for strict RFC compliance\n        utf8 = (options && typeof options.utf8 === 'boolean') ? options.utf8 : true; // enable/disable utf8 encoding\n\n      // privileged (public) methods\n      this.hex = function(s) {\n        return rstr2hex(rstr(s, utf8), hexcase);\n      };\n      this.b64 = function(s) {\n        return rstr2b64(rstr(s), b64pad);\n      };\n      this.any = function(s, e) {\n        return rstr2any(rstr(s, utf8), e);\n      };\n      this.raw = function(s) {\n        return rstr(s, utf8);\n      };\n      this.hex_hmac = function(k, d) {\n        return rstr2hex(rstr_hmac(k, d), hexcase);\n      };\n      this.b64_hmac = function(k, d) {\n        return rstr2b64(rstr_hmac(k, d), b64pad);\n      };\n      this.any_hmac = function(k, d, e) {\n        return rstr2any(rstr_hmac(k, d), e);\n      };\n      /**\n       * Perform a simple self-test to see if the VM is working\n       * @return {String} Hexadecimal hash sample\n       */\n      this.vm_test = function() {\n        return hex('abc').toLowerCase() === '900150983cd24fb0d6963f7d28e17f72';\n      };\n      /**\n       * Enable/disable uppercase hexadecimal returned string\n       * @param {Boolean}\n       * @return {Object} this\n       */\n      this.setUpperCase = function(a) {\n        if (typeof a === 'boolean') {\n          hexcase = a;\n        }\n        return this;\n      };\n      /**\n       * Defines a base64 pad string\n       * @param {String} Pad\n       * @return {Object} this\n       */\n      this.setPad = function(a) {\n        b64pad = a || b64pad;\n        return this;\n      };\n      /**\n       * Defines a base64 pad string\n       * @param {Boolean}\n       * @return {Object} [this]\n       */\n      this.setUTF8 = function(a) {\n        if (typeof a === 'boolean') {\n          utf8 = a;\n        }\n        return this;\n      };\n\n      // private methods\n\n      /**\n       * Calculate the MD5 of a raw string\n       */\n\n      function rstr(s) {\n        s = (utf8) ? utf8Encode(s) : s;\n        return binl2rstr(binl(rstr2binl(s), s.length * 8));\n      }\n\n      /**\n       * Calculate the HMAC-MD5, of a key and some data (raw strings)\n       */\n\n      function rstr_hmac(key, data) {\n        var bkey, ipad, opad, hash, i;\n\n        key = (utf8) ? utf8Encode(key) : key;\n        data = (utf8) ? utf8Encode(data) : data;\n        bkey = rstr2binl(key);\n        if (bkey.length > 16) {\n          bkey = binl(bkey, key.length * 8);\n        }\n\n        ipad = Array(16), opad = Array(16);\n        for (i = 0; i < 16; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5C5C5C5C;\n        }\n        hash = binl(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n        return binl2rstr(binl(opad.concat(hash), 512 + 128));\n      }\n\n      /**\n       * Calculate the MD5 of an array of little-endian words, and a bit length.\n       */\n\n      function binl(x, len) {\n        var i, olda, oldb, oldc, oldd,\n          a = 1732584193,\n          b = -271733879,\n          c = -1732584194,\n          d = 271733878;\n\n        /* append padding */\n        x[len >> 5] |= 0x80 << ((len) % 32);\n        x[(((len + 64) >>> 9) << 4) + 14] = len;\n\n        for (i = 0; i < x.length; i += 16) {\n          olda = a;\n          oldb = b;\n          oldc = c;\n          oldd = d;\n\n          a = md5_ff(a, b, c, d, x[i + 0], 7, -680876936);\n          d = md5_ff(d, a, b, c, x[i + 1], 12, -389564586);\n          c = md5_ff(c, d, a, b, x[i + 2], 17, 606105819);\n          b = md5_ff(b, c, d, a, x[i + 3], 22, -1044525330);\n          a = md5_ff(a, b, c, d, x[i + 4], 7, -176418897);\n          d = md5_ff(d, a, b, c, x[i + 5], 12, 1200080426);\n          c = md5_ff(c, d, a, b, x[i + 6], 17, -1473231341);\n          b = md5_ff(b, c, d, a, x[i + 7], 22, -45705983);\n          a = md5_ff(a, b, c, d, x[i + 8], 7, 1770035416);\n          d = md5_ff(d, a, b, c, x[i + 9], 12, -1958414417);\n          c = md5_ff(c, d, a, b, x[i + 10], 17, -42063);\n          b = md5_ff(b, c, d, a, x[i + 11], 22, -1990404162);\n          a = md5_ff(a, b, c, d, x[i + 12], 7, 1804603682);\n          d = md5_ff(d, a, b, c, x[i + 13], 12, -40341101);\n          c = md5_ff(c, d, a, b, x[i + 14], 17, -1502002290);\n          b = md5_ff(b, c, d, a, x[i + 15], 22, 1236535329);\n\n          a = md5_gg(a, b, c, d, x[i + 1], 5, -165796510);\n          d = md5_gg(d, a, b, c, x[i + 6], 9, -1069501632);\n          c = md5_gg(c, d, a, b, x[i + 11], 14, 643717713);\n          b = md5_gg(b, c, d, a, x[i + 0], 20, -373897302);\n          a = md5_gg(a, b, c, d, x[i + 5], 5, -701558691);\n          d = md5_gg(d, a, b, c, x[i + 10], 9, 38016083);\n          c = md5_gg(c, d, a, b, x[i + 15], 14, -660478335);\n          b = md5_gg(b, c, d, a, x[i + 4], 20, -405537848);\n          a = md5_gg(a, b, c, d, x[i + 9], 5, 568446438);\n          d = md5_gg(d, a, b, c, x[i + 14], 9, -1019803690);\n          c = md5_gg(c, d, a, b, x[i + 3], 14, -187363961);\n          b = md5_gg(b, c, d, a, x[i + 8], 20, 1163531501);\n          a = md5_gg(a, b, c, d, x[i + 13], 5, -1444681467);\n          d = md5_gg(d, a, b, c, x[i + 2], 9, -51403784);\n          c = md5_gg(c, d, a, b, x[i + 7], 14, 1735328473);\n          b = md5_gg(b, c, d, a, x[i + 12], 20, -1926607734);\n\n          a = md5_hh(a, b, c, d, x[i + 5], 4, -378558);\n          d = md5_hh(d, a, b, c, x[i + 8], 11, -2022574463);\n          c = md5_hh(c, d, a, b, x[i + 11], 16, 1839030562);\n          b = md5_hh(b, c, d, a, x[i + 14], 23, -35309556);\n          a = md5_hh(a, b, c, d, x[i + 1], 4, -1530992060);\n          d = md5_hh(d, a, b, c, x[i + 4], 11, 1272893353);\n          c = md5_hh(c, d, a, b, x[i + 7], 16, -155497632);\n          b = md5_hh(b, c, d, a, x[i + 10], 23, -1094730640);\n          a = md5_hh(a, b, c, d, x[i + 13], 4, 681279174);\n          d = md5_hh(d, a, b, c, x[i + 0], 11, -358537222);\n          c = md5_hh(c, d, a, b, x[i + 3], 16, -722521979);\n          b = md5_hh(b, c, d, a, x[i + 6], 23, 76029189);\n          a = md5_hh(a, b, c, d, x[i + 9], 4, -640364487);\n          d = md5_hh(d, a, b, c, x[i + 12], 11, -421815835);\n          c = md5_hh(c, d, a, b, x[i + 15], 16, 530742520);\n          b = md5_hh(b, c, d, a, x[i + 2], 23, -995338651);\n\n          a = md5_ii(a, b, c, d, x[i + 0], 6, -198630844);\n          d = md5_ii(d, a, b, c, x[i + 7], 10, 1126891415);\n          c = md5_ii(c, d, a, b, x[i + 14], 15, -1416354905);\n          b = md5_ii(b, c, d, a, x[i + 5], 21, -57434055);\n          a = md5_ii(a, b, c, d, x[i + 12], 6, 1700485571);\n          d = md5_ii(d, a, b, c, x[i + 3], 10, -1894986606);\n          c = md5_ii(c, d, a, b, x[i + 10], 15, -1051523);\n          b = md5_ii(b, c, d, a, x[i + 1], 21, -2054922799);\n          a = md5_ii(a, b, c, d, x[i + 8], 6, 1873313359);\n          d = md5_ii(d, a, b, c, x[i + 15], 10, -30611744);\n          c = md5_ii(c, d, a, b, x[i + 6], 15, -1560198380);\n          b = md5_ii(b, c, d, a, x[i + 13], 21, 1309151649);\n          a = md5_ii(a, b, c, d, x[i + 4], 6, -145523070);\n          d = md5_ii(d, a, b, c, x[i + 11], 10, -1120210379);\n          c = md5_ii(c, d, a, b, x[i + 2], 15, 718787259);\n          b = md5_ii(b, c, d, a, x[i + 9], 21, -343485551);\n\n          a = safe_add(a, olda);\n          b = safe_add(b, oldb);\n          c = safe_add(c, oldc);\n          d = safe_add(d, oldd);\n        }\n        return Array(a, b, c, d);\n      }\n\n      /**\n       * These functions implement the four basic operations the algorithm uses.\n       */\n\n      function md5_cmn(q, a, b, x, s, t) {\n        return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s), b);\n      }\n\n      function md5_ff(a, b, c, d, x, s, t) {\n        return md5_cmn((b & c) | ((~b) & d), a, b, x, s, t);\n      }\n\n      function md5_gg(a, b, c, d, x, s, t) {\n        return md5_cmn((b & d) | (c & (~d)), a, b, x, s, t);\n      }\n\n      function md5_hh(a, b, c, d, x, s, t) {\n        return md5_cmn(b ^ c ^ d, a, b, x, s, t);\n      }\n\n      function md5_ii(a, b, c, d, x, s, t) {\n        return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);\n      }\n    },\n    /**\n     * @member Hashes\n     * @class Hashes.SHA1\n     * @param {Object} [config]\n     * @constructor\n     *\n     * A JavaScript implementation of the Secure Hash Algorithm, SHA-1, as defined in FIPS 180-1\n     * Version 2.2 Copyright Paul Johnston 2000 - 2009.\n     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n     * See http://pajhome.org.uk/crypt/md5 for details.\n     */\n    SHA1: function(options) {\n      /**\n       * Private config properties. You may need to tweak these to be compatible with\n       * the server-side, but the defaults work in most cases.\n       * See {@link Hashes.MD5#method-setUpperCase} and {@link Hashes.SHA1#method-setUpperCase}\n       */\n      var hexcase = (options && typeof options.uppercase === 'boolean') ? options.uppercase : false, // hexadecimal output case format. false - lowercase; true - uppercase\n        b64pad = (options && typeof options.pad === 'string') ? options.pad : '=', // base-64 pad character. Defaults to '=' for strict RFC compliance\n        utf8 = (options && typeof options.utf8 === 'boolean') ? options.utf8 : true; // enable/disable utf8 encoding\n\n      // public methods\n      this.hex = function(s) {\n        return rstr2hex(rstr(s, utf8), hexcase);\n      };\n      this.b64 = function(s) {\n        return rstr2b64(rstr(s, utf8), b64pad);\n      };\n      this.any = function(s, e) {\n        return rstr2any(rstr(s, utf8), e);\n      };\n      this.raw = function(s) {\n        return rstr(s, utf8);\n      };\n      this.hex_hmac = function(k, d) {\n        return rstr2hex(rstr_hmac(k, d));\n      };\n      this.b64_hmac = function(k, d) {\n        return rstr2b64(rstr_hmac(k, d), b64pad);\n      };\n      this.any_hmac = function(k, d, e) {\n        return rstr2any(rstr_hmac(k, d), e);\n      };\n      /**\n       * Perform a simple self-test to see if the VM is working\n       * @return {String} Hexadecimal hash sample\n       * @public\n       */\n      this.vm_test = function() {\n        return hex('abc').toLowerCase() === '900150983cd24fb0d6963f7d28e17f72';\n      };\n      /**\n       * @description Enable/disable uppercase hexadecimal returned string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUpperCase = function(a) {\n        if (typeof a === 'boolean') {\n          hexcase = a;\n        }\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {string} Pad\n       * @return {Object} this\n       * @public\n       */\n      this.setPad = function(a) {\n        b64pad = a || b64pad;\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUTF8 = function(a) {\n        if (typeof a === 'boolean') {\n          utf8 = a;\n        }\n        return this;\n      };\n\n      // private methods\n\n      /**\n       * Calculate the SHA-512 of a raw string\n       */\n\n      function rstr(s) {\n        s = (utf8) ? utf8Encode(s) : s;\n        return binb2rstr(binb(rstr2binb(s), s.length * 8));\n      }\n\n      /**\n       * Calculate the HMAC-SHA1 of a key and some data (raw strings)\n       */\n\n      function rstr_hmac(key, data) {\n        var bkey, ipad, opad, i, hash;\n        key = (utf8) ? utf8Encode(key) : key;\n        data = (utf8) ? utf8Encode(data) : data;\n        bkey = rstr2binb(key);\n\n        if (bkey.length > 16) {\n          bkey = binb(bkey, key.length * 8);\n        }\n        ipad = Array(16), opad = Array(16);\n        for (i = 0; i < 16; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5C5C5C5C;\n        }\n        hash = binb(ipad.concat(rstr2binb(data)), 512 + data.length * 8);\n        return binb2rstr(binb(opad.concat(hash), 512 + 160));\n      }\n\n      /**\n       * Calculate the SHA-1 of an array of big-endian words, and a bit length\n       */\n\n      function binb(x, len) {\n        var i, j, t, olda, oldb, oldc, oldd, olde,\n          w = Array(80),\n          a = 1732584193,\n          b = -271733879,\n          c = -1732584194,\n          d = 271733878,\n          e = -1009589776;\n\n        /* append padding */\n        x[len >> 5] |= 0x80 << (24 - len % 32);\n        x[((len + 64 >> 9) << 4) + 15] = len;\n\n        for (i = 0; i < x.length; i += 16) {\n          olda = a;\n          oldb = b;\n          oldc = c;\n          oldd = d;\n          olde = e;\n\n          for (j = 0; j < 80; j += 1) {\n            if (j < 16) {\n              w[j] = x[i + j];\n            } else {\n              w[j] = bit_rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1);\n            }\n            t = safe_add(safe_add(bit_rol(a, 5), sha1_ft(j, b, c, d)),\n              safe_add(safe_add(e, w[j]), sha1_kt(j)));\n            e = d;\n            d = c;\n            c = bit_rol(b, 30);\n            b = a;\n            a = t;\n          }\n\n          a = safe_add(a, olda);\n          b = safe_add(b, oldb);\n          c = safe_add(c, oldc);\n          d = safe_add(d, oldd);\n          e = safe_add(e, olde);\n        }\n        return Array(a, b, c, d, e);\n      }\n\n      /**\n       * Perform the appropriate triplet combination function for the current\n       * iteration\n       */\n\n      function sha1_ft(t, b, c, d) {\n        if (t < 20) {\n          return (b & c) | ((~b) & d);\n        }\n        if (t < 40) {\n          return b ^ c ^ d;\n        }\n        if (t < 60) {\n          return (b & c) | (b & d) | (c & d);\n        }\n        return b ^ c ^ d;\n      }\n\n      /**\n       * Determine the appropriate additive constant for the current iteration\n       */\n\n      function sha1_kt(t) {\n        return (t < 20) ? 1518500249 : (t < 40) ? 1859775393 :\n          (t < 60) ? -1894007588 : -899497514;\n      }\n    },\n    /**\n     * @class Hashes.SHA256\n     * @param {config}\n     *\n     * A JavaScript implementation of the Secure Hash Algorithm, SHA-256, as defined in FIPS 180-2\n     * Version 2.2 Copyright Angel Marin, Paul Johnston 2000 - 2009.\n     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n     * See http://pajhome.org.uk/crypt/md5 for details.\n     * Also http://anmar.eu.org/projects/jssha2/\n     */\n    SHA256: function(options) {\n      /**\n       * Private properties configuration variables. You may need to tweak these to be compatible with\n       * the server-side, but the defaults work in most cases.\n       * @see this.setUpperCase() method\n       * @see this.setPad() method\n       */\n      var hexcase = (options && typeof options.uppercase === 'boolean') ? options.uppercase : false, // hexadecimal output case format. false - lowercase; true - uppercase  */\n        b64pad = (options && typeof options.pad === 'string') ? options.pad : '=',\n        /* base-64 pad character. Default '=' for strict RFC compliance   */\n        utf8 = (options && typeof options.utf8 === 'boolean') ? options.utf8 : true,\n        /* enable/disable utf8 encoding */\n        sha256_K;\n\n      /* privileged (public) methods */\n      this.hex = function(s) {\n        return rstr2hex(rstr(s, utf8));\n      };\n      this.b64 = function(s) {\n        return rstr2b64(rstr(s, utf8), b64pad);\n      };\n      this.any = function(s, e) {\n        return rstr2any(rstr(s, utf8), e);\n      };\n      this.raw = function(s) {\n        return rstr(s, utf8);\n      };\n      this.hex_hmac = function(k, d) {\n        return rstr2hex(rstr_hmac(k, d));\n      };\n      this.b64_hmac = function(k, d) {\n        return rstr2b64(rstr_hmac(k, d), b64pad);\n      };\n      this.any_hmac = function(k, d, e) {\n        return rstr2any(rstr_hmac(k, d), e);\n      };\n      /**\n       * Perform a simple self-test to see if the VM is working\n       * @return {String} Hexadecimal hash sample\n       * @public\n       */\n      this.vm_test = function() {\n        return hex('abc').toLowerCase() === '900150983cd24fb0d6963f7d28e17f72';\n      };\n      /**\n       * Enable/disable uppercase hexadecimal returned string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUpperCase = function(a) {\n        if (typeof a === 'boolean') {\n          hexcase = a;\n        }\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {string} Pad\n       * @return {Object} this\n       * @public\n       */\n      this.setPad = function(a) {\n        b64pad = a || b64pad;\n        return this;\n      };\n      /**\n       * Defines a base64 pad string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUTF8 = function(a) {\n        if (typeof a === 'boolean') {\n          utf8 = a;\n        }\n        return this;\n      };\n\n      // private methods\n\n      /**\n       * Calculate the SHA-512 of a raw string\n       */\n\n      function rstr(s, utf8) {\n        s = (utf8) ? utf8Encode(s) : s;\n        return binb2rstr(binb(rstr2binb(s), s.length * 8));\n      }\n\n      /**\n       * Calculate the HMAC-sha256 of a key and some data (raw strings)\n       */\n\n      function rstr_hmac(key, data) {\n        key = (utf8) ? utf8Encode(key) : key;\n        data = (utf8) ? utf8Encode(data) : data;\n        var hash, i = 0,\n          bkey = rstr2binb(key),\n          ipad = Array(16),\n          opad = Array(16);\n\n        if (bkey.length > 16) {\n          bkey = binb(bkey, key.length * 8);\n        }\n\n        for (; i < 16; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5C5C5C5C;\n        }\n\n        hash = binb(ipad.concat(rstr2binb(data)), 512 + data.length * 8);\n        return binb2rstr(binb(opad.concat(hash), 512 + 256));\n      }\n\n      /*\n       * Main sha256 function, with its support functions\n       */\n\n      function sha256_S(X, n) {\n        return (X >>> n) | (X << (32 - n));\n      }\n\n      function sha256_R(X, n) {\n        return (X >>> n);\n      }\n\n      function sha256_Ch(x, y, z) {\n        return ((x & y) ^ ((~x) & z));\n      }\n\n      function sha256_Maj(x, y, z) {\n        return ((x & y) ^ (x & z) ^ (y & z));\n      }\n\n      function sha256_Sigma0256(x) {\n        return (sha256_S(x, 2) ^ sha256_S(x, 13) ^ sha256_S(x, 22));\n      }\n\n      function sha256_Sigma1256(x) {\n        return (sha256_S(x, 6) ^ sha256_S(x, 11) ^ sha256_S(x, 25));\n      }\n\n      function sha256_Gamma0256(x) {\n        return (sha256_S(x, 7) ^ sha256_S(x, 18) ^ sha256_R(x, 3));\n      }\n\n      function sha256_Gamma1256(x) {\n        return (sha256_S(x, 17) ^ sha256_S(x, 19) ^ sha256_R(x, 10));\n      }\n\n      function sha256_Sigma0512(x) {\n        return (sha256_S(x, 28) ^ sha256_S(x, 34) ^ sha256_S(x, 39));\n      }\n\n      function sha256_Sigma1512(x) {\n        return (sha256_S(x, 14) ^ sha256_S(x, 18) ^ sha256_S(x, 41));\n      }\n\n      function sha256_Gamma0512(x) {\n        return (sha256_S(x, 1) ^ sha256_S(x, 8) ^ sha256_R(x, 7));\n      }\n\n      function sha256_Gamma1512(x) {\n        return (sha256_S(x, 19) ^ sha256_S(x, 61) ^ sha256_R(x, 6));\n      }\n\n      sha256_K = [\n        1116352408, 1899447441, -1245643825, -373957723, 961987163, 1508970993, -1841331548, -1424204075, -670586216, 310598401, 607225278, 1426881987,\n        1925078388, -2132889090, -1680079193, -1046744716, -459576895, -272742522,\n        264347078, 604807628, 770255983, 1249150122, 1555081692, 1996064986, -1740746414, -1473132947, -1341970488, -1084653625, -958395405, -710438585,\n        113926993, 338241895, 666307205, 773529912, 1294757372, 1396182291,\n        1695183700, 1986661051, -2117940946, -1838011259, -1564481375, -1474664885, -1035236496, -949202525, -778901479, -694614492, -200395387, 275423344,\n        430227734, 506948616, 659060556, 883997877, 958139571, 1322822218,\n        1537002063, 1747873779, 1955562222, 2024104815, -2067236844, -1933114872, -1866530822, -1538233109, -1090935817, -965641998\n      ];\n\n      function binb(m, l) {\n        var HASH = [1779033703, -1150833019, 1013904242, -1521486534,\n          1359893119, -1694144372, 528734635, 1541459225\n        ];\n        var W = new Array(64);\n        var a, b, c, d, e, f, g, h;\n        var i, j, T1, T2;\n\n        /* append padding */\n        m[l >> 5] |= 0x80 << (24 - l % 32);\n        m[((l + 64 >> 9) << 4) + 15] = l;\n\n        for (i = 0; i < m.length; i += 16) {\n          a = HASH[0];\n          b = HASH[1];\n          c = HASH[2];\n          d = HASH[3];\n          e = HASH[4];\n          f = HASH[5];\n          g = HASH[6];\n          h = HASH[7];\n\n          for (j = 0; j < 64; j += 1) {\n            if (j < 16) {\n              W[j] = m[j + i];\n            } else {\n              W[j] = safe_add(safe_add(safe_add(sha256_Gamma1256(W[j - 2]), W[j - 7]),\n                sha256_Gamma0256(W[j - 15])), W[j - 16]);\n            }\n\n            T1 = safe_add(safe_add(safe_add(safe_add(h, sha256_Sigma1256(e)), sha256_Ch(e, f, g)),\n              sha256_K[j]), W[j]);\n            T2 = safe_add(sha256_Sigma0256(a), sha256_Maj(a, b, c));\n            h = g;\n            g = f;\n            f = e;\n            e = safe_add(d, T1);\n            d = c;\n            c = b;\n            b = a;\n            a = safe_add(T1, T2);\n          }\n\n          HASH[0] = safe_add(a, HASH[0]);\n          HASH[1] = safe_add(b, HASH[1]);\n          HASH[2] = safe_add(c, HASH[2]);\n          HASH[3] = safe_add(d, HASH[3]);\n          HASH[4] = safe_add(e, HASH[4]);\n          HASH[5] = safe_add(f, HASH[5]);\n          HASH[6] = safe_add(g, HASH[6]);\n          HASH[7] = safe_add(h, HASH[7]);\n        }\n        return HASH;\n      }\n\n    },\n\n    /**\n     * @class Hashes.SHA512\n     * @param {config}\n     *\n     * A JavaScript implementation of the Secure Hash Algorithm, SHA-512, as defined in FIPS 180-2\n     * Version 2.2 Copyright Anonymous Contributor, Paul Johnston 2000 - 2009.\n     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n     * See http://pajhome.org.uk/crypt/md5 for details.\n     */\n    SHA512: function(options) {\n      /**\n       * Private properties configuration variables. You may need to tweak these to be compatible with\n       * the server-side, but the defaults work in most cases.\n       * @see this.setUpperCase() method\n       * @see this.setPad() method\n       */\n      var hexcase = (options && typeof options.uppercase === 'boolean') ? options.uppercase : false,\n        /* hexadecimal output case format. false - lowercase; true - uppercase  */\n        b64pad = (options && typeof options.pad === 'string') ? options.pad : '=',\n        /* base-64 pad character. Default '=' for strict RFC compliance   */\n        utf8 = (options && typeof options.utf8 === 'boolean') ? options.utf8 : true,\n        /* enable/disable utf8 encoding */\n        sha512_k;\n\n      /* privileged (public) methods */\n      this.hex = function(s) {\n        return rstr2hex(rstr(s));\n      };\n      this.b64 = function(s) {\n        return rstr2b64(rstr(s), b64pad);\n      };\n      this.any = function(s, e) {\n        return rstr2any(rstr(s), e);\n      };\n      this.raw = function(s) {\n        return rstr(s, utf8);\n      };\n      this.hex_hmac = function(k, d) {\n        return rstr2hex(rstr_hmac(k, d));\n      };\n      this.b64_hmac = function(k, d) {\n        return rstr2b64(rstr_hmac(k, d), b64pad);\n      };\n      this.any_hmac = function(k, d, e) {\n        return rstr2any(rstr_hmac(k, d), e);\n      };\n      /**\n       * Perform a simple self-test to see if the VM is working\n       * @return {String} Hexadecimal hash sample\n       * @public\n       */\n      this.vm_test = function() {\n        return hex('abc').toLowerCase() === '900150983cd24fb0d6963f7d28e17f72';\n      };\n      /**\n       * @description Enable/disable uppercase hexadecimal returned string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUpperCase = function(a) {\n        if (typeof a === 'boolean') {\n          hexcase = a;\n        }\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {string} Pad\n       * @return {Object} this\n       * @public\n       */\n      this.setPad = function(a) {\n        b64pad = a || b64pad;\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUTF8 = function(a) {\n        if (typeof a === 'boolean') {\n          utf8 = a;\n        }\n        return this;\n      };\n\n      /* private methods */\n\n      /**\n       * Calculate the SHA-512 of a raw string\n       */\n\n      function rstr(s) {\n        s = (utf8) ? utf8Encode(s) : s;\n        return binb2rstr(binb(rstr2binb(s), s.length * 8));\n      }\n      /*\n       * Calculate the HMAC-SHA-512 of a key and some data (raw strings)\n       */\n\n      function rstr_hmac(key, data) {\n        key = (utf8) ? utf8Encode(key) : key;\n        data = (utf8) ? utf8Encode(data) : data;\n\n        var hash, i = 0,\n          bkey = rstr2binb(key),\n          ipad = Array(32),\n          opad = Array(32);\n\n        if (bkey.length > 32) {\n          bkey = binb(bkey, key.length * 8);\n        }\n\n        for (; i < 32; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5C5C5C5C;\n        }\n\n        hash = binb(ipad.concat(rstr2binb(data)), 1024 + data.length * 8);\n        return binb2rstr(binb(opad.concat(hash), 1024 + 512));\n      }\n\n      /**\n       * Calculate the SHA-512 of an array of big-endian dwords, and a bit length\n       */\n\n      function binb(x, len) {\n        var j, i, l,\n          W = new Array(80),\n          hash = new Array(16),\n          //Initial hash values\n          H = [\n            new int64(0x6a09e667, -205731576),\n            new int64(-1150833019, -2067093701),\n            new int64(0x3c6ef372, -23791573),\n            new int64(-1521486534, 0x5f1d36f1),\n            new int64(0x510e527f, -1377402159),\n            new int64(-1694144372, 0x2b3e6c1f),\n            new int64(0x1f83d9ab, -79577749),\n            new int64(0x5be0cd19, 0x137e2179)\n          ],\n          T1 = new int64(0, 0),\n          T2 = new int64(0, 0),\n          a = new int64(0, 0),\n          b = new int64(0, 0),\n          c = new int64(0, 0),\n          d = new int64(0, 0),\n          e = new int64(0, 0),\n          f = new int64(0, 0),\n          g = new int64(0, 0),\n          h = new int64(0, 0),\n          //Temporary variables not specified by the document\n          s0 = new int64(0, 0),\n          s1 = new int64(0, 0),\n          Ch = new int64(0, 0),\n          Maj = new int64(0, 0),\n          r1 = new int64(0, 0),\n          r2 = new int64(0, 0),\n          r3 = new int64(0, 0);\n\n        if (sha512_k === undefined) {\n          //SHA512 constants\n          sha512_k = [\n            new int64(0x428a2f98, -685199838), new int64(0x71374491, 0x23ef65cd),\n            new int64(-1245643825, -330482897), new int64(-373957723, -2121671748),\n            new int64(0x3956c25b, -213338824), new int64(0x59f111f1, -1241133031),\n            new int64(-1841331548, -1357295717), new int64(-1424204075, -630357736),\n            new int64(-670586216, -1560083902), new int64(0x12835b01, 0x45706fbe),\n            new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, -704662302),\n            new int64(0x72be5d74, -226784913), new int64(-2132889090, 0x3b1696b1),\n            new int64(-1680079193, 0x25c71235), new int64(-1046744716, -815192428),\n            new int64(-459576895, -1628353838), new int64(-272742522, 0x384f25e3),\n            new int64(0xfc19dc6, -1953704523), new int64(0x240ca1cc, 0x77ac9c65),\n            new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\n            new int64(0x5cb0a9dc, -1119749164), new int64(0x76f988da, -2096016459),\n            new int64(-1740746414, -295247957), new int64(-1473132947, 0x2db43210),\n            new int64(-1341970488, -1728372417), new int64(-1084653625, -1091629340),\n            new int64(-958395405, 0x3da88fc2), new int64(-710438585, -1828018395),\n            new int64(0x6ca6351, -536640913), new int64(0x14292967, 0xa0e6e70),\n            new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\n            new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, -1651133473),\n            new int64(0x650a7354, -1951439906), new int64(0x766a0abb, 0x3c77b2a8),\n            new int64(-2117940946, 0x47edaee6), new int64(-1838011259, 0x1482353b),\n            new int64(-1564481375, 0x4cf10364), new int64(-1474664885, -1136513023),\n            new int64(-1035236496, -789014639), new int64(-949202525, 0x654be30),\n            new int64(-778901479, -688958952), new int64(-694614492, 0x5565a910),\n            new int64(-200395387, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\n            new int64(0x19a4c116, -1194143544), new int64(0x1e376c08, 0x5141ab53),\n            new int64(0x2748774c, -544281703), new int64(0x34b0bcb5, -509917016),\n            new int64(0x391c0cb3, -976659869), new int64(0x4ed8aa4a, -482243893),\n            new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, -692930397),\n            new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\n            new int64(-2067236844, -1578062990), new int64(-1933114872, 0x1a6439ec),\n            new int64(-1866530822, 0x23631e28), new int64(-1538233109, -561857047),\n            new int64(-1090935817, -1295615723), new int64(-965641998, -479046869),\n            new int64(-903397682, -366583396), new int64(-779700025, 0x21c0c207),\n            new int64(-354779690, -840897762), new int64(-176337025, -294727304),\n            new int64(0x6f067aa, 0x72176fba), new int64(0xa637dc5, -1563912026),\n            new int64(0x113f9804, -1090974290), new int64(0x1b710b35, 0x131c471b),\n            new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\n            new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, -1676669620),\n            new int64(0x4cc5d4be, -885112138), new int64(0x597f299c, -60457430),\n            new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)\n          ];\n        }\n\n        for (i = 0; i < 80; i += 1) {\n          W[i] = new int64(0, 0);\n        }\n\n        // append padding to the source string. The format is described in the FIPS.\n        x[len >> 5] |= 0x80 << (24 - (len & 0x1f));\n        x[((len + 128 >> 10) << 5) + 31] = len;\n        l = x.length;\n        for (i = 0; i < l; i += 32) { //32 dwords is the block size\n          int64copy(a, H[0]);\n          int64copy(b, H[1]);\n          int64copy(c, H[2]);\n          int64copy(d, H[3]);\n          int64copy(e, H[4]);\n          int64copy(f, H[5]);\n          int64copy(g, H[6]);\n          int64copy(h, H[7]);\n\n          for (j = 0; j < 16; j += 1) {\n            W[j].h = x[i + 2 * j];\n            W[j].l = x[i + 2 * j + 1];\n          }\n\n          for (j = 16; j < 80; j += 1) {\n            //sigma1\n            int64rrot(r1, W[j - 2], 19);\n            int64revrrot(r2, W[j - 2], 29);\n            int64shr(r3, W[j - 2], 6);\n            s1.l = r1.l ^ r2.l ^ r3.l;\n            s1.h = r1.h ^ r2.h ^ r3.h;\n            //sigma0\n            int64rrot(r1, W[j - 15], 1);\n            int64rrot(r2, W[j - 15], 8);\n            int64shr(r3, W[j - 15], 7);\n            s0.l = r1.l ^ r2.l ^ r3.l;\n            s0.h = r1.h ^ r2.h ^ r3.h;\n\n            int64add4(W[j], s1, W[j - 7], s0, W[j - 16]);\n          }\n\n          for (j = 0; j < 80; j += 1) {\n            //Ch\n            Ch.l = (e.l & f.l) ^ (~e.l & g.l);\n            Ch.h = (e.h & f.h) ^ (~e.h & g.h);\n\n            //Sigma1\n            int64rrot(r1, e, 14);\n            int64rrot(r2, e, 18);\n            int64revrrot(r3, e, 9);\n            s1.l = r1.l ^ r2.l ^ r3.l;\n            s1.h = r1.h ^ r2.h ^ r3.h;\n\n            //Sigma0\n            int64rrot(r1, a, 28);\n            int64revrrot(r2, a, 2);\n            int64revrrot(r3, a, 7);\n            s0.l = r1.l ^ r2.l ^ r3.l;\n            s0.h = r1.h ^ r2.h ^ r3.h;\n\n            //Maj\n            Maj.l = (a.l & b.l) ^ (a.l & c.l) ^ (b.l & c.l);\n            Maj.h = (a.h & b.h) ^ (a.h & c.h) ^ (b.h & c.h);\n\n            int64add5(T1, h, s1, Ch, sha512_k[j], W[j]);\n            int64add(T2, s0, Maj);\n\n            int64copy(h, g);\n            int64copy(g, f);\n            int64copy(f, e);\n            int64add(e, d, T1);\n            int64copy(d, c);\n            int64copy(c, b);\n            int64copy(b, a);\n            int64add(a, T1, T2);\n          }\n          int64add(H[0], H[0], a);\n          int64add(H[1], H[1], b);\n          int64add(H[2], H[2], c);\n          int64add(H[3], H[3], d);\n          int64add(H[4], H[4], e);\n          int64add(H[5], H[5], f);\n          int64add(H[6], H[6], g);\n          int64add(H[7], H[7], h);\n        }\n\n        //represent the hash as an array of 32-bit dwords\n        for (i = 0; i < 8; i += 1) {\n          hash[2 * i] = H[i].h;\n          hash[2 * i + 1] = H[i].l;\n        }\n        return hash;\n      }\n\n      //A constructor for 64-bit numbers\n\n      function int64(h, l) {\n        this.h = h;\n        this.l = l;\n        //this.toString = int64toString;\n      }\n\n      //Copies src into dst, assuming both are 64-bit numbers\n\n      function int64copy(dst, src) {\n        dst.h = src.h;\n        dst.l = src.l;\n      }\n\n      //Right-rotates a 64-bit number by shift\n      //Won't handle cases of shift>=32\n      //The function revrrot() is for that\n\n      function int64rrot(dst, x, shift) {\n        dst.l = (x.l >>> shift) | (x.h << (32 - shift));\n        dst.h = (x.h >>> shift) | (x.l << (32 - shift));\n      }\n\n      //Reverses the dwords of the source and then rotates right by shift.\n      //This is equivalent to rotation by 32+shift\n\n      function int64revrrot(dst, x, shift) {\n        dst.l = (x.h >>> shift) | (x.l << (32 - shift));\n        dst.h = (x.l >>> shift) | (x.h << (32 - shift));\n      }\n\n      //Bitwise-shifts right a 64-bit number by shift\n      //Won't handle shift>=32, but it's never needed in SHA512\n\n      function int64shr(dst, x, shift) {\n        dst.l = (x.l >>> shift) | (x.h << (32 - shift));\n        dst.h = (x.h >>> shift);\n      }\n\n      //Adds two 64-bit numbers\n      //Like the original implementation, does not rely on 32-bit operations\n\n      function int64add(dst, x, y) {\n        var w0 = (x.l & 0xffff) + (y.l & 0xffff);\n        var w1 = (x.l >>> 16) + (y.l >>> 16) + (w0 >>> 16);\n        var w2 = (x.h & 0xffff) + (y.h & 0xffff) + (w1 >>> 16);\n        var w3 = (x.h >>> 16) + (y.h >>> 16) + (w2 >>> 16);\n        dst.l = (w0 & 0xffff) | (w1 << 16);\n        dst.h = (w2 & 0xffff) | (w3 << 16);\n      }\n\n      //Same, except with 4 addends. Works faster than adding them one by one.\n\n      function int64add4(dst, a, b, c, d) {\n        var w0 = (a.l & 0xffff) + (b.l & 0xffff) + (c.l & 0xffff) + (d.l & 0xffff);\n        var w1 = (a.l >>> 16) + (b.l >>> 16) + (c.l >>> 16) + (d.l >>> 16) + (w0 >>> 16);\n        var w2 = (a.h & 0xffff) + (b.h & 0xffff) + (c.h & 0xffff) + (d.h & 0xffff) + (w1 >>> 16);\n        var w3 = (a.h >>> 16) + (b.h >>> 16) + (c.h >>> 16) + (d.h >>> 16) + (w2 >>> 16);\n        dst.l = (w0 & 0xffff) | (w1 << 16);\n        dst.h = (w2 & 0xffff) | (w3 << 16);\n      }\n\n      //Same, except with 5 addends\n\n      function int64add5(dst, a, b, c, d, e) {\n        var w0 = (a.l & 0xffff) + (b.l & 0xffff) + (c.l & 0xffff) + (d.l & 0xffff) + (e.l & 0xffff),\n          w1 = (a.l >>> 16) + (b.l >>> 16) + (c.l >>> 16) + (d.l >>> 16) + (e.l >>> 16) + (w0 >>> 16),\n          w2 = (a.h & 0xffff) + (b.h & 0xffff) + (c.h & 0xffff) + (d.h & 0xffff) + (e.h & 0xffff) + (w1 >>> 16),\n          w3 = (a.h >>> 16) + (b.h >>> 16) + (c.h >>> 16) + (d.h >>> 16) + (e.h >>> 16) + (w2 >>> 16);\n        dst.l = (w0 & 0xffff) | (w1 << 16);\n        dst.h = (w2 & 0xffff) | (w3 << 16);\n      }\n    },\n    /**\n     * @class Hashes.RMD160\n     * @constructor\n     * @param {Object} [config]\n     *\n     * A JavaScript implementation of the RIPEMD-160 Algorithm\n     * Version 2.2 Copyright Jeremy Lin, Paul Johnston 2000 - 2009.\n     * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n     * See http://pajhome.org.uk/crypt/md5 for details.\n     * Also http://www.ocf.berkeley.edu/~jjlin/jsotp/\n     */\n    RMD160: function(options) {\n      /**\n       * Private properties configuration variables. You may need to tweak these to be compatible with\n       * the server-side, but the defaults work in most cases.\n       * @see this.setUpperCase() method\n       * @see this.setPad() method\n       */\n      var hexcase = (options && typeof options.uppercase === 'boolean') ? options.uppercase : false,\n        /* hexadecimal output case format. false - lowercase; true - uppercase  */\n        b64pad = (options && typeof options.pad === 'string') ? options.pa : '=',\n        /* base-64 pad character. Default '=' for strict RFC compliance   */\n        utf8 = (options && typeof options.utf8 === 'boolean') ? options.utf8 : true,\n        /* enable/disable utf8 encoding */\n        rmd160_r1 = [\n          0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,\n          7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8,\n          3, 10, 14, 4, 9, 15, 8, 1, 2, 7, 0, 6, 13, 11, 5, 12,\n          1, 9, 11, 10, 0, 8, 12, 4, 13, 3, 7, 15, 14, 5, 6, 2,\n          4, 0, 5, 9, 7, 12, 2, 10, 14, 1, 3, 8, 11, 6, 15, 13\n        ],\n        rmd160_r2 = [\n          5, 14, 7, 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12,\n          6, 11, 3, 7, 0, 13, 5, 10, 14, 15, 8, 12, 4, 9, 1, 2,\n          15, 5, 1, 3, 7, 14, 6, 9, 11, 8, 12, 2, 10, 0, 4, 13,\n          8, 6, 4, 1, 3, 11, 15, 0, 5, 12, 2, 13, 9, 7, 10, 14,\n          12, 15, 10, 4, 1, 5, 8, 7, 6, 2, 13, 14, 0, 3, 9, 11\n        ],\n        rmd160_s1 = [\n          11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8,\n          7, 6, 8, 13, 11, 9, 7, 15, 7, 12, 15, 9, 11, 7, 13, 12,\n          11, 13, 6, 7, 14, 9, 13, 15, 14, 8, 13, 6, 5, 12, 7, 5,\n          11, 12, 14, 15, 14, 15, 9, 8, 9, 14, 5, 6, 8, 6, 5, 12,\n          9, 15, 5, 11, 6, 8, 13, 12, 5, 12, 13, 14, 11, 8, 5, 6\n        ],\n        rmd160_s2 = [\n          8, 9, 9, 11, 13, 15, 15, 5, 7, 7, 8, 11, 14, 14, 12, 6,\n          9, 13, 15, 7, 12, 8, 9, 11, 7, 7, 12, 7, 6, 15, 13, 11,\n          9, 7, 15, 11, 8, 6, 6, 14, 12, 13, 5, 14, 13, 13, 7, 5,\n          15, 5, 8, 11, 14, 14, 6, 14, 6, 9, 12, 9, 12, 5, 15, 8,\n          8, 5, 12, 9, 12, 5, 14, 6, 8, 13, 6, 5, 15, 13, 11, 11\n        ];\n\n      /* privileged (public) methods */\n      this.hex = function(s) {\n        return rstr2hex(rstr(s, utf8));\n      };\n      this.b64 = function(s) {\n        return rstr2b64(rstr(s, utf8), b64pad);\n      };\n      this.any = function(s, e) {\n        return rstr2any(rstr(s, utf8), e);\n      };\n      this.raw = function(s) {\n        return rstr(s, utf8);\n      };\n      this.hex_hmac = function(k, d) {\n        return rstr2hex(rstr_hmac(k, d));\n      };\n      this.b64_hmac = function(k, d) {\n        return rstr2b64(rstr_hmac(k, d), b64pad);\n      };\n      this.any_hmac = function(k, d, e) {\n        return rstr2any(rstr_hmac(k, d), e);\n      };\n      /**\n       * Perform a simple self-test to see if the VM is working\n       * @return {String} Hexadecimal hash sample\n       * @public\n       */\n      this.vm_test = function() {\n        return hex('abc').toLowerCase() === '900150983cd24fb0d6963f7d28e17f72';\n      };\n      /**\n       * @description Enable/disable uppercase hexadecimal returned string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUpperCase = function(a) {\n        if (typeof a === 'boolean') {\n          hexcase = a;\n        }\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {string} Pad\n       * @return {Object} this\n       * @public\n       */\n      this.setPad = function(a) {\n        if (typeof a !== 'undefined') {\n          b64pad = a;\n        }\n        return this;\n      };\n      /**\n       * @description Defines a base64 pad string\n       * @param {boolean}\n       * @return {Object} this\n       * @public\n       */\n      this.setUTF8 = function(a) {\n        if (typeof a === 'boolean') {\n          utf8 = a;\n        }\n        return this;\n      };\n\n      /* private methods */\n\n      /**\n       * Calculate the rmd160 of a raw string\n       */\n\n      function rstr(s) {\n        s = (utf8) ? utf8Encode(s) : s;\n        return binl2rstr(binl(rstr2binl(s), s.length * 8));\n      }\n\n      /**\n       * Calculate the HMAC-rmd160 of a key and some data (raw strings)\n       */\n\n      function rstr_hmac(key, data) {\n        key = (utf8) ? utf8Encode(key) : key;\n        data = (utf8) ? utf8Encode(data) : data;\n        var i, hash,\n          bkey = rstr2binl(key),\n          ipad = Array(16),\n          opad = Array(16);\n\n        if (bkey.length > 16) {\n          bkey = binl(bkey, key.length * 8);\n        }\n\n        for (i = 0; i < 16; i += 1) {\n          ipad[i] = bkey[i] ^ 0x36363636;\n          opad[i] = bkey[i] ^ 0x5C5C5C5C;\n        }\n        hash = binl(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n        return binl2rstr(binl(opad.concat(hash), 512 + 160));\n      }\n\n      /**\n       * Convert an array of little-endian words to a string\n       */\n\n      function binl2rstr(input) {\n        var i, output = '',\n          l = input.length * 32;\n        for (i = 0; i < l; i += 8) {\n          output += String.fromCharCode((input[i >> 5] >>> (i % 32)) & 0xFF);\n        }\n        return output;\n      }\n\n      /**\n       * Calculate the RIPE-MD160 of an array of little-endian words, and a bit length.\n       */\n\n      function binl(x, len) {\n        var T, j, i, l,\n          h0 = 0x67452301,\n          h1 = 0xefcdab89,\n          h2 = 0x98badcfe,\n          h3 = 0x10325476,\n          h4 = 0xc3d2e1f0,\n          A1, B1, C1, D1, E1,\n          A2, B2, C2, D2, E2;\n\n        /* append padding */\n        x[len >> 5] |= 0x80 << (len % 32);\n        x[(((len + 64) >>> 9) << 4) + 14] = len;\n        l = x.length;\n\n        for (i = 0; i < l; i += 16) {\n          A1 = A2 = h0;\n          B1 = B2 = h1;\n          C1 = C2 = h2;\n          D1 = D2 = h3;\n          E1 = E2 = h4;\n          for (j = 0; j <= 79; j += 1) {\n            T = safe_add(A1, rmd160_f(j, B1, C1, D1));\n            T = safe_add(T, x[i + rmd160_r1[j]]);\n            T = safe_add(T, rmd160_K1(j));\n            T = safe_add(bit_rol(T, rmd160_s1[j]), E1);\n            A1 = E1;\n            E1 = D1;\n            D1 = bit_rol(C1, 10);\n            C1 = B1;\n            B1 = T;\n            T = safe_add(A2, rmd160_f(79 - j, B2, C2, D2));\n            T = safe_add(T, x[i + rmd160_r2[j]]);\n            T = safe_add(T, rmd160_K2(j));\n            T = safe_add(bit_rol(T, rmd160_s2[j]), E2);\n            A2 = E2;\n            E2 = D2;\n            D2 = bit_rol(C2, 10);\n            C2 = B2;\n            B2 = T;\n          }\n\n          T = safe_add(h1, safe_add(C1, D2));\n          h1 = safe_add(h2, safe_add(D1, E2));\n          h2 = safe_add(h3, safe_add(E1, A2));\n          h3 = safe_add(h4, safe_add(A1, B2));\n          h4 = safe_add(h0, safe_add(B1, C2));\n          h0 = T;\n        }\n        return [h0, h1, h2, h3, h4];\n      }\n\n      // specific algorithm methods\n\n      function rmd160_f(j, x, y, z) {\n        return (0 <= j && j <= 15) ? (x ^ y ^ z) :\n          (16 <= j && j <= 31) ? (x & y) | (~x & z) :\n          (32 <= j && j <= 47) ? (x | ~y) ^ z :\n          (48 <= j && j <= 63) ? (x & z) | (y & ~z) :\n          (64 <= j && j <= 79) ? x ^ (y | ~z) :\n          'rmd160_f: j out of range';\n      }\n\n      function rmd160_K1(j) {\n        return (0 <= j && j <= 15) ? 0x00000000 :\n          (16 <= j && j <= 31) ? 0x5a827999 :\n          (32 <= j && j <= 47) ? 0x6ed9eba1 :\n          (48 <= j && j <= 63) ? 0x8f1bbcdc :\n          (64 <= j && j <= 79) ? 0xa953fd4e :\n          'rmd160_K1: j out of range';\n      }\n\n      function rmd160_K2(j) {\n        return (0 <= j && j <= 15) ? 0x50a28be6 :\n          (16 <= j && j <= 31) ? 0x5c4dd124 :\n          (32 <= j && j <= 47) ? 0x6d703ef3 :\n          (48 <= j && j <= 63) ? 0x7a6d76e9 :\n          (64 <= j && j <= 79) ? 0x00000000 :\n          'rmd160_K2: j out of range';\n      }\n    }\n  };\n\n  // exposes Hashes\n  (function(window, undefined) {\n    var freeExports = false;\n    if (typeof exports === 'object') {\n      freeExports = exports;\n      if (exports && typeof global === 'object' && global && global === global.global) {\n        window = global;\n      }\n    }\n\n    if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n      // define as an anonymous module, so, through path mapping, it can be aliased\n      define(function() {\n        return Hashes;\n      });\n    } else if (freeExports) {\n      // in Node.js or RingoJS v0.8.0+\n      if (typeof module === 'object' && module && module.exports === freeExports) {\n        module.exports = Hashes;\n      }\n      // in Narwhal or RingoJS v0.7.0-\n      else {\n        freeExports.Hashes = Hashes;\n      }\n    } else {\n      // in a browser or Rhino\n      window.Hashes = Hashes;\n    }\n  }(this));\n}()); // IIFE\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import root from './_root.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nexport default cloneBuffer;\n","import URL from 'lite-url';\nimport * as socketIOClient from 'socket.io-client';\n/**\n * Try to create a socket.io connection with given address.\n * @throws {Error} when an error during connection is detected.\n * @param {string} address socket.io server address.\n * @return {Promise<io.Socket>} resolved with connected socket.io client.\n */\nexport const create = (address, { socketIO = socketIOClient } = {}) => {\n    return new Promise((resolve, reject) => {\n        const url = new URL(address);\n        // @todo autoaprobar los certificados por parametro\n        const socket = socketIO.connect(url.origin, {\n            path: url.pathname,\n            'force new connection': true,\n            rejectUnauthorized: process.env.NODE_TLS_REJECT_UNAUTHORIZED !== '0'\n        });\n        let onSuccess;\n        let onError;\n        const done = () => {\n            socket.off('connect', onSuccess);\n            socket.off('disconnect', onError);\n            socket.off('connect_failed', onError);\n        };\n        onSuccess = () => {\n            done();\n            resolve(socket);\n        };\n        onError = () => {\n            done();\n            reject(new Error('got error while connecting'));\n        };\n        socket.on('connect', onSuccess);\n        socket.on('disconnect', onError);\n        socket.on('connect_failed', onError);\n    });\n};\n","/**\n * lite-url - Small, JS lib that uses regex for parsing a URL into it's component parts.\n * @version v1.0.5\n * @link https://github.com/sadams/lite-url\n * @license BSD-3-Clause\n */\n(function(){\"use strict\";function r(r,n,t){var e=r.split(n),o=e.shift();return t(o,e.join(n))}function n(n){var t={hash:\"\",host:\"\",hostname:\"\",origin:\"\",pathname:\"\",protocol:\"\",search:\"\",password:\"\",username:\"\",port:\"\"};return r(n,\"#\",function(n,e){e&&(t.hash=e?\"#\"+e:\"\"),r(n,\"?\",function(n,e){e&&(t.search=\"?\"+e),n&&r(n,\"//\",function(n,e){t.protocol=n,r(e,\"/\",function(n,e){t.pathname=\"/\"+(e||\"\"),(t.protocol||n)&&(t.origin=t.protocol+\"//\"+n),r(n,\"@\",function(n,e){if(e){var o=n.split(\":\");t.username=o[0],t.password=o[1]}else e=n;t.host=e,r(e,\":\",function(r,n){t.hostname=r,n&&(t.port=n)})})})})})}),t.href=t.origin+t.pathname+t.search+t.hash,t}function t(r){var n={},t=r.search;if(t){t=t.replace(new RegExp(\"\\\\?\"),\"\");var e=t.split(\"&\");for(var o in e)if(e.hasOwnProperty(o)&&e[o]){var i=e[o].split(\"=\");n[i[0]]=i[1]}}return n}function e(r){var e=i[r];return\"undefined\"!=typeof e?e:(e=n(r),e.params=t(e),i[r]=e,e)}var o=this,i={};return e.changeQueryParser=function(r){t=r},\"undefined\"!=typeof exports?(\"undefined\"!=typeof module&&module.exports&&(exports=module.exports=e),exports.liteURL=e):o.liteURL=e,e}).call(this);\n","// This file replaces `index.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nif (process.env.NODE_ENV !== 'production') {\n  // All bundlers will remove this block in production bundle\n  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n    throw new Error(\n      'React Native does not have a built-in secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use `nanoid/non-secure`. ' +\n      'For secure ID install `expo-random` locally and use `nanoid/async`.'\n    )\n  }\n  if (typeof self === 'undefined' || (!self.crypto && !self.msCrypto)) {\n    throw new Error(\n      'Your browser does not have secure random generator. ' +\n      'If you dont need unpredictable IDs, you can use nanoid/non-secure.'\n    )\n  }\n}\n\nvar crypto = self.crypto || self.msCrypto\n\n// This alphabet uses a-z A-Z 0-9 _- symbols.\n// Symbols are generated for smaller size.\n// -_zyxwvutsrqponmlkjihgfedcba9876543210ZYXWVUTSRQPONMLKJIHGFEDCBA\nvar url = '-_'\n// Loop from 36 to 0 (from z to a and 9 to 0 in Base36).\nvar i = 36\nwhile (i--) {\n  // 36 is radix. Number.prototype.toString(36) returns number\n  // in Base36 representation. Base36 is like hex, but it uses 09 and a-z.\n  url += i.toString(36)\n}\n// Loop from 36 to 10 (from Z to A in Base36).\ni = 36\nwhile (i-- - 10) {\n  url += i.toString(36).toUpperCase()\n}\n\nmodule.exports = function (size) {\n  var id = ''\n  var bytes = crypto.getRandomValues(new Uint8Array(size || 21))\n  i = size || 21\n\n  // Compact alternative for `for (var i = 0; i < size; i++)`\n  while (i--) {\n    // We cant use bytes bigger than the alphabet. 63 is 00111111 bitmask.\n    // This mask reduces random byte 0-255 to 0-63 values.\n    // There is no need in `|| ''` and `* 1.6` hacks in here,\n    // because bitmask trim bytes exact to alphabet size.\n    id += url[bytes[i] & 63]\n  }\n  return id\n}\n","\"use strict\";\n(function() {\n\n\tvar instanceId = 0;\n\tfunction getInstanceId() {\n\t\treturn instanceId++;\n\t}\n\n\t// note that this function invoked from call/apply, which has \"this\" binded\t\n\tfunction _upload(file, options) {\n\t\toptions = options || {};\n\n\t\tvar self = this;\n\t\tvar socket = this.socket;\n\t\tvar chunkSize = this.chunkSize;\n\t\tvar transmissionDelay = this.transmissionDelay;\n\t\tvar uploadId = file.uploadId;\n\t\tvar uploadTo = options.uploadTo || '';\n\t\tvar data = options.data || {};\n\t\tvar fileInfo = {\n\t\t\tid: uploadId,\n\t\t\tname: file.name,\n\t\t\tsize: file.size,\n\t\t\tchunkSize: chunkSize,\n\t\t\tsent: 0,\n\t\t\tdata: data\n\t\t};\n\n\t\tuploadTo && (fileInfo.uploadTo = uploadTo);\n\n\t\t// read file\n\t\tvar fileReader = new FileReader();\n\n\t\tfileReader.onloadstart = function() {\n\t\t\tself.emit('loadstart');\n\t\t};\n\n\t\tfileReader.onprogress = function(progress) {\n\t\t\tself.emit('progress', {\n\t\t\t\tloaded: progress.loaded,\n\t\t\t\ttotal: progress.total\n\t\t\t});\n\t\t};\n\n\t\tfileReader.onloadend = function() {\n\t\t\tvar buffer = fileReader.result;\n\n\t\t\t// check file mime type if exists\n\t\t\tif(self.accepts && self.accepts.length > 0) {\n\t\t\t\tvar found = false;\n\n\t\t\t\tfor(var i = 0; i < self.accepts.length; i++) {\n\t\t\t\t\tvar accept = self.accepts[i];\n\n\t\t\t\t\tif(file.type === accept) {\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!found) {\n\t\t\t\t\treturn self.emit('error', \n\t\t\t\t\t\tnew Error('Not Acceptable file type ' + file.type + ' of ' + file.name + '. Type must be one of these: ' + self.accepts.join(', ')),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\t\t\t\tname: fileInfo.name, \n\t\t\t\t\t\t\tsize: fileInfo.size,\n\t\t\t\t\t\t\ttype: file.type,\n\t\t\t\t\t\t\tuploadTo: uploadTo,\n\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// check file size\n\t\t\tif(self.maxFileSize && self.maxFileSize > 0) {\n\t\t\t\tif(file.size > +self.maxFileSize) {\n\t\t\t\t\treturn self.emit('error', \n\t\t\t\t\t\tnew Error('Max Uploading File size must be under ' + self.maxFileSize + ' byte(s).'),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\t\t\t\t\tname: fileInfo.name, \n\t\t\t\t\t\t\t\tsize: fileInfo.size,\n\t\t\t\t\t\t\t\tuploadTo: uploadTo,\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// put into uploadingFiles list\n\t\t\tself.uploadingFiles[uploadId] = fileInfo;\n\n\t\t\t// request the server to make a file\n\t\t\tself.emit('start', { \n\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\tname: fileInfo.name, \n\t\t\t\tsize: fileInfo.size,\n\t\t\t\tuploadTo: uploadTo,\n\t\t\t\tdata: data\n\t\t\t});\n\t\t\tsocket.emit('socket.io-file::createFile', fileInfo);\n\n\t\t\tfunction sendChunk() {\n\t\t\t\tif(fileInfo.aborted) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(fileInfo.sent >= buffer.byteLength) {\n\t\t\t\t\tsocket.emit('socket.io-file::done::' + uploadId);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar chunk = buffer.slice(fileInfo.sent, fileInfo.sent + chunkSize);\n\n\t\t\t\tself.emit('stream', { \n\t\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\t\tname: fileInfo.name, \n\t\t\t\t\tsize: fileInfo.size, \n\t\t\t\t\tsent: fileInfo.sent,\n\t\t\t\t\tuploadTo: uploadTo,\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t\tsocket.once('socket.io-file::request::' + uploadId, sendChunk);\n\t\t\t\tsocket.emit('socket.io-file::stream::' + uploadId, chunk);\n\n\t\t\t\tfileInfo.sent += chunk.byteLength;\n\t\t\t\tself.uploadingFiles[uploadId] = fileInfo;\n\t\t\t}\n\t\t\tsocket.once('socket.io-file::request::' + uploadId, sendChunk);\n\t\t\tsocket.on('socket.io-file::complete::' + uploadId, function(info) {\n\t\t\t\tinfo.uploadId = fileInfo.id;\n\t\t\t\tinfo.data = fileInfo.data;\n\t\t\t\t\n\t\t\t\tsocket.removeAllListeners('socket.io-file::abort::' + uploadId);\n\t\t\t\tsocket.removeAllListeners('socket.io-file::error::' + uploadId);\n\t\t\t\tsocket.removeAllListeners('socket.io-file::complete::' + uploadId);\n\n\t\t\t\t// remove from uploadingFiles list\n\t\t\t\tdelete self.uploadingFiles[uploadId];\n\n\t\t\t\tself.emit('complete', info);\n\t\t\t});\n\t\t\tsocket.on('socket.io-file::abort::' + uploadId, function(info) {\n\t\t\t\tfileInfo.aborted = true;\n\t\t\t\tself.emit('abort', { \n\t\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\t\tname: fileInfo.name, \n\t\t\t\t\tsize: fileInfo.size, \n\t\t\t\t\tsent: fileInfo.sent, \n\t\t\t\t\twrote: info.wrote,\n\t\t\t\t\tuploadTo: uploadTo,\n\t\t\t\t\tdata: data\n\t\t\t\t});\n\t\t\t});\n\t\t\tsocket.on('socket.io-file::error::' + uploadId, function(err) {\n\t\t\t\tself.emit('error', \n\t\t\t\t\tnew Error(err.message),\n\t\t\t\t\t{\n\t\t\t\t\t\tuploadId: fileInfo.id,\n\t\t\t\t\t\tname: fileInfo.name, \n\t\t\t\t\t\tsize: fileInfo.size,\n\t\t\t\t\t\tuploadTo: uploadTo,\n\t\t\t\t\t\tdata: data\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t};\n\t\tfileReader.readAsArrayBuffer(file);\n\t}\n\n\tfunction SocketIOFileClient(socket, options) {\n\t\tif(!socket) {\n\t\t\treturn this.emit('error', new Error('SocketIOFile requires Socket.'));\n\t\t}\n\n\t\tthis.instanceId = getInstanceId();\t\t// using for identifying multiple file upload from SocketIOFileClient objects\n\t\tthis.uploadId = 0;\t\t\t\t\t\t// using for identifying each uploading\n\t\tthis.ev = {};\t\t\t\t\t\t\t// event handlers\n\t\tthis.options = options || {};\n\t\tthis.accepts = [];\n\t\tthis.maxFileSize = undefined;\n\t\tthis.socket = socket;\n\t\tthis.uploadingFiles = {};\n\t\tthis.isDestroyed = false;\n\n\t\tvar self = this;\n\n\t\tsocket.on('socket.io-file::recvSync', function(settings) {\n\t\t\tself.maxFileSize = settings.maxFileSize || undefined;\n\t\t\tself.accepts = settings.accepts || [];\n\t\t\tself.chunkSize = settings.chunkSize || 10240;\n\t\t\tself.transmissionDelay = settings.transmissionDelay || 0;\n\n\t\t\tself.emit('ready');\n\t\t});\n\t\tsocket.emit('socket.io-file::reqSync');\n\n\t\tsocket.on('socket.io-file::disconnectByServer', function() {\n\t\t\tself.emit('disconnected');\n\t\t\tself.destroy();\n\t\t});\n\t}\n\tSocketIOFileClient.prototype.getUploadId = function() {\n\t\treturn 'u_' + this.uploadId++;\n\t}\n\tSocketIOFileClient.prototype.upload = function(fileEl, options) {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tif(!fileEl ||\n\t\t\t(fileEl.files && fileEl.files.length <= 0) ||\n\t\t\tfileEl.length <= 0\n\t\t) {\n\t\t\tthis.emit('error', new Error('No file(s) to upload.'));\n\t\t\treturn [];\n\t\t}\n\n\t\tvar self = this;\n\t\tvar uploadIds = [];\n\n\t\tvar files = fileEl.files ? fileEl.files : fileEl;\n\t\tvar loaded = 0;\n\n\t\tfor(var i = 0; i < files.length; i++) {\n\t\t\tvar file = files[i];\n\t\t\tvar uploadId = this.getUploadId();\n\t\t\tuploadIds.push(uploadId);\n\n\t\t\tfile.uploadId = uploadId;\n\n\t\t\t_upload.call(self, file, options);\n\t\t}\n\t\t\n\t\treturn uploadIds;\n\t};\n\tSocketIOFileClient.prototype.on = function(evName, fn) {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tif(!this.ev[evName]) {\n\t\t\tthis.ev[evName] = [];\n\t\t}\n\n\t\tthis.ev[evName].push(fn);\n\t\treturn this;\n\t};\n\tSocketIOFileClient.prototype.off = function(evName, fn) {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tif(typeof evName === 'undefined') {\n\t\t\tthis.ev = [];\n\t\t}\n\t\telse if(typeof fn === 'undefined') {\n\t\t\tif(this.ev[evName]) {\n\t\t\t\tdelete this.ev[evName]; \n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tvar evList = this.ev[evName] || [];\n\n\t\t\tfor(var i = 0; i < evList.length; i++) {\n\t\t\t\tif(evList[i] === fn) {\n\t\t\t\t\tevList = evList.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t};\n\tSocketIOFileClient.prototype.emit = function(evName) {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tvar evList = this.ev[evName] || [];\n\n\t\tvar args = Array.from(arguments);\n\t\targs.splice(0, 1);\t\t\t// Don't pass evName to the event handler.\n\n\t\tfor(var i = 0; i < evList.length; i++) {\n\t\t\tevList[i].apply(null, args);\n\t\t}\n\n\t\treturn this;\n\t};\n\tSocketIOFileClient.prototype.abort = function(id) {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tvar socket = this.socket;\n\t\tsocket.emit('socket.io-file::abort::' + id);\n\t};\n\tSocketIOFileClient.prototype.destroy = function() {\n\t\tif(this.isDestroyed) {\n\t\t\tthrow new Error('SocketIOFileClient is closed.');\n\t\t}\n\n\t\tvar uploadingFiles = this.uploadingFiles;\n\n\t\tfor(var key in uploadingFiles) {\n\t\t\tthis.abort(key);\n\t\t}\n\n\t\tthis.socket = null;\n\t\tthis.uploadingFiles = null;\n\t\tthis.ev = null;\n\t\tthis.isDestroyed = true;\n\t};\n\tSocketIOFileClient.prototype.getUploadInfo = function() {\n\t\treturn JSON.parse(JSON.stringify(this.uploadingFiles));\n\t};\n\n\t// module export\n\t// CommonJS\n\tif (typeof exports === \"object\" && typeof module !== \"undefined\") {\n\t\tmodule.exports = SocketIOFileClient;\n\t}\n\t// RequireJS\n\telse if (typeof define === \"function\" && define.amd) {\n\t\tdefine(['SocketIOFileClient'], SocketIOFileClient);\n\t}\n\telse {\n\t\tvar g;\n\n\t\tif (typeof window !== \"undefined\") {\n\t\t\tg = window;\n\t\t}\n\t\telse if (typeof global !== \"undefined\") {\n\t\t\tg = global;\n\t\t}\n\t\telse if (typeof self !== \"undefined\") {\n\t\t\tg = self;\n\t\t}\n\n\t\tg.SocketIOFileClient = SocketIOFileClient;\n\t}\n})();\n","'use strict';\nmodule.exports = function (str) {\n\treturn encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n\t\treturn '%' + c.charCodeAt(0).toString(16).toUpperCase();\n\t});\n};\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Buffer = require('safe-buffer').Buffer;\nvar util = require('util');\n\nfunction copyBuffer(src, target, offset) {\n  src.copy(target, offset);\n}\n\nmodule.exports = function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n\n  BufferList.prototype.push = function push(v) {\n    var entry = { data: v, next: null };\n    if (this.length > 0) this.tail.next = entry;else this.head = entry;\n    this.tail = entry;\n    ++this.length;\n  };\n\n  BufferList.prototype.unshift = function unshift(v) {\n    var entry = { data: v, next: this.head };\n    if (this.length === 0) this.tail = entry;\n    this.head = entry;\n    ++this.length;\n  };\n\n  BufferList.prototype.shift = function shift() {\n    if (this.length === 0) return;\n    var ret = this.head.data;\n    if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n    --this.length;\n    return ret;\n  };\n\n  BufferList.prototype.clear = function clear() {\n    this.head = this.tail = null;\n    this.length = 0;\n  };\n\n  BufferList.prototype.join = function join(s) {\n    if (this.length === 0) return '';\n    var p = this.head;\n    var ret = '' + p.data;\n    while (p = p.next) {\n      ret += s + p.data;\n    }return ret;\n  };\n\n  BufferList.prototype.concat = function concat(n) {\n    if (this.length === 0) return Buffer.alloc(0);\n    if (this.length === 1) return this.head.data;\n    var ret = Buffer.allocUnsafe(n >>> 0);\n    var p = this.head;\n    var i = 0;\n    while (p) {\n      copyBuffer(p.data, ret, i);\n      i += p.data.length;\n      p = p.next;\n    }\n    return ret;\n  };\n\n  return BufferList;\n}();\n\nif (util && util.inspect && util.inspect.custom) {\n  module.exports.prototype[util.inspect.custom] = function () {\n    var obj = util.inspect({ length: this.length });\n    return this.constructor.name + ' ' + obj;\n  };\n}","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","\n/**\n * Module exports.\n */\n\nmodule.exports = deprecate;\n\n/**\n * Mark that a method should not be used.\n * Returns a modified function which warns once by default.\n *\n * If `localStorage.noDeprecation = true` is set, then it is a no-op.\n *\n * If `localStorage.throwDeprecation = true` is set, then deprecated functions\n * will throw an Error when invoked.\n *\n * If `localStorage.traceDeprecation = true` is set, then deprecated functions\n * will invoke `console.trace()` instead of `console.error()`.\n *\n * @param {Function} fn - the function to deprecate\n * @param {String} msg - the string to print to the console when `fn` is invoked\n * @returns {Function} a new \"deprecated\" version of `fn`\n * @api public\n */\n\nfunction deprecate (fn, msg) {\n  if (config('noDeprecation')) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (config('throwDeprecation')) {\n        throw new Error(msg);\n      } else if (config('traceDeprecation')) {\n        console.trace(msg);\n      } else {\n        console.warn(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n}\n\n/**\n * Checks `localStorage` for boolean values for the given `name`.\n *\n * @param {String} name\n * @returns {Boolean}\n * @api private\n */\n\nfunction config (name) {\n  // accessing global.localStorage can trigger a DOMException in sandboxed iframes\n  try {\n    if (!global.localStorage) return false;\n  } catch (_) {\n    return false;\n  }\n  var val = global.localStorage[name];\n  if (null == val) return false;\n  return String(val).toLowerCase() === 'true';\n}\n","/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\n\nvar Transform = require('./_stream_transform');\n\n/*<replacement>*/\nvar util = require('core-util-is');\nutil.inherits = require('inherits');\n/*</replacement>*/\n\nutil.inherits(PassThrough, Transform);\n\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n\n  Transform.call(this, options);\n}\n\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","var crypto = self.crypto || self.msCrypto\n\nmodule.exports = function (bytes) {\n  return crypto.getRandomValues(new Uint8Array(bytes))\n}\n","// This file replaces `format.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nmodule.exports = function (random, alphabet, size) {\n  // We cant use bytes bigger than the alphabet. To make bytes values closer\n  // to the alphabet, we apply bitmask on them. We look for the closest\n  // `2 ** x - 1` number, which will be bigger than alphabet size. If we have\n  // 30 symbols in the alphabet, we will take 31 (00011111).\n  // We do not use faster Math.clz32, because it is not available in browsers.\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  // Bitmask is not a perfect solution (in our example it will pass 31 bytes,\n  // which is bigger than the alphabet). As a result, we will need more bytes,\n  // than ID size, because we will refuse bytes bigger than the alphabet.\n\n  // Every hardware random generator call is costly,\n  // because we need to wait for entropy collection. This is why often it will\n  // be faster to ask for few extra bytes in advance, to avoid additional calls.\n\n  // Here we calculate how many random bytes should we call in advance.\n  // It depends on ID length, mask / alphabet size and magic number 1.6\n  // (which was selected according benchmarks).\n\n  // -~f => Math.ceil(f) if n is float number\n  // -~i => i + 1 if n is integer number\n  var step = -~(1.6 * mask * size / alphabet.length)\n  var id = ''\n\n  while (true) {\n    var bytes = random(step)\n    // Compact alternative for `for (var i = 0; i < step; i++)`\n    var i = step\n    while (i--) {\n      // If random byte is bigger than alphabet even after bitmask,\n      // we refuse it by `|| ''`.\n      id += alphabet[bytes[i] & mask] || ''\n      // More compact than `id.length + 1 === size`\n      if (id.length === +size) return id\n    }\n  }\n}\n","import { Transform } from 'readable-stream';\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - create-hash, Copyright (c) 2017 crypto-browserify contributors\n */\nclass Hash extends Transform {\n    constructor(blockSize, finalSize, endian = 'be') {\n        super();\n        this._block = Buffer.alloc(blockSize);\n        this._finalSize = finalSize;\n        this._blockSize = blockSize;\n        this._bigEndian = endian === 'be';\n        this._len = 0;\n    }\n    _transform(chunk, encoding, callback) {\n        let error = null;\n        try {\n            this.update(chunk, encoding);\n        }\n        catch (err) {\n            error = err;\n        }\n        callback(error);\n    }\n    _flush(callback) {\n        let error = null;\n        try {\n            this.push(this.digest());\n        }\n        catch (err) {\n            error = err;\n        }\n        callback(error);\n    }\n    update(data, enc) {\n        if (typeof data === 'string') {\n            enc = enc || 'utf8';\n            data = Buffer.from(data, enc);\n        }\n        const block = this._block;\n        const blockSize = this._blockSize;\n        const length = data.length;\n        let accum = this._len;\n        for (let offset = 0; offset < length;) {\n            const assigned = accum % blockSize;\n            const remainder = Math.min(length - offset, blockSize - assigned);\n            for (let i = 0; i < remainder; i++) {\n                block[assigned + i] = data[offset + i];\n            }\n            accum += remainder;\n            offset += remainder;\n            if (accum % blockSize === 0) {\n                this._update(block);\n            }\n        }\n        this._len += length;\n        return this;\n    }\n    digest(enc) {\n        const rem = this._len % this._blockSize;\n        this._block[rem] = 0x80;\n        // zero (rem + 1) trailing bits, where (rem + 1) is the smallest\n        // non-negative solution to the equation (length + 1 + (rem + 1)) === finalSize mod blockSize\n        this._block.fill(0, rem + 1);\n        if (rem >= this._finalSize) {\n            this._update(this._block);\n            this._block.fill(0);\n        }\n        const bits = this._len * 8;\n        if (bits <= 0xffffffff) {\n            if (this._bigEndian) {\n                this._block.writeUInt32BE(0, this._blockSize - 8);\n                this._block.writeUInt32BE(bits, this._blockSize - 4);\n            }\n            else {\n                this._block.writeUInt32LE(bits, this._blockSize - 8);\n                this._block.writeUInt32LE(0, this._blockSize - 4);\n            }\n        }\n        else {\n            const lowBits = (bits & 0xffffffff) >>> 0;\n            const highBits = (bits - lowBits) / 0x100000000;\n            if (this._bigEndian) {\n                this._block.writeUInt32BE(highBits, this._blockSize - 8);\n                this._block.writeUInt32BE(lowBits, this._blockSize - 4);\n            }\n            else {\n                this._block.writeUInt32LE(lowBits, this._blockSize - 8);\n                this._block.writeUInt32LE(highBits, this._blockSize - 4);\n            }\n        }\n        this._update(this._block);\n        const hash = this._hash();\n        return enc ? hash.toString(enc) : hash;\n    }\n    _update(block) {\n        throw new Error('_update must be implemented by subclass');\n    }\n    _hash() {\n        throw new Error('_update must be implemented by subclass');\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - md5.js, Copyright (c) 2016 Kirill Fomichev\n */\nfunction rotl(x, n) {\n    return (x << n) | (x >>> (32 - n));\n}\nfunction fnF(a, b, c, d, m, k, s) {\n    return (rotl((a + ((b & c) | (~b & d)) + m + k) | 0, s) + b) | 0;\n}\nfunction fnG(a, b, c, d, m, k, s) {\n    return (rotl((a + ((b & d) | (c & ~d)) + m + k) | 0, s) + b) | 0;\n}\nfunction fnH(a, b, c, d, m, k, s) {\n    return (rotl((a + (b ^ c ^ d) + m + k) | 0, s) + b) | 0;\n}\nfunction fnI(a, b, c, d, m, k, s) {\n    return (rotl((a + (c ^ (b | ~d)) + m + k) | 0, s) + b) | 0;\n}\nclass MD5 extends Hash {\n    constructor() {\n        super(64, 56, 'le');\n        this._a = 0x67452301;\n        this._b = 0xefcdab89;\n        this._c = 0x98badcfe;\n        this._d = 0x10325476;\n        this._m = new Array(16);\n    }\n    _update(B) {\n        const M = this._m;\n        for (let i = 0; i < 16; ++i) {\n            M[i] = B.readInt32LE(i * 4);\n        }\n        let a = this._a;\n        let b = this._b;\n        let c = this._c;\n        let d = this._d;\n        a = fnF(a, b, c, d, M[0], 0xd76aa478, 7);\n        d = fnF(d, a, b, c, M[1], 0xe8c7b756, 12);\n        c = fnF(c, d, a, b, M[2], 0x242070db, 17);\n        b = fnF(b, c, d, a, M[3], 0xc1bdceee, 22);\n        a = fnF(a, b, c, d, M[4], 0xf57c0faf, 7);\n        d = fnF(d, a, b, c, M[5], 0x4787c62a, 12);\n        c = fnF(c, d, a, b, M[6], 0xa8304613, 17);\n        b = fnF(b, c, d, a, M[7], 0xfd469501, 22);\n        a = fnF(a, b, c, d, M[8], 0x698098d8, 7);\n        d = fnF(d, a, b, c, M[9], 0x8b44f7af, 12);\n        c = fnF(c, d, a, b, M[10], 0xffff5bb1, 17);\n        b = fnF(b, c, d, a, M[11], 0x895cd7be, 22);\n        a = fnF(a, b, c, d, M[12], 0x6b901122, 7);\n        d = fnF(d, a, b, c, M[13], 0xfd987193, 12);\n        c = fnF(c, d, a, b, M[14], 0xa679438e, 17);\n        b = fnF(b, c, d, a, M[15], 0x49b40821, 22);\n        a = fnG(a, b, c, d, M[1], 0xf61e2562, 5);\n        d = fnG(d, a, b, c, M[6], 0xc040b340, 9);\n        c = fnG(c, d, a, b, M[11], 0x265e5a51, 14);\n        b = fnG(b, c, d, a, M[0], 0xe9b6c7aa, 20);\n        a = fnG(a, b, c, d, M[5], 0xd62f105d, 5);\n        d = fnG(d, a, b, c, M[10], 0x02441453, 9);\n        c = fnG(c, d, a, b, M[15], 0xd8a1e681, 14);\n        b = fnG(b, c, d, a, M[4], 0xe7d3fbc8, 20);\n        a = fnG(a, b, c, d, M[9], 0x21e1cde6, 5);\n        d = fnG(d, a, b, c, M[14], 0xc33707d6, 9);\n        c = fnG(c, d, a, b, M[3], 0xf4d50d87, 14);\n        b = fnG(b, c, d, a, M[8], 0x455a14ed, 20);\n        a = fnG(a, b, c, d, M[13], 0xa9e3e905, 5);\n        d = fnG(d, a, b, c, M[2], 0xfcefa3f8, 9);\n        c = fnG(c, d, a, b, M[7], 0x676f02d9, 14);\n        b = fnG(b, c, d, a, M[12], 0x8d2a4c8a, 20);\n        a = fnH(a, b, c, d, M[5], 0xfffa3942, 4);\n        d = fnH(d, a, b, c, M[8], 0x8771f681, 11);\n        c = fnH(c, d, a, b, M[11], 0x6d9d6122, 16);\n        b = fnH(b, c, d, a, M[14], 0xfde5380c, 23);\n        a = fnH(a, b, c, d, M[1], 0xa4beea44, 4);\n        d = fnH(d, a, b, c, M[4], 0x4bdecfa9, 11);\n        c = fnH(c, d, a, b, M[7], 0xf6bb4b60, 16);\n        b = fnH(b, c, d, a, M[10], 0xbebfbc70, 23);\n        a = fnH(a, b, c, d, M[13], 0x289b7ec6, 4);\n        d = fnH(d, a, b, c, M[0], 0xeaa127fa, 11);\n        c = fnH(c, d, a, b, M[3], 0xd4ef3085, 16);\n        b = fnH(b, c, d, a, M[6], 0x04881d05, 23);\n        a = fnH(a, b, c, d, M[9], 0xd9d4d039, 4);\n        d = fnH(d, a, b, c, M[12], 0xe6db99e5, 11);\n        c = fnH(c, d, a, b, M[15], 0x1fa27cf8, 16);\n        b = fnH(b, c, d, a, M[2], 0xc4ac5665, 23);\n        a = fnI(a, b, c, d, M[0], 0xf4292244, 6);\n        d = fnI(d, a, b, c, M[7], 0x432aff97, 10);\n        c = fnI(c, d, a, b, M[14], 0xab9423a7, 15);\n        b = fnI(b, c, d, a, M[5], 0xfc93a039, 21);\n        a = fnI(a, b, c, d, M[12], 0x655b59c3, 6);\n        d = fnI(d, a, b, c, M[3], 0x8f0ccc92, 10);\n        c = fnI(c, d, a, b, M[10], 0xffeff47d, 15);\n        b = fnI(b, c, d, a, M[1], 0x85845dd1, 21);\n        a = fnI(a, b, c, d, M[8], 0x6fa87e4f, 6);\n        d = fnI(d, a, b, c, M[15], 0xfe2ce6e0, 10);\n        c = fnI(c, d, a, b, M[6], 0xa3014314, 15);\n        b = fnI(b, c, d, a, M[13], 0x4e0811a1, 21);\n        a = fnI(a, b, c, d, M[4], 0xf7537e82, 6);\n        d = fnI(d, a, b, c, M[11], 0xbd3af235, 10);\n        c = fnI(c, d, a, b, M[2], 0x2ad7d2bb, 15);\n        b = fnI(b, c, d, a, M[9], 0xeb86d391, 21);\n        this._a = (this._a + a) | 0;\n        this._b = (this._b + b) | 0;\n        this._c = (this._c + c) | 0;\n        this._d = (this._d + d) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(16);\n        H.writeInt32LE(this._a, 0);\n        H.writeInt32LE(this._b, 4);\n        H.writeInt32LE(this._c, 8);\n        H.writeInt32LE(this._d, 12);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc | 0, 0xca62c1d6 | 0];\nfunction rotl1(num) {\n    return (num << 1) | (num >>> 31);\n}\nfunction rotl5(num) {\n    return (num << 5) | (num >>> 27);\n}\nfunction rotl30(num) {\n    return (num << 30) | (num >>> 2);\n}\nfunction ft(s, b, c, d) {\n    if (s === 0) {\n        return (b & c) | (~b & d);\n    }\n    if (s === 2) {\n        return (b & c) | (b & d) | (c & d);\n    }\n    return b ^ c ^ d;\n}\nclass Sha1 extends Hash {\n    constructor() {\n        super(64, 56);\n        this._a = 0x67452301;\n        this._b = 0xefcdab89;\n        this._c = 0x98badcfe;\n        this._d = 0x10325476;\n        this._e = 0xc3d2e1f0;\n        this._w = new Array(80);\n    }\n    _update(M) {\n        const W = this._w;\n        let a = this._a | 0;\n        let b = this._b | 0;\n        let c = this._c | 0;\n        let d = this._d | 0;\n        let e = this._e | 0;\n        let i;\n        for (i = 0; i < 16; ++i) {\n            W[i] = M.readInt32BE(i * 4);\n        }\n        for (; i < 80; ++i) {\n            W[i] = rotl1(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16]);\n        }\n        for (let j = 0; j < 80; ++j) {\n            const s = ~~(j / 20);\n            const t = (rotl5(a) + ft(s, b, c, d) + e + W[j] + K[s]) | 0;\n            e = d;\n            d = c;\n            c = rotl30(b);\n            b = a;\n            a = t;\n        }\n        this._a = (a + this._a) | 0;\n        this._b = (b + this._b) | 0;\n        this._c = (c + this._c) | 0;\n        this._d = (d + this._d) | 0;\n        this._e = (e + this._e) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(20);\n        H.writeInt32BE(this._a | 0, 0);\n        H.writeInt32BE(this._b | 0, 4);\n        H.writeInt32BE(this._c | 0, 8);\n        H.writeInt32BE(this._d | 0, 12);\n        H.writeInt32BE(this._e | 0, 16);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K$1 = [\n    0x428a2f98,\n    0x71374491,\n    0xb5c0fbcf,\n    0xe9b5dba5,\n    0x3956c25b,\n    0x59f111f1,\n    0x923f82a4,\n    0xab1c5ed5,\n    0xd807aa98,\n    0x12835b01,\n    0x243185be,\n    0x550c7dc3,\n    0x72be5d74,\n    0x80deb1fe,\n    0x9bdc06a7,\n    0xc19bf174,\n    0xe49b69c1,\n    0xefbe4786,\n    0x0fc19dc6,\n    0x240ca1cc,\n    0x2de92c6f,\n    0x4a7484aa,\n    0x5cb0a9dc,\n    0x76f988da,\n    0x983e5152,\n    0xa831c66d,\n    0xb00327c8,\n    0xbf597fc7,\n    0xc6e00bf3,\n    0xd5a79147,\n    0x06ca6351,\n    0x14292967,\n    0x27b70a85,\n    0x2e1b2138,\n    0x4d2c6dfc,\n    0x53380d13,\n    0x650a7354,\n    0x766a0abb,\n    0x81c2c92e,\n    0x92722c85,\n    0xa2bfe8a1,\n    0xa81a664b,\n    0xc24b8b70,\n    0xc76c51a3,\n    0xd192e819,\n    0xd6990624,\n    0xf40e3585,\n    0x106aa070,\n    0x19a4c116,\n    0x1e376c08,\n    0x2748774c,\n    0x34b0bcb5,\n    0x391c0cb3,\n    0x4ed8aa4a,\n    0x5b9cca4f,\n    0x682e6ff3,\n    0x748f82ee,\n    0x78a5636f,\n    0x84c87814,\n    0x8cc70208,\n    0x90befffa,\n    0xa4506ceb,\n    0xbef9a3f7,\n    0xc67178f2\n];\nfunction ch(x, y, z) {\n    return z ^ (x & (y ^ z));\n}\nfunction maj(x, y, z) {\n    return (x & y) | (z & (x | y));\n}\nfunction sigma0(x) {\n    return ((x >>> 2) | (x << 30)) ^ ((x >>> 13) | (x << 19)) ^ ((x >>> 22) | (x << 10));\n}\nfunction sigma1(x) {\n    return ((x >>> 6) | (x << 26)) ^ ((x >>> 11) | (x << 21)) ^ ((x >>> 25) | (x << 7));\n}\nfunction gamma0(x) {\n    return ((x >>> 7) | (x << 25)) ^ ((x >>> 18) | (x << 14)) ^ (x >>> 3);\n}\nfunction gamma1(x) {\n    return ((x >>> 17) | (x << 15)) ^ ((x >>> 19) | (x << 13)) ^ (x >>> 10);\n}\nclass Sha256 extends Hash {\n    constructor() {\n        super(64, 56);\n        this._a = 0x6a09e667;\n        this._b = 0xbb67ae85;\n        this._c = 0x3c6ef372;\n        this._d = 0xa54ff53a;\n        this._e = 0x510e527f;\n        this._f = 0x9b05688c;\n        this._g = 0x1f83d9ab;\n        this._h = 0x5be0cd19;\n        this._w = new Array(64);\n    }\n    _update(M) {\n        const W = this._w;\n        let a = this._a | 0;\n        let b = this._b | 0;\n        let c = this._c | 0;\n        let d = this._d | 0;\n        let e = this._e | 0;\n        let f = this._f | 0;\n        let g = this._g | 0;\n        let h = this._h | 0;\n        let i;\n        for (i = 0; i < 16; ++i) {\n            W[i] = M.readInt32BE(i * 4);\n        }\n        for (; i < 64; ++i) {\n            W[i] = (gamma1(W[i - 2]) + W[i - 7] + gamma0(W[i - 15]) + W[i - 16]) | 0;\n        }\n        for (let j = 0; j < 64; ++j) {\n            const T1 = (h + sigma1(e) + ch(e, f, g) + K$1[j] + W[j]) | 0;\n            const T2 = (sigma0(a) + maj(a, b, c)) | 0;\n            h = g;\n            g = f;\n            f = e;\n            e = (d + T1) | 0;\n            d = c;\n            c = b;\n            b = a;\n            a = (T1 + T2) | 0;\n        }\n        this._a = (a + this._a) | 0;\n        this._b = (b + this._b) | 0;\n        this._c = (c + this._c) | 0;\n        this._d = (d + this._d) | 0;\n        this._e = (e + this._e) | 0;\n        this._f = (f + this._f) | 0;\n        this._g = (g + this._g) | 0;\n        this._h = (h + this._h) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(32);\n        H.writeInt32BE(this._a, 0);\n        H.writeInt32BE(this._b, 4);\n        H.writeInt32BE(this._c, 8);\n        H.writeInt32BE(this._d, 12);\n        H.writeInt32BE(this._e, 16);\n        H.writeInt32BE(this._f, 20);\n        H.writeInt32BE(this._g, 24);\n        H.writeInt32BE(this._h, 28);\n        return H;\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - sha.js, Copyright (c) 2013-2018 sha.js contributors\n */\nconst K$2 = [\n    0x428a2f98,\n    0xd728ae22,\n    0x71374491,\n    0x23ef65cd,\n    0xb5c0fbcf,\n    0xec4d3b2f,\n    0xe9b5dba5,\n    0x8189dbbc,\n    0x3956c25b,\n    0xf348b538,\n    0x59f111f1,\n    0xb605d019,\n    0x923f82a4,\n    0xaf194f9b,\n    0xab1c5ed5,\n    0xda6d8118,\n    0xd807aa98,\n    0xa3030242,\n    0x12835b01,\n    0x45706fbe,\n    0x243185be,\n    0x4ee4b28c,\n    0x550c7dc3,\n    0xd5ffb4e2,\n    0x72be5d74,\n    0xf27b896f,\n    0x80deb1fe,\n    0x3b1696b1,\n    0x9bdc06a7,\n    0x25c71235,\n    0xc19bf174,\n    0xcf692694,\n    0xe49b69c1,\n    0x9ef14ad2,\n    0xefbe4786,\n    0x384f25e3,\n    0x0fc19dc6,\n    0x8b8cd5b5,\n    0x240ca1cc,\n    0x77ac9c65,\n    0x2de92c6f,\n    0x592b0275,\n    0x4a7484aa,\n    0x6ea6e483,\n    0x5cb0a9dc,\n    0xbd41fbd4,\n    0x76f988da,\n    0x831153b5,\n    0x983e5152,\n    0xee66dfab,\n    0xa831c66d,\n    0x2db43210,\n    0xb00327c8,\n    0x98fb213f,\n    0xbf597fc7,\n    0xbeef0ee4,\n    0xc6e00bf3,\n    0x3da88fc2,\n    0xd5a79147,\n    0x930aa725,\n    0x06ca6351,\n    0xe003826f,\n    0x14292967,\n    0x0a0e6e70,\n    0x27b70a85,\n    0x46d22ffc,\n    0x2e1b2138,\n    0x5c26c926,\n    0x4d2c6dfc,\n    0x5ac42aed,\n    0x53380d13,\n    0x9d95b3df,\n    0x650a7354,\n    0x8baf63de,\n    0x766a0abb,\n    0x3c77b2a8,\n    0x81c2c92e,\n    0x47edaee6,\n    0x92722c85,\n    0x1482353b,\n    0xa2bfe8a1,\n    0x4cf10364,\n    0xa81a664b,\n    0xbc423001,\n    0xc24b8b70,\n    0xd0f89791,\n    0xc76c51a3,\n    0x0654be30,\n    0xd192e819,\n    0xd6ef5218,\n    0xd6990624,\n    0x5565a910,\n    0xf40e3585,\n    0x5771202a,\n    0x106aa070,\n    0x32bbd1b8,\n    0x19a4c116,\n    0xb8d2d0c8,\n    0x1e376c08,\n    0x5141ab53,\n    0x2748774c,\n    0xdf8eeb99,\n    0x34b0bcb5,\n    0xe19b48a8,\n    0x391c0cb3,\n    0xc5c95a63,\n    0x4ed8aa4a,\n    0xe3418acb,\n    0x5b9cca4f,\n    0x7763e373,\n    0x682e6ff3,\n    0xd6b2b8a3,\n    0x748f82ee,\n    0x5defb2fc,\n    0x78a5636f,\n    0x43172f60,\n    0x84c87814,\n    0xa1f0ab72,\n    0x8cc70208,\n    0x1a6439ec,\n    0x90befffa,\n    0x23631e28,\n    0xa4506ceb,\n    0xde82bde9,\n    0xbef9a3f7,\n    0xb2c67915,\n    0xc67178f2,\n    0xe372532b,\n    0xca273ece,\n    0xea26619c,\n    0xd186b8c7,\n    0x21c0c207,\n    0xeada7dd6,\n    0xcde0eb1e,\n    0xf57d4f7f,\n    0xee6ed178,\n    0x06f067aa,\n    0x72176fba,\n    0x0a637dc5,\n    0xa2c898a6,\n    0x113f9804,\n    0xbef90dae,\n    0x1b710b35,\n    0x131c471b,\n    0x28db77f5,\n    0x23047d84,\n    0x32caab7b,\n    0x40c72493,\n    0x3c9ebe0a,\n    0x15c9bebc,\n    0x431d67c4,\n    0x9c100d4c,\n    0x4cc5d4be,\n    0xcb3e42b6,\n    0x597f299c,\n    0xfc657e2a,\n    0x5fcb6fab,\n    0x3ad6faec,\n    0x6c44198c,\n    0x4a475817\n];\nfunction Ch(x, y, z) {\n    return z ^ (x & (y ^ z));\n}\nfunction maj$1(x, y, z) {\n    return (x & y) | (z & (x | y));\n}\nfunction sigma0$1(x, xl) {\n    return ((x >>> 28) | (xl << 4)) ^ ((xl >>> 2) | (x << 30)) ^ ((xl >>> 7) | (x << 25));\n}\nfunction sigma1$1(x, xl) {\n    return ((x >>> 14) | (xl << 18)) ^ ((x >>> 18) | (xl << 14)) ^ ((xl >>> 9) | (x << 23));\n}\nfunction Gamma0(x, xl) {\n    return ((x >>> 1) | (xl << 31)) ^ ((x >>> 8) | (xl << 24)) ^ (x >>> 7);\n}\nfunction Gamma0l(x, xl) {\n    return ((x >>> 1) | (xl << 31)) ^ ((x >>> 8) | (xl << 24)) ^ ((x >>> 7) | (xl << 25));\n}\nfunction Gamma1(x, xl) {\n    return ((x >>> 19) | (xl << 13)) ^ ((xl >>> 29) | (x << 3)) ^ (x >>> 6);\n}\nfunction Gamma1l(x, xl) {\n    return ((x >>> 19) | (xl << 13)) ^ ((xl >>> 29) | (x << 3)) ^ ((x >>> 6) | (xl << 26));\n}\nfunction getCarry(a, b) {\n    return a >>> 0 < b >>> 0 ? 1 : 0;\n}\nclass Sha512 extends Hash {\n    constructor() {\n        super(128, 112);\n        this._ah = 0x6a09e667;\n        this._bh = 0xbb67ae85;\n        this._ch = 0x3c6ef372;\n        this._dh = 0xa54ff53a;\n        this._eh = 0x510e527f;\n        this._fh = 0x9b05688c;\n        this._gh = 0x1f83d9ab;\n        this._hh = 0x5be0cd19;\n        this._al = 0xf3bcc908;\n        this._bl = 0x84caa73b;\n        this._cl = 0xfe94f82b;\n        this._dl = 0x5f1d36f1;\n        this._el = 0xade682d1;\n        this._fl = 0x2b3e6c1f;\n        this._gl = 0xfb41bd6b;\n        this._hl = 0x137e2179;\n        this._w = new Array(160);\n    }\n    _update(M) {\n        const W = this._w;\n        let ah = this._ah | 0;\n        let bh = this._bh | 0;\n        let ch = this._ch | 0;\n        let dh = this._dh | 0;\n        let eh = this._eh | 0;\n        let fh = this._fh | 0;\n        let gh = this._gh | 0;\n        let hh = this._hh | 0;\n        let al = this._al | 0;\n        let bl = this._bl | 0;\n        let cl = this._cl | 0;\n        let dl = this._dl | 0;\n        let el = this._el | 0;\n        let fl = this._fl | 0;\n        let gl = this._gl | 0;\n        let hl = this._hl | 0;\n        let Wih;\n        let Wil;\n        let i = 0;\n        for (i = 0; i < 32; i += 2) {\n            W[i] = M.readInt32BE(i * 4);\n            W[i + 1] = M.readInt32BE(i * 4 + 4);\n        }\n        for (; i < 160; i += 2) {\n            let xh = W[i - 15 * 2];\n            let xl = W[i - 15 * 2 + 1];\n            const gamma0 = Gamma0(xh, xl);\n            const gamma0l = Gamma0l(xl, xh);\n            xh = W[i - 2 * 2];\n            xl = W[i - 2 * 2 + 1];\n            const gamma1 = Gamma1(xh, xl);\n            const gamma1l = Gamma1l(xl, xh);\n            // W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16]\n            const Wi7h = W[i - 7 * 2];\n            const Wi7l = W[i - 7 * 2 + 1];\n            const Wi16h = W[i - 16 * 2];\n            const Wi16l = W[i - 16 * 2 + 1];\n            Wil = (gamma0l + Wi7l) | 0;\n            Wih = (gamma0 + Wi7h + getCarry(Wil, gamma0l)) | 0;\n            Wil = (Wil + gamma1l) | 0;\n            Wih = (Wih + gamma1 + getCarry(Wil, gamma1l)) | 0;\n            Wil = (Wil + Wi16l) | 0;\n            Wih = (Wih + Wi16h + getCarry(Wil, Wi16l)) | 0;\n            W[i] = Wih;\n            W[i + 1] = Wil;\n        }\n        for (let j = 0; j < 160; j += 2) {\n            Wih = W[j];\n            Wil = W[j + 1];\n            const majh = maj$1(ah, bh, ch);\n            const majl = maj$1(al, bl, cl);\n            const sigma0h = sigma0$1(ah, al);\n            const sigma0l = sigma0$1(al, ah);\n            const sigma1h = sigma1$1(eh, el);\n            const sigma1l = sigma1$1(el, eh);\n            // t1 = h + sigma1 + ch + K[j] + W[j]\n            const Kih = K$2[j];\n            const Kil = K$2[j + 1];\n            const chh = Ch(eh, fh, gh);\n            const chl = Ch(el, fl, gl);\n            let t1l = (hl + sigma1l) | 0;\n            let t1h = (hh + sigma1h + getCarry(t1l, hl)) | 0;\n            t1l = (t1l + chl) | 0;\n            t1h = (t1h + chh + getCarry(t1l, chl)) | 0;\n            t1l = (t1l + Kil) | 0;\n            t1h = (t1h + Kih + getCarry(t1l, Kil)) | 0;\n            t1l = (t1l + Wil) | 0;\n            t1h = (t1h + Wih + getCarry(t1l, Wil)) | 0;\n            // t2 = sigma0 + maj\n            const t2l = (sigma0l + majl) | 0;\n            const t2h = (sigma0h + majh + getCarry(t2l, sigma0l)) | 0;\n            hh = gh;\n            hl = gl;\n            gh = fh;\n            gl = fl;\n            fh = eh;\n            fl = el;\n            el = (dl + t1l) | 0;\n            eh = (dh + t1h + getCarry(el, dl)) | 0;\n            dh = ch;\n            dl = cl;\n            ch = bh;\n            cl = bl;\n            bh = ah;\n            bl = al;\n            al = (t1l + t2l) | 0;\n            ah = (t1h + t2h + getCarry(al, t1l)) | 0;\n        }\n        this._al = (this._al + al) | 0;\n        this._bl = (this._bl + bl) | 0;\n        this._cl = (this._cl + cl) | 0;\n        this._dl = (this._dl + dl) | 0;\n        this._el = (this._el + el) | 0;\n        this._fl = (this._fl + fl) | 0;\n        this._gl = (this._gl + gl) | 0;\n        this._hl = (this._hl + hl) | 0;\n        this._ah = (this._ah + ah + getCarry(this._al, al)) | 0;\n        this._bh = (this._bh + bh + getCarry(this._bl, bl)) | 0;\n        this._ch = (this._ch + ch + getCarry(this._cl, cl)) | 0;\n        this._dh = (this._dh + dh + getCarry(this._dl, dl)) | 0;\n        this._eh = (this._eh + eh + getCarry(this._el, el)) | 0;\n        this._fh = (this._fh + fh + getCarry(this._fl, fl)) | 0;\n        this._gh = (this._gh + gh + getCarry(this._gl, gl)) | 0;\n        this._hh = (this._hh + hh + getCarry(this._hl, hl)) | 0;\n    }\n    _hash() {\n        const H = Buffer.allocUnsafe(64);\n        function writeInt64BE(h, l, offset) {\n            H.writeInt32BE(h, offset);\n            H.writeInt32BE(l, offset + 4);\n        }\n        writeInt64BE(this._ah, this._al, 0);\n        writeInt64BE(this._bh, this._bl, 8);\n        writeInt64BE(this._ch, this._cl, 16);\n        writeInt64BE(this._dh, this._dl, 24);\n        writeInt64BE(this._eh, this._el, 32);\n        writeInt64BE(this._fh, this._fl, 40);\n        writeInt64BE(this._gh, this._gl, 48);\n        writeInt64BE(this._hh, this._hl, 56);\n        return H;\n    }\n}\n\nconst HASH_IMPLEMENTATIONS = new Map([\n    ['md5', MD5],\n    ['sha-1', Sha1],\n    ['sha-256', Sha256],\n    ['sha-512', Sha512],\n    ['sha1', Sha1],\n    ['sha256', Sha256],\n    ['sha512', Sha512]\n]);\nfunction createHash(alg) {\n    alg = alg.toLowerCase();\n    const HashImp = HASH_IMPLEMENTATIONS.get(alg);\n    if (HashImp) {\n        return new HashImp();\n    }\n    else {\n        throw new Error('Unsupported hash algorithm: ' + alg);\n    }\n}\n\n/**\n * This file is derived from prior work.\n *\n * See NOTICE.md for full license text.\n *\n * Derived from:\n * - hash-base, Copyright (c) 2016 Kirill Fomichev\n * - cipher-base, Copyright (c) 2017 crypto-browserify contributors\n * - create-hash, Copyright (c) 2017 crypto-browserify contributors\n * - create-hmac, Copyright (c) 2017 crypto-browserify contributors\n * - randombytes, Copyright (c) 2017 crypto-browserify\n */\nconst ZEROS = Buffer.alloc(128);\nclass Hmac extends Transform {\n    constructor(alg, key) {\n        super();\n        if (typeof key === 'string') {\n            key = Buffer.from(key);\n        }\n        const blocksize = alg === 'sha512' ? 128 : 64;\n        this._alg = alg;\n        if (key.length > blocksize) {\n            key = createHash(alg)\n                .update(key)\n                .digest();\n        }\n        else if (key.length < blocksize) {\n            key = Buffer.concat([key, ZEROS], blocksize);\n        }\n        this._ipad = Buffer.alloc(blocksize);\n        this._opad = Buffer.alloc(blocksize);\n        for (let i = 0; i < blocksize; i++) {\n            this._ipad[i] = key[i] ^ 0x36;\n            this._opad[i] = key[i] ^ 0x5c;\n        }\n        this._hash = createHash(alg).update(this._ipad);\n    }\n    _transform(data, enc, next) {\n        let err;\n        try {\n            this.update(data, enc);\n        }\n        catch (e) {\n            err = e;\n        }\n        finally {\n            next(err);\n        }\n    }\n    _flush(done) {\n        let err;\n        try {\n            this.push(this._final());\n        }\n        catch (e) {\n            err = e;\n        }\n        done(err);\n    }\n    _final() {\n        const h = this._hash.digest();\n        return createHash(this._alg)\n            .update(this._opad)\n            .update(h)\n            .digest();\n    }\n    update(data, inputEnc) {\n        this._hash.update(data, inputEnc);\n        return this;\n    }\n    digest(outputEnc) {\n        const outData = this._final() || Buffer.alloc(0);\n        if (outputEnc) {\n            return outData.toString(outputEnc);\n        }\n        return outData;\n    }\n}\n\nlet root;\nif (typeof window !== 'undefined') {\n    root = window;\n}\nelse if (typeof global !== 'undefined') {\n    root = global;\n}\nfunction randomBytes(size) {\n    const rawBytes = new Uint8Array(size);\n    if (size > 0) {\n        (root.crypto || root.msCrypto).getRandomValues(rawBytes);\n    }\n    return Buffer.from(rawBytes.buffer);\n}\nfunction getHashes() {\n    return ['sha-1', 'sha-256', 'sha-512', 'md5'];\n}\nfunction createHmac(alg, key) {\n    return new Hmac(alg.toLowerCase(), key);\n}\nconst nativeFetch = fetch;\nconst nativeWS = WebSocket;\n\nexport { Hash, Hmac, nativeWS as WebSocket, createHash, createHmac, nativeFetch as fetch, getHashes, randomBytes };\n","module.exports = function() {\n\tthrow new Error(\"define cannot be used indirect\");\n};\n","\n/**\n * Module dependencies.\n */\n\nvar parseuri = require('parseuri');\nvar debug = require('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url (uri, loc) {\n  var obj = uri;\n\n  // default to window.location\n  loc = loc || (typeof location !== 'undefined' && location);\n  if (null == uri) uri = loc.protocol + '//' + loc.host;\n\n  // relative path support\n  if ('string' === typeof uri) {\n    if ('/' === uri.charAt(0)) {\n      if ('/' === uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.host + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' !== typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    } else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  var ipv6 = obj.host.indexOf(':') !== -1;\n  var host = ipv6 ? '[' + obj.host + ']' : obj.host;\n\n  // define unique id\n  obj.id = obj.protocol + '://' + host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + host + (loc && loc.port === obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* Active `debug` instances.\n\t*/\n\tcreateDebug.instances = [];\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.enabled = createDebug.enabled(namespace);\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = selectColor(namespace);\n\t\tdebug.destroy = destroy;\n\t\tdebug.extend = extend;\n\t\t// Debug.formatArgs = formatArgs;\n\t\t// debug.rawLog = rawLog;\n\n\t\t// env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\tcreateDebug.instances.push(debug);\n\n\t\treturn debug;\n\t}\n\n\tfunction destroy() {\n\t\tconst index = createDebug.instances.indexOf(this);\n\t\tif (index !== -1) {\n\t\t\tcreateDebug.instances.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < createDebug.instances.length; i++) {\n\t\t\tconst instance = createDebug.instances[i];\n\t\t\tinstance.enabled = createDebug.enabled(instance.namespace);\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' || (typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]');\nvar withNativeFile = typeof File === 'function' || (typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]');\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n","\nmodule.exports = require('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = require('engine.io-parser');\n","/**\n * Module dependencies.\n */\n\nvar transports = require('./transports/index');\nvar Emitter = require('component-emitter');\nvar debug = require('debug')('engine.io-client:socket');\nvar index = require('indexof');\nvar parser = require('engine.io-parser');\nvar parseuri = require('parseuri');\nvar parseqs = require('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket (uri, opts) {\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.hostname = uri.host;\n    opts.secure = uri.protocol === 'https' || uri.protocol === 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  } else if (opts.host) {\n    opts.hostname = parseuri(opts.host).host;\n  }\n\n  this.secure = null != opts.secure ? opts.secure\n    : (typeof location !== 'undefined' && 'https:' === location.protocol);\n\n  if (opts.hostname && !opts.port) {\n    // if no port is specified manually, use the protocol default\n    opts.port = this.secure ? '443' : '80';\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (typeof location !== 'undefined' ? location.hostname : 'localhost');\n  this.port = opts.port || (typeof location !== 'undefined' && location.port\n      ? location.port\n      : (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' === typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.withCredentials = false !== opts.withCredentials;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.transportOptions = opts.transportOptions || {};\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.prevBufferLen = 0;\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || {}) : false;\n\n  if (true === this.perMessageDeflate) this.perMessageDeflate = {};\n  if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {\n    this.perMessageDeflate.threshold = 1024;\n  }\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx || null;\n  this.key = opts.key || null;\n  this.passphrase = opts.passphrase || null;\n  this.cert = opts.cert || null;\n  this.ca = opts.ca || null;\n  this.ciphers = opts.ciphers || null;\n  this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;\n  this.forceNode = !!opts.forceNode;\n\n  // detect ReactNative environment\n  this.isReactNative = (typeof navigator !== 'undefined' && typeof navigator.product === 'string' && navigator.product.toLowerCase() === 'reactnative');\n\n  // other options for Node.js or ReactNative client\n  if (typeof self === 'undefined' || this.isReactNative) {\n    if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {\n      this.extraHeaders = opts.extraHeaders;\n    }\n\n    if (opts.localAddress) {\n      this.localAddress = opts.localAddress;\n    }\n  }\n\n  // set on handshake\n  this.id = null;\n  this.upgrades = null;\n  this.pingInterval = null;\n  this.pingTimeout = null;\n\n  // set on heartbeat\n  this.pingIntervalTimer = null;\n  this.pingTimeoutTimer = null;\n\n  this.open();\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = require('./transport');\nSocket.transports = require('./transports/index');\nSocket.parser = require('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // per-transport options\n  var options = this.transportOptions[name] || {};\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    query: query,\n    socket: this,\n    agent: options.agent || this.agent,\n    hostname: options.hostname || this.hostname,\n    port: options.port || this.port,\n    secure: options.secure || this.secure,\n    path: options.path || this.path,\n    forceJSONP: options.forceJSONP || this.forceJSONP,\n    jsonp: options.jsonp || this.jsonp,\n    forceBase64: options.forceBase64 || this.forceBase64,\n    enablesXDR: options.enablesXDR || this.enablesXDR,\n    withCredentials: options.withCredentials || this.withCredentials,\n    timestampRequests: options.timestampRequests || this.timestampRequests,\n    timestampParam: options.timestampParam || this.timestampParam,\n    policyPort: options.policyPort || this.policyPort,\n    pfx: options.pfx || this.pfx,\n    key: options.key || this.key,\n    passphrase: options.passphrase || this.passphrase,\n    cert: options.cert || this.cert,\n    ca: options.ca || this.ca,\n    ciphers: options.ciphers || this.ciphers,\n    rejectUnauthorized: options.rejectUnauthorized || this.rejectUnauthorized,\n    perMessageDeflate: options.perMessageDeflate || this.perMessageDeflate,\n    extraHeaders: options.extraHeaders || this.extraHeaders,\n    forceNode: options.forceNode || this.forceNode,\n    localAddress: options.localAddress || this.localAddress,\n    requestTimeout: options.requestTimeout || this.requestTimeout,\n    protocols: options.protocols || void (0),\n    isReactNative: this.isReactNative\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') !== -1) {\n    transport = 'websocket';\n  } else if (0 === this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function () {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function (transport) {\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function () {\n    self.onDrain();\n  })\n  .on('packet', function (packet) {\n    self.onPacket(packet);\n  })\n  .on('error', function (e) {\n    self.onError(e);\n  })\n  .on('close', function () {\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 });\n  var failed = false;\n  var self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen () {\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' === msg.type && 'probe' === msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' === transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' === self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport () {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  // Handle any error that happens while probing\n  function onerror (err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose () {\n    onerror('transport closed');\n  }\n\n  // When the socket is closed while we're probing\n  function onclose () {\n    onerror('socket closed');\n  }\n\n  // When the socket is upgraded while we're probing\n  function onupgrade (to) {\n    if (transport && to.name !== transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  // Remove all listeners on the transport and on self\n  function cleanup () {\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' === this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' === this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' === this.readyState || 'open' === this.readyState ||\n      'closing' === this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(JSON.parse(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        this.emit('pong');\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.onError(err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if ('closed' === this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' === self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api private\n*/\n\nSocket.prototype.ping = function () {\n  var self = this;\n  this.sendPacket('ping', function () {\n    self.emit('ping');\n  });\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function () {\n  this.writeBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (0 === this.writeBuffer.length) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' !== this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @param {Object} options.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, options, fn) {\n  this.sendPacket('message', msg, options, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Object} options.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, options, fn) {\n  if ('function' === typeof data) {\n    fn = data;\n    data = undefined;\n  }\n\n  if ('function' === typeof options) {\n    fn = options;\n    options = null;\n  }\n\n  if ('closing' === this.readyState || 'closed' === this.readyState) {\n    return;\n  }\n\n  options = options || {};\n  options.compress = false !== options.compress;\n\n  var packet = {\n    type: type,\n    data: data,\n    options: options\n  };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  if (fn) this.once('flush', fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function () {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  function close () {\n    self.onClose('forced close');\n    debug('socket closing - telling transport to close');\n    self.transport.close();\n  }\n\n  function cleanupAndClose () {\n    self.removeListener('upgrade', cleanupAndClose);\n    self.removeListener('upgradeError', cleanupAndClose);\n    close();\n  }\n\n  function waitForUpgrade () {\n    // wait for upgrade to finish since we can't send packets while pausing a transport\n    self.once('upgrade', cleanupAndClose);\n    self.once('upgradeError', cleanupAndClose);\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' === this.readyState || 'open' === this.readyState || 'closing' === this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n\n    // clean buffers after, so users can still\n    // grab the buffers on `close` event\n    self.writeBuffer = [];\n    self.prevBufferLen = 0;\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i < j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n","\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = typeof XMLHttpRequest !== 'undefined' &&\n    'withCredentials' in new XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n","/* global attachEvent */\n\n/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar Polling = require('./polling');\nvar Emitter = require('component-emitter');\nvar inherit = require('component-inherit');\nvar debug = require('debug')('engine.io-client:polling-xhr');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty () {}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR (opts) {\n  Polling.call(this, opts);\n  this.requestTimeout = opts.requestTimeout;\n  this.extraHeaders = opts.extraHeaders;\n\n  if (typeof location !== 'undefined') {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = (typeof location !== 'undefined' && opts.hostname !== location.hostname) ||\n      port !== opts.port;\n    this.xs = opts.secure !== isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function (opts) {\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n  opts.withCredentials = this.withCredentials;\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  opts.requestTimeout = this.requestTimeout;\n\n  // other options for Node.js client\n  opts.extraHeaders = this.extraHeaders;\n\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function (data, fn) {\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function (err) {\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function () {\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function (data) {\n    self.onData(data);\n  });\n  req.on('error', function (err) {\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request (opts) {\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined !== opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.withCredentials = opts.withCredentials;\n  this.requestTimeout = opts.requestTimeout;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function () {\n  var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n\n  var xhr = this.xhr = new XMLHttpRequest(opts);\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    try {\n      if (this.extraHeaders) {\n        xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n        for (var i in this.extraHeaders) {\n          if (this.extraHeaders.hasOwnProperty(i)) {\n            xhr.setRequestHeader(i, this.extraHeaders[i]);\n          }\n        }\n      }\n    } catch (e) {}\n\n    if ('POST' === this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    try {\n      xhr.setRequestHeader('Accept', '*/*');\n    } catch (e) {}\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = this.withCredentials;\n    }\n\n    if (this.requestTimeout) {\n      xhr.timeout = this.requestTimeout;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function () {\n        self.onLoad();\n      };\n      xhr.onerror = function () {\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 2) {\n          try {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (self.supportsBinary && contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n              xhr.responseType = 'arraybuffer';\n            }\n          } catch (e) {}\n        }\n        if (4 !== xhr.readyState) return;\n        if (200 === xhr.status || 1223 === xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function () {\n            self.onError(typeof xhr.status === 'number' ? xhr.status : 0);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function () {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (typeof document !== 'undefined') {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function () {\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function (data) {\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function (err) {\n  this.emit('error', err);\n  this.cleanup(true);\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function (fromError) {\n  if ('undefined' === typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  if (fromError) {\n    try {\n      this.xhr.abort();\n    } catch (e) {}\n  }\n\n  if (typeof document !== 'undefined') {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function () {\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type');\n    } catch (e) {}\n    if (contentType === 'application/octet-stream' || contentType === 'application/octet-stream; charset=UTF-8') {\n      data = this.xhr.response || this.xhr.responseText;\n    } else {\n      data = this.xhr.responseText;\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function () {\n  return typeof XDomainRequest !== 'undefined' && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function () {\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nRequest.requestsCount = 0;\nRequest.requests = {};\n\nif (typeof document !== 'undefined') {\n  if (typeof attachEvent === 'function') {\n    attachEvent('onunload', unloadHandler);\n  } else if (typeof addEventListener === 'function') {\n    var terminationEvent = 'onpagehide' in self ? 'pagehide' : 'unload';\n    addEventListener(terminationEvent, unloadHandler, false);\n  }\n}\n\nfunction unloadHandler () {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n","\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n","module.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n","/*! https://mths.be/utf8js v2.1.2 by @mathias */\n\nvar stringFromCharCode = String.fromCharCode;\n\n// Taken from https://mths.be/punycode\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\tvar value;\n\tvar extra;\n\twhile (counter < length) {\n\t\tvalue = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// high surrogate, and there is a next character\n\t\t\textra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n// Taken from https://mths.be/punycode\nfunction ucs2encode(array) {\n\tvar length = array.length;\n\tvar index = -1;\n\tvar value;\n\tvar output = '';\n\twhile (++index < length) {\n\t\tvalue = array[index];\n\t\tif (value > 0xFFFF) {\n\t\t\tvalue -= 0x10000;\n\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(value);\n\t}\n\treturn output;\n}\n\nfunction checkScalarValue(codePoint, strict) {\n\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\tif (strict) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}\n/*--------------------------------------------------------------------------*/\n\nfunction createByte(codePoint, shift) {\n\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n}\n\nfunction encodeCodePoint(codePoint, strict) {\n\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\treturn stringFromCharCode(codePoint);\n\t}\n\tvar symbol = '';\n\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t}\n\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\tif (!checkScalarValue(codePoint, strict)) {\n\t\t\tcodePoint = 0xFFFD;\n\t\t}\n\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\tsymbol += createByte(codePoint, 12);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\treturn symbol;\n}\n\nfunction utf8encode(string, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tvar codePoints = ucs2decode(string);\n\tvar length = codePoints.length;\n\tvar index = -1;\n\tvar codePoint;\n\tvar byteString = '';\n\twhile (++index < length) {\n\t\tcodePoint = codePoints[index];\n\t\tbyteString += encodeCodePoint(codePoint, strict);\n\t}\n\treturn byteString;\n}\n\n/*--------------------------------------------------------------------------*/\n\nfunction readContinuationByte() {\n\tif (byteIndex >= byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\tif ((continuationByte & 0xC0) == 0x80) {\n\t\treturn continuationByte & 0x3F;\n\t}\n\n\t// If we end up here, its not a continuation byte\n\tthrow Error('Invalid continuation byte');\n}\n\nfunction decodeSymbol(strict) {\n\tvar byte1;\n\tvar byte2;\n\tvar byte3;\n\tvar byte4;\n\tvar codePoint;\n\n\tif (byteIndex > byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tif (byteIndex == byteCount) {\n\t\treturn false;\n\t}\n\n\t// Read first byte\n\tbyte1 = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\t// 1-byte sequence (no continuation bytes)\n\tif ((byte1 & 0x80) == 0) {\n\t\treturn byte1;\n\t}\n\n\t// 2-byte sequence\n\tif ((byte1 & 0xE0) == 0xC0) {\n\t\tbyte2 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\tif (codePoint >= 0x80) {\n\t\t\treturn codePoint;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 3-byte sequence (may include unpaired surrogates)\n\tif ((byte1 & 0xF0) == 0xE0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\tif (codePoint >= 0x0800) {\n\t\t\treturn checkScalarValue(codePoint, strict) ? codePoint : 0xFFFD;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 4-byte sequence\n\tif ((byte1 & 0xF8) == 0xF0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tbyte4 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t(byte3 << 0x06) | byte4;\n\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\treturn codePoint;\n\t\t}\n\t}\n\n\tthrow Error('Invalid UTF-8 detected');\n}\n\nvar byteArray;\nvar byteCount;\nvar byteIndex;\nfunction utf8decode(byteString, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tbyteArray = ucs2decode(byteString);\n\tbyteCount = byteArray.length;\n\tbyteIndex = 0;\n\tvar codePoints = [];\n\tvar tmp;\n\twhile ((tmp = decodeSymbol(strict)) !== false) {\n\t\tcodePoints.push(tmp);\n\t}\n\treturn ucs2encode(codePoints);\n}\n\nmodule.exports = {\n\tversion: '2.1.2',\n\tencode: utf8encode,\n\tdecode: utf8decode\n};\n","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n};\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n};\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nmodule.exports = (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * Until https://github.com/tc39/proposal-global is shipped.\n */\nfunction glob () {\n  return typeof self !== 'undefined' ? self\n      : typeof window !== 'undefined' ? window\n      : typeof global !== 'undefined' ? global : {};\n}\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    var global = glob();\n    callbacks = global.___eio = (global.___eio || []);\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parser = require('engine.io-parser');\nvar parseqs = require('parseqs');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:websocket');\n\nvar BrowserWebSocket, NodeWebSocket;\n\nif (typeof WebSocket !== 'undefined') {\n  BrowserWebSocket = WebSocket;\n} else if (typeof self !== 'undefined') {\n  BrowserWebSocket = self.WebSocket || self.MozWebSocket;\n}\n\nif (typeof window === 'undefined') {\n  try {\n    NodeWebSocket = require('ws');\n  } catch (e) { }\n}\n\n/**\n * Get either the `WebSocket` or `MozWebSocket` globals\n * in the browser or try to resolve WebSocket-compatible\n * interface exposed by `ws` for Node-like environment.\n */\n\nvar WebSocketImpl = BrowserWebSocket || NodeWebSocket;\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  this.perMessageDeflate = opts.perMessageDeflate;\n  this.usingBrowserWebSocket = BrowserWebSocket && !opts.forceNode;\n  this.protocols = opts.protocols;\n  if (!this.usingBrowserWebSocket) {\n    WebSocketImpl = NodeWebSocket;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function () {\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var uri = this.uri();\n  var protocols = this.protocols;\n  var opts = {\n    agent: this.agent,\n    perMessageDeflate: this.perMessageDeflate\n  };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  if (this.extraHeaders) {\n    opts.headers = this.extraHeaders;\n  }\n  if (this.localAddress) {\n    opts.localAddress = this.localAddress;\n  }\n\n  try {\n    this.ws =\n      this.usingBrowserWebSocket && !this.isReactNative\n        ? protocols\n          ? new WebSocketImpl(uri, protocols)\n          : new WebSocketImpl(uri)\n        : new WebSocketImpl(uri, protocols, opts);\n  } catch (err) {\n    return this.emit('error', err);\n  }\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  if (this.ws.supports && this.ws.supports.binary) {\n    this.supportsBinary = true;\n    this.ws.binaryType = 'nodebuffer';\n  } else {\n    this.ws.binaryType = 'arraybuffer';\n  }\n\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function () {\n  var self = this;\n\n  this.ws.onopen = function () {\n    self.onOpen();\n  };\n  this.ws.onclose = function () {\n    self.onClose();\n  };\n  this.ws.onmessage = function (ev) {\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function (e) {\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  var total = packets.length;\n  for (var i = 0, l = total; i < l; i++) {\n    (function (packet) {\n      parser.encodePacket(packet, self.supportsBinary, function (data) {\n        if (!self.usingBrowserWebSocket) {\n          // always create a new object (GH-437)\n          var opts = {};\n          if (packet.options) {\n            opts.compress = packet.options.compress;\n          }\n\n          if (self.perMessageDeflate) {\n            var len = 'string' === typeof data ? Buffer.byteLength(data) : data.length;\n            if (len < self.perMessageDeflate.threshold) {\n              opts.compress = false;\n            }\n          }\n        }\n\n        // Sometimes the websocket has already been closed but the browser didn't\n        // have a chance of informing us about it yet, in that case send will\n        // throw an error\n        try {\n          if (self.usingBrowserWebSocket) {\n            // TypeError is thrown when passing the second argument on Safari\n            self.ws.send(data);\n          } else {\n            self.ws.send(data, opts);\n          }\n        } catch (e) {\n          debug('websocket closed before onclose event');\n        }\n\n        --total || done();\n      });\n    })(packets[i]);\n  }\n\n  function done () {\n    self.emit('flush');\n\n    // fake drain\n    // defer to next tick to allow Socket to clear writeBuffer\n    setTimeout(function () {\n      self.writable = true;\n      self.emit('drain');\n    }, 0);\n  }\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function () {\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function () {\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' === schema && Number(this.port) !== 443) ||\n    ('ws' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function () {\n  return !!WebSocketImpl && !('__initialize' in WebSocketImpl && this.name === WS.prototype.name);\n};\n","module.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n","\n/**\n * Expose `Backoff`.\n */\n\nmodule.exports = Backoff;\n\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction Backoff(opts) {\n  opts = opts || {};\n  this.ms = opts.min || 100;\n  this.max = opts.max || 10000;\n  this.factor = opts.factor || 2;\n  this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n  this.attempts = 0;\n}\n\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\n\nBackoff.prototype.duration = function(){\n  var ms = this.ms * Math.pow(this.factor, this.attempts++);\n  if (this.jitter) {\n    var rand =  Math.random();\n    var deviation = Math.floor(rand * this.jitter * ms);\n    ms = (Math.floor(rand * 10) & 1) == 0  ? ms - deviation : ms + deviation;\n  }\n  return Math.min(ms, this.max) | 0;\n};\n\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\n\nBackoff.prototype.reset = function(){\n  this.attempts = 0;\n};\n\n/**\n * Set the minimum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMin = function(min){\n  this.ms = min;\n};\n\n/**\n * Set the maximum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMax = function(max){\n  this.max = max;\n};\n\n/**\n * Set the jitter\n *\n * @api public\n */\n\nBackoff.prototype.setJitter = function(jitter){\n  this.jitter = jitter;\n};\n\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nexports.__esModule = true;\nvar Semaphore_1 = require(\"./Semaphore\");\n/**\n * A lock that can be used to synchronize critical sections in your code.\n * For more details on how to use this class, please view the documentation\n * of the Semaphore class from which Lock inherits.\n */\nvar Lock = (function (_super) {\n    __extends(Lock, _super);\n    /**\n     * Creates a lock.\n     */\n    function Lock() {\n        return _super.call(this, 1) || this;\n    }\n    return Lock;\n}(Semaphore_1[\"default\"]));\nexports.Lock = Lock;\n","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","// generated by genversion\nexport const version = '25.1.0-rc.2'\n","\n\nconst resolvePromises = (promises, result) => {\n\tpromises.forEach(p => p.resolve(result));\n};\n\nconst rejectPromises = (promises, err) => {\n\tpromises.forEach(p => p.reject(err));\n};\n\n/**\n * The PromiseQueue class offers a promise queue, enabling us to execute promise in sequence, with some restrictions.\n * It provides a method \"queue\", which is in charge of queueing and executing every callback it receives.\n *\n * Example:\n * we have an empty queue and we add a functionA to execute. Once funcionA is executing, we queue functionB, functionC\n * and functionB again. When functionA ends its execution, the queue decides to execute the last call of functionB.\n * At this point, functionC call is rejected because there are more priority calls. Once functionB ends its execution,\n * the first call to functionB is resolved or rejected depending on the result.\n *\n * NOTE: more use cases of this class can be seen in test/unit/utils/PromiseQueue\n * @private\n */\nexport class PromiseQueue {\n\tconstructor() {\n\t\tthis.executionQueue = [];\n\t\tthis.executing = false;\n\t}\n\n\t/**\n\t * Method which receives a callback expected to return a promise and the type of its callback.\n\t * It also returns a promise which will be resolved when the callback ends its execution, or rejected if an error\n\t * occurs or the callback aren't going to be executed.\n\t * When there are multiple callbacks waiting for being executed, it executes the last one; rejecting all the prior\n\t * added callbacks with a different type. Once the selected callback ends its execution, all the prior promises of the\n\t * callbacks with the same type are rejected or resolved in function of its result.\n\t *\n\t * @param cb function to execute. It musts return a promise.\n\t * @param type type of the callback to execute. Useful in order to decide how to resolve or reject callbacks which\n\t * aren't going to be executed because there are more priority ones.\n\t * @returns Promise Promise which will be resolved or rejected with the result of executing the callback.\n\t */\n\tqueue(cb, type) {\n\t\tconst executionPromise = this._addToExecutionQueue({\n\t\t\tcb,\n\t\t\ttype,\n\t\t});\n\n\t\tif (!this.executing) {\n\t\t\tthis._startExecution();\n\t\t}\n\n\t\treturn executionPromise;\n\t}\n\n\t_addToExecutionQueue(executionData) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\texecutionData.resolve = resolve;\n\t\t\texecutionData.reject = reject;\n\t\t\tthis.executionQueue.push(executionData);\n\t\t});\n\t}\n\n\t_startExecution() {\n\t\tthis.executing = true;\n\t\treturn this._decideKeepExecuting();\n\t}\n\n\t_decideKeepExecuting() {\n\t\treturn this.executionQueue.length > 0 ?\n\t\t\tthis._executeNextFunction()\n\t\t\t\t.then(() => this._decideKeepExecuting())\n\t\t\t:\n\t\t\tthis._endExecution();\n\t}\n\n\t_endExecution() {\n\t\treturn Promise.resolve()\n\t\t\t.then(() => {\n\t\t\t\tthis.executing = false;\n\t\t\t});\n\t}\n\n\t_executeNextFunction() {\n\t\tconst functionToExecute = this.executionQueue.pop();\n\t\tconst sameTypePromises = this._getSameTypePromises(functionToExecute.type);\n\t\tthis._cleanExecutionQueue(functionToExecute.type);\n\t\treturn functionToExecute.cb()\n\t\t\t.then((result) => {\n\t\t\t\tfunctionToExecute.resolve(result);\n\t\t\t\tresolvePromises(sameTypePromises, result);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tfunctionToExecute.reject(err);\n\t\t\t\trejectPromises(sameTypePromises, err);\n\t\t\t});\n\t}\n\n\t_cleanExecutionQueue(type) {\n\t\tthis._rejectDifferentTypePromises(type);\n\t\tthis.executionQueue = [];\n\t}\n\n\t_getSameTypePromises(type) {\n\t\treturn this.executionQueue\n\t\t\t.filter(executionData => executionData.type === type);\n\t}\n\n\t_rejectDifferentTypePromises(type) {\n\t\treturn this.executionQueue\n\t\t\t.filter(executionData => executionData.type !== type)\n\t\t\t.map((executionData) => {\n\t\t\t\texecutionData.reject(Error('Unable to call this function because there are more priority ones'));\n\t\t\t});\n\t}\n}\n","/** @private */\nexport function bindMethods(instance, methods, appendEmitter = true) {\n\tmethods.forEach((method) => {\n\t\tif (appendEmitter) {\n\t\t\tinstance[method] = function(...args) {\n\t\t\t\targs.push(this);\n\t\t\t\treturn Object.getPrototypeOf(instance)[method].apply(instance, args);\n\t\t\t};\n\t\t} else {\n\t\t\tinstance[method] = Object.getPrototypeOf(instance)[method].bind(instance);\n\t\t}\n\t});\n}\n","/** @private */\nexport function Enum(...args) {\n\tif (!(this instanceof Enum)) {\n\t\treturn new Enum(...args);\n\t}\n\tlet list;\n\tif (args.length === 1 && Array.isArray(args[0])) {\n\t\tlist = args[0];\n\t} else {\n\t\tlist = args;\n\t}\n\tlist.forEach((arg) => {\n\t\tlet symbol = Symbol(arg);\n\t\tthis[arg] = symbol;\n\t\tthis[symbol] = arg;\n\t});\n\tObject.freeze(this);\n}\n","/** @private */\nexport function isDevice() {\n\treturn !!(window.cordova ? window.device.uuid : null);\n}\n","/** @private */\nexport function getDeviceId() {\n\treturn window.cordova ? window.device.uuid : null;\n}\n","import EXIF from 'exif-js';\nimport {decode} from 'base64-arraybuffer';\nimport {cropImage} from './cropImage';\n\nconst REGULAR_EXPRESSION_BASE64 = /^data:([A-Za-z-+/]+);base64,(.+)$/;\n\nfunction isBase64(url) {\n\treturn !!REGULAR_EXPRESSION_BASE64.test(url);\n}\n\n/**\n * Reset the orientation of an image and return the image in base64\n * Reference: https://stackoverflow.com/questions/20600800/js-client-side-exif-orientation-rotate-and-mirror-jpeg-images/31273162#31273162\n * @param {String} srcBase64 Base64 uri of an image\n * @param {Integer} srcOrientation Identify the orientation of an image\n * @return {String} Base64 uri of an transformed image\n */\nfunction resetOrientation(srcBase64, srcOrientation) {\n\tlet img = new Image();\n\treturn new Promise((resolve) => {\n\t\timg.onload = function() {\n\t\t\tlet canvas = document.createElement('canvas'),\n\t\t\t\tctx = canvas.getContext('2d');\n\n\t\t\t// set proper canvas dimensions before transform & export\n\t\t\tif (srcOrientation > 4 && srcOrientation < 9) {\n\t\t\t\tcanvas.width = this.height;\n\t\t\t\tcanvas.height = this.width;\n\t\t\t} else {\n\t\t\t\tcanvas.width = this.width;\n\t\t\t\tcanvas.height = this.height;\n\t\t\t}\n\n\t\t\t// transform context before drawing image\n\t\t\tswitch (srcOrientation) {\n\t\t\t\tcase 2: ctx.transform(-1, 0, 0, 1, this.width, 0); break;\n\t\t\t\tcase 3: ctx.transform(-1, 0, 0, -1, this.width, this.height); break;\n\t\t\t\tcase 4: ctx.transform(1, 0, 0, -1, 0, this.height); break;\n\t\t\t\tcase 5: ctx.transform(0, 1, 1, 0, 0, 0); break;\n\t\t\t\tcase 6: ctx.transform(0, 1, -1, 0, this.height, 0); break;\n\t\t\t\tcase 7: ctx.transform(0, -1, -1, 0, this.height, this.width); break;\n\t\t\t\tcase 8: ctx.transform(0, -1, 1, 0, 0, this.width); break;\n\t\t\t\tdefault: break;\n\t\t\t}\n\n\t\t\t// draw image\n\t\t\tctx.drawImage(img, 0, 0, this.width, this.height);\n\t\t\tlet base64Url = ctx.canvas.toDataURL('image/png');\n\t\t\timg = null;\n\t\t\tcanvas = null;\n\t\t\tresolve(base64Url);\n\t\t};\n\t\timg.src = srcBase64;\n\t});\n}\n\n\n/**\n * Scales an image to the size passed by parameters and returns a URI\n * with the new image encoded in base64\n * @param {string} url Base64 URI of an image\n * @param {number} width Desired width of the image\n * @param {number} height Desired height of the image\n * @return {Promise<string>} Base64 URI of a transformed image\n * @private\n */\nexport function scaleImg(url, width = 128, height = 128) {\n\tlet type, data;\n\tif (!window) {\n\t\treturn url;\n\t}\n\treturn new Promise((resolve) => {\n\t\tif (!isBase64(url)) {\n\t\t\treturn resolve();\n\t\t}\n\t\t[, type, data] = url.match(REGULAR_EXPRESSION_BASE64);\n\t\tlet exifdata = EXIF.readFromBinaryFile(decode(data));\n\t\tif (exifdata) {\n\t\t\treturn resolve(exifdata.Orientation);\n\t\t}\n\t\treturn resolve();\n\t}).then((orientation) => {\n\t\tif (orientation) {\n\t\t\treturn resetOrientation(url, orientation, type);\n\t\t}\n\t\treturn url;\n\t}).then(imageUrl => cropImage(imageUrl, width, height));\n}\n","/**\n * Crops an image to get a square picture\n * @param {String} imageUrl Uri of an image\n * @param {Integer} widthScalated Width of the image\n * @param {Integer} heightScalated Height of the image\n * @return {String} Base64 uri of a transformed image\n * @private\n */\nexport function cropImage(imageUrl, widthScalated, heightScalated) {\n\treturn new Promise((resolve) => {\n\t\tif (!window) {\n\t\t\tresolve(imageUrl);\n\t\t}\n\t\tlet image = new Image();\n\t\timage.onload = function() {\n\t\t\tlet canvas = document.createElement('canvas');\n\t\t\tcanvas.width = Math.min(this.width, widthScalated);\n\t\t\tcanvas.height = Math.min(this.height, heightScalated);\n\t\t\tlet sx = 0, sy = 0, dx = 0, dy = 0;\n\t\t\tlet sWidth = this.width;\n\t\t\tlet sHeight = this.width;\n\t\t\tlet dWidth = Math.min(this.width, widthScalated);\n\t\t\tlet dHeight = Math.min(this.height, heightScalated);\n\t\t\tif (this.height > this.width) {\n\t\t\t\tsy = (this.height - this.width) / 2;\n\t\t\t} else if (this.height < this.width) {\n\t\t\t\tsx = (this.width - this.height) / 2;\n\t\t\t\tsWidth = sHeight = this.height;\n\t\t\t}\n\t\t\tcanvas.getContext('2d').drawImage(this,\n\t\t\t\tsx, sy,\n\t\t\t\tsWidth,\n\t\t\t\tsHeight,\n\t\t\t\tdx, dy,\n\t\t\t\tdWidth, dHeight);\n\t\t\tlet base64Url = canvas.toDataURL('image/png');\n\t\t\timage = null;\n\t\t\tcanvas = null;\n\t\t\tresolve(base64Url);\n\t\t};\n\t\timage.src = imageUrl;\n\t});\n}\n","const PREFIX = 'sippo.storage.';\n\n/**\n * Get a previous stored value with given name.\n * @param {string} name\n * @return {object} previous stored object or null if not found.\n * @private\n */\nexport function getItem(name) {\n\treturn JSON.parse(localStorage.getItem(PREFIX + name));\n}\n\n/**\n * Store a value with an associated name.\n * @param {string} name\n * @param {object} value\n * @private\n */\nexport function setItem(name, value) {\n\tlocalStorage.setItem(PREFIX + name, JSON.stringify(value));\n}\n\n/**\n * Remove the item with the associated name.\n * @param {string} name\n * @private\n */\nexport function removeItem(name) {\n\tlocalStorage.removeItem(PREFIX + name);\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible status of a session. Possible values:\n * - UNCONNECTED: The session has not attempted to connect.\n * - CONNECTING: The session is in the process of being established.\n * - CONNECTED: The session is connected to the server.\n * - SUSPENDED: The session is in a connected state but the underlying channel is allowed to be closed.\n * - DISCONNECTED: The session is ended and should no longer be used.\n * @type {Enum}\n */\nexport const SessionStatus = new Enum([\n\t'UNCONNECTED',\n\t'CONNECTING',\n\t'CONNECTED',\n\t'SUSPENDED',\n\t'DISCONNECTED',\n]);\n","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _extendableBuiltin(cls) {\n  function ExtendableBuiltin() {\n    cls.apply(this, arguments);\n  }\n\n  ExtendableBuiltin.prototype = Object.create(cls.prototype, {\n    constructor: {\n      value: cls,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(ExtendableBuiltin, cls);\n  } else {\n    ExtendableBuiltin.__proto__ = cls;\n  }\n\n  return ExtendableBuiltin;\n}\n\nvar ExtendableError = function (_extendableBuiltin2) {\n  _inherits(ExtendableError, _extendableBuiltin2);\n\n  function ExtendableError() {\n    var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\n    _classCallCheck(this, ExtendableError);\n\n    // extending Error is weird and does not propagate `message`\n    var _this = _possibleConstructorReturn(this, (ExtendableError.__proto__ || Object.getPrototypeOf(ExtendableError)).call(this, message));\n\n    Object.defineProperty(_this, 'message', {\n      configurable: true,\n      enumerable: false,\n      value: message,\n      writable: true\n    });\n\n    Object.defineProperty(_this, 'name', {\n      configurable: true,\n      enumerable: false,\n      value: _this.constructor.name,\n      writable: true\n    });\n\n    if (Error.hasOwnProperty('captureStackTrace')) {\n      Error.captureStackTrace(_this, _this.constructor);\n      return _possibleConstructorReturn(_this);\n    }\n\n    Object.defineProperty(_this, 'stack', {\n      configurable: true,\n      enumerable: false,\n      value: new Error(message).stack,\n      writable: true\n    });\n    return _this;\n  }\n\n  return ExtendableError;\n}(_extendableBuiltin(Error));\n\nexport default ExtendableError;\n","import ExtendableError from 'es6-error';\n\n/**\n * Possible messages of the errors:\n * - UNAUTHORIZED\n * - WAC_INTERNAL_ERROR\n * - WAC_REGISTER_ERROR\n * - STACK_REGISTER_ERROR\n * - WAC_UNREGISTER_ERROR\n * - STACK_UNREGISTER_ERROR\n */\nexport class SessionError extends ExtendableError {}\n","import ExtendableError from 'es6-error';\n\n/** @private */\nexport class LoginError extends ExtendableError {}\n\n/** @private */\nexport class StackRegisterError extends ExtendableError {}\n\n/** @private */\nexport class StackUnregisterError extends ExtendableError {}\n\n/** @private */\nexport class WacInternalError extends ExtendableError {}\n\n/** @private */\nexport class WacRegisterError extends ExtendableError {}\n\n/** @private */\nexport class WacUnregisterError extends ExtendableError {}\n\n/** @private */\nexport class AlreadyLoggedError extends ExtendableError {}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// Used for setting prototype methods that IE8 chokes on.\nvar DELETE = 'delete';\n\n// Constants describing the size of trie nodes.\nvar SHIFT = 5; // Resulted in best performance after ______?\nvar SIZE = 1 << SHIFT;\nvar MASK = SIZE - 1;\n\n// A consistent shared value representing \"not set\" which equals nothing other\n// than itself, and nothing that could be provided externally.\nvar NOT_SET = {};\n\n// Boolean references, Rough equivalent of `bool &`.\nfunction MakeRef() {\n  return { value: false };\n}\n\nfunction SetRef(ref) {\n  if (ref) {\n    ref.value = true;\n  }\n}\n\n// A function which returns a value representing an \"owner\" for transient writes\n// to tries. The return value will only ever equal itself, and will not equal\n// the return of any subsequent call of this function.\nfunction OwnerID() {}\n\nfunction ensureSize(iter) {\n  if (iter.size === undefined) {\n    iter.size = iter.__iterate(returnTrue);\n  }\n  return iter.size;\n}\n\nfunction wrapIndex(iter, index) {\n  // This implements \"is array index\" which the ECMAString spec defines as:\n  //\n  //     A String property name P is an array index if and only if\n  //     ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal\n  //     to 2^321.\n  //\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects\n  if (typeof index !== 'number') {\n    var uint32Index = index >>> 0; // N >>> 0 is shorthand for ToUint32\n    if ('' + uint32Index !== index || uint32Index === 4294967295) {\n      return NaN;\n    }\n    index = uint32Index;\n  }\n  return index < 0 ? ensureSize(iter) + index : index;\n}\n\nfunction returnTrue() {\n  return true;\n}\n\nfunction wholeSlice(begin, end, size) {\n  return (\n    ((begin === 0 && !isNeg(begin)) ||\n      (size !== undefined && begin <= -size)) &&\n    (end === undefined || (size !== undefined && end >= size))\n  );\n}\n\nfunction resolveBegin(begin, size) {\n  return resolveIndex(begin, size, 0);\n}\n\nfunction resolveEnd(end, size) {\n  return resolveIndex(end, size, size);\n}\n\nfunction resolveIndex(index, size, defaultIndex) {\n  // Sanitize indices using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  return index === undefined\n    ? defaultIndex\n    : isNeg(index)\n      ? size === Infinity\n        ? size\n        : Math.max(0, size + index) | 0\n      : size === undefined || size === index\n        ? index\n        : Math.min(size, index) | 0;\n}\n\nfunction isNeg(value) {\n  // Account for -0 which is negative, but not less than 0.\n  return value < 0 || (value === 0 && 1 / value === -Infinity);\n}\n\n// Note: value is unchanged to not break immutable-devtools.\nvar IS_COLLECTION_SYMBOL = '@@__IMMUTABLE_ITERABLE__@@';\n\nfunction isCollection(maybeCollection) {\n  return Boolean(maybeCollection && maybeCollection[IS_COLLECTION_SYMBOL]);\n}\n\nvar IS_KEYED_SYMBOL = '@@__IMMUTABLE_KEYED__@@';\n\nfunction isKeyed(maybeKeyed) {\n  return Boolean(maybeKeyed && maybeKeyed[IS_KEYED_SYMBOL]);\n}\n\nvar IS_INDEXED_SYMBOL = '@@__IMMUTABLE_INDEXED__@@';\n\nfunction isIndexed(maybeIndexed) {\n  return Boolean(maybeIndexed && maybeIndexed[IS_INDEXED_SYMBOL]);\n}\n\nfunction isAssociative(maybeAssociative) {\n  return isKeyed(maybeAssociative) || isIndexed(maybeAssociative);\n}\n\nvar Collection = function Collection(value) {\n  return isCollection(value) ? value : Seq(value);\n};\n\nvar KeyedCollection = /*@__PURE__*/(function (Collection) {\n  function KeyedCollection(value) {\n    return isKeyed(value) ? value : KeyedSeq(value);\n  }\n\n  if ( Collection ) KeyedCollection.__proto__ = Collection;\n  KeyedCollection.prototype = Object.create( Collection && Collection.prototype );\n  KeyedCollection.prototype.constructor = KeyedCollection;\n\n  return KeyedCollection;\n}(Collection));\n\nvar IndexedCollection = /*@__PURE__*/(function (Collection) {\n  function IndexedCollection(value) {\n    return isIndexed(value) ? value : IndexedSeq(value);\n  }\n\n  if ( Collection ) IndexedCollection.__proto__ = Collection;\n  IndexedCollection.prototype = Object.create( Collection && Collection.prototype );\n  IndexedCollection.prototype.constructor = IndexedCollection;\n\n  return IndexedCollection;\n}(Collection));\n\nvar SetCollection = /*@__PURE__*/(function (Collection) {\n  function SetCollection(value) {\n    return isCollection(value) && !isAssociative(value) ? value : SetSeq(value);\n  }\n\n  if ( Collection ) SetCollection.__proto__ = Collection;\n  SetCollection.prototype = Object.create( Collection && Collection.prototype );\n  SetCollection.prototype.constructor = SetCollection;\n\n  return SetCollection;\n}(Collection));\n\nCollection.Keyed = KeyedCollection;\nCollection.Indexed = IndexedCollection;\nCollection.Set = SetCollection;\n\nvar IS_SEQ_SYMBOL = '@@__IMMUTABLE_SEQ__@@';\n\nfunction isSeq(maybeSeq) {\n  return Boolean(maybeSeq && maybeSeq[IS_SEQ_SYMBOL]);\n}\n\nvar IS_RECORD_SYMBOL = '@@__IMMUTABLE_RECORD__@@';\n\nfunction isRecord(maybeRecord) {\n  return Boolean(maybeRecord && maybeRecord[IS_RECORD_SYMBOL]);\n}\n\nfunction isImmutable(maybeImmutable) {\n  return isCollection(maybeImmutable) || isRecord(maybeImmutable);\n}\n\nvar IS_ORDERED_SYMBOL = '@@__IMMUTABLE_ORDERED__@@';\n\nfunction isOrdered(maybeOrdered) {\n  return Boolean(maybeOrdered && maybeOrdered[IS_ORDERED_SYMBOL]);\n}\n\nvar ITERATE_KEYS = 0;\nvar ITERATE_VALUES = 1;\nvar ITERATE_ENTRIES = 2;\n\nvar REAL_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nvar FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nvar ITERATOR_SYMBOL = REAL_ITERATOR_SYMBOL || FAUX_ITERATOR_SYMBOL;\n\nvar Iterator = function Iterator(next) {\n  this.next = next;\n};\n\nIterator.prototype.toString = function toString () {\n  return '[Iterator]';\n};\n\nIterator.KEYS = ITERATE_KEYS;\nIterator.VALUES = ITERATE_VALUES;\nIterator.ENTRIES = ITERATE_ENTRIES;\n\nIterator.prototype.inspect = Iterator.prototype.toSource = function() {\n  return this.toString();\n};\nIterator.prototype[ITERATOR_SYMBOL] = function() {\n  return this;\n};\n\nfunction iteratorValue(type, k, v, iteratorResult) {\n  var value = type === 0 ? k : type === 1 ? v : [k, v];\n  iteratorResult\n    ? (iteratorResult.value = value)\n    : (iteratorResult = {\n        value: value,\n        done: false,\n      });\n  return iteratorResult;\n}\n\nfunction iteratorDone() {\n  return { value: undefined, done: true };\n}\n\nfunction hasIterator(maybeIterable) {\n  return !!getIteratorFn(maybeIterable);\n}\n\nfunction isIterator(maybeIterator) {\n  return maybeIterator && typeof maybeIterator.next === 'function';\n}\n\nfunction getIterator(iterable) {\n  var iteratorFn = getIteratorFn(iterable);\n  return iteratorFn && iteratorFn.call(iterable);\n}\n\nfunction getIteratorFn(iterable) {\n  var iteratorFn =\n    iterable &&\n    ((REAL_ITERATOR_SYMBOL && iterable[REAL_ITERATOR_SYMBOL]) ||\n      iterable[FAUX_ITERATOR_SYMBOL]);\n  if (typeof iteratorFn === 'function') {\n    return iteratorFn;\n  }\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isArrayLike(value) {\n  if (Array.isArray(value) || typeof value === 'string') {\n    return true;\n  }\n\n  return (\n    value &&\n    typeof value === 'object' &&\n    Number.isInteger(value.length) &&\n    value.length >= 0 &&\n    (value.length === 0\n      ? // Only {length: 0} is considered Array-like.\n        Object.keys(value).length === 1\n      : // An object is only Array-like if it has a property where the last value\n        // in the array-like may be found (which could be undefined).\n        value.hasOwnProperty(value.length - 1))\n  );\n}\n\nvar Seq = /*@__PURE__*/(function (Collection$$1) {\n  function Seq(value) {\n    return value === null || value === undefined\n      ? emptySequence()\n      : isImmutable(value)\n        ? value.toSeq()\n        : seqFromValue(value);\n  }\n\n  if ( Collection$$1 ) Seq.__proto__ = Collection$$1;\n  Seq.prototype = Object.create( Collection$$1 && Collection$$1.prototype );\n  Seq.prototype.constructor = Seq;\n\n  Seq.prototype.toSeq = function toSeq () {\n    return this;\n  };\n\n  Seq.prototype.toString = function toString () {\n    return this.__toString('Seq {', '}');\n  };\n\n  Seq.prototype.cacheResult = function cacheResult () {\n    if (!this._cache && this.__iterateUncached) {\n      this._cache = this.entrySeq().toArray();\n      this.size = this._cache.length;\n    }\n    return this;\n  };\n\n  // abstract __iterateUncached(fn, reverse)\n\n  Seq.prototype.__iterate = function __iterate (fn, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      while (i !== size) {\n        var entry = cache[reverse ? size - ++i : i++];\n        if (fn(entry[1], entry[0], this) === false) {\n          break;\n        }\n      }\n      return i;\n    }\n    return this.__iterateUncached(fn, reverse);\n  };\n\n  // abstract __iteratorUncached(type, reverse)\n\n  Seq.prototype.__iterator = function __iterator (type, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      return new Iterator(function () {\n        if (i === size) {\n          return iteratorDone();\n        }\n        var entry = cache[reverse ? size - ++i : i++];\n        return iteratorValue(type, entry[0], entry[1]);\n      });\n    }\n    return this.__iteratorUncached(type, reverse);\n  };\n\n  return Seq;\n}(Collection));\n\nvar KeyedSeq = /*@__PURE__*/(function (Seq) {\n  function KeyedSeq(value) {\n    return value === null || value === undefined\n      ? emptySequence().toKeyedSeq()\n      : isCollection(value)\n        ? isKeyed(value)\n          ? value.toSeq()\n          : value.fromEntrySeq()\n        : isRecord(value)\n          ? value.toSeq()\n          : keyedSeqFromValue(value);\n  }\n\n  if ( Seq ) KeyedSeq.__proto__ = Seq;\n  KeyedSeq.prototype = Object.create( Seq && Seq.prototype );\n  KeyedSeq.prototype.constructor = KeyedSeq;\n\n  KeyedSeq.prototype.toKeyedSeq = function toKeyedSeq () {\n    return this;\n  };\n\n  return KeyedSeq;\n}(Seq));\n\nvar IndexedSeq = /*@__PURE__*/(function (Seq) {\n  function IndexedSeq(value) {\n    return value === null || value === undefined\n      ? emptySequence()\n      : isCollection(value)\n        ? isKeyed(value)\n          ? value.entrySeq()\n          : value.toIndexedSeq()\n        : isRecord(value)\n          ? value.toSeq().entrySeq()\n          : indexedSeqFromValue(value);\n  }\n\n  if ( Seq ) IndexedSeq.__proto__ = Seq;\n  IndexedSeq.prototype = Object.create( Seq && Seq.prototype );\n  IndexedSeq.prototype.constructor = IndexedSeq;\n\n  IndexedSeq.of = function of (/*...values*/) {\n    return IndexedSeq(arguments);\n  };\n\n  IndexedSeq.prototype.toIndexedSeq = function toIndexedSeq () {\n    return this;\n  };\n\n  IndexedSeq.prototype.toString = function toString () {\n    return this.__toString('Seq [', ']');\n  };\n\n  return IndexedSeq;\n}(Seq));\n\nvar SetSeq = /*@__PURE__*/(function (Seq) {\n  function SetSeq(value) {\n    return (isCollection(value) && !isAssociative(value)\n      ? value\n      : IndexedSeq(value)\n    ).toSetSeq();\n  }\n\n  if ( Seq ) SetSeq.__proto__ = Seq;\n  SetSeq.prototype = Object.create( Seq && Seq.prototype );\n  SetSeq.prototype.constructor = SetSeq;\n\n  SetSeq.of = function of (/*...values*/) {\n    return SetSeq(arguments);\n  };\n\n  SetSeq.prototype.toSetSeq = function toSetSeq () {\n    return this;\n  };\n\n  return SetSeq;\n}(Seq));\n\nSeq.isSeq = isSeq;\nSeq.Keyed = KeyedSeq;\nSeq.Set = SetSeq;\nSeq.Indexed = IndexedSeq;\n\nSeq.prototype[IS_SEQ_SYMBOL] = true;\n\n// #pragma Root Sequences\n\nvar ArraySeq = /*@__PURE__*/(function (IndexedSeq) {\n  function ArraySeq(array) {\n    this._array = array;\n    this.size = array.length;\n  }\n\n  if ( IndexedSeq ) ArraySeq.__proto__ = IndexedSeq;\n  ArraySeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  ArraySeq.prototype.constructor = ArraySeq;\n\n  ArraySeq.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._array[wrapIndex(this, index)] : notSetValue;\n  };\n\n  ArraySeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    while (i !== size) {\n      var ii = reverse ? size - ++i : i++;\n      if (fn(array[ii], ii, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ArraySeq.prototype.__iterator = function __iterator (type, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var ii = reverse ? size - ++i : i++;\n      return iteratorValue(type, ii, array[ii]);\n    });\n  };\n\n  return ArraySeq;\n}(IndexedSeq));\n\nvar ObjectSeq = /*@__PURE__*/(function (KeyedSeq) {\n  function ObjectSeq(object) {\n    var keys = Object.keys(object);\n    this._object = object;\n    this._keys = keys;\n    this.size = keys.length;\n  }\n\n  if ( KeyedSeq ) ObjectSeq.__proto__ = KeyedSeq;\n  ObjectSeq.prototype = Object.create( KeyedSeq && KeyedSeq.prototype );\n  ObjectSeq.prototype.constructor = ObjectSeq;\n\n  ObjectSeq.prototype.get = function get (key, notSetValue) {\n    if (notSetValue !== undefined && !this.has(key)) {\n      return notSetValue;\n    }\n    return this._object[key];\n  };\n\n  ObjectSeq.prototype.has = function has (key) {\n    return hasOwnProperty.call(this._object, key);\n  };\n\n  ObjectSeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    while (i !== size) {\n      var key = keys[reverse ? size - ++i : i++];\n      if (fn(object[key], key, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ObjectSeq.prototype.__iterator = function __iterator (type, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var key = keys[reverse ? size - ++i : i++];\n      return iteratorValue(type, key, object[key]);\n    });\n  };\n\n  return ObjectSeq;\n}(KeyedSeq));\nObjectSeq.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar CollectionSeq = /*@__PURE__*/(function (IndexedSeq) {\n  function CollectionSeq(collection) {\n    this._collection = collection;\n    this.size = collection.length || collection.size;\n  }\n\n  if ( IndexedSeq ) CollectionSeq.__proto__ = IndexedSeq;\n  CollectionSeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  CollectionSeq.prototype.constructor = CollectionSeq;\n\n  CollectionSeq.prototype.__iterateUncached = function __iterateUncached (fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    var iterations = 0;\n    if (isIterator(iterator)) {\n      var step;\n      while (!(step = iterator.next()).done) {\n        if (fn(step.value, iterations++, this) === false) {\n          break;\n        }\n      }\n    }\n    return iterations;\n  };\n\n  CollectionSeq.prototype.__iteratorUncached = function __iteratorUncached (type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    if (!isIterator(iterator)) {\n      return new Iterator(iteratorDone);\n    }\n    var iterations = 0;\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done ? step : iteratorValue(type, iterations++, step.value);\n    });\n  };\n\n  return CollectionSeq;\n}(IndexedSeq));\n\n// # pragma Helper functions\n\nvar EMPTY_SEQ;\n\nfunction emptySequence() {\n  return EMPTY_SEQ || (EMPTY_SEQ = new ArraySeq([]));\n}\n\nfunction keyedSeqFromValue(value) {\n  var seq = Array.isArray(value)\n    ? new ArraySeq(value)\n    : hasIterator(value)\n      ? new CollectionSeq(value)\n      : undefined;\n  if (seq) {\n    return seq.fromEntrySeq();\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of [k, v] entries, or keyed object: ' +\n      value\n  );\n}\n\nfunction indexedSeqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq;\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values: ' + value\n  );\n}\n\nfunction seqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq;\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values, or keyed object: ' + value\n  );\n}\n\nfunction maybeIndexedSeqFromValue(value) {\n  return isArrayLike(value)\n    ? new ArraySeq(value)\n    : hasIterator(value)\n      ? new CollectionSeq(value)\n      : undefined;\n}\n\nvar IS_MAP_SYMBOL = '@@__IMMUTABLE_MAP__@@';\n\nfunction isMap(maybeMap) {\n  return Boolean(maybeMap && maybeMap[IS_MAP_SYMBOL]);\n}\n\nfunction isOrderedMap(maybeOrderedMap) {\n  return isMap(maybeOrderedMap) && isOrdered(maybeOrderedMap);\n}\n\nfunction isValueObject(maybeValue) {\n  return Boolean(\n    maybeValue &&\n      typeof maybeValue.equals === 'function' &&\n      typeof maybeValue.hashCode === 'function'\n  );\n}\n\n/**\n * An extension of the \"same-value\" algorithm as [described for use by ES6 Map\n * and Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)\n *\n * NaN is considered the same as NaN, however -0 and 0 are considered the same\n * value, which is different from the algorithm described by\n * [`Object.is`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).\n *\n * This is extended further to allow Objects to describe the values they\n * represent, by way of `valueOf` or `equals` (and `hashCode`).\n *\n * Note: because of this extension, the key equality of Immutable.Map and the\n * value equality of Immutable.Set will differ from ES6 Map and Set.\n *\n * ### Defining custom values\n *\n * The easiest way to describe the value an object represents is by implementing\n * `valueOf`. For example, `Date` represents a value by returning a unix\n * timestamp for `valueOf`:\n *\n *     var date1 = new Date(1234567890000); // Fri Feb 13 2009 ...\n *     var date2 = new Date(1234567890000);\n *     date1.valueOf(); // 1234567890000\n *     assert( date1 !== date2 );\n *     assert( Immutable.is( date1, date2 ) );\n *\n * Note: overriding `valueOf` may have other implications if you use this object\n * where JavaScript expects a primitive, such as implicit string coercion.\n *\n * For more complex types, especially collections, implementing `valueOf` may\n * not be performant. An alternative is to implement `equals` and `hashCode`.\n *\n * `equals` takes another object, presumably of similar type, and returns true\n * if it is equal. Equality is symmetrical, so the same result should be\n * returned if this and the argument are flipped.\n *\n *     assert( a.equals(b) === b.equals(a) );\n *\n * `hashCode` returns a 32bit integer number representing the object which will\n * be used to determine how to store the value object in a Map or Set. You must\n * provide both or neither methods, one must not exist without the other.\n *\n * Also, an important relationship between these methods must be upheld: if two\n * values are equal, they *must* return the same hashCode. If the values are not\n * equal, they might have the same hashCode; this is called a hash collision,\n * and while undesirable for performance reasons, it is acceptable.\n *\n *     if (a.equals(b)) {\n *       assert( a.hashCode() === b.hashCode() );\n *     }\n *\n * All Immutable collections are Value Objects: they implement `equals()`\n * and `hashCode()`.\n */\nfunction is(valueA, valueB) {\n  if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n    return true;\n  }\n  if (!valueA || !valueB) {\n    return false;\n  }\n  if (\n    typeof valueA.valueOf === 'function' &&\n    typeof valueB.valueOf === 'function'\n  ) {\n    valueA = valueA.valueOf();\n    valueB = valueB.valueOf();\n    if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n      return true;\n    }\n    if (!valueA || !valueB) {\n      return false;\n    }\n  }\n  return !!(\n    isValueObject(valueA) &&\n    isValueObject(valueB) &&\n    valueA.equals(valueB)\n  );\n}\n\nvar imul =\n  typeof Math.imul === 'function' && Math.imul(0xffffffff, 2) === -2\n    ? Math.imul\n    : function imul(a, b) {\n        a |= 0; // int\n        b |= 0; // int\n        var c = a & 0xffff;\n        var d = b & 0xffff;\n        // Shift by 0 fixes the sign on the high part.\n        return (c * d + ((((a >>> 16) * d + c * (b >>> 16)) << 16) >>> 0)) | 0; // int\n      };\n\n// v8 has an optimization for storing 31-bit signed numbers.\n// Values which have either 00 or 11 as the high order bits qualify.\n// This function drops the highest order bit in a signed number, maintaining\n// the sign bit.\nfunction smi(i32) {\n  return ((i32 >>> 1) & 0x40000000) | (i32 & 0xbfffffff);\n}\n\nvar defaultValueOf = Object.prototype.valueOf;\n\nfunction hash(o) {\n  switch (typeof o) {\n    case 'boolean':\n      // The hash values for built-in constants are a 1 value for each 5-byte\n      // shift region expect for the first, which encodes the value. This\n      // reduces the odds of a hash collision for these common values.\n      return o ? 0x42108421 : 0x42108420;\n    case 'number':\n      return hashNumber(o);\n    case 'string':\n      return o.length > STRING_HASH_CACHE_MIN_STRLEN\n        ? cachedHashString(o)\n        : hashString(o);\n    case 'object':\n    case 'function':\n      if (o === null) {\n        return 0x42108422;\n      }\n      if (typeof o.hashCode === 'function') {\n        // Drop any high bits from accidentally long hash codes.\n        return smi(o.hashCode(o));\n      }\n      if (o.valueOf !== defaultValueOf && typeof o.valueOf === 'function') {\n        o = o.valueOf(o);\n      }\n      return hashJSObj(o);\n    case 'undefined':\n      return 0x42108423;\n    default:\n      if (typeof o.toString === 'function') {\n        return hashString(o.toString());\n      }\n      throw new Error('Value type ' + typeof o + ' cannot be hashed.');\n  }\n}\n\n// Compress arbitrarily large numbers into smi hashes.\nfunction hashNumber(n) {\n  if (n !== n || n === Infinity) {\n    return 0;\n  }\n  var hash = n | 0;\n  if (hash !== n) {\n    hash ^= n * 0xffffffff;\n  }\n  while (n > 0xffffffff) {\n    n /= 0xffffffff;\n    hash ^= n;\n  }\n  return smi(hash);\n}\n\nfunction cachedHashString(string) {\n  var hashed = stringHashCache[string];\n  if (hashed === undefined) {\n    hashed = hashString(string);\n    if (STRING_HASH_CACHE_SIZE === STRING_HASH_CACHE_MAX_SIZE) {\n      STRING_HASH_CACHE_SIZE = 0;\n      stringHashCache = {};\n    }\n    STRING_HASH_CACHE_SIZE++;\n    stringHashCache[string] = hashed;\n  }\n  return hashed;\n}\n\n// http://jsperf.com/hashing-strings\nfunction hashString(string) {\n  // This is the hash from JVM\n  // The hash code for a string is computed as\n  // s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n  // where s[i] is the ith character of the string and n is the length of\n  // the string. We \"mod\" the result to make it between 0 (inclusive) and 2^31\n  // (exclusive) by dropping high bits.\n  var hashed = 0;\n  for (var ii = 0; ii < string.length; ii++) {\n    hashed = (31 * hashed + string.charCodeAt(ii)) | 0;\n  }\n  return smi(hashed);\n}\n\nfunction hashJSObj(obj) {\n  var hashed;\n  if (usingWeakMap) {\n    hashed = weakMap.get(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = obj[UID_HASH_KEY];\n  if (hashed !== undefined) {\n    return hashed;\n  }\n\n  if (!canDefineProperty) {\n    hashed = obj.propertyIsEnumerable && obj.propertyIsEnumerable[UID_HASH_KEY];\n    if (hashed !== undefined) {\n      return hashed;\n    }\n\n    hashed = getIENodeHash(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = ++objHashUID;\n  if (objHashUID & 0x40000000) {\n    objHashUID = 0;\n  }\n\n  if (usingWeakMap) {\n    weakMap.set(obj, hashed);\n  } else if (isExtensible !== undefined && isExtensible(obj) === false) {\n    throw new Error('Non-extensible objects are not allowed as keys.');\n  } else if (canDefineProperty) {\n    Object.defineProperty(obj, UID_HASH_KEY, {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: hashed,\n    });\n  } else if (\n    obj.propertyIsEnumerable !== undefined &&\n    obj.propertyIsEnumerable === obj.constructor.prototype.propertyIsEnumerable\n  ) {\n    // Since we can't define a non-enumerable property on the object\n    // we'll hijack one of the less-used non-enumerable properties to\n    // save our hash on it. Since this is a function it will not show up in\n    // `JSON.stringify` which is what we want.\n    obj.propertyIsEnumerable = function() {\n      return this.constructor.prototype.propertyIsEnumerable.apply(\n        this,\n        arguments\n      );\n    };\n    obj.propertyIsEnumerable[UID_HASH_KEY] = hashed;\n  } else if (obj.nodeType !== undefined) {\n    // At this point we couldn't get the IE `uniqueID` to use as a hash\n    // and we couldn't use a non-enumerable property to exploit the\n    // dontEnum bug so we simply add the `UID_HASH_KEY` on the node\n    // itself.\n    obj[UID_HASH_KEY] = hashed;\n  } else {\n    throw new Error('Unable to set a non-enumerable property on object.');\n  }\n\n  return hashed;\n}\n\n// Get references to ES5 object methods.\nvar isExtensible = Object.isExtensible;\n\n// True if Object.defineProperty works as expected. IE8 fails this test.\nvar canDefineProperty = (function() {\n  try {\n    Object.defineProperty({}, '@', {});\n    return true;\n  } catch (e) {\n    return false;\n  }\n})();\n\n// IE has a `uniqueID` property on DOM nodes. We can construct the hash from it\n// and avoid memory leaks from the IE cloneNode bug.\nfunction getIENodeHash(node) {\n  if (node && node.nodeType > 0) {\n    switch (node.nodeType) {\n      case 1: // Element\n        return node.uniqueID;\n      case 9: // Document\n        return node.documentElement && node.documentElement.uniqueID;\n    }\n  }\n}\n\n// If possible, use a WeakMap.\nvar usingWeakMap = typeof WeakMap === 'function';\nvar weakMap;\nif (usingWeakMap) {\n  weakMap = new WeakMap();\n}\n\nvar objHashUID = 0;\n\nvar UID_HASH_KEY = '__immutablehash__';\nif (typeof Symbol === 'function') {\n  UID_HASH_KEY = Symbol(UID_HASH_KEY);\n}\n\nvar STRING_HASH_CACHE_MIN_STRLEN = 16;\nvar STRING_HASH_CACHE_MAX_SIZE = 255;\nvar STRING_HASH_CACHE_SIZE = 0;\nvar stringHashCache = {};\n\nvar ToKeyedSequence = /*@__PURE__*/(function (KeyedSeq$$1) {\n  function ToKeyedSequence(indexed, useKeys) {\n    this._iter = indexed;\n    this._useKeys = useKeys;\n    this.size = indexed.size;\n  }\n\n  if ( KeyedSeq$$1 ) ToKeyedSequence.__proto__ = KeyedSeq$$1;\n  ToKeyedSequence.prototype = Object.create( KeyedSeq$$1 && KeyedSeq$$1.prototype );\n  ToKeyedSequence.prototype.constructor = ToKeyedSequence;\n\n  ToKeyedSequence.prototype.get = function get (key, notSetValue) {\n    return this._iter.get(key, notSetValue);\n  };\n\n  ToKeyedSequence.prototype.has = function has (key) {\n    return this._iter.has(key);\n  };\n\n  ToKeyedSequence.prototype.valueSeq = function valueSeq () {\n    return this._iter.valueSeq();\n  };\n\n  ToKeyedSequence.prototype.reverse = function reverse () {\n    var this$1 = this;\n\n    var reversedSequence = reverseFactory(this, true);\n    if (!this._useKeys) {\n      reversedSequence.valueSeq = function () { return this$1._iter.toSeq().reverse(); };\n    }\n    return reversedSequence;\n  };\n\n  ToKeyedSequence.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    var mappedSequence = mapFactory(this, mapper, context);\n    if (!this._useKeys) {\n      mappedSequence.valueSeq = function () { return this$1._iter.toSeq().map(mapper, context); };\n    }\n    return mappedSequence;\n  };\n\n  ToKeyedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (v, k) { return fn(v, k, this$1); }, reverse);\n  };\n\n  ToKeyedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    return this._iter.__iterator(type, reverse);\n  };\n\n  return ToKeyedSequence;\n}(KeyedSeq));\nToKeyedSequence.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar ToIndexedSequence = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function ToIndexedSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( IndexedSeq$$1 ) ToIndexedSequence.__proto__ = IndexedSeq$$1;\n  ToIndexedSequence.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  ToIndexedSequence.prototype.constructor = ToIndexedSequence;\n\n  ToIndexedSequence.prototype.includes = function includes (value) {\n    return this._iter.includes(value);\n  };\n\n  ToIndexedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(this);\n    return this._iter.__iterate(\n      function (v) { return fn(v, reverse ? this$1.size - ++i : i++, this$1); },\n      reverse\n    );\n  };\n\n  ToIndexedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1 = this;\n\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    var i = 0;\n    reverse && ensureSize(this);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(\n            type,\n            reverse ? this$1.size - ++i : i++,\n            step.value,\n            step\n          );\n    });\n  };\n\n  return ToIndexedSequence;\n}(IndexedSeq));\n\nvar ToSetSequence = /*@__PURE__*/(function (SetSeq$$1) {\n  function ToSetSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( SetSeq$$1 ) ToSetSequence.__proto__ = SetSeq$$1;\n  ToSetSequence.prototype = Object.create( SetSeq$$1 && SetSeq$$1.prototype );\n  ToSetSequence.prototype.constructor = ToSetSequence;\n\n  ToSetSequence.prototype.has = function has (key) {\n    return this._iter.includes(key);\n  };\n\n  ToSetSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (v) { return fn(v, v, this$1); }, reverse);\n  };\n\n  ToSetSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(type, step.value, step.value, step);\n    });\n  };\n\n  return ToSetSequence;\n}(SetSeq));\n\nvar FromEntriesSequence = /*@__PURE__*/(function (KeyedSeq$$1) {\n  function FromEntriesSequence(entries) {\n    this._iter = entries;\n    this.size = entries.size;\n  }\n\n  if ( KeyedSeq$$1 ) FromEntriesSequence.__proto__ = KeyedSeq$$1;\n  FromEntriesSequence.prototype = Object.create( KeyedSeq$$1 && KeyedSeq$$1.prototype );\n  FromEntriesSequence.prototype.constructor = FromEntriesSequence;\n\n  FromEntriesSequence.prototype.entrySeq = function entrySeq () {\n    return this._iter.toSeq();\n  };\n\n  FromEntriesSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._iter.__iterate(function (entry) {\n      // Check if entry exists first so array access doesn't throw for holes\n      // in the parent iteration.\n      if (entry) {\n        validateEntry(entry);\n        var indexedCollection = isCollection(entry);\n        return fn(\n          indexedCollection ? entry.get(1) : entry[1],\n          indexedCollection ? entry.get(0) : entry[0],\n          this$1\n        );\n      }\n    }, reverse);\n  };\n\n  FromEntriesSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        // Check if entry exists first so array access doesn't throw for holes\n        // in the parent iteration.\n        if (entry) {\n          validateEntry(entry);\n          var indexedCollection = isCollection(entry);\n          return iteratorValue(\n            type,\n            indexedCollection ? entry.get(0) : entry[0],\n            indexedCollection ? entry.get(1) : entry[1],\n            step\n          );\n        }\n      }\n    });\n  };\n\n  return FromEntriesSequence;\n}(KeyedSeq));\n\nToIndexedSequence.prototype.cacheResult = ToKeyedSequence.prototype.cacheResult = ToSetSequence.prototype.cacheResult = FromEntriesSequence.prototype.cacheResult = cacheResultThrough;\n\nfunction flipFactory(collection) {\n  var flipSequence = makeSequence(collection);\n  flipSequence._iter = collection;\n  flipSequence.size = collection.size;\n  flipSequence.flip = function () { return collection; };\n  flipSequence.reverse = function() {\n    var reversedSequence = collection.reverse.apply(this); // super.reverse()\n    reversedSequence.flip = function () { return collection.reverse(); };\n    return reversedSequence;\n  };\n  flipSequence.has = function (key) { return collection.includes(key); };\n  flipSequence.includes = function (key) { return collection.has(key); };\n  flipSequence.cacheResult = cacheResultThrough;\n  flipSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    return collection.__iterate(function (v, k) { return fn(k, v, this$1) !== false; }, reverse);\n  };\n  flipSequence.__iteratorUncached = function(type, reverse) {\n    if (type === ITERATE_ENTRIES) {\n      var iterator = collection.__iterator(type, reverse);\n      return new Iterator(function () {\n        var step = iterator.next();\n        if (!step.done) {\n          var k = step.value[0];\n          step.value[0] = step.value[1];\n          step.value[1] = k;\n        }\n        return step;\n      });\n    }\n    return collection.__iterator(\n      type === ITERATE_VALUES ? ITERATE_KEYS : ITERATE_VALUES,\n      reverse\n    );\n  };\n  return flipSequence;\n}\n\nfunction mapFactory(collection, mapper, context) {\n  var mappedSequence = makeSequence(collection);\n  mappedSequence.size = collection.size;\n  mappedSequence.has = function (key) { return collection.has(key); };\n  mappedSequence.get = function (key, notSetValue) {\n    var v = collection.get(key, NOT_SET);\n    return v === NOT_SET\n      ? notSetValue\n      : mapper.call(context, v, key, collection);\n  };\n  mappedSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    return collection.__iterate(\n      function (v, k, c) { return fn(mapper.call(context, v, k, c), k, this$1) !== false; },\n      reverse\n    );\n  };\n  mappedSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var key = entry[0];\n      return iteratorValue(\n        type,\n        key,\n        mapper.call(context, entry[1], key, collection),\n        step\n      );\n    });\n  };\n  return mappedSequence;\n}\n\nfunction reverseFactory(collection, useKeys) {\n  var this$1 = this;\n\n  var reversedSequence = makeSequence(collection);\n  reversedSequence._iter = collection;\n  reversedSequence.size = collection.size;\n  reversedSequence.reverse = function () { return collection; };\n  if (collection.flip) {\n    reversedSequence.flip = function() {\n      var flipSequence = flipFactory(collection);\n      flipSequence.reverse = function () { return collection.flip(); };\n      return flipSequence;\n    };\n  }\n  reversedSequence.get = function (key, notSetValue) { return collection.get(useKeys ? key : -1 - key, notSetValue); };\n  reversedSequence.has = function (key) { return collection.has(useKeys ? key : -1 - key); };\n  reversedSequence.includes = function (value) { return collection.includes(value); };\n  reversedSequence.cacheResult = cacheResultThrough;\n  reversedSequence.__iterate = function(fn, reverse) {\n    var this$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(collection);\n    return collection.__iterate(\n      function (v, k) { return fn(v, useKeys ? k : reverse ? this$1.size - ++i : i++, this$1); },\n      !reverse\n    );\n  };\n  reversedSequence.__iterator = function (type, reverse) {\n    var i = 0;\n    reverse && ensureSize(collection);\n    var iterator = collection.__iterator(ITERATE_ENTRIES, !reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      return iteratorValue(\n        type,\n        useKeys ? entry[0] : reverse ? this$1.size - ++i : i++,\n        entry[1],\n        step\n      );\n    });\n  };\n  return reversedSequence;\n}\n\nfunction filterFactory(collection, predicate, context, useKeys) {\n  var filterSequence = makeSequence(collection);\n  if (useKeys) {\n    filterSequence.has = function (key) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && !!predicate.call(context, v, key, collection);\n    };\n    filterSequence.get = function (key, notSetValue) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && predicate.call(context, v, key, collection)\n        ? v\n        : notSetValue;\n    };\n  }\n  filterSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1);\n      }\n    }, reverse);\n    return iterations;\n  };\n  filterSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterations = 0;\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var key = entry[0];\n        var value = entry[1];\n        if (predicate.call(context, value, key, collection)) {\n          return iteratorValue(type, useKeys ? key : iterations++, value, step);\n        }\n      }\n    });\n  };\n  return filterSequence;\n}\n\nfunction countByFactory(collection, grouper, context) {\n  var groups = Map().asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(grouper.call(context, v, k, collection), 0, function (a) { return a + 1; });\n  });\n  return groups.asImmutable();\n}\n\nfunction groupByFactory(collection, grouper, context) {\n  var isKeyedIter = isKeyed(collection);\n  var groups = (isOrdered(collection) ? OrderedMap() : Map()).asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(\n      grouper.call(context, v, k, collection),\n      function (a) { return ((a = a || []), a.push(isKeyedIter ? [k, v] : v), a); }\n    );\n  });\n  var coerce = collectionClass(collection);\n  return groups.map(function (arr) { return reify(collection, coerce(arr)); }).asImmutable();\n}\n\nfunction sliceFactory(collection, begin, end, useKeys) {\n  var originalSize = collection.size;\n\n  if (wholeSlice(begin, end, originalSize)) {\n    return collection;\n  }\n\n  var resolvedBegin = resolveBegin(begin, originalSize);\n  var resolvedEnd = resolveEnd(end, originalSize);\n\n  // begin or end will be NaN if they were provided as negative numbers and\n  // this collection's size is unknown. In that case, cache first so there is\n  // a known size and these do not resolve to NaN.\n  if (resolvedBegin !== resolvedBegin || resolvedEnd !== resolvedEnd) {\n    return sliceFactory(collection.toSeq().cacheResult(), begin, end, useKeys);\n  }\n\n  // Note: resolvedEnd is undefined when the original sequence's length is\n  // unknown and this slice did not supply an end and should contain all\n  // elements after resolvedBegin.\n  // In that case, resolvedSize will be NaN and sliceSize will remain undefined.\n  var resolvedSize = resolvedEnd - resolvedBegin;\n  var sliceSize;\n  if (resolvedSize === resolvedSize) {\n    sliceSize = resolvedSize < 0 ? 0 : resolvedSize;\n  }\n\n  var sliceSeq = makeSequence(collection);\n\n  // If collection.size is undefined, the size of the realized sliceSeq is\n  // unknown at this point unless the number of items to slice is 0\n  sliceSeq.size =\n    sliceSize === 0 ? sliceSize : (collection.size && sliceSize) || undefined;\n\n  if (!useKeys && isSeq(collection) && sliceSize >= 0) {\n    sliceSeq.get = function(index, notSetValue) {\n      index = wrapIndex(this, index);\n      return index >= 0 && index < sliceSize\n        ? collection.get(index + resolvedBegin, notSetValue)\n        : notSetValue;\n    };\n  }\n\n  sliceSeq.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (sliceSize === 0) {\n      return 0;\n    }\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var skipped = 0;\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k) {\n      if (!(isSkipping && (isSkipping = skipped++ < resolvedBegin))) {\n        iterations++;\n        return (\n          fn(v, useKeys ? k : iterations - 1, this$1) !== false &&\n          iterations !== sliceSize\n        );\n      }\n    });\n    return iterations;\n  };\n\n  sliceSeq.__iteratorUncached = function(type, reverse) {\n    if (sliceSize !== 0 && reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    // Don't bother instantiating parent iterator if taking 0.\n    if (sliceSize === 0) {\n      return new Iterator(iteratorDone);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var skipped = 0;\n    var iterations = 0;\n    return new Iterator(function () {\n      while (skipped++ < resolvedBegin) {\n        iterator.next();\n      }\n      if (++iterations > sliceSize) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (useKeys || type === ITERATE_VALUES || step.done) {\n        return step;\n      }\n      if (type === ITERATE_KEYS) {\n        return iteratorValue(type, iterations - 1, undefined, step);\n      }\n      return iteratorValue(type, iterations - 1, step.value[1], step);\n    });\n  };\n\n  return sliceSeq;\n}\n\nfunction takeWhileFactory(collection, predicate, context) {\n  var takeSequence = makeSequence(collection);\n  takeSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    collection.__iterate(\n      function (v, k, c) { return predicate.call(context, v, k, c) && ++iterations && fn(v, k, this$1); }\n    );\n    return iterations;\n  };\n  takeSequence.__iteratorUncached = function(type, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterating = true;\n    return new Iterator(function () {\n      if (!iterating) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var k = entry[0];\n      var v = entry[1];\n      if (!predicate.call(context, v, k, this$1)) {\n        iterating = false;\n        return iteratorDone();\n      }\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return takeSequence;\n}\n\nfunction skipWhileFactory(collection, predicate, context, useKeys) {\n  var skipSequence = makeSequence(collection);\n  skipSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (!(isSkipping && (isSkipping = predicate.call(context, v, k, c)))) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1);\n      }\n    });\n    return iterations;\n  };\n  skipSequence.__iteratorUncached = function(type, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var skipping = true;\n    var iterations = 0;\n    return new Iterator(function () {\n      var step;\n      var k;\n      var v;\n      do {\n        step = iterator.next();\n        if (step.done) {\n          if (useKeys || type === ITERATE_VALUES) {\n            return step;\n          }\n          if (type === ITERATE_KEYS) {\n            return iteratorValue(type, iterations++, undefined, step);\n          }\n          return iteratorValue(type, iterations++, step.value[1], step);\n        }\n        var entry = step.value;\n        k = entry[0];\n        v = entry[1];\n        skipping && (skipping = predicate.call(context, v, k, this$1));\n      } while (skipping);\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return skipSequence;\n}\n\nfunction concatFactory(collection, values) {\n  var isKeyedCollection = isKeyed(collection);\n  var iters = [collection]\n    .concat(values)\n    .map(function (v) {\n      if (!isCollection(v)) {\n        v = isKeyedCollection\n          ? keyedSeqFromValue(v)\n          : indexedSeqFromValue(Array.isArray(v) ? v : [v]);\n      } else if (isKeyedCollection) {\n        v = KeyedCollection(v);\n      }\n      return v;\n    })\n    .filter(function (v) { return v.size !== 0; });\n\n  if (iters.length === 0) {\n    return collection;\n  }\n\n  if (iters.length === 1) {\n    var singleton = iters[0];\n    if (\n      singleton === collection ||\n      (isKeyedCollection && isKeyed(singleton)) ||\n      (isIndexed(collection) && isIndexed(singleton))\n    ) {\n      return singleton;\n    }\n  }\n\n  var concatSeq = new ArraySeq(iters);\n  if (isKeyedCollection) {\n    concatSeq = concatSeq.toKeyedSeq();\n  } else if (!isIndexed(collection)) {\n    concatSeq = concatSeq.toSetSeq();\n  }\n  concatSeq = concatSeq.flatten(true);\n  concatSeq.size = iters.reduce(function (sum, seq) {\n    if (sum !== undefined) {\n      var size = seq.size;\n      if (size !== undefined) {\n        return sum + size;\n      }\n    }\n  }, 0);\n  return concatSeq;\n}\n\nfunction flattenFactory(collection, depth, useKeys) {\n  var flatSequence = makeSequence(collection);\n  flatSequence.__iterateUncached = function(fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    var stopped = false;\n    function flatDeep(iter, currentDepth) {\n      iter.__iterate(function (v, k) {\n        if ((!depth || currentDepth < depth) && isCollection(v)) {\n          flatDeep(v, currentDepth + 1);\n        } else {\n          iterations++;\n          if (fn(v, useKeys ? k : iterations - 1, flatSequence) === false) {\n            stopped = true;\n          }\n        }\n        return !stopped;\n      }, reverse);\n    }\n    flatDeep(collection, 0);\n    return iterations;\n  };\n  flatSequence.__iteratorUncached = function(type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var stack = [];\n    var iterations = 0;\n    return new Iterator(function () {\n      while (iterator) {\n        var step = iterator.next();\n        if (step.done !== false) {\n          iterator = stack.pop();\n          continue;\n        }\n        var v = step.value;\n        if (type === ITERATE_ENTRIES) {\n          v = v[1];\n        }\n        if ((!depth || stack.length < depth) && isCollection(v)) {\n          stack.push(iterator);\n          iterator = v.__iterator(type, reverse);\n        } else {\n          return useKeys ? step : iteratorValue(type, iterations++, v, step);\n        }\n      }\n      return iteratorDone();\n    });\n  };\n  return flatSequence;\n}\n\nfunction flatMapFactory(collection, mapper, context) {\n  var coerce = collectionClass(collection);\n  return collection\n    .toSeq()\n    .map(function (v, k) { return coerce(mapper.call(context, v, k, collection)); })\n    .flatten(true);\n}\n\nfunction interposeFactory(collection, separator) {\n  var interposedSequence = makeSequence(collection);\n  interposedSequence.size = collection.size && collection.size * 2 - 1;\n  interposedSequence.__iterateUncached = function(fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(\n      function (v) { return (!iterations || fn(separator, iterations++, this$1) !== false) &&\n        fn(v, iterations++, this$1) !== false; },\n      reverse\n    );\n    return iterations;\n  };\n  interposedSequence.__iteratorUncached = function(type, reverse) {\n    var iterator = collection.__iterator(ITERATE_VALUES, reverse);\n    var iterations = 0;\n    var step;\n    return new Iterator(function () {\n      if (!step || iterations % 2) {\n        step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n      }\n      return iterations % 2\n        ? iteratorValue(type, iterations++, separator)\n        : iteratorValue(type, iterations++, step.value, step);\n    });\n  };\n  return interposedSequence;\n}\n\nfunction sortFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  var isKeyedCollection = isKeyed(collection);\n  var index = 0;\n  var entries = collection\n    .toSeq()\n    .map(function (v, k) { return [k, v, index++, mapper ? mapper(v, k, collection) : v]; })\n    .valueSeq()\n    .toArray();\n  entries.sort(function (a, b) { return comparator(a[3], b[3]) || a[2] - b[2]; }).forEach(\n    isKeyedCollection\n      ? function (v, i) {\n          entries[i].length = 2;\n        }\n      : function (v, i) {\n          entries[i] = v[1];\n        }\n  );\n  return isKeyedCollection\n    ? KeyedSeq(entries)\n    : isIndexed(collection)\n      ? IndexedSeq(entries)\n      : SetSeq(entries);\n}\n\nfunction maxFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  if (mapper) {\n    var entry = collection\n      .toSeq()\n      .map(function (v, k) { return [v, mapper(v, k, collection)]; })\n      .reduce(function (a, b) { return (maxCompare(comparator, a[1], b[1]) ? b : a); });\n    return entry && entry[0];\n  }\n  return collection.reduce(function (a, b) { return (maxCompare(comparator, a, b) ? b : a); });\n}\n\nfunction maxCompare(comparator, a, b) {\n  var comp = comparator(b, a);\n  // b is considered the new max if the comparator declares them equal, but\n  // they are not equal and b is in fact a nullish value.\n  return (\n    (comp === 0 && b !== a && (b === undefined || b === null || b !== b)) ||\n    comp > 0\n  );\n}\n\nfunction zipWithFactory(keyIter, zipper, iters, zipAll) {\n  var zipSequence = makeSequence(keyIter);\n  var sizes = new ArraySeq(iters).map(function (i) { return i.size; });\n  zipSequence.size = zipAll ? sizes.max() : sizes.min();\n  // Note: this a generic base implementation of __iterate in terms of\n  // __iterator which may be more generically useful in the future.\n  zipSequence.__iterate = function(fn, reverse) {\n    /* generic:\n    var iterator = this.__iterator(ITERATE_ENTRIES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      iterations++;\n      if (fn(step.value[1], step.value[0], this) === false) {\n        break;\n      }\n    }\n    return iterations;\n    */\n    // indexed:\n    var iterator = this.__iterator(ITERATE_VALUES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      if (fn(step.value, iterations++, this) === false) {\n        break;\n      }\n    }\n    return iterations;\n  };\n  zipSequence.__iteratorUncached = function(type, reverse) {\n    var iterators = iters.map(\n      function (i) { return ((i = Collection(i)), getIterator(reverse ? i.reverse() : i)); }\n    );\n    var iterations = 0;\n    var isDone = false;\n    return new Iterator(function () {\n      var steps;\n      if (!isDone) {\n        steps = iterators.map(function (i) { return i.next(); });\n        isDone = zipAll ? steps.every(function (s) { return s.done; }) : steps.some(function (s) { return s.done; });\n      }\n      if (isDone) {\n        return iteratorDone();\n      }\n      return iteratorValue(\n        type,\n        iterations++,\n        zipper.apply(null, steps.map(function (s) { return s.value; }))\n      );\n    });\n  };\n  return zipSequence;\n}\n\n// #pragma Helper Functions\n\nfunction reify(iter, seq) {\n  return iter === seq ? iter : isSeq(iter) ? seq : iter.constructor(seq);\n}\n\nfunction validateEntry(entry) {\n  if (entry !== Object(entry)) {\n    throw new TypeError('Expected [K, V] tuple: ' + entry);\n  }\n}\n\nfunction collectionClass(collection) {\n  return isKeyed(collection)\n    ? KeyedCollection\n    : isIndexed(collection)\n      ? IndexedCollection\n      : SetCollection;\n}\n\nfunction makeSequence(collection) {\n  return Object.create(\n    (isKeyed(collection)\n      ? KeyedSeq\n      : isIndexed(collection)\n        ? IndexedSeq\n        : SetSeq\n    ).prototype\n  );\n}\n\nfunction cacheResultThrough() {\n  if (this._iter.cacheResult) {\n    this._iter.cacheResult();\n    this.size = this._iter.size;\n    return this;\n  }\n  return Seq.prototype.cacheResult.call(this);\n}\n\nfunction defaultComparator(a, b) {\n  if (a === undefined && b === undefined) {\n    return 0;\n  }\n\n  if (a === undefined) {\n    return 1;\n  }\n\n  if (b === undefined) {\n    return -1;\n  }\n\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n// http://jsperf.com/copy-array-inline\nfunction arrCopy(arr, offset) {\n  offset = offset || 0;\n  var len = Math.max(0, arr.length - offset);\n  var newArr = new Array(len);\n  for (var ii = 0; ii < len; ii++) {\n    newArr[ii] = arr[ii + offset];\n  }\n  return newArr;\n}\n\nfunction invariant(condition, error) {\n  if (!condition) { throw new Error(error); }\n}\n\nfunction assertNotInfinite(size) {\n  invariant(\n    size !== Infinity,\n    'Cannot perform this action with an infinite size.'\n  );\n}\n\nfunction coerceKeyPath(keyPath) {\n  if (isArrayLike(keyPath) && typeof keyPath !== 'string') {\n    return keyPath;\n  }\n  if (isOrdered(keyPath)) {\n    return keyPath.toArray();\n  }\n  throw new TypeError(\n    'Invalid keyPath: expected Ordered Collection or Array: ' + keyPath\n  );\n}\n\nfunction isPlainObj(value) {\n  return (\n    value &&\n    (typeof value.constructor !== 'function' ||\n      value.constructor.name === 'Object')\n  );\n}\n\n/**\n * Returns true if the value is a potentially-persistent data structure, either\n * provided by Immutable.js or a plain Array or Object.\n */\nfunction isDataStructure(value) {\n  return (\n    typeof value === 'object' &&\n    (isImmutable(value) || Array.isArray(value) || isPlainObj(value))\n  );\n}\n\n/**\n * Converts a value to a string, adding quotes if a string was provided.\n */\nfunction quoteString(value) {\n  try {\n    return typeof value === 'string' ? JSON.stringify(value) : String(value);\n  } catch (_ignoreError) {\n    return JSON.stringify(value);\n  }\n}\n\nfunction has(collection, key) {\n  return isImmutable(collection)\n    ? collection.has(key)\n    : isDataStructure(collection) && hasOwnProperty.call(collection, key);\n}\n\nfunction get(collection, key, notSetValue) {\n  return isImmutable(collection)\n    ? collection.get(key, notSetValue)\n    : !has(collection, key)\n      ? notSetValue\n      : typeof collection.get === 'function'\n        ? collection.get(key)\n        : collection[key];\n}\n\nfunction shallowCopy(from) {\n  if (Array.isArray(from)) {\n    return arrCopy(from);\n  }\n  var to = {};\n  for (var key in from) {\n    if (hasOwnProperty.call(from, key)) {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\n\nfunction remove(collection, key) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.remove) {\n      throw new TypeError(\n        'Cannot update immutable value without .remove() method: ' + collection\n      );\n    }\n    return collection.remove(key);\n  }\n  if (!hasOwnProperty.call(collection, key)) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  if (Array.isArray(collectionCopy)) {\n    collectionCopy.splice(key, 1);\n  } else {\n    delete collectionCopy[key];\n  }\n  return collectionCopy;\n}\n\nfunction set(collection, key, value) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.set) {\n      throw new TypeError(\n        'Cannot update immutable value without .set() method: ' + collection\n      );\n    }\n    return collection.set(key, value);\n  }\n  if (hasOwnProperty.call(collection, key) && value === collection[key]) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  collectionCopy[key] = value;\n  return collectionCopy;\n}\n\nfunction updateIn(collection, keyPath, notSetValue, updater) {\n  if (!updater) {\n    updater = notSetValue;\n    notSetValue = undefined;\n  }\n  var updatedValue = updateInDeeply(\n    isImmutable(collection),\n    collection,\n    coerceKeyPath(keyPath),\n    0,\n    notSetValue,\n    updater\n  );\n  return updatedValue === NOT_SET ? notSetValue : updatedValue;\n}\n\nfunction updateInDeeply(\n  inImmutable,\n  existing,\n  keyPath,\n  i,\n  notSetValue,\n  updater\n) {\n  var wasNotSet = existing === NOT_SET;\n  if (i === keyPath.length) {\n    var existingValue = wasNotSet ? notSetValue : existing;\n    var newValue = updater(existingValue);\n    return newValue === existingValue ? existing : newValue;\n  }\n  if (!wasNotSet && !isDataStructure(existing)) {\n    throw new TypeError(\n      'Cannot update within non-data-structure value in path [' +\n        keyPath.slice(0, i).map(quoteString) +\n        ']: ' +\n        existing\n    );\n  }\n  var key = keyPath[i];\n  var nextExisting = wasNotSet ? NOT_SET : get(existing, key, NOT_SET);\n  var nextUpdated = updateInDeeply(\n    nextExisting === NOT_SET ? inImmutable : isImmutable(nextExisting),\n    nextExisting,\n    keyPath,\n    i + 1,\n    notSetValue,\n    updater\n  );\n  return nextUpdated === nextExisting\n    ? existing\n    : nextUpdated === NOT_SET\n      ? remove(existing, key)\n      : set(\n          wasNotSet ? (inImmutable ? emptyMap() : {}) : existing,\n          key,\n          nextUpdated\n        );\n}\n\nfunction setIn(collection, keyPath, value) {\n  return updateIn(collection, keyPath, NOT_SET, function () { return value; });\n}\n\nfunction setIn$1(keyPath, v) {\n  return setIn(this, keyPath, v);\n}\n\nfunction removeIn(collection, keyPath) {\n  return updateIn(collection, keyPath, function () { return NOT_SET; });\n}\n\nfunction deleteIn(keyPath) {\n  return removeIn(this, keyPath);\n}\n\nfunction update(collection, key, notSetValue, updater) {\n  return updateIn(collection, [key], notSetValue, updater);\n}\n\nfunction update$1(key, notSetValue, updater) {\n  return arguments.length === 1\n    ? key(this)\n    : update(this, key, notSetValue, updater);\n}\n\nfunction updateIn$1(keyPath, notSetValue, updater) {\n  return updateIn(this, keyPath, notSetValue, updater);\n}\n\nfunction merge() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeIntoKeyedWith(this, iters);\n}\n\nfunction mergeWith(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  if (typeof merger !== 'function') {\n    throw new TypeError('Invalid merger function: ' + merger);\n  }\n  return mergeIntoKeyedWith(this, iters, merger);\n}\n\nfunction mergeIntoKeyedWith(collection, collections, merger) {\n  var iters = [];\n  for (var ii = 0; ii < collections.length; ii++) {\n    var collection$1 = KeyedCollection(collections[ii]);\n    if (collection$1.size !== 0) {\n      iters.push(collection$1);\n    }\n  }\n  if (iters.length === 0) {\n    return collection;\n  }\n  if (\n    collection.toSeq().size === 0 &&\n    !collection.__ownerID &&\n    iters.length === 1\n  ) {\n    return collection.constructor(iters[0]);\n  }\n  return collection.withMutations(function (collection) {\n    var mergeIntoCollection = merger\n      ? function (value, key) {\n          update(\n            collection,\n            key,\n            NOT_SET,\n            function (oldVal) { return (oldVal === NOT_SET ? value : merger(oldVal, value, key)); }\n          );\n        }\n      : function (value, key) {\n          collection.set(key, value);\n        };\n    for (var ii = 0; ii < iters.length; ii++) {\n      iters[ii].forEach(mergeIntoCollection);\n    }\n  });\n}\n\nfunction merge$1(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeWithSources(collection, sources);\n}\n\nfunction mergeWith$1(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeWithSources(collection, sources, merger);\n}\n\nfunction mergeDeep(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(collection, sources);\n}\n\nfunction mergeDeepWith(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeDeepWithSources(collection, sources, merger);\n}\n\nfunction mergeDeepWithSources(collection, sources, merger) {\n  return mergeWithSources(collection, sources, deepMergerWith(merger));\n}\n\nfunction mergeWithSources(collection, sources, merger) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot merge into non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    return typeof merger === 'function' && collection.mergeWith\n      ? collection.mergeWith.apply(collection, [ merger ].concat( sources ))\n      : collection.merge\n        ? collection.merge.apply(collection, sources)\n        : collection.concat.apply(collection, sources);\n  }\n  var isArray = Array.isArray(collection);\n  var merged = collection;\n  var Collection$$1 = isArray ? IndexedCollection : KeyedCollection;\n  var mergeItem = isArray\n    ? function (value) {\n        // Copy on write\n        if (merged === collection) {\n          merged = shallowCopy(merged);\n        }\n        merged.push(value);\n      }\n    : function (value, key) {\n        var hasVal = hasOwnProperty.call(merged, key);\n        var nextVal =\n          hasVal && merger ? merger(merged[key], value, key) : value;\n        if (!hasVal || nextVal !== merged[key]) {\n          // Copy on write\n          if (merged === collection) {\n            merged = shallowCopy(merged);\n          }\n          merged[key] = nextVal;\n        }\n      };\n  for (var i = 0; i < sources.length; i++) {\n    Collection$$1(sources[i]).forEach(mergeItem);\n  }\n  return merged;\n}\n\nfunction deepMergerWith(merger) {\n  function deepMerger(oldValue, newValue, key) {\n    return isDataStructure(oldValue) && isDataStructure(newValue)\n      ? mergeWithSources(oldValue, [newValue], deepMerger)\n      : merger\n        ? merger(oldValue, newValue, key)\n        : newValue;\n  }\n  return deepMerger;\n}\n\nfunction mergeDeep$1() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeDeepWithSources(this, iters);\n}\n\nfunction mergeDeepWith$1(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(this, iters, merger);\n}\n\nfunction mergeIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn(this, keyPath, emptyMap(), function (m) { return mergeWithSources(m, iters); });\n}\n\nfunction mergeDeepIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn(this, keyPath, emptyMap(), function (m) { return mergeDeepWithSources(m, iters); }\n  );\n}\n\nfunction withMutations(fn) {\n  var mutable = this.asMutable();\n  fn(mutable);\n  return mutable.wasAltered() ? mutable.__ensureOwner(this.__ownerID) : this;\n}\n\nfunction asMutable() {\n  return this.__ownerID ? this : this.__ensureOwner(new OwnerID());\n}\n\nfunction asImmutable() {\n  return this.__ensureOwner();\n}\n\nfunction wasAltered() {\n  return this.__altered;\n}\n\nvar Map = /*@__PURE__*/(function (KeyedCollection$$1) {\n  function Map(value) {\n    return value === null || value === undefined\n      ? emptyMap()\n      : isMap(value) && !isOrdered(value)\n        ? value\n        : emptyMap().withMutations(function (map) {\n            var iter = KeyedCollection$$1(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v, k) { return map.set(k, v); });\n          });\n  }\n\n  if ( KeyedCollection$$1 ) Map.__proto__ = KeyedCollection$$1;\n  Map.prototype = Object.create( KeyedCollection$$1 && KeyedCollection$$1.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.of = function of () {\n    var keyValues = [], len = arguments.length;\n    while ( len-- ) keyValues[ len ] = arguments[ len ];\n\n    return emptyMap().withMutations(function (map) {\n      for (var i = 0; i < keyValues.length; i += 2) {\n        if (i + 1 >= keyValues.length) {\n          throw new Error('Missing value for key: ' + keyValues[i]);\n        }\n        map.set(keyValues[i], keyValues[i + 1]);\n      }\n    });\n  };\n\n  Map.prototype.toString = function toString () {\n    return this.__toString('Map {', '}');\n  };\n\n  // @pragma Access\n\n  Map.prototype.get = function get (k, notSetValue) {\n    return this._root\n      ? this._root.get(0, undefined, k, notSetValue)\n      : notSetValue;\n  };\n\n  // @pragma Modification\n\n  Map.prototype.set = function set (k, v) {\n    return updateMap(this, k, v);\n  };\n\n  Map.prototype.remove = function remove (k) {\n    return updateMap(this, k, NOT_SET);\n  };\n\n  Map.prototype.deleteAll = function deleteAll (keys) {\n    var collection = Collection(keys);\n\n    if (collection.size === 0) {\n      return this;\n    }\n\n    return this.withMutations(function (map) {\n      collection.forEach(function (key) { return map.remove(key); });\n    });\n  };\n\n  Map.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._root = null;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyMap();\n  };\n\n  // @pragma Composition\n\n  Map.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator));\n  };\n\n  Map.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator, mapper));\n  };\n\n  Map.prototype.map = function map (mapper, context) {\n    return this.withMutations(function (map) {\n      map.forEach(function (value, key) {\n        map.set(key, mapper.call(context, value, key, map));\n      });\n    });\n  };\n\n  // @pragma Mutability\n\n  Map.prototype.__iterator = function __iterator (type, reverse) {\n    return new MapIterator(this, type, reverse);\n  };\n\n  Map.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    var iterations = 0;\n    this._root &&\n      this._root.iterate(function (entry) {\n        iterations++;\n        return fn(entry[1], entry[0], this$1);\n      }, reverse);\n    return iterations;\n  };\n\n  Map.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyMap();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeMap(this.size, this._root, ownerID, this.__hash);\n  };\n\n  return Map;\n}(KeyedCollection));\n\nMap.isMap = isMap;\n\nvar MapPrototype = Map.prototype;\nMapPrototype[IS_MAP_SYMBOL] = true;\nMapPrototype[DELETE] = MapPrototype.remove;\nMapPrototype.removeAll = MapPrototype.deleteAll;\nMapPrototype.setIn = setIn$1;\nMapPrototype.removeIn = MapPrototype.deleteIn = deleteIn;\nMapPrototype.update = update$1;\nMapPrototype.updateIn = updateIn$1;\nMapPrototype.merge = MapPrototype.concat = merge;\nMapPrototype.mergeWith = mergeWith;\nMapPrototype.mergeDeep = mergeDeep$1;\nMapPrototype.mergeDeepWith = mergeDeepWith$1;\nMapPrototype.mergeIn = mergeIn;\nMapPrototype.mergeDeepIn = mergeDeepIn;\nMapPrototype.withMutations = withMutations;\nMapPrototype.wasAltered = wasAltered;\nMapPrototype.asImmutable = asImmutable;\nMapPrototype['@@transducer/init'] = MapPrototype.asMutable = asMutable;\nMapPrototype['@@transducer/step'] = function(result, arr) {\n  return result.set(arr[0], arr[1]);\n};\nMapPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\n// #pragma Trie Nodes\n\nvar ArrayMapNode = function ArrayMapNode(ownerID, entries) {\n  this.ownerID = ownerID;\n  this.entries = entries;\n};\n\nArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && entries.length === 1) {\n    return; // undefined\n  }\n\n  if (!exists && !removed && entries.length >= MAX_ARRAY_MAP_SIZE) {\n    return createNodes(ownerID, entries, key, value);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new ArrayMapNode(ownerID, newEntries);\n};\n\nvar BitmapIndexedNode = function BitmapIndexedNode(ownerID, bitmap, nodes) {\n  this.ownerID = ownerID;\n  this.bitmap = bitmap;\n  this.nodes = nodes;\n};\n\nBitmapIndexedNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var bit = 1 << ((shift === 0 ? keyHash : keyHash >>> shift) & MASK);\n  var bitmap = this.bitmap;\n  return (bitmap & bit) === 0\n    ? notSetValue\n    : this.nodes[popCount(bitmap & (bit - 1))].get(\n        shift + SHIFT,\n        keyHash,\n        key,\n        notSetValue\n      );\n};\n\nBitmapIndexedNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var keyHashFrag = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var bit = 1 << keyHashFrag;\n  var bitmap = this.bitmap;\n  var exists = (bitmap & bit) !== 0;\n\n  if (!exists && value === NOT_SET) {\n    return this;\n  }\n\n  var idx = popCount(bitmap & (bit - 1));\n  var nodes = this.nodes;\n  var node = exists ? nodes[idx] : undefined;\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n\n  if (newNode === node) {\n    return this;\n  }\n\n  if (!exists && newNode && nodes.length >= MAX_BITMAP_INDEXED_SIZE) {\n    return expandNodes(ownerID, nodes, bitmap, keyHashFrag, newNode);\n  }\n\n  if (\n    exists &&\n    !newNode &&\n    nodes.length === 2 &&\n    isLeafNode(nodes[idx ^ 1])\n  ) {\n    return nodes[idx ^ 1];\n  }\n\n  if (exists && newNode && nodes.length === 1 && isLeafNode(newNode)) {\n    return newNode;\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newBitmap = exists ? (newNode ? bitmap : bitmap ^ bit) : bitmap | bit;\n  var newNodes = exists\n    ? newNode\n      ? setAt(nodes, idx, newNode, isEditable)\n      : spliceOut(nodes, idx, isEditable)\n    : spliceIn(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.bitmap = newBitmap;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new BitmapIndexedNode(ownerID, newBitmap, newNodes);\n};\n\nvar HashArrayMapNode = function HashArrayMapNode(ownerID, count, nodes) {\n  this.ownerID = ownerID;\n  this.count = count;\n  this.nodes = nodes;\n};\n\nHashArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var node = this.nodes[idx];\n  return node\n    ? node.get(shift + SHIFT, keyHash, key, notSetValue)\n    : notSetValue;\n};\n\nHashArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var removed = value === NOT_SET;\n  var nodes = this.nodes;\n  var node = nodes[idx];\n\n  if (removed && !node) {\n    return this;\n  }\n\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n  if (newNode === node) {\n    return this;\n  }\n\n  var newCount = this.count;\n  if (!node) {\n    newCount++;\n  } else if (!newNode) {\n    newCount--;\n    if (newCount < MIN_HASH_ARRAY_MAP_SIZE) {\n      return packNodes(ownerID, nodes, newCount, idx);\n    }\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newNodes = setAt(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.count = newCount;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new HashArrayMapNode(ownerID, newCount, newNodes);\n};\n\nvar HashCollisionNode = function HashCollisionNode(ownerID, keyHash, entries) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entries = entries;\n};\n\nHashCollisionNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nHashCollisionNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n\n  var removed = value === NOT_SET;\n\n  if (keyHash !== this.keyHash) {\n    if (removed) {\n      return this;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return mergeIntoNode(this, ownerID, shift, keyHash, [key, value]);\n  }\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && len === 2) {\n    return new ValueNode(ownerID, this.keyHash, entries[idx ^ 1]);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new HashCollisionNode(ownerID, this.keyHash, newEntries);\n};\n\nvar ValueNode = function ValueNode(ownerID, keyHash, entry) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entry = entry;\n};\n\nValueNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  return is(key, this.entry[0]) ? this.entry[1] : notSetValue;\n};\n\nValueNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n  var keyMatch = is(key, this.entry[0]);\n  if (keyMatch ? value === this.entry[1] : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n\n  if (removed) {\n    SetRef(didChangeSize);\n    return; // undefined\n  }\n\n  if (keyMatch) {\n    if (ownerID && ownerID === this.ownerID) {\n      this.entry[1] = value;\n      return this;\n    }\n    return new ValueNode(ownerID, this.keyHash, [key, value]);\n  }\n\n  SetRef(didChangeSize);\n  return mergeIntoNode(this, ownerID, shift, hash(key), [key, value]);\n};\n\n// #pragma Iterators\n\nArrayMapNode.prototype.iterate = HashCollisionNode.prototype.iterate = function(\n  fn,\n  reverse\n) {\n  var entries = this.entries;\n  for (var ii = 0, maxIndex = entries.length - 1; ii <= maxIndex; ii++) {\n    if (fn(entries[reverse ? maxIndex - ii : ii]) === false) {\n      return false;\n    }\n  }\n};\n\nBitmapIndexedNode.prototype.iterate = HashArrayMapNode.prototype.iterate = function(\n  fn,\n  reverse\n) {\n  var nodes = this.nodes;\n  for (var ii = 0, maxIndex = nodes.length - 1; ii <= maxIndex; ii++) {\n    var node = nodes[reverse ? maxIndex - ii : ii];\n    if (node && node.iterate(fn, reverse) === false) {\n      return false;\n    }\n  }\n};\n\n// eslint-disable-next-line no-unused-vars\nValueNode.prototype.iterate = function(fn, reverse) {\n  return fn(this.entry);\n};\n\nvar MapIterator = /*@__PURE__*/(function (Iterator$$1) {\n  function MapIterator(map, type, reverse) {\n    this._type = type;\n    this._reverse = reverse;\n    this._stack = map._root && mapIteratorFrame(map._root);\n  }\n\n  if ( Iterator$$1 ) MapIterator.__proto__ = Iterator$$1;\n  MapIterator.prototype = Object.create( Iterator$$1 && Iterator$$1.prototype );\n  MapIterator.prototype.constructor = MapIterator;\n\n  MapIterator.prototype.next = function next () {\n    var type = this._type;\n    var stack = this._stack;\n    while (stack) {\n      var node = stack.node;\n      var index = stack.index++;\n      var maxIndex = (void 0);\n      if (node.entry) {\n        if (index === 0) {\n          return mapIteratorValue(type, node.entry);\n        }\n      } else if (node.entries) {\n        maxIndex = node.entries.length - 1;\n        if (index <= maxIndex) {\n          return mapIteratorValue(\n            type,\n            node.entries[this._reverse ? maxIndex - index : index]\n          );\n        }\n      } else {\n        maxIndex = node.nodes.length - 1;\n        if (index <= maxIndex) {\n          var subNode = node.nodes[this._reverse ? maxIndex - index : index];\n          if (subNode) {\n            if (subNode.entry) {\n              return mapIteratorValue(type, subNode.entry);\n            }\n            stack = this._stack = mapIteratorFrame(subNode, stack);\n          }\n          continue;\n        }\n      }\n      stack = this._stack = this._stack.__prev;\n    }\n    return iteratorDone();\n  };\n\n  return MapIterator;\n}(Iterator));\n\nfunction mapIteratorValue(type, entry) {\n  return iteratorValue(type, entry[0], entry[1]);\n}\n\nfunction mapIteratorFrame(node, prev) {\n  return {\n    node: node,\n    index: 0,\n    __prev: prev,\n  };\n}\n\nfunction makeMap(size, root, ownerID, hash$$1) {\n  var map = Object.create(MapPrototype);\n  map.size = size;\n  map._root = root;\n  map.__ownerID = ownerID;\n  map.__hash = hash$$1;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_MAP;\nfunction emptyMap() {\n  return EMPTY_MAP || (EMPTY_MAP = makeMap(0));\n}\n\nfunction updateMap(map, k, v) {\n  var newRoot;\n  var newSize;\n  if (!map._root) {\n    if (v === NOT_SET) {\n      return map;\n    }\n    newSize = 1;\n    newRoot = new ArrayMapNode(map.__ownerID, [[k, v]]);\n  } else {\n    var didChangeSize = MakeRef();\n    var didAlter = MakeRef();\n    newRoot = updateNode(\n      map._root,\n      map.__ownerID,\n      0,\n      undefined,\n      k,\n      v,\n      didChangeSize,\n      didAlter\n    );\n    if (!didAlter.value) {\n      return map;\n    }\n    newSize = map.size + (didChangeSize.value ? (v === NOT_SET ? -1 : 1) : 0);\n  }\n  if (map.__ownerID) {\n    map.size = newSize;\n    map._root = newRoot;\n    map.__hash = undefined;\n    map.__altered = true;\n    return map;\n  }\n  return newRoot ? makeMap(newSize, newRoot) : emptyMap();\n}\n\nfunction updateNode(\n  node,\n  ownerID,\n  shift,\n  keyHash,\n  key,\n  value,\n  didChangeSize,\n  didAlter\n) {\n  if (!node) {\n    if (value === NOT_SET) {\n      return node;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return new ValueNode(ownerID, keyHash, [key, value]);\n  }\n  return node.update(\n    ownerID,\n    shift,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n}\n\nfunction isLeafNode(node) {\n  return (\n    node.constructor === ValueNode || node.constructor === HashCollisionNode\n  );\n}\n\nfunction mergeIntoNode(node, ownerID, shift, keyHash, entry) {\n  if (node.keyHash === keyHash) {\n    return new HashCollisionNode(ownerID, keyHash, [node.entry, entry]);\n  }\n\n  var idx1 = (shift === 0 ? node.keyHash : node.keyHash >>> shift) & MASK;\n  var idx2 = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n\n  var newNode;\n  var nodes =\n    idx1 === idx2\n      ? [mergeIntoNode(node, ownerID, shift + SHIFT, keyHash, entry)]\n      : ((newNode = new ValueNode(ownerID, keyHash, entry)),\n        idx1 < idx2 ? [node, newNode] : [newNode, node]);\n\n  return new BitmapIndexedNode(ownerID, (1 << idx1) | (1 << idx2), nodes);\n}\n\nfunction createNodes(ownerID, entries, key, value) {\n  if (!ownerID) {\n    ownerID = new OwnerID();\n  }\n  var node = new ValueNode(ownerID, hash(key), [key, value]);\n  for (var ii = 0; ii < entries.length; ii++) {\n    var entry = entries[ii];\n    node = node.update(ownerID, 0, undefined, entry[0], entry[1]);\n  }\n  return node;\n}\n\nfunction packNodes(ownerID, nodes, count, excluding) {\n  var bitmap = 0;\n  var packedII = 0;\n  var packedNodes = new Array(count);\n  for (var ii = 0, bit = 1, len = nodes.length; ii < len; ii++, bit <<= 1) {\n    var node = nodes[ii];\n    if (node !== undefined && ii !== excluding) {\n      bitmap |= bit;\n      packedNodes[packedII++] = node;\n    }\n  }\n  return new BitmapIndexedNode(ownerID, bitmap, packedNodes);\n}\n\nfunction expandNodes(ownerID, nodes, bitmap, including, node) {\n  var count = 0;\n  var expandedNodes = new Array(SIZE);\n  for (var ii = 0; bitmap !== 0; ii++, bitmap >>>= 1) {\n    expandedNodes[ii] = bitmap & 1 ? nodes[count++] : undefined;\n  }\n  expandedNodes[including] = node;\n  return new HashArrayMapNode(ownerID, count + 1, expandedNodes);\n}\n\nfunction popCount(x) {\n  x -= (x >> 1) & 0x55555555;\n  x = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n  x = (x + (x >> 4)) & 0x0f0f0f0f;\n  x += x >> 8;\n  x += x >> 16;\n  return x & 0x7f;\n}\n\nfunction setAt(array, idx, val, canEdit) {\n  var newArray = canEdit ? array : arrCopy(array);\n  newArray[idx] = val;\n  return newArray;\n}\n\nfunction spliceIn(array, idx, val, canEdit) {\n  var newLen = array.length + 1;\n  if (canEdit && idx + 1 === newLen) {\n    array[idx] = val;\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      newArray[ii] = val;\n      after = -1;\n    } else {\n      newArray[ii] = array[ii + after];\n    }\n  }\n  return newArray;\n}\n\nfunction spliceOut(array, idx, canEdit) {\n  var newLen = array.length - 1;\n  if (canEdit && idx === newLen) {\n    array.pop();\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      after = 1;\n    }\n    newArray[ii] = array[ii + after];\n  }\n  return newArray;\n}\n\nvar MAX_ARRAY_MAP_SIZE = SIZE / 4;\nvar MAX_BITMAP_INDEXED_SIZE = SIZE / 2;\nvar MIN_HASH_ARRAY_MAP_SIZE = SIZE / 4;\n\nvar IS_LIST_SYMBOL = '@@__IMMUTABLE_LIST__@@';\n\nfunction isList(maybeList) {\n  return Boolean(maybeList && maybeList[IS_LIST_SYMBOL]);\n}\n\nvar List = /*@__PURE__*/(function (IndexedCollection$$1) {\n  function List(value) {\n    var empty = emptyList();\n    if (value === null || value === undefined) {\n      return empty;\n    }\n    if (isList(value)) {\n      return value;\n    }\n    var iter = IndexedCollection$$1(value);\n    var size = iter.size;\n    if (size === 0) {\n      return empty;\n    }\n    assertNotInfinite(size);\n    if (size > 0 && size < SIZE) {\n      return makeList(0, size, SHIFT, null, new VNode(iter.toArray()));\n    }\n    return empty.withMutations(function (list) {\n      list.setSize(size);\n      iter.forEach(function (v, i) { return list.set(i, v); });\n    });\n  }\n\n  if ( IndexedCollection$$1 ) List.__proto__ = IndexedCollection$$1;\n  List.prototype = Object.create( IndexedCollection$$1 && IndexedCollection$$1.prototype );\n  List.prototype.constructor = List;\n\n  List.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  List.prototype.toString = function toString () {\n    return this.__toString('List [', ']');\n  };\n\n  // @pragma Access\n\n  List.prototype.get = function get (index, notSetValue) {\n    index = wrapIndex(this, index);\n    if (index >= 0 && index < this.size) {\n      index += this._origin;\n      var node = listNodeFor(this, index);\n      return node && node.array[index & MASK];\n    }\n    return notSetValue;\n  };\n\n  // @pragma Modification\n\n  List.prototype.set = function set (index, value) {\n    return updateList(this, index, value);\n  };\n\n  List.prototype.remove = function remove (index) {\n    return !this.has(index)\n      ? this\n      : index === 0\n        ? this.shift()\n        : index === this.size - 1\n          ? this.pop()\n          : this.splice(index, 1);\n  };\n\n  List.prototype.insert = function insert (index, value) {\n    return this.splice(index, 0, value);\n  };\n\n  List.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = this._origin = this._capacity = 0;\n      this._level = SHIFT;\n      this._root = this._tail = null;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyList();\n  };\n\n  List.prototype.push = function push (/*...values*/) {\n    var values = arguments;\n    var oldSize = this.size;\n    return this.withMutations(function (list) {\n      setListBounds(list, 0, oldSize + values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(oldSize + ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.pop = function pop () {\n    return setListBounds(this, 0, -1);\n  };\n\n  List.prototype.unshift = function unshift (/*...values*/) {\n    var values = arguments;\n    return this.withMutations(function (list) {\n      setListBounds(list, -values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.shift = function shift () {\n    return setListBounds(this, 1);\n  };\n\n  // @pragma Composition\n\n  List.prototype.concat = function concat (/*...collections*/) {\n    var arguments$1 = arguments;\n\n    var seqs = [];\n    for (var i = 0; i < arguments.length; i++) {\n      var argument = arguments$1[i];\n      var seq = IndexedCollection$$1(\n        typeof argument !== 'string' && hasIterator(argument)\n          ? argument\n          : [argument]\n      );\n      if (seq.size !== 0) {\n        seqs.push(seq);\n      }\n    }\n    if (seqs.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && seqs.length === 1) {\n      return this.constructor(seqs[0]);\n    }\n    return this.withMutations(function (list) {\n      seqs.forEach(function (seq) { return seq.forEach(function (value) { return list.push(value); }); });\n    });\n  };\n\n  List.prototype.setSize = function setSize (size) {\n    return setListBounds(this, 0, size);\n  };\n\n  List.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    return this.withMutations(function (list) {\n      for (var i = 0; i < this$1.size; i++) {\n        list.set(i, mapper.call(context, list.get(i), i, list));\n      }\n    });\n  };\n\n  // @pragma Iteration\n\n  List.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    if (wholeSlice(begin, end, size)) {\n      return this;\n    }\n    return setListBounds(\n      this,\n      resolveBegin(begin, size),\n      resolveEnd(end, size)\n    );\n  };\n\n  List.prototype.__iterator = function __iterator (type, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    return new Iterator(function () {\n      var value = values();\n      return value === DONE\n        ? iteratorDone()\n        : iteratorValue(type, reverse ? --index : index++, value);\n    });\n  };\n\n  List.prototype.__iterate = function __iterate (fn, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    var value;\n    while ((value = values()) !== DONE) {\n      if (fn(value, reverse ? --index : index++, this) === false) {\n        break;\n      }\n    }\n    return index;\n  };\n\n  List.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyList();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeList(\n      this._origin,\n      this._capacity,\n      this._level,\n      this._root,\n      this._tail,\n      ownerID,\n      this.__hash\n    );\n  };\n\n  return List;\n}(IndexedCollection));\n\nList.isList = isList;\n\nvar ListPrototype = List.prototype;\nListPrototype[IS_LIST_SYMBOL] = true;\nListPrototype[DELETE] = ListPrototype.remove;\nListPrototype.merge = ListPrototype.concat;\nListPrototype.setIn = setIn$1;\nListPrototype.deleteIn = ListPrototype.removeIn = deleteIn;\nListPrototype.update = update$1;\nListPrototype.updateIn = updateIn$1;\nListPrototype.mergeIn = mergeIn;\nListPrototype.mergeDeepIn = mergeDeepIn;\nListPrototype.withMutations = withMutations;\nListPrototype.wasAltered = wasAltered;\nListPrototype.asImmutable = asImmutable;\nListPrototype['@@transducer/init'] = ListPrototype.asMutable = asMutable;\nListPrototype['@@transducer/step'] = function(result, arr) {\n  return result.push(arr);\n};\nListPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nvar VNode = function VNode(array, ownerID) {\n  this.array = array;\n  this.ownerID = ownerID;\n};\n\n// TODO: seems like these methods are very similar\n\nVNode.prototype.removeBefore = function removeBefore (ownerID, level, index) {\n  if (index === level ? 1 << level : this.array.length === 0) {\n    return this;\n  }\n  var originIndex = (index >>> level) & MASK;\n  if (originIndex >= this.array.length) {\n    return new VNode([], ownerID);\n  }\n  var removingFirst = originIndex === 0;\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[originIndex];\n    newChild =\n      oldChild && oldChild.removeBefore(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && removingFirst) {\n      return this;\n    }\n  }\n  if (removingFirst && !newChild) {\n    return this;\n  }\n  var editable = editableVNode(this, ownerID);\n  if (!removingFirst) {\n    for (var ii = 0; ii < originIndex; ii++) {\n      editable.array[ii] = undefined;\n    }\n  }\n  if (newChild) {\n    editable.array[originIndex] = newChild;\n  }\n  return editable;\n};\n\nVNode.prototype.removeAfter = function removeAfter (ownerID, level, index) {\n  if (index === (level ? 1 << level : 0) || this.array.length === 0) {\n    return this;\n  }\n  var sizeIndex = ((index - 1) >>> level) & MASK;\n  if (sizeIndex >= this.array.length) {\n    return this;\n  }\n\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[sizeIndex];\n    newChild =\n      oldChild && oldChild.removeAfter(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && sizeIndex === this.array.length - 1) {\n      return this;\n    }\n  }\n\n  var editable = editableVNode(this, ownerID);\n  editable.array.splice(sizeIndex + 1);\n  if (newChild) {\n    editable.array[sizeIndex] = newChild;\n  }\n  return editable;\n};\n\nvar DONE = {};\n\nfunction iterateList(list, reverse) {\n  var left = list._origin;\n  var right = list._capacity;\n  var tailPos = getTailOffset(right);\n  var tail = list._tail;\n\n  return iterateNodeOrLeaf(list._root, list._level, 0);\n\n  function iterateNodeOrLeaf(node, level, offset) {\n    return level === 0\n      ? iterateLeaf(node, offset)\n      : iterateNode(node, level, offset);\n  }\n\n  function iterateLeaf(node, offset) {\n    var array = offset === tailPos ? tail && tail.array : node && node.array;\n    var from = offset > left ? 0 : left - offset;\n    var to = right - offset;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      if (from === to) {\n        return DONE;\n      }\n      var idx = reverse ? --to : from++;\n      return array && array[idx];\n    };\n  }\n\n  function iterateNode(node, level, offset) {\n    var values;\n    var array = node && node.array;\n    var from = offset > left ? 0 : (left - offset) >> level;\n    var to = ((right - offset) >> level) + 1;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      while (true) {\n        if (values) {\n          var value = values();\n          if (value !== DONE) {\n            return value;\n          }\n          values = null;\n        }\n        if (from === to) {\n          return DONE;\n        }\n        var idx = reverse ? --to : from++;\n        values = iterateNodeOrLeaf(\n          array && array[idx],\n          level - SHIFT,\n          offset + (idx << level)\n        );\n      }\n    };\n  }\n}\n\nfunction makeList(origin, capacity, level, root, tail, ownerID, hash) {\n  var list = Object.create(ListPrototype);\n  list.size = capacity - origin;\n  list._origin = origin;\n  list._capacity = capacity;\n  list._level = level;\n  list._root = root;\n  list._tail = tail;\n  list.__ownerID = ownerID;\n  list.__hash = hash;\n  list.__altered = false;\n  return list;\n}\n\nvar EMPTY_LIST;\nfunction emptyList() {\n  return EMPTY_LIST || (EMPTY_LIST = makeList(0, 0, SHIFT));\n}\n\nfunction updateList(list, index, value) {\n  index = wrapIndex(list, index);\n\n  if (index !== index) {\n    return list;\n  }\n\n  if (index >= list.size || index < 0) {\n    return list.withMutations(function (list) {\n      index < 0\n        ? setListBounds(list, index).set(0, value)\n        : setListBounds(list, 0, index + 1).set(index, value);\n    });\n  }\n\n  index += list._origin;\n\n  var newTail = list._tail;\n  var newRoot = list._root;\n  var didAlter = MakeRef();\n  if (index >= getTailOffset(list._capacity)) {\n    newTail = updateVNode(newTail, list.__ownerID, 0, index, value, didAlter);\n  } else {\n    newRoot = updateVNode(\n      newRoot,\n      list.__ownerID,\n      list._level,\n      index,\n      value,\n      didAlter\n    );\n  }\n\n  if (!didAlter.value) {\n    return list;\n  }\n\n  if (list.__ownerID) {\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(list._origin, list._capacity, list._level, newRoot, newTail);\n}\n\nfunction updateVNode(node, ownerID, level, index, value, didAlter) {\n  var idx = (index >>> level) & MASK;\n  var nodeHas = node && idx < node.array.length;\n  if (!nodeHas && value === undefined) {\n    return node;\n  }\n\n  var newNode;\n\n  if (level > 0) {\n    var lowerNode = node && node.array[idx];\n    var newLowerNode = updateVNode(\n      lowerNode,\n      ownerID,\n      level - SHIFT,\n      index,\n      value,\n      didAlter\n    );\n    if (newLowerNode === lowerNode) {\n      return node;\n    }\n    newNode = editableVNode(node, ownerID);\n    newNode.array[idx] = newLowerNode;\n    return newNode;\n  }\n\n  if (nodeHas && node.array[idx] === value) {\n    return node;\n  }\n\n  if (didAlter) {\n    SetRef(didAlter);\n  }\n\n  newNode = editableVNode(node, ownerID);\n  if (value === undefined && idx === newNode.array.length - 1) {\n    newNode.array.pop();\n  } else {\n    newNode.array[idx] = value;\n  }\n  return newNode;\n}\n\nfunction editableVNode(node, ownerID) {\n  if (ownerID && node && ownerID === node.ownerID) {\n    return node;\n  }\n  return new VNode(node ? node.array.slice() : [], ownerID);\n}\n\nfunction listNodeFor(list, rawIndex) {\n  if (rawIndex >= getTailOffset(list._capacity)) {\n    return list._tail;\n  }\n  if (rawIndex < 1 << (list._level + SHIFT)) {\n    var node = list._root;\n    var level = list._level;\n    while (node && level > 0) {\n      node = node.array[(rawIndex >>> level) & MASK];\n      level -= SHIFT;\n    }\n    return node;\n  }\n}\n\nfunction setListBounds(list, begin, end) {\n  // Sanitize begin & end using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  if (begin !== undefined) {\n    begin |= 0;\n  }\n  if (end !== undefined) {\n    end |= 0;\n  }\n  var owner = list.__ownerID || new OwnerID();\n  var oldOrigin = list._origin;\n  var oldCapacity = list._capacity;\n  var newOrigin = oldOrigin + begin;\n  var newCapacity =\n    end === undefined\n      ? oldCapacity\n      : end < 0\n        ? oldCapacity + end\n        : oldOrigin + end;\n  if (newOrigin === oldOrigin && newCapacity === oldCapacity) {\n    return list;\n  }\n\n  // If it's going to end after it starts, it's empty.\n  if (newOrigin >= newCapacity) {\n    return list.clear();\n  }\n\n  var newLevel = list._level;\n  var newRoot = list._root;\n\n  // New origin might need creating a higher root.\n  var offsetShift = 0;\n  while (newOrigin + offsetShift < 0) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [undefined, newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n    offsetShift += 1 << newLevel;\n  }\n  if (offsetShift) {\n    newOrigin += offsetShift;\n    oldOrigin += offsetShift;\n    newCapacity += offsetShift;\n    oldCapacity += offsetShift;\n  }\n\n  var oldTailOffset = getTailOffset(oldCapacity);\n  var newTailOffset = getTailOffset(newCapacity);\n\n  // New size might need creating a higher root.\n  while (newTailOffset >= 1 << (newLevel + SHIFT)) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n  }\n\n  // Locate or create the new tail.\n  var oldTail = list._tail;\n  var newTail =\n    newTailOffset < oldTailOffset\n      ? listNodeFor(list, newCapacity - 1)\n      : newTailOffset > oldTailOffset\n        ? new VNode([], owner)\n        : oldTail;\n\n  // Merge Tail into tree.\n  if (\n    oldTail &&\n    newTailOffset > oldTailOffset &&\n    newOrigin < oldCapacity &&\n    oldTail.array.length\n  ) {\n    newRoot = editableVNode(newRoot, owner);\n    var node = newRoot;\n    for (var level = newLevel; level > SHIFT; level -= SHIFT) {\n      var idx = (oldTailOffset >>> level) & MASK;\n      node = node.array[idx] = editableVNode(node.array[idx], owner);\n    }\n    node.array[(oldTailOffset >>> SHIFT) & MASK] = oldTail;\n  }\n\n  // If the size has been reduced, there's a chance the tail needs to be trimmed.\n  if (newCapacity < oldCapacity) {\n    newTail = newTail && newTail.removeAfter(owner, 0, newCapacity);\n  }\n\n  // If the new origin is within the tail, then we do not need a root.\n  if (newOrigin >= newTailOffset) {\n    newOrigin -= newTailOffset;\n    newCapacity -= newTailOffset;\n    newLevel = SHIFT;\n    newRoot = null;\n    newTail = newTail && newTail.removeBefore(owner, 0, newOrigin);\n\n    // Otherwise, if the root has been trimmed, garbage collect.\n  } else if (newOrigin > oldOrigin || newTailOffset < oldTailOffset) {\n    offsetShift = 0;\n\n    // Identify the new top root node of the subtree of the old root.\n    while (newRoot) {\n      var beginIndex = (newOrigin >>> newLevel) & MASK;\n      if ((beginIndex !== newTailOffset >>> newLevel) & MASK) {\n        break;\n      }\n      if (beginIndex) {\n        offsetShift += (1 << newLevel) * beginIndex;\n      }\n      newLevel -= SHIFT;\n      newRoot = newRoot.array[beginIndex];\n    }\n\n    // Trim the new sides of the new root.\n    if (newRoot && newOrigin > oldOrigin) {\n      newRoot = newRoot.removeBefore(owner, newLevel, newOrigin - offsetShift);\n    }\n    if (newRoot && newTailOffset < oldTailOffset) {\n      newRoot = newRoot.removeAfter(\n        owner,\n        newLevel,\n        newTailOffset - offsetShift\n      );\n    }\n    if (offsetShift) {\n      newOrigin -= offsetShift;\n      newCapacity -= offsetShift;\n    }\n  }\n\n  if (list.__ownerID) {\n    list.size = newCapacity - newOrigin;\n    list._origin = newOrigin;\n    list._capacity = newCapacity;\n    list._level = newLevel;\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(newOrigin, newCapacity, newLevel, newRoot, newTail);\n}\n\nfunction getTailOffset(size) {\n  return size < SIZE ? 0 : ((size - 1) >>> SHIFT) << SHIFT;\n}\n\nvar OrderedMap = /*@__PURE__*/(function (Map$$1) {\n  function OrderedMap(value) {\n    return value === null || value === undefined\n      ? emptyOrderedMap()\n      : isOrderedMap(value)\n        ? value\n        : emptyOrderedMap().withMutations(function (map) {\n            var iter = KeyedCollection(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v, k) { return map.set(k, v); });\n          });\n  }\n\n  if ( Map$$1 ) OrderedMap.__proto__ = Map$$1;\n  OrderedMap.prototype = Object.create( Map$$1 && Map$$1.prototype );\n  OrderedMap.prototype.constructor = OrderedMap;\n\n  OrderedMap.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedMap.prototype.toString = function toString () {\n    return this.__toString('OrderedMap {', '}');\n  };\n\n  // @pragma Access\n\n  OrderedMap.prototype.get = function get (k, notSetValue) {\n    var index = this._map.get(k);\n    return index !== undefined ? this._list.get(index)[1] : notSetValue;\n  };\n\n  // @pragma Modification\n\n  OrderedMap.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._map.clear();\n      this._list.clear();\n      return this;\n    }\n    return emptyOrderedMap();\n  };\n\n  OrderedMap.prototype.set = function set (k, v) {\n    return updateOrderedMap(this, k, v);\n  };\n\n  OrderedMap.prototype.remove = function remove (k) {\n    return updateOrderedMap(this, k, NOT_SET);\n  };\n\n  OrderedMap.prototype.wasAltered = function wasAltered () {\n    return this._map.wasAltered() || this._list.wasAltered();\n  };\n\n  OrderedMap.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._list.__iterate(\n      function (entry) { return entry && fn(entry[1], entry[0], this$1); },\n      reverse\n    );\n  };\n\n  OrderedMap.prototype.__iterator = function __iterator (type, reverse) {\n    return this._list.fromEntrySeq().__iterator(type, reverse);\n  };\n\n  OrderedMap.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    var newList = this._list.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyOrderedMap();\n      }\n      this.__ownerID = ownerID;\n      this._map = newMap;\n      this._list = newList;\n      return this;\n    }\n    return makeOrderedMap(newMap, newList, ownerID, this.__hash);\n  };\n\n  return OrderedMap;\n}(Map));\n\nOrderedMap.isOrderedMap = isOrderedMap;\n\nOrderedMap.prototype[IS_ORDERED_SYMBOL] = true;\nOrderedMap.prototype[DELETE] = OrderedMap.prototype.remove;\n\nfunction makeOrderedMap(map, list, ownerID, hash) {\n  var omap = Object.create(OrderedMap.prototype);\n  omap.size = map ? map.size : 0;\n  omap._map = map;\n  omap._list = list;\n  omap.__ownerID = ownerID;\n  omap.__hash = hash;\n  return omap;\n}\n\nvar EMPTY_ORDERED_MAP;\nfunction emptyOrderedMap() {\n  return (\n    EMPTY_ORDERED_MAP ||\n    (EMPTY_ORDERED_MAP = makeOrderedMap(emptyMap(), emptyList()))\n  );\n}\n\nfunction updateOrderedMap(omap, k, v) {\n  var map = omap._map;\n  var list = omap._list;\n  var i = map.get(k);\n  var has = i !== undefined;\n  var newMap;\n  var newList;\n  if (v === NOT_SET) {\n    // removed\n    if (!has) {\n      return omap;\n    }\n    if (list.size >= SIZE && list.size >= map.size * 2) {\n      newList = list.filter(function (entry, idx) { return entry !== undefined && i !== idx; });\n      newMap = newList\n        .toKeyedSeq()\n        .map(function (entry) { return entry[0]; })\n        .flip()\n        .toMap();\n      if (omap.__ownerID) {\n        newMap.__ownerID = newList.__ownerID = omap.__ownerID;\n      }\n    } else {\n      newMap = map.remove(k);\n      newList = i === list.size - 1 ? list.pop() : list.set(i, undefined);\n    }\n  } else if (has) {\n    if (v === list.get(i)[1]) {\n      return omap;\n    }\n    newMap = map;\n    newList = list.set(i, [k, v]);\n  } else {\n    newMap = map.set(k, list.size);\n    newList = list.set(list.size, [k, v]);\n  }\n  if (omap.__ownerID) {\n    omap.size = newMap.size;\n    omap._map = newMap;\n    omap._list = newList;\n    omap.__hash = undefined;\n    return omap;\n  }\n  return makeOrderedMap(newMap, newList);\n}\n\nvar IS_STACK_SYMBOL = '@@__IMMUTABLE_STACK__@@';\n\nfunction isStack(maybeStack) {\n  return Boolean(maybeStack && maybeStack[IS_STACK_SYMBOL]);\n}\n\nvar Stack = /*@__PURE__*/(function (IndexedCollection$$1) {\n  function Stack(value) {\n    return value === null || value === undefined\n      ? emptyStack()\n      : isStack(value)\n        ? value\n        : emptyStack().pushAll(value);\n  }\n\n  if ( IndexedCollection$$1 ) Stack.__proto__ = IndexedCollection$$1;\n  Stack.prototype = Object.create( IndexedCollection$$1 && IndexedCollection$$1.prototype );\n  Stack.prototype.constructor = Stack;\n\n  Stack.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Stack.prototype.toString = function toString () {\n    return this.__toString('Stack [', ']');\n  };\n\n  // @pragma Access\n\n  Stack.prototype.get = function get (index, notSetValue) {\n    var head = this._head;\n    index = wrapIndex(this, index);\n    while (head && index--) {\n      head = head.next;\n    }\n    return head ? head.value : notSetValue;\n  };\n\n  Stack.prototype.peek = function peek () {\n    return this._head && this._head.value;\n  };\n\n  // @pragma Modification\n\n  Stack.prototype.push = function push (/*...values*/) {\n    var arguments$1 = arguments;\n\n    if (arguments.length === 0) {\n      return this;\n    }\n    var newSize = this.size + arguments.length;\n    var head = this._head;\n    for (var ii = arguments.length - 1; ii >= 0; ii--) {\n      head = {\n        value: arguments$1[ii],\n        next: head,\n      };\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pushAll = function pushAll (iter) {\n    iter = IndexedCollection$$1(iter);\n    if (iter.size === 0) {\n      return this;\n    }\n    if (this.size === 0 && isStack(iter)) {\n      return iter;\n    }\n    assertNotInfinite(iter.size);\n    var newSize = this.size;\n    var head = this._head;\n    iter.__iterate(function (value) {\n      newSize++;\n      head = {\n        value: value,\n        next: head,\n      };\n    }, /* reverse */ true);\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pop = function pop () {\n    return this.slice(1);\n  };\n\n  Stack.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._head = undefined;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyStack();\n  };\n\n  Stack.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    var resolvedBegin = resolveBegin(begin, this.size);\n    var resolvedEnd = resolveEnd(end, this.size);\n    if (resolvedEnd !== this.size) {\n      // super.slice(begin, end);\n      return IndexedCollection$$1.prototype.slice.call(this, begin, end);\n    }\n    var newSize = this.size - resolvedBegin;\n    var head = this._head;\n    while (resolvedBegin--) {\n      head = head.next;\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  // @pragma Mutability\n\n  Stack.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyStack();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeStack(this.size, this._head, ownerID, this.__hash);\n  };\n\n  // @pragma Iteration\n\n  Stack.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterate(\n        function (v, k) { return fn(v, k, this$1); },\n        reverse\n      );\n    }\n    var iterations = 0;\n    var node = this._head;\n    while (node) {\n      if (fn(node.value, iterations++, this) === false) {\n        break;\n      }\n      node = node.next;\n    }\n    return iterations;\n  };\n\n  Stack.prototype.__iterator = function __iterator (type, reverse) {\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterator(type, reverse);\n    }\n    var iterations = 0;\n    var node = this._head;\n    return new Iterator(function () {\n      if (node) {\n        var value = node.value;\n        node = node.next;\n        return iteratorValue(type, iterations++, value);\n      }\n      return iteratorDone();\n    });\n  };\n\n  return Stack;\n}(IndexedCollection));\n\nStack.isStack = isStack;\n\nvar StackPrototype = Stack.prototype;\nStackPrototype[IS_STACK_SYMBOL] = true;\nStackPrototype.shift = StackPrototype.pop;\nStackPrototype.unshift = StackPrototype.push;\nStackPrototype.unshiftAll = StackPrototype.pushAll;\nStackPrototype.withMutations = withMutations;\nStackPrototype.wasAltered = wasAltered;\nStackPrototype.asImmutable = asImmutable;\nStackPrototype['@@transducer/init'] = StackPrototype.asMutable = asMutable;\nStackPrototype['@@transducer/step'] = function(result, arr) {\n  return result.unshift(arr);\n};\nStackPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nfunction makeStack(size, head, ownerID, hash) {\n  var map = Object.create(StackPrototype);\n  map.size = size;\n  map._head = head;\n  map.__ownerID = ownerID;\n  map.__hash = hash;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_STACK;\nfunction emptyStack() {\n  return EMPTY_STACK || (EMPTY_STACK = makeStack(0));\n}\n\nvar IS_SET_SYMBOL = '@@__IMMUTABLE_SET__@@';\n\nfunction isSet(maybeSet) {\n  return Boolean(maybeSet && maybeSet[IS_SET_SYMBOL]);\n}\n\nfunction isOrderedSet(maybeOrderedSet) {\n  return isSet(maybeOrderedSet) && isOrdered(maybeOrderedSet);\n}\n\nfunction deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (\n    !isCollection(b) ||\n    (a.size !== undefined && b.size !== undefined && a.size !== b.size) ||\n    (a.__hash !== undefined &&\n      b.__hash !== undefined &&\n      a.__hash !== b.__hash) ||\n    isKeyed(a) !== isKeyed(b) ||\n    isIndexed(a) !== isIndexed(b) ||\n    isOrdered(a) !== isOrdered(b)\n  ) {\n    return false;\n  }\n\n  if (a.size === 0 && b.size === 0) {\n    return true;\n  }\n\n  var notAssociative = !isAssociative(a);\n\n  if (isOrdered(a)) {\n    var entries = a.entries();\n    return (\n      b.every(function (v, k) {\n        var entry = entries.next().value;\n        return entry && is(entry[1], v) && (notAssociative || is(entry[0], k));\n      }) && entries.next().done\n    );\n  }\n\n  var flipped = false;\n\n  if (a.size === undefined) {\n    if (b.size === undefined) {\n      if (typeof a.cacheResult === 'function') {\n        a.cacheResult();\n      }\n    } else {\n      flipped = true;\n      var _ = a;\n      a = b;\n      b = _;\n    }\n  }\n\n  var allEqual = true;\n  var bSize = b.__iterate(function (v, k) {\n    if (\n      notAssociative\n        ? !a.has(v)\n        : flipped\n          ? !is(v, a.get(k, NOT_SET))\n          : !is(a.get(k, NOT_SET), v)\n    ) {\n      allEqual = false;\n      return false;\n    }\n  });\n\n  return allEqual && a.size === bSize;\n}\n\n/**\n * Contributes additional methods to a constructor\n */\nfunction mixin(ctor, methods) {\n  var keyCopier = function (key) {\n    ctor.prototype[key] = methods[key];\n  };\n  Object.keys(methods).forEach(keyCopier);\n  Object.getOwnPropertySymbols &&\n    Object.getOwnPropertySymbols(methods).forEach(keyCopier);\n  return ctor;\n}\n\nfunction toJS(value) {\n  if (!value || typeof value !== 'object') {\n    return value;\n  }\n  if (!isCollection(value)) {\n    if (!isDataStructure(value)) {\n      return value;\n    }\n    value = Seq(value);\n  }\n  if (isKeyed(value)) {\n    var result$1 = {};\n    value.__iterate(function (v, k) {\n      result$1[k] = toJS(v);\n    });\n    return result$1;\n  }\n  var result = [];\n  value.__iterate(function (v) {\n    result.push(toJS(v));\n  });\n  return result;\n}\n\nvar Set = /*@__PURE__*/(function (SetCollection$$1) {\n  function Set(value) {\n    return value === null || value === undefined\n      ? emptySet()\n      : isSet(value) && !isOrdered(value)\n        ? value\n        : emptySet().withMutations(function (set) {\n            var iter = SetCollection$$1(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v) { return set.add(v); });\n          });\n  }\n\n  if ( SetCollection$$1 ) Set.__proto__ = SetCollection$$1;\n  Set.prototype = Object.create( SetCollection$$1 && SetCollection$$1.prototype );\n  Set.prototype.constructor = Set;\n\n  Set.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Set.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  Set.intersect = function intersect (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.intersect.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.union = function union (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.union.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.prototype.toString = function toString () {\n    return this.__toString('Set {', '}');\n  };\n\n  // @pragma Access\n\n  Set.prototype.has = function has (value) {\n    return this._map.has(value);\n  };\n\n  // @pragma Modification\n\n  Set.prototype.add = function add (value) {\n    return updateSet(this, this._map.set(value, value));\n  };\n\n  Set.prototype.remove = function remove (value) {\n    return updateSet(this, this._map.remove(value));\n  };\n\n  Set.prototype.clear = function clear () {\n    return updateSet(this, this._map.clear());\n  };\n\n  // @pragma Composition\n\n  Set.prototype.map = function map (mapper, context) {\n    var this$1 = this;\n\n    var removes = [];\n    var adds = [];\n    this.forEach(function (value) {\n      var mapped = mapper.call(context, value, value, this$1);\n      if (mapped !== value) {\n        removes.push(value);\n        adds.push(mapped);\n      }\n    });\n    return this.withMutations(function (set) {\n      removes.forEach(function (value) { return set.remove(value); });\n      adds.forEach(function (value) { return set.add(value); });\n    });\n  };\n\n  Set.prototype.union = function union () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    iters = iters.filter(function (x) { return x.size !== 0; });\n    if (iters.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && iters.length === 1) {\n      return this.constructor(iters[0]);\n    }\n    return this.withMutations(function (set) {\n      for (var ii = 0; ii < iters.length; ii++) {\n        SetCollection$$1(iters[ii]).forEach(function (value) { return set.add(value); });\n      }\n    });\n  };\n\n  Set.prototype.intersect = function intersect () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection$$1(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (!iters.every(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.subtract = function subtract () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection$$1(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (iters.some(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator));\n  };\n\n  Set.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator, mapper));\n  };\n\n  Set.prototype.wasAltered = function wasAltered () {\n    return this._map.wasAltered();\n  };\n\n  Set.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1 = this;\n\n    return this._map.__iterate(function (k) { return fn(k, k, this$1); }, reverse);\n  };\n\n  Set.prototype.__iterator = function __iterator (type, reverse) {\n    return this._map.__iterator(type, reverse);\n  };\n\n  Set.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return this.__empty();\n      }\n      this.__ownerID = ownerID;\n      this._map = newMap;\n      return this;\n    }\n    return this.__make(newMap, ownerID);\n  };\n\n  return Set;\n}(SetCollection));\n\nSet.isSet = isSet;\n\nvar SetPrototype = Set.prototype;\nSetPrototype[IS_SET_SYMBOL] = true;\nSetPrototype[DELETE] = SetPrototype.remove;\nSetPrototype.merge = SetPrototype.concat = SetPrototype.union;\nSetPrototype.withMutations = withMutations;\nSetPrototype.asImmutable = asImmutable;\nSetPrototype['@@transducer/init'] = SetPrototype.asMutable = asMutable;\nSetPrototype['@@transducer/step'] = function(result, arr) {\n  return result.add(arr);\n};\nSetPrototype['@@transducer/result'] = function(obj) {\n  return obj.asImmutable();\n};\n\nSetPrototype.__empty = emptySet;\nSetPrototype.__make = makeSet;\n\nfunction updateSet(set, newMap) {\n  if (set.__ownerID) {\n    set.size = newMap.size;\n    set._map = newMap;\n    return set;\n  }\n  return newMap === set._map\n    ? set\n    : newMap.size === 0\n      ? set.__empty()\n      : set.__make(newMap);\n}\n\nfunction makeSet(map, ownerID) {\n  var set = Object.create(SetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_SET;\nfunction emptySet() {\n  return EMPTY_SET || (EMPTY_SET = makeSet(emptyMap()));\n}\n\n/**\n * Returns a lazy seq of nums from start (inclusive) to end\n * (exclusive), by step, where start defaults to 0, step to 1, and end to\n * infinity. When start is equal to end, returns empty list.\n */\nvar Range = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function Range(start, end, step) {\n    if (!(this instanceof Range)) {\n      return new Range(start, end, step);\n    }\n    invariant(step !== 0, 'Cannot step a Range by 0');\n    start = start || 0;\n    if (end === undefined) {\n      end = Infinity;\n    }\n    step = step === undefined ? 1 : Math.abs(step);\n    if (end < start) {\n      step = -step;\n    }\n    this._start = start;\n    this._end = end;\n    this._step = step;\n    this.size = Math.max(0, Math.ceil((end - start) / step - 1) + 1);\n    if (this.size === 0) {\n      if (EMPTY_RANGE) {\n        return EMPTY_RANGE;\n      }\n      EMPTY_RANGE = this;\n    }\n  }\n\n  if ( IndexedSeq$$1 ) Range.__proto__ = IndexedSeq$$1;\n  Range.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  Range.prototype.constructor = Range;\n\n  Range.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Range []';\n    }\n    return (\n      'Range [ ' +\n      this._start +\n      '...' +\n      this._end +\n      (this._step !== 1 ? ' by ' + this._step : '') +\n      ' ]'\n    );\n  };\n\n  Range.prototype.get = function get (index, notSetValue) {\n    return this.has(index)\n      ? this._start + wrapIndex(this, index) * this._step\n      : notSetValue;\n  };\n\n  Range.prototype.includes = function includes (searchValue) {\n    var possibleIndex = (searchValue - this._start) / this._step;\n    return (\n      possibleIndex >= 0 &&\n      possibleIndex < this.size &&\n      possibleIndex === Math.floor(possibleIndex)\n    );\n  };\n\n  Range.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    begin = resolveBegin(begin, this.size);\n    end = resolveEnd(end, this.size);\n    if (end <= begin) {\n      return new Range(0, 0);\n    }\n    return new Range(\n      this.get(begin, this._end),\n      this.get(end, this._end),\n      this._step\n    );\n  };\n\n  Range.prototype.indexOf = function indexOf (searchValue) {\n    var offsetValue = searchValue - this._start;\n    if (offsetValue % this._step === 0) {\n      var index = offsetValue / this._step;\n      if (index >= 0 && index < this.size) {\n        return index;\n      }\n    }\n    return -1;\n  };\n\n  Range.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    return this.indexOf(searchValue);\n  };\n\n  Range.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    while (i !== size) {\n      if (fn(value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n      value += reverse ? -step : step;\n    }\n    return i;\n  };\n\n  Range.prototype.__iterator = function __iterator (type, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var v = value;\n      value += reverse ? -step : step;\n      return iteratorValue(type, reverse ? size - ++i : i++, v);\n    });\n  };\n\n  Range.prototype.equals = function equals (other) {\n    return other instanceof Range\n      ? this._start === other._start &&\n          this._end === other._end &&\n          this._step === other._step\n      : deepEqual(this, other);\n  };\n\n  return Range;\n}(IndexedSeq));\n\nvar EMPTY_RANGE;\n\nfunction getIn(collection, searchKeyPath, notSetValue) {\n  var keyPath = coerceKeyPath(searchKeyPath);\n  var i = 0;\n  while (i !== keyPath.length) {\n    collection = get(collection, keyPath[i++], NOT_SET);\n    if (collection === NOT_SET) {\n      return notSetValue;\n    }\n  }\n  return collection;\n}\n\nfunction getIn$1(searchKeyPath, notSetValue) {\n  return getIn(this, searchKeyPath, notSetValue);\n}\n\nfunction hasIn(collection, keyPath) {\n  return getIn(collection, keyPath, NOT_SET) !== NOT_SET;\n}\n\nfunction hasIn$1(searchKeyPath) {\n  return hasIn(this, searchKeyPath);\n}\n\nfunction toObject() {\n  assertNotInfinite(this.size);\n  var object = {};\n  this.__iterate(function (v, k) {\n    object[k] = v;\n  });\n  return object;\n}\n\n// Note: all of these methods are deprecated.\nCollection.isIterable = isCollection;\nCollection.isKeyed = isKeyed;\nCollection.isIndexed = isIndexed;\nCollection.isAssociative = isAssociative;\nCollection.isOrdered = isOrdered;\n\nCollection.Iterator = Iterator;\n\nmixin(Collection, {\n  // ### Conversion to other types\n\n  toArray: function toArray() {\n    assertNotInfinite(this.size);\n    var array = new Array(this.size || 0);\n    var useTuples = isKeyed(this);\n    var i = 0;\n    this.__iterate(function (v, k) {\n      // Keyed collections produce an array of tuples.\n      array[i++] = useTuples ? [k, v] : v;\n    });\n    return array;\n  },\n\n  toIndexedSeq: function toIndexedSeq() {\n    return new ToIndexedSequence(this);\n  },\n\n  toJS: function toJS$1() {\n    return toJS(this);\n  },\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, true);\n  },\n\n  toMap: function toMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return Map(this.toKeyedSeq());\n  },\n\n  toObject: toObject,\n\n  toOrderedMap: function toOrderedMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedMap(this.toKeyedSeq());\n  },\n\n  toOrderedSet: function toOrderedSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedSet(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSet: function toSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return Set(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSetSeq: function toSetSeq() {\n    return new ToSetSequence(this);\n  },\n\n  toSeq: function toSeq() {\n    return isIndexed(this)\n      ? this.toIndexedSeq()\n      : isKeyed(this)\n        ? this.toKeyedSeq()\n        : this.toSetSeq();\n  },\n\n  toStack: function toStack() {\n    // Use Late Binding here to solve the circular dependency.\n    return Stack(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toList: function toList() {\n    // Use Late Binding here to solve the circular dependency.\n    return List(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  // ### Common JavaScript methods and properties\n\n  toString: function toString() {\n    return '[Collection]';\n  },\n\n  __toString: function __toString(head, tail) {\n    if (this.size === 0) {\n      return head + tail;\n    }\n    return (\n      head +\n      ' ' +\n      this.toSeq()\n        .map(this.__toStringMapper)\n        .join(', ') +\n      ' ' +\n      tail\n    );\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  concat: function concat() {\n    var values = [], len = arguments.length;\n    while ( len-- ) values[ len ] = arguments[ len ];\n\n    return reify(this, concatFactory(this, values));\n  },\n\n  includes: function includes(searchValue) {\n    return this.some(function (value) { return is(value, searchValue); });\n  },\n\n  entries: function entries() {\n    return this.__iterator(ITERATE_ENTRIES);\n  },\n\n  every: function every(predicate, context) {\n    assertNotInfinite(this.size);\n    var returnValue = true;\n    this.__iterate(function (v, k, c) {\n      if (!predicate.call(context, v, k, c)) {\n        returnValue = false;\n        return false;\n      }\n    });\n    return returnValue;\n  },\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, true));\n  },\n\n  find: function find(predicate, context, notSetValue) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[1] : notSetValue;\n  },\n\n  forEach: function forEach(sideEffect, context) {\n    assertNotInfinite(this.size);\n    return this.__iterate(context ? sideEffect.bind(context) : sideEffect);\n  },\n\n  join: function join(separator) {\n    assertNotInfinite(this.size);\n    separator = separator !== undefined ? '' + separator : ',';\n    var joined = '';\n    var isFirst = true;\n    this.__iterate(function (v) {\n      isFirst ? (isFirst = false) : (joined += separator);\n      joined += v !== null && v !== undefined ? v.toString() : '';\n    });\n    return joined;\n  },\n\n  keys: function keys() {\n    return this.__iterator(ITERATE_KEYS);\n  },\n\n  map: function map(mapper, context) {\n    return reify(this, mapFactory(this, mapper, context));\n  },\n\n  reduce: function reduce$1(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      false\n    );\n  },\n\n  reduceRight: function reduceRight(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      true\n    );\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, true));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, true));\n  },\n\n  some: function some(predicate, context) {\n    return !this.every(not(predicate), context);\n  },\n\n  sort: function sort(comparator) {\n    return reify(this, sortFactory(this, comparator));\n  },\n\n  values: function values() {\n    return this.__iterator(ITERATE_VALUES);\n  },\n\n  // ### More sequential methods\n\n  butLast: function butLast() {\n    return this.slice(0, -1);\n  },\n\n  isEmpty: function isEmpty() {\n    return this.size !== undefined ? this.size === 0 : !this.some(function () { return true; });\n  },\n\n  count: function count(predicate, context) {\n    return ensureSize(\n      predicate ? this.toSeq().filter(predicate, context) : this\n    );\n  },\n\n  countBy: function countBy(grouper, context) {\n    return countByFactory(this, grouper, context);\n  },\n\n  equals: function equals(other) {\n    return deepEqual(this, other);\n  },\n\n  entrySeq: function entrySeq() {\n    var collection = this;\n    if (collection._cache) {\n      // We cache as an entries array, so we can just return the cache!\n      return new ArraySeq(collection._cache);\n    }\n    var entriesSequence = collection\n      .toSeq()\n      .map(entryMapper)\n      .toIndexedSeq();\n    entriesSequence.fromEntrySeq = function () { return collection.toSeq(); };\n    return entriesSequence;\n  },\n\n  filterNot: function filterNot(predicate, context) {\n    return this.filter(not(predicate), context);\n  },\n\n  findEntry: function findEntry(predicate, context, notSetValue) {\n    var found = notSetValue;\n    this.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        found = [k, v];\n        return false;\n      }\n    });\n    return found;\n  },\n\n  findKey: function findKey(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry && entry[0];\n  },\n\n  findLast: function findLast(predicate, context, notSetValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .find(predicate, context, notSetValue);\n  },\n\n  findLastEntry: function findLastEntry(predicate, context, notSetValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .findEntry(predicate, context, notSetValue);\n  },\n\n  findLastKey: function findLastKey(predicate, context) {\n    return this.toKeyedSeq()\n      .reverse()\n      .findKey(predicate, context);\n  },\n\n  first: function first(notSetValue) {\n    return this.find(returnTrue, null, notSetValue);\n  },\n\n  flatMap: function flatMap(mapper, context) {\n    return reify(this, flatMapFactory(this, mapper, context));\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, true));\n  },\n\n  fromEntrySeq: function fromEntrySeq() {\n    return new FromEntriesSequence(this);\n  },\n\n  get: function get(searchKey, notSetValue) {\n    return this.find(function (_, key) { return is(key, searchKey); }, undefined, notSetValue);\n  },\n\n  getIn: getIn$1,\n\n  groupBy: function groupBy(grouper, context) {\n    return groupByFactory(this, grouper, context);\n  },\n\n  has: function has(searchKey) {\n    return this.get(searchKey, NOT_SET) !== NOT_SET;\n  },\n\n  hasIn: hasIn$1,\n\n  isSubset: function isSubset(iter) {\n    iter = typeof iter.includes === 'function' ? iter : Collection(iter);\n    return this.every(function (value) { return iter.includes(value); });\n  },\n\n  isSuperset: function isSuperset(iter) {\n    iter = typeof iter.isSubset === 'function' ? iter : Collection(iter);\n    return iter.isSubset(this);\n  },\n\n  keyOf: function keyOf(searchValue) {\n    return this.findKey(function (value) { return is(value, searchValue); });\n  },\n\n  keySeq: function keySeq() {\n    return this.toSeq()\n      .map(keyMapper)\n      .toIndexedSeq();\n  },\n\n  last: function last(notSetValue) {\n    return this.toSeq()\n      .reverse()\n      .first(notSetValue);\n  },\n\n  lastKeyOf: function lastKeyOf(searchValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .keyOf(searchValue);\n  },\n\n  max: function max(comparator) {\n    return maxFactory(this, comparator);\n  },\n\n  maxBy: function maxBy(mapper, comparator) {\n    return maxFactory(this, comparator, mapper);\n  },\n\n  min: function min(comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator\n    );\n  },\n\n  minBy: function minBy(mapper, comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator,\n      mapper\n    );\n  },\n\n  rest: function rest() {\n    return this.slice(1);\n  },\n\n  skip: function skip(amount) {\n    return amount === 0 ? this : this.slice(Math.max(0, amount));\n  },\n\n  skipLast: function skipLast(amount) {\n    return amount === 0 ? this : this.slice(0, -Math.max(0, amount));\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, true));\n  },\n\n  skipUntil: function skipUntil(predicate, context) {\n    return this.skipWhile(not(predicate), context);\n  },\n\n  sortBy: function sortBy(mapper, comparator) {\n    return reify(this, sortFactory(this, comparator, mapper));\n  },\n\n  take: function take(amount) {\n    return this.slice(0, Math.max(0, amount));\n  },\n\n  takeLast: function takeLast(amount) {\n    return this.slice(-Math.max(0, amount));\n  },\n\n  takeWhile: function takeWhile(predicate, context) {\n    return reify(this, takeWhileFactory(this, predicate, context));\n  },\n\n  takeUntil: function takeUntil(predicate, context) {\n    return this.takeWhile(not(predicate), context);\n  },\n\n  update: function update(fn) {\n    return fn(this);\n  },\n\n  valueSeq: function valueSeq() {\n    return this.toIndexedSeq();\n  },\n\n  // ### Hashable Object\n\n  hashCode: function hashCode() {\n    return this.__hash || (this.__hash = hashCollection(this));\n  },\n\n  // ### Internal\n\n  // abstract __iterate(fn, reverse)\n\n  // abstract __iterator(type, reverse)\n});\n\nvar CollectionPrototype = Collection.prototype;\nCollectionPrototype[IS_COLLECTION_SYMBOL] = true;\nCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.values;\nCollectionPrototype.toJSON = CollectionPrototype.toArray;\nCollectionPrototype.__toStringMapper = quoteString;\nCollectionPrototype.inspect = CollectionPrototype.toSource = function() {\n  return this.toString();\n};\nCollectionPrototype.chain = CollectionPrototype.flatMap;\nCollectionPrototype.contains = CollectionPrototype.includes;\n\nmixin(KeyedCollection, {\n  // ### More sequential methods\n\n  flip: function flip() {\n    return reify(this, flipFactory(this));\n  },\n\n  mapEntries: function mapEntries(mapper, context) {\n    var this$1 = this;\n\n    var iterations = 0;\n    return reify(\n      this,\n      this.toSeq()\n        .map(function (v, k) { return mapper.call(context, [k, v], iterations++, this$1); })\n        .fromEntrySeq()\n    );\n  },\n\n  mapKeys: function mapKeys(mapper, context) {\n    var this$1 = this;\n\n    return reify(\n      this,\n      this.toSeq()\n        .flip()\n        .map(function (k, v) { return mapper.call(context, k, v, this$1); })\n        .flip()\n    );\n  },\n});\n\nvar KeyedCollectionPrototype = KeyedCollection.prototype;\nKeyedCollectionPrototype[IS_KEYED_SYMBOL] = true;\nKeyedCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.entries;\nKeyedCollectionPrototype.toJSON = toObject;\nKeyedCollectionPrototype.__toStringMapper = function (v, k) { return quoteString(k) + ': ' + quoteString(v); };\n\nmixin(IndexedCollection, {\n  // ### Conversion to other types\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, false);\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, false));\n  },\n\n  findIndex: function findIndex(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  indexOf: function indexOf(searchValue) {\n    var key = this.keyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  lastIndexOf: function lastIndexOf(searchValue) {\n    var key = this.lastKeyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, false));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, false));\n  },\n\n  splice: function splice(index, removeNum /*, ...values*/) {\n    var numArgs = arguments.length;\n    removeNum = Math.max(removeNum || 0, 0);\n    if (numArgs === 0 || (numArgs === 2 && !removeNum)) {\n      return this;\n    }\n    // If index is negative, it should resolve relative to the size of the\n    // collection. However size may be expensive to compute if not cached, so\n    // only call count() if the number is in fact negative.\n    index = resolveBegin(index, index < 0 ? this.count() : this.size);\n    var spliced = this.slice(0, index);\n    return reify(\n      this,\n      numArgs === 1\n        ? spliced\n        : spliced.concat(arrCopy(arguments, 2), this.slice(index + removeNum))\n    );\n  },\n\n  // ### More collection methods\n\n  findLastIndex: function findLastIndex(predicate, context) {\n    var entry = this.findLastEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  first: function first(notSetValue) {\n    return this.get(0, notSetValue);\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, false));\n  },\n\n  get: function get(index, notSetValue) {\n    index = wrapIndex(this, index);\n    return index < 0 ||\n      (this.size === Infinity || (this.size !== undefined && index > this.size))\n      ? notSetValue\n      : this.find(function (_, key) { return key === index; }, undefined, notSetValue);\n  },\n\n  has: function has(index) {\n    index = wrapIndex(this, index);\n    return (\n      index >= 0 &&\n      (this.size !== undefined\n        ? this.size === Infinity || index < this.size\n        : this.indexOf(index) !== -1)\n    );\n  },\n\n  interpose: function interpose(separator) {\n    return reify(this, interposeFactory(this, separator));\n  },\n\n  interleave: function interleave(/*...collections*/) {\n    var collections = [this].concat(arrCopy(arguments));\n    var zipped = zipWithFactory(this.toSeq(), IndexedSeq.of, collections);\n    var interleaved = zipped.flatten(true);\n    if (zipped.size) {\n      interleaved.size = zipped.size * collections.length;\n    }\n    return reify(this, interleaved);\n  },\n\n  keySeq: function keySeq() {\n    return Range(0, this.size);\n  },\n\n  last: function last(notSetValue) {\n    return this.get(-1, notSetValue);\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, false));\n  },\n\n  zip: function zip(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections));\n  },\n\n  zipAll: function zipAll(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections, true));\n  },\n\n  zipWith: function zipWith(zipper /*, ...collections */) {\n    var collections = arrCopy(arguments);\n    collections[0] = this;\n    return reify(this, zipWithFactory(this, zipper, collections));\n  },\n});\n\nvar IndexedCollectionPrototype = IndexedCollection.prototype;\nIndexedCollectionPrototype[IS_INDEXED_SYMBOL] = true;\nIndexedCollectionPrototype[IS_ORDERED_SYMBOL] = true;\n\nmixin(SetCollection, {\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  get: function get(value, notSetValue) {\n    return this.has(value) ? value : notSetValue;\n  },\n\n  includes: function includes(value) {\n    return this.has(value);\n  },\n\n  // ### More sequential methods\n\n  keySeq: function keySeq() {\n    return this.valueSeq();\n  },\n});\n\nSetCollection.prototype.has = CollectionPrototype.includes;\nSetCollection.prototype.contains = SetCollection.prototype.includes;\n\n// Mixin subclasses\n\nmixin(KeyedSeq, KeyedCollection.prototype);\nmixin(IndexedSeq, IndexedCollection.prototype);\nmixin(SetSeq, SetCollection.prototype);\n\n// #pragma Helper functions\n\nfunction reduce(collection, reducer, reduction, context, useFirst, reverse) {\n  assertNotInfinite(collection.size);\n  collection.__iterate(function (v, k, c) {\n    if (useFirst) {\n      useFirst = false;\n      reduction = v;\n    } else {\n      reduction = reducer.call(context, reduction, v, k, c);\n    }\n  }, reverse);\n  return reduction;\n}\n\nfunction keyMapper(v, k) {\n  return k;\n}\n\nfunction entryMapper(v, k) {\n  return [k, v];\n}\n\nfunction not(predicate) {\n  return function() {\n    return !predicate.apply(this, arguments);\n  };\n}\n\nfunction neg(predicate) {\n  return function() {\n    return -predicate.apply(this, arguments);\n  };\n}\n\nfunction defaultZipper() {\n  return arrCopy(arguments);\n}\n\nfunction defaultNegComparator(a, b) {\n  return a < b ? 1 : a > b ? -1 : 0;\n}\n\nfunction hashCollection(collection) {\n  if (collection.size === Infinity) {\n    return 0;\n  }\n  var ordered = isOrdered(collection);\n  var keyed = isKeyed(collection);\n  var h = ordered ? 1 : 0;\n  var size = collection.__iterate(\n    keyed\n      ? ordered\n        ? function (v, k) {\n            h = (31 * h + hashMerge(hash(v), hash(k))) | 0;\n          }\n        : function (v, k) {\n            h = (h + hashMerge(hash(v), hash(k))) | 0;\n          }\n      : ordered\n        ? function (v) {\n            h = (31 * h + hash(v)) | 0;\n          }\n        : function (v) {\n            h = (h + hash(v)) | 0;\n          }\n  );\n  return murmurHashOfSize(size, h);\n}\n\nfunction murmurHashOfSize(size, h) {\n  h = imul(h, 0xcc9e2d51);\n  h = imul((h << 15) | (h >>> -15), 0x1b873593);\n  h = imul((h << 13) | (h >>> -13), 5);\n  h = ((h + 0xe6546b64) | 0) ^ size;\n  h = imul(h ^ (h >>> 16), 0x85ebca6b);\n  h = imul(h ^ (h >>> 13), 0xc2b2ae35);\n  h = smi(h ^ (h >>> 16));\n  return h;\n}\n\nfunction hashMerge(a, b) {\n  return (a ^ (b + 0x9e3779b9 + (a << 6) + (a >> 2))) | 0; // int\n}\n\nvar OrderedSet = /*@__PURE__*/(function (Set$$1) {\n  function OrderedSet(value) {\n    return value === null || value === undefined\n      ? emptyOrderedSet()\n      : isOrderedSet(value)\n        ? value\n        : emptyOrderedSet().withMutations(function (set) {\n            var iter = SetCollection(value);\n            assertNotInfinite(iter.size);\n            iter.forEach(function (v) { return set.add(v); });\n          });\n  }\n\n  if ( Set$$1 ) OrderedSet.__proto__ = Set$$1;\n  OrderedSet.prototype = Object.create( Set$$1 && Set$$1.prototype );\n  OrderedSet.prototype.constructor = OrderedSet;\n\n  OrderedSet.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedSet.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  OrderedSet.prototype.toString = function toString () {\n    return this.__toString('OrderedSet {', '}');\n  };\n\n  return OrderedSet;\n}(Set));\n\nOrderedSet.isOrderedSet = isOrderedSet;\n\nvar OrderedSetPrototype = OrderedSet.prototype;\nOrderedSetPrototype[IS_ORDERED_SYMBOL] = true;\nOrderedSetPrototype.zip = IndexedCollectionPrototype.zip;\nOrderedSetPrototype.zipWith = IndexedCollectionPrototype.zipWith;\n\nOrderedSetPrototype.__empty = emptyOrderedSet;\nOrderedSetPrototype.__make = makeOrderedSet;\n\nfunction makeOrderedSet(map, ownerID) {\n  var set = Object.create(OrderedSetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_ORDERED_SET;\nfunction emptyOrderedSet() {\n  return (\n    EMPTY_ORDERED_SET || (EMPTY_ORDERED_SET = makeOrderedSet(emptyOrderedMap()))\n  );\n}\n\nvar Record = function Record(defaultValues, name) {\n  var hasInitialized;\n\n  var RecordType = function Record(values) {\n    var this$1 = this;\n\n    if (values instanceof RecordType) {\n      return values;\n    }\n    if (!(this instanceof RecordType)) {\n      return new RecordType(values);\n    }\n    if (!hasInitialized) {\n      hasInitialized = true;\n      var keys = Object.keys(defaultValues);\n      var indices = (RecordTypePrototype._indices = {});\n      // Deprecated: left to attempt not to break any external code which\n      // relies on a ._name property existing on record instances.\n      // Use Record.getDescriptiveName() instead\n      RecordTypePrototype._name = name;\n      RecordTypePrototype._keys = keys;\n      RecordTypePrototype._defaultValues = defaultValues;\n      for (var i = 0; i < keys.length; i++) {\n        var propName = keys[i];\n        indices[propName] = i;\n        if (RecordTypePrototype[propName]) {\n          /* eslint-disable no-console */\n          typeof console === 'object' &&\n            console.warn &&\n            console.warn(\n              'Cannot define ' +\n                recordName(this) +\n                ' with property \"' +\n                propName +\n                '\" since that property name is part of the Record API.'\n            );\n          /* eslint-enable no-console */\n        } else {\n          setProp(RecordTypePrototype, propName);\n        }\n      }\n    }\n    this.__ownerID = undefined;\n    this._values = List().withMutations(function (l) {\n      l.setSize(this$1._keys.length);\n      KeyedCollection(values).forEach(function (v, k) {\n        l.set(this$1._indices[k], v === this$1._defaultValues[k] ? undefined : v);\n      });\n    });\n  };\n\n  var RecordTypePrototype = (RecordType.prototype = Object.create(\n    RecordPrototype\n  ));\n  RecordTypePrototype.constructor = RecordType;\n\n  if (name) {\n    RecordType.displayName = name;\n  }\n\n  return RecordType;\n};\n\nRecord.prototype.toString = function toString () {\n  var str = recordName(this) + ' { ';\n  var keys = this._keys;\n  var k;\n  for (var i = 0, l = keys.length; i !== l; i++) {\n    k = keys[i];\n    str += (i ? ', ' : '') + k + ': ' + quoteString(this.get(k));\n  }\n  return str + ' }';\n};\n\nRecord.prototype.equals = function equals (other) {\n  return (\n    this === other ||\n    (other &&\n      this._keys === other._keys &&\n      recordSeq(this).equals(recordSeq(other)))\n  );\n};\n\nRecord.prototype.hashCode = function hashCode () {\n  return recordSeq(this).hashCode();\n};\n\n// @pragma Access\n\nRecord.prototype.has = function has (k) {\n  return this._indices.hasOwnProperty(k);\n};\n\nRecord.prototype.get = function get (k, notSetValue) {\n  if (!this.has(k)) {\n    return notSetValue;\n  }\n  var index = this._indices[k];\n  var value = this._values.get(index);\n  return value === undefined ? this._defaultValues[k] : value;\n};\n\n// @pragma Modification\n\nRecord.prototype.set = function set (k, v) {\n  if (this.has(k)) {\n    var newValues = this._values.set(\n      this._indices[k],\n      v === this._defaultValues[k] ? undefined : v\n    );\n    if (newValues !== this._values && !this.__ownerID) {\n      return makeRecord(this, newValues);\n    }\n  }\n  return this;\n};\n\nRecord.prototype.remove = function remove (k) {\n  return this.set(k);\n};\n\nRecord.prototype.clear = function clear () {\n  var newValues = this._values.clear().setSize(this._keys.length);\n  return this.__ownerID ? this : makeRecord(this, newValues);\n};\n\nRecord.prototype.wasAltered = function wasAltered () {\n  return this._values.wasAltered();\n};\n\nRecord.prototype.toSeq = function toSeq () {\n  return recordSeq(this);\n};\n\nRecord.prototype.toJS = function toJS$1 () {\n  return toJS(this);\n};\n\nRecord.prototype.entries = function entries () {\n  return this.__iterator(ITERATE_ENTRIES);\n};\n\nRecord.prototype.__iterator = function __iterator (type, reverse) {\n  return recordSeq(this).__iterator(type, reverse);\n};\n\nRecord.prototype.__iterate = function __iterate (fn, reverse) {\n  return recordSeq(this).__iterate(fn, reverse);\n};\n\nRecord.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n  if (ownerID === this.__ownerID) {\n    return this;\n  }\n  var newValues = this._values.__ensureOwner(ownerID);\n  if (!ownerID) {\n    this.__ownerID = ownerID;\n    this._values = newValues;\n    return this;\n  }\n  return makeRecord(this, newValues, ownerID);\n};\n\nRecord.isRecord = isRecord;\nRecord.getDescriptiveName = recordName;\nvar RecordPrototype = Record.prototype;\nRecordPrototype[IS_RECORD_SYMBOL] = true;\nRecordPrototype[DELETE] = RecordPrototype.remove;\nRecordPrototype.deleteIn = RecordPrototype.removeIn = deleteIn;\nRecordPrototype.getIn = getIn$1;\nRecordPrototype.hasIn = CollectionPrototype.hasIn;\nRecordPrototype.merge = merge;\nRecordPrototype.mergeWith = mergeWith;\nRecordPrototype.mergeIn = mergeIn;\nRecordPrototype.mergeDeep = mergeDeep$1;\nRecordPrototype.mergeDeepWith = mergeDeepWith$1;\nRecordPrototype.mergeDeepIn = mergeDeepIn;\nRecordPrototype.setIn = setIn$1;\nRecordPrototype.update = update$1;\nRecordPrototype.updateIn = updateIn$1;\nRecordPrototype.withMutations = withMutations;\nRecordPrototype.asMutable = asMutable;\nRecordPrototype.asImmutable = asImmutable;\nRecordPrototype[ITERATOR_SYMBOL] = RecordPrototype.entries;\nRecordPrototype.toJSON = RecordPrototype.toObject =\n  CollectionPrototype.toObject;\nRecordPrototype.inspect = RecordPrototype.toSource = function() {\n  return this.toString();\n};\n\nfunction makeRecord(likeRecord, values, ownerID) {\n  var record = Object.create(Object.getPrototypeOf(likeRecord));\n  record._values = values;\n  record.__ownerID = ownerID;\n  return record;\n}\n\nfunction recordName(record) {\n  return record.constructor.displayName || record.constructor.name || 'Record';\n}\n\nfunction recordSeq(record) {\n  return keyedSeqFromValue(record._keys.map(function (k) { return [k, record.get(k)]; }));\n}\n\nfunction setProp(prototype, name) {\n  try {\n    Object.defineProperty(prototype, name, {\n      get: function() {\n        return this.get(name);\n      },\n      set: function(value) {\n        invariant(this.__ownerID, 'Cannot set on an immutable record.');\n        this.set(name, value);\n      },\n    });\n  } catch (error) {\n    // Object.defineProperty failed. Probably IE8.\n  }\n}\n\n/**\n * Returns a lazy Seq of `value` repeated `times` times. When `times` is\n * undefined, returns an infinite sequence of `value`.\n */\nvar Repeat = /*@__PURE__*/(function (IndexedSeq$$1) {\n  function Repeat(value, times) {\n    if (!(this instanceof Repeat)) {\n      return new Repeat(value, times);\n    }\n    this._value = value;\n    this.size = times === undefined ? Infinity : Math.max(0, times);\n    if (this.size === 0) {\n      if (EMPTY_REPEAT) {\n        return EMPTY_REPEAT;\n      }\n      EMPTY_REPEAT = this;\n    }\n  }\n\n  if ( IndexedSeq$$1 ) Repeat.__proto__ = IndexedSeq$$1;\n  Repeat.prototype = Object.create( IndexedSeq$$1 && IndexedSeq$$1.prototype );\n  Repeat.prototype.constructor = Repeat;\n\n  Repeat.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Repeat []';\n    }\n    return 'Repeat [ ' + this._value + ' ' + this.size + ' times ]';\n  };\n\n  Repeat.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._value : notSetValue;\n  };\n\n  Repeat.prototype.includes = function includes (searchValue) {\n    return is(this._value, searchValue);\n  };\n\n  Repeat.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    return wholeSlice(begin, end, size)\n      ? this\n      : new Repeat(\n          this._value,\n          resolveEnd(end, size) - resolveBegin(begin, size)\n        );\n  };\n\n  Repeat.prototype.reverse = function reverse () {\n    return this;\n  };\n\n  Repeat.prototype.indexOf = function indexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return 0;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return this.size;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var i = 0;\n    while (i !== size) {\n      if (fn(this._value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  Repeat.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1 = this;\n\n    var size = this.size;\n    var i = 0;\n    return new Iterator(\n      function () { return i === size\n          ? iteratorDone()\n          : iteratorValue(type, reverse ? size - ++i : i++, this$1._value); }\n    );\n  };\n\n  Repeat.prototype.equals = function equals (other) {\n    return other instanceof Repeat\n      ? is(this._value, other._value)\n      : deepEqual(other);\n  };\n\n  return Repeat;\n}(IndexedSeq));\n\nvar EMPTY_REPEAT;\n\nfunction fromJS(value, converter) {\n  return fromJSWith(\n    [],\n    converter || defaultConverter,\n    value,\n    '',\n    converter && converter.length > 2 ? [] : undefined,\n    { '': value }\n  );\n}\n\nfunction fromJSWith(stack, converter, value, key, keyPath, parentValue) {\n  var toSeq = Array.isArray(value)\n    ? IndexedSeq\n    : isPlainObj(value)\n      ? KeyedSeq\n      : null;\n  if (toSeq) {\n    if (~stack.indexOf(value)) {\n      throw new TypeError('Cannot convert circular structure to Immutable');\n    }\n    stack.push(value);\n    keyPath && key !== '' && keyPath.push(key);\n    var converted = converter.call(\n      parentValue,\n      key,\n      toSeq(value).map(function (v, k) { return fromJSWith(stack, converter, v, k, keyPath, value); }\n      ),\n      keyPath && keyPath.slice()\n    );\n    stack.pop();\n    keyPath && keyPath.pop();\n    return converted;\n  }\n  return value;\n}\n\nfunction defaultConverter(k, v) {\n  return isKeyed(v) ? v.toMap() : v.toList();\n}\n\nvar version = \"4.0.0-rc.11\";\n\nvar Immutable = {\n  version: version,\n\n  Collection: Collection,\n  // Note: Iterable is deprecated\n  Iterable: Collection,\n\n  Seq: Seq,\n  Map: Map,\n  OrderedMap: OrderedMap,\n  List: List,\n  Stack: Stack,\n  Set: Set,\n  OrderedSet: OrderedSet,\n\n  Record: Record,\n  Range: Range,\n  Repeat: Repeat,\n\n  is: is,\n  fromJS: fromJS,\n  hash: hash,\n\n  isImmutable: isImmutable,\n  isCollection: isCollection,\n  isKeyed: isKeyed,\n  isIndexed: isIndexed,\n  isAssociative: isAssociative,\n  isOrdered: isOrdered,\n  isValueObject: isValueObject,\n  isSeq: isSeq,\n  isList: isList,\n  isMap: isMap,\n  isOrderedMap: isOrderedMap,\n  isStack: isStack,\n  isSet: isSet,\n  isOrderedSet: isOrderedSet,\n  isRecord: isRecord,\n\n  get: get,\n  getIn: getIn,\n  has: has,\n  hasIn: hasIn,\n  merge: merge$1,\n  mergeDeep: mergeDeep,\n  mergeWith: mergeWith$1,\n  mergeDeepWith: mergeDeepWith,\n  remove: remove,\n  removeIn: removeIn,\n  set: set,\n  setIn: setIn,\n  update: update,\n  updateIn: updateIn,\n};\n\n// Note: Iterable is deprecated\nvar Iterable = Collection;\n\nexport default Immutable;\nexport { version, Collection, Iterable, Seq, Map, OrderedMap, List, Stack, Set, OrderedSet, Record, Range, Repeat, is, fromJS, hash, isImmutable, isCollection, isKeyed, isIndexed, isAssociative, isOrdered, isValueObject, get, getIn, has, hasIn, merge$1 as merge, mergeDeep, mergeWith$1 as mergeWith, mergeDeepWith, remove, removeIn, set, setIn, update, updateIn };\n","import Logger from 'js-logger';\n\nconst singleton = Symbol();\nconst singletonEnforcer = Symbol();\n\n/**\n * @protected\n * Class that provides logger instances\n * Each log instance has an associated name used to identify the file\n * that created log records.\n *\n * This class implements a singleton pattern. Instances of {Logs} are created\n * with Logs.instance\n *\n * @example\n * // Log a debug message\n * var log = Logs.instance.getLogger('test.js');\n * log.debug('a message');\n *\n * // Generates next log message:\n * // [14:55:03] test.js a message\n *\n * @example\n * // Log an error message\n * var log = Logs.instance.getLogger('test.js');\n * log.error('an error message');\n *\n * // Generates next error message:\n * // [14:55:03] test.js a message\n */\nexport default class Logs {\n\n\t/**\n\t * Get a {Logs} instance\n\t *\n\t * @type {Logs}\n\t */\n\tstatic get instance() {\n\t\tif (!this[singleton]) {\n\t\t\tthis[singleton] = new Logs(singletonEnforcer);\n\t\t}\n\t\treturn this[singleton];\n\t}\n\n\t/**\n\t * Class constructor\n\t *\n\t * @private\n\t *\n\t * @param {Symbol} enforcer symbol used internally to implement singleton access\n\t */\n\tconstructor(enforcer) {\n\t\tif (enforcer != singletonEnforcer) {\n\t\t\tthrow new Error('The constructor is private, use Logs.instance instead');\n\t\t}\n\n\t\tthis._handlers = [];\n\n\t\tLogger.useDefaults();\n\t\tLogger.setHandler((messages, context) => {\n\t\t\tthis._handlers.forEach((handler) => {\n\t\t\t\thandler(messages, context);\n\t\t\t});\n\t\t});\n\n\t\tthis.addHandler(Logger.createDefaultHandler({formatter: this._formatter}));\n\t}\n\n\t/**\n\t * Supported log levels\n\t *\n\t * @type {Object}\n\t */\n\tget LEVELS() {\n\t\treturn {\n\t\t\tDEBUG: Logger.DEBUG,\n\t\t\tINFO: Logger.INFO,\n\t\t\tTIME: Logger.TIME,\n\t\t\tWARN: Logger.WARN,\n\t\t\tERROR: Logger.ERROR,\n\t\t\tOFF: Logger.OFF,\n\t\t};\n\t}\n\n\t/**\n\t * Get a stored log level associated with given name.\n\t *\n\t * If environment doesn't support localStorage Logs.LEVELS.OFF is returned\n\t *\n\t * Log levels are stored as a comma separated list in localStorage.sippodebug. Each\n\t * element of this list follows next syntax: \"name<=level>\". level defaults to DEBUG.\n\t *\n\t * @param {String} name element name\n\t *\n\t * @return {Object} log level\n\t */\n\tgetLevelFromLocalStorage(name) {\n\t\tif (!localStorage || !localStorage.sippodebug) {\n\t\t\treturn this.LEVELS.WARN;\n\t\t}\n\t\tlet any = false;\n\t\tlet entries = localStorage.sippodebug.split(',').map((entry) => {\n\t\t\tlet [id, value] = entry.split('=');\n\t\t\tany = any || entry === '*';\n\t\t\treturn {\n\t\t\t\tid: id,\n\t\t\t\tvalue: value || 'DEBUG',\n\t\t\t};\n\t\t});\n\t\tfor (let i = 0; i < entries.length; i++) {\n\t\t\tlet entry = entries[i];\n\t\t\tif (entry.id === name && this.LEVELS[entry.value]) {\n\t\t\t\treturn this.LEVELS[entry.value];\n\t\t\t}\n\t\t}\n\t\treturn any ? this.LEVELS.DEBUG : this.LEVELS.WARN;\n\t}\n\n\t/**\n\t * Get a js-logger named logger\n\t *\n\t * @param {String} name logger identifier\n\t *\n\t * @return {Logger} js-logger named instance\n\t */\n\tgetLogger(name) {\n\t\tlet logger = Logger.get(name);\n\t\tlogger.setLevel(this.getLevelFromLocalStorage(name));\n\t\treturn logger;\n\t}\n\n\t/**\n\t * Set global log level\n\t *\n\t * @param {String} name named logger identifier\n\t * @param {Object} level selected log level.\n\t *\n\t * @return {Void} this method doesn't return anything\n\t */\n\tsetLevel(name, level) {\n\t\tLogger.get(name).setLevel(level);\n\t}\n\n\t/**\n\t * Add log handler: function called every time a log message is\n\t * created.\n\t *\n\t * @param {Function} fn log handler. Expects two arguments; the first\n\t * being the log messages to output and the latter being a context\n\t * object which can be inspected by the log handler.\n\t *\n\t * @return {Logs} self\n\t */\n\taddHandler(fn) {\n\t\tif (this._handlers.indexOf(fn) === -1) {\n\t\t\tthis._handlers.push(fn);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Remove a log handler\n\t *\n\t * @param {Function} fn log handler\n\t *\n\t * @return {Logs} self\n\t */\n\tremoveHandler(fn) {\n\t\tthis._handlers = this._handlers.filter(function(handler) {\n\t\t\treturn handler !== fn;\n\t\t});\n\t}\n\n\t/**\n\t * Add Logger name and current time to log messages.\n\t *\n\t * @private\n\t *\n\t * @param {Array<Object>} messages message array to log\n\t * @param {Object} context js-logger context\n\t *\n\t * @return {Void} this method doesn't return anything\n\t */\n\t_formatter(messages, context) {\n\t\tlet time = new Date().toTimeString().replace(/.*(\\d{2}:\\d{2}:\\d{2}).*/, '$1');\n\t\tfor (let i = 0; i < messages.length; i++) {\n\t\t\tif (messages[i] instanceof Error && messages[i].stack) {\n\t\t\t\tmessages[i] = messages[i].stack;\n\t\t\t}\n\t\t}\n\t\tmessages.unshift(`[${time}] ${context.name}`);\n\t}\n}\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isFunction(x) {\n    return typeof x === 'function';\n}\n//# sourceMappingURL=isFunction.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nexport var config = {\n    Promise: undefined,\n    set useDeprecatedSynchronousErrorHandling(value) {\n        if (value) {\n            var error = /*@__PURE__*/ new Error();\n            /*@__PURE__*/ console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n        }\n        else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n            /*@__PURE__*/ console.log('RxJS: Back to a better error behavior. Thank you. <3');\n        }\n        _enable_super_gross_mode_that_will_cause_bad_things = value;\n    },\n    get useDeprecatedSynchronousErrorHandling() {\n        return _enable_super_gross_mode_that_will_cause_bad_things;\n    },\n};\n//# sourceMappingURL=config.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function hostReportError(err) {\n    setTimeout(function () { throw err; }, 0);\n}\n//# sourceMappingURL=hostReportError.js.map\n","/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\nexport var empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) {\n        if (config.useDeprecatedSynchronousErrorHandling) {\n            throw err;\n        }\n        else {\n            hostReportError(err);\n        }\n    },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArray = /*@__PURE__*/ (function () { return Array.isArray || (function (x) { return x && typeof x.length === 'number'; }); })();\n//# sourceMappingURL=isArray.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isObject(x) {\n    return x !== null && typeof x === 'object';\n}\n//# sourceMappingURL=isObject.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar UnsubscriptionErrorImpl = /*@__PURE__*/ (function () {\n    function UnsubscriptionErrorImpl(errors) {\n        Error.call(this);\n        this.message = errors ?\n            errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ') : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n        return this;\n    }\n    UnsubscriptionErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);\n    return UnsubscriptionErrorImpl;\n})();\nexport var UnsubscriptionError = UnsubscriptionErrorImpl;\n//# sourceMappingURL=UnsubscriptionError.js.map\n","/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\nimport { isArray } from './util/isArray';\nimport { isObject } from './util/isObject';\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nvar Subscription = /*@__PURE__*/ (function () {\n    function Subscription(unsubscribe) {\n        this.closed = false;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parentOrParents = _a._parentOrParents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parentOrParents = null;\n        this._subscriptions = null;\n        if (_parentOrParents instanceof Subscription) {\n            _parentOrParents.remove(this);\n        }\n        else if (_parentOrParents !== null) {\n            for (var index = 0; index < _parentOrParents.length; ++index) {\n                var parent_1 = _parentOrParents[index];\n                parent_1.remove(this);\n            }\n        }\n        if (isFunction(_unsubscribe)) {\n            try {\n                _unsubscribe.call(this);\n            }\n            catch (e) {\n                errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n            }\n        }\n        if (isArray(_subscriptions)) {\n            var index = -1;\n            var len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject(sub)) {\n                    try {\n                        sub.unsubscribe();\n                    }\n                    catch (e) {\n                        errors = errors || [];\n                        if (e instanceof UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n                        }\n                        else {\n                            errors.push(e);\n                        }\n                    }\n                }\n            }\n        }\n        if (errors) {\n            throw new UnsubscriptionError(errors);\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var subscription = teardown;\n        if (!teardown) {\n            return Subscription.EMPTY;\n        }\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (!(subscription instanceof Subscription)) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default: {\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n            }\n        }\n        var _parentOrParents = subscription._parentOrParents;\n        if (_parentOrParents === null) {\n            subscription._parentOrParents = this;\n        }\n        else if (_parentOrParents instanceof Subscription) {\n            if (_parentOrParents === this) {\n                return subscription;\n            }\n            subscription._parentOrParents = [_parentOrParents, this];\n        }\n        else if (_parentOrParents.indexOf(this) === -1) {\n            _parentOrParents.push(this);\n        }\n        else {\n            return subscription;\n        }\n        var subscriptions = this._subscriptions;\n        if (subscriptions === null) {\n            this._subscriptions = [subscription];\n        }\n        else {\n            subscriptions.push(subscription);\n        }\n        return subscription;\n    };\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexport { Subscription };\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var rxSubscriber = /*@__PURE__*/ (function () {\n    return typeof Symbol === 'function'\n        ? /*@__PURE__*/ Symbol('rxSubscriber')\n        : '@@rxSubscriber_' + /*@__PURE__*/ Math.random();\n})();\nexport var $$rxSubscriber = rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { empty as emptyObserver } from './Observer';\nimport { Subscription } from './Subscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\nvar Subscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Subscriber, _super);\n    function Subscriber(destinationOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.syncErrorValue = null;\n        _this.syncErrorThrown = false;\n        _this.syncErrorThrowable = false;\n        _this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                _this.destination = emptyObserver;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    _this.destination = emptyObserver;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        _this.destination = destinationOrNext;\n                        destinationOrNext.add(_this);\n                    }\n                    else {\n                        _this.syncErrorThrowable = true;\n                        _this.destination = new SafeSubscriber(_this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                _this.syncErrorThrowable = true;\n                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n                break;\n        }\n        return _this;\n    }\n    Subscriber.prototype[rxSubscriberSymbol] = function () { return this; };\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _parentOrParents = this._parentOrParents;\n        this._parentOrParents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parentOrParents = _parentOrParents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar SafeSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = _this;\n        if (isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== emptyObserver) {\n                context = Object.create(observerOrNext);\n                if (isFunction(context.unsubscribe)) {\n                    _this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = _this.unsubscribe.bind(_this);\n            }\n        }\n        _this._context = context;\n        _this._next = next;\n        _this._error = error;\n        _this._complete = complete;\n        return _this;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n            if (this._error) {\n                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                if (useDeprecatedSynchronousErrorHandling) {\n                    throw err;\n                }\n                hostReportError(err);\n            }\n            else {\n                if (useDeprecatedSynchronousErrorHandling) {\n                    _parentSubscriber.syncErrorValue = err;\n                    _parentSubscriber.syncErrorThrown = true;\n                }\n                else {\n                    hostReportError(err);\n                }\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                throw err;\n            }\n            else {\n                hostReportError(err);\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        if (!config.useDeprecatedSynchronousErrorHandling) {\n            throw new Error('bad call');\n        }\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                parent.syncErrorValue = err;\n                parent.syncErrorThrown = true;\n                return true;\n            }\n            else {\n                hostReportError(err);\n                return true;\n            }\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\n//# sourceMappingURL=Subscriber.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var observable = /*@__PURE__*/ (function () { return typeof Symbol === 'function' && Symbol.observable || '@@observable'; })();\n//# sourceMappingURL=observable.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function noop() { }\n//# sourceMappingURL=noop.js.map\n","/** PURE_IMPORTS_START _noop PURE_IMPORTS_END */\nimport { noop } from './noop';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (!fns) {\n        return noop;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map\n","/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\nimport { canReportError } from './util/canReportError';\nimport { toSubscriber } from './util/toSubscriber';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nvar Observable = /*@__PURE__*/ (function () {\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            sink.add(operator.call(sink, this.source));\n        }\n        else {\n            sink.add(this.source || (config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n                this._subscribe(sink) :\n                this._trySubscribe(sink));\n        }\n        if (config.useDeprecatedSynchronousErrorHandling) {\n            if (sink.syncErrorThrowable) {\n                sink.syncErrorThrowable = false;\n                if (sink.syncErrorThrown) {\n                    throw sink.syncErrorValue;\n                }\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                sink.syncErrorThrown = true;\n                sink.syncErrorValue = err;\n            }\n            if (canReportError(sink)) {\n                sink.error(err);\n            }\n            else {\n                console.warn(err);\n            }\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    if (subscription) {\n                        subscription.unsubscribe();\n                    }\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        return source && source.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    if (!promiseCtor) {\n        promiseCtor = config.Promise || Promise;\n    }\n    if (!promiseCtor) {\n        throw new Error('no Promise impl found');\n    }\n    return promiseCtor;\n}\n//# sourceMappingURL=Observable.js.map\n","/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\nimport { Subscriber } from '../Subscriber';\nimport { rxSubscriber as rxSubscriberSymbol } from '../symbol/rxSubscriber';\nimport { empty as emptyObserver } from '../Observer';\nexport function toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriberSymbol]) {\n            return nextOrObserver[rxSubscriberSymbol]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber(emptyObserver);\n    }\n    return new Subscriber(nextOrObserver, error, complete);\n}\n//# sourceMappingURL=toSubscriber.js.map\n","/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\nimport { Subscriber } from '../Subscriber';\nexport function canReportError(observer) {\n    while (observer) {\n        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;\n        if (closed_1 || isStopped) {\n            return false;\n        }\n        else if (destination && destination instanceof Subscriber) {\n            observer = destination;\n        }\n        else {\n            observer = null;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=canReportError.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar ObjectUnsubscribedErrorImpl = /*@__PURE__*/ (function () {\n    function ObjectUnsubscribedErrorImpl() {\n        Error.call(this);\n        this.message = 'object unsubscribed';\n        this.name = 'ObjectUnsubscribedError';\n        return this;\n    }\n    ObjectUnsubscribedErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);\n    return ObjectUnsubscribedErrorImpl;\n})();\nexport var ObjectUnsubscribedError = ObjectUnsubscribedErrorImpl;\n//# sourceMappingURL=ObjectUnsubscribedError.js.map\n","/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from './Subscription';\nvar SubjectSubscription = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SubjectSubscription, _super);\n    function SubjectSubscription(subject, subscriber) {\n        var _this = _super.call(this) || this;\n        _this.subject = subject;\n        _this.subscriber = subscriber;\n        _this.closed = false;\n        return _this;\n    }\n    SubjectSubscription.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        var subject = this.subject;\n        var observers = subject.observers;\n        this.subject = null;\n        if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n            return;\n        }\n        var subscriberIndex = observers.indexOf(this.subscriber);\n        if (subscriberIndex !== -1) {\n            observers.splice(subscriberIndex, 1);\n        }\n    };\n    return SubjectSubscription;\n}(Subscription));\nexport { SubjectSubscription };\n//# sourceMappingURL=SubjectSubscription.js.map\n","/** PURE_IMPORTS_START tslib,_Observable,_Subscriber,_Subscription,_util_ObjectUnsubscribedError,_SubjectSubscription,_internal_symbol_rxSubscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Observable } from './Observable';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\nvar SubjectSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SubjectSubscriber, _super);\n    function SubjectSubscriber(destination) {\n        var _this = _super.call(this, destination) || this;\n        _this.destination = destination;\n        return _this;\n    }\n    return SubjectSubscriber;\n}(Subscriber));\nexport { SubjectSubscriber };\nvar Subject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Subject, _super);\n    function Subject() {\n        var _this = _super.call(this) || this;\n        _this.observers = [];\n        _this.closed = false;\n        _this.isStopped = false;\n        _this.hasError = false;\n        _this.thrownError = null;\n        return _this;\n    }\n    Subject.prototype[rxSubscriberSymbol] = function () {\n        return new SubjectSubscriber(this);\n    };\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype.next = function (value) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        if (!this.isStopped) {\n            var observers = this.observers;\n            var len = observers.length;\n            var copy = observers.slice();\n            for (var i = 0; i < len; i++) {\n                copy[i].next(value);\n            }\n        }\n    };\n    Subject.prototype.error = function (err) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.hasError = true;\n        this.thrownError = err;\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].error(err);\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.complete = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].complete();\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = true;\n        this.closed = true;\n        this.observers = null;\n    };\n    Subject.prototype._trySubscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else {\n            return _super.prototype._trySubscribe.call(this, subscriber);\n        }\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else if (this.hasError) {\n            subscriber.error(this.thrownError);\n            return Subscription.EMPTY;\n        }\n        else if (this.isStopped) {\n            subscriber.complete();\n            return Subscription.EMPTY;\n        }\n        else {\n            this.observers.push(subscriber);\n            return new SubjectSubscription(this, subscriber);\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\nexport { Subject };\nvar AnonymousSubject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        var _this = _super.call(this) || this;\n        _this.destination = destination;\n        _this.source = source;\n        return _this;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var destination = this.destination;\n        if (destination && destination.next) {\n            destination.next(value);\n        }\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var destination = this.destination;\n        if (destination && destination.error) {\n            this.destination.error(err);\n        }\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var destination = this.destination;\n        if (destination && destination.complete) {\n            this.destination.complete();\n        }\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        if (source) {\n            return this.source.subscribe(subscriber);\n        }\n        else {\n            return Subscription.EMPTY;\n        }\n    };\n    return AnonymousSubject;\n}(Subject));\nexport { AnonymousSubject };\n//# sourceMappingURL=Subject.js.map\n","/** PURE_IMPORTS_START tslib,_Subject,_util_ObjectUnsubscribedError PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subject } from './Subject';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nvar BehaviorSubject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(BehaviorSubject, _super);\n    function BehaviorSubject(_value) {\n        var _this = _super.call(this) || this;\n        _this._value = _value;\n        return _this;\n    }\n    Object.defineProperty(BehaviorSubject.prototype, \"value\", {\n        get: function () {\n            return this.getValue();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    BehaviorSubject.prototype._subscribe = function (subscriber) {\n        var subscription = _super.prototype._subscribe.call(this, subscriber);\n        if (subscription && !subscription.closed) {\n            subscriber.next(this._value);\n        }\n        return subscription;\n    };\n    BehaviorSubject.prototype.getValue = function () {\n        if (this.hasError) {\n            throw this.thrownError;\n        }\n        else if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else {\n            return this._value;\n        }\n    };\n    BehaviorSubject.prototype.next = function (value) {\n        _super.prototype.next.call(this, this._value = value);\n    };\n    return BehaviorSubject;\n}(Subject));\nexport { BehaviorSubject };\n//# sourceMappingURL=BehaviorSubject.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\n//# sourceMappingURL=isScheduler.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar OuterSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber));\nexport { OuterSubscriber };\n//# sourceMappingURL=OuterSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar InnerSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber));\nexport { InnerSubscriber };\n//# sourceMappingURL=InnerSubscriber.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var subscribeToArray = function (array) {\n    return function (subscriber) {\n        for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        subscriber.complete();\n    };\n};\n//# sourceMappingURL=subscribeToArray.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = /*@__PURE__*/ getSymbolIterator();\nexport var $$iterator = iterator;\n//# sourceMappingURL=iterator.js.map\n","/** PURE_IMPORTS_START _subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\nimport { subscribeToArray } from './subscribeToArray';\nimport { subscribeToPromise } from './subscribeToPromise';\nimport { subscribeToIterable } from './subscribeToIterable';\nimport { subscribeToObservable } from './subscribeToObservable';\nimport { isArrayLike } from './isArrayLike';\nimport { isPromise } from './isPromise';\nimport { isObject } from './isObject';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeTo = function (result) {\n    if (!!result && typeof result[Symbol_observable] === 'function') {\n        return subscribeToObservable(result);\n    }\n    else if (isArrayLike(result)) {\n        return subscribeToArray(result);\n    }\n    else if (isPromise(result)) {\n        return subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[Symbol_iterator] === 'function') {\n        return subscribeToIterable(result);\n    }\n    else {\n        var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map\n","/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeToObservable = function (obj) {\n    return function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (typeof obs.subscribe !== 'function') {\n            throw new TypeError('Provided object does not correctly implement Symbol.observable');\n        }\n        else {\n            return obs.subscribe(subscriber);\n        }\n    };\n};\n//# sourceMappingURL=subscribeToObservable.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n//# sourceMappingURL=isPromise.js.map\n","/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\nimport { hostReportError } from './hostReportError';\nexport var subscribeToPromise = function (promise) {\n    return function (subscriber) {\n        promise.then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, hostReportError);\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToPromise.js.map\n","/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nexport var subscribeToIterable = function (iterable) {\n    return function (subscriber) {\n        var iterator = iterable[Symbol_iterator]();\n        do {\n            var item = iterator.next();\n            if (item.done) {\n                subscriber.complete();\n                break;\n            }\n            subscriber.next(item.value);\n            if (subscriber.closed) {\n                break;\n            }\n        } while (true);\n        if (typeof iterator.return === 'function') {\n            subscriber.add(function () {\n                if (iterator.return) {\n                    iterator.return();\n                }\n            });\n        }\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToIterable.js.map\n","/** PURE_IMPORTS_START _InnerSubscriber,_subscribeTo,_Observable PURE_IMPORTS_END */\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeTo } from './subscribeTo';\nimport { Observable } from '../Observable';\nexport function subscribeToResult(outerSubscriber, result, outerValue, outerIndex, innerSubscriber) {\n    if (innerSubscriber === void 0) {\n        innerSubscriber = new InnerSubscriber(outerSubscriber, outerValue, outerIndex);\n    }\n    if (innerSubscriber.closed) {\n        return undefined;\n    }\n    if (result instanceof Observable) {\n        return result.subscribe(innerSubscriber);\n    }\n    return subscribeTo(result)(innerSubscriber);\n}\n//# sourceMappingURL=subscribeToResult.js.map\n","/** PURE_IMPORTS_START _Observable,_util_subscribeToArray,_scheduled_scheduleArray PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { subscribeToArray } from '../util/subscribeToArray';\nimport { scheduleArray } from '../scheduled/scheduleArray';\nexport function fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToArray(input));\n    }\n    else {\n        return scheduleArray(input, scheduler);\n    }\n}\n//# sourceMappingURL=fromArray.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nexport function scheduleArray(input, scheduler) {\n    return new Observable(function (subscriber) {\n        var sub = new Subscription();\n        var i = 0;\n        sub.add(scheduler.schedule(function () {\n            if (i === input.length) {\n                subscriber.complete();\n                return;\n            }\n            subscriber.next(input[i++]);\n            if (!subscriber.closed) {\n                sub.add(this.schedule());\n            }\n        }));\n        return sub;\n    });\n}\n//# sourceMappingURL=scheduleArray.js.map\n","/** PURE_IMPORTS_START tslib,_util_isScheduler,_util_isArray,_OuterSubscriber,_util_subscribeToResult,_fromArray PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { isScheduler } from '../util/isScheduler';\nimport { isArray } from '../util/isArray';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { fromArray } from './fromArray';\nvar NONE = {};\nexport function combineLatest() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var resultSelector = null;\n    var scheduler = null;\n    if (isScheduler(observables[observables.length - 1])) {\n        scheduler = observables.pop();\n    }\n    if (typeof observables[observables.length - 1] === 'function') {\n        resultSelector = observables.pop();\n    }\n    if (observables.length === 1 && isArray(observables[0])) {\n        observables = observables[0];\n    }\n    return fromArray(observables, scheduler).lift(new CombineLatestOperator(resultSelector));\n}\nvar CombineLatestOperator = /*@__PURE__*/ (function () {\n    function CombineLatestOperator(resultSelector) {\n        this.resultSelector = resultSelector;\n    }\n    CombineLatestOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new CombineLatestSubscriber(subscriber, this.resultSelector));\n    };\n    return CombineLatestOperator;\n}());\nexport { CombineLatestOperator };\nvar CombineLatestSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(CombineLatestSubscriber, _super);\n    function CombineLatestSubscriber(destination, resultSelector) {\n        var _this = _super.call(this, destination) || this;\n        _this.resultSelector = resultSelector;\n        _this.active = 0;\n        _this.values = [];\n        _this.observables = [];\n        return _this;\n    }\n    CombineLatestSubscriber.prototype._next = function (observable) {\n        this.values.push(NONE);\n        this.observables.push(observable);\n    };\n    CombineLatestSubscriber.prototype._complete = function () {\n        var observables = this.observables;\n        var len = observables.length;\n        if (len === 0) {\n            this.destination.complete();\n        }\n        else {\n            this.active = len;\n            this.toRespond = len;\n            for (var i = 0; i < len; i++) {\n                var observable = observables[i];\n                this.add(subscribeToResult(this, observable, observable, i));\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyComplete = function (unused) {\n        if ((this.active -= 1) === 0) {\n            this.destination.complete();\n        }\n    };\n    CombineLatestSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        var values = this.values;\n        var oldVal = values[outerIndex];\n        var toRespond = !this.toRespond\n            ? 0\n            : oldVal === NONE ? --this.toRespond : this.toRespond;\n        values[outerIndex] = innerValue;\n        if (toRespond === 0) {\n            if (this.resultSelector) {\n                this._tryResultSelector(values);\n            }\n            else {\n                this.destination.next(values.slice());\n            }\n        }\n    };\n    CombineLatestSubscriber.prototype._tryResultSelector = function (values) {\n        var result;\n        try {\n            result = this.resultSelector.apply(this, values);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return CombineLatestSubscriber;\n}(OuterSubscriber));\nexport { CombineLatestSubscriber };\n//# sourceMappingURL=combineLatest.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function map(project, thisArg) {\n    return function mapOperation(source) {\n        if (typeof project !== 'function') {\n            throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');\n        }\n        return source.lift(new MapOperator(project, thisArg));\n    };\n}\nvar MapOperator = /*@__PURE__*/ (function () {\n    function MapOperator(project, thisArg) {\n        this.project = project;\n        this.thisArg = thisArg;\n    }\n    MapOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));\n    };\n    return MapOperator;\n}());\nexport { MapOperator };\nvar MapSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(MapSubscriber, _super);\n    function MapSubscriber(destination, project, thisArg) {\n        var _this = _super.call(this, destination) || this;\n        _this.project = project;\n        _this.count = 0;\n        _this.thisArg = thisArg || _this;\n        return _this;\n    }\n    MapSubscriber.prototype._next = function (value) {\n        var result;\n        try {\n            result = this.project.call(this.thisArg, value, this.count++);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return MapSubscriber;\n}(Subscriber));\n//# sourceMappingURL=map.js.map\n","import {Enum} from '../utils/Enum';\n\n/**\n * Enum containing the possible status of a file upload. Possible values:\n * - LOADING\n * - SENDING\n * - COMPLETED\n * - ERROR\n * - ABORTED\n * @type {Enum}\n */\nexport const FileUploadStatus = new Enum([\n\t'LOADING',\n\t'SENDING',\n\t'COMPLETED',\n\t'ERROR',\n\t'ABORTED',\n]);\n","/**\n * Instances of this class represents a file in a chat message. This class must not be\n * directly instantiated. Instances of this class can be obtained using ChatMessage#getData.\n */\nexport class ChatMessageFile {\n\t/** @protected */\n\tconstructor(name, url = null) {\n\t\t/** @private */\n\t\tthis.name = name;\n\t\t/** @private */\n\t\tthis.url = url;\n\t\t/** @private */\n\t\tthis.cache = {\n\t\t\ttype: null,\n\t\t};\n\t\tObject.freeze(this);\n\t}\n\n\t/**\n\t * Returns the name of the file.\n\t * @return {string} Name of the file\n\t */\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\t/**\n\t * Returns the URL of the file.\n\t * @return {string} URL of the file\n\t */\n\tgetUrl() {\n\t\treturn this.url;\n\t}\n\n\t/**\n\t * Returns the mime-type of the file.\n\t * @return {Promise<string>} A promise fulfilled with the mime-type of the file\n\t */\n\tasync getType() {\n\t\tif (!this.cache.type) {\n\t\t\tconst res = await window.fetch(this.url, {\n\t\t\t\tmethod: 'HEAD',\n\t\t\t});\n\t\t\tthis.cache.type = res.headers.get('content-type');\n\t\t\tObject.freeze(this.cache);\n\t\t}\n\t\treturn this.cache.type;\n\t}\n}\n","/**\n * Enum containing the possible directions of a chat message. Possible values:\n * - INCOMING\n * - OUTGOING\n * @type {Enum}\n */\nexport const ChatMessageDirection = {\n\t'INCOMING': 'incoming',\n\t'OUTGOING': 'outgoing',\n};\n","/**\n * Enum containing the possible status of chat message. Possible values:\n * - ERROR\n * - SENDING\n * - SENT\n * - RECEIVED\n * - DISPLAYED\n * - ACKNOWLEDGED\n * @type {Enum}\n */\nexport const ChatMessageStatus = {\n\t'ERROR': 'error',\n\t'SENDING': 'sending',\n\t'SENT': 'sent',\n\t'RECEIVED': 'received',\n\t'DISPLAYED': 'displayed',\n\t'ACKNOWLEDGED': 'acknowledged',\n};\n","/**\n * Enum containing the possible types of a chat message. Possible values:\n * - FILE\n * - TEXT\n * @type {Enum}\n */\nexport const ChatMessageType = {\n\t'FILE': 'file',\n\t'TEXT': 'text',\n};\n","import {ChatMessageDirection} from './ChatMessageDirection';\nimport {ChatMessageStatus} from './ChatMessageStatus';\nimport {ChatMessageType} from './ChatMessageType';\n\n/**\n * Instances of this class represents a message of the chat.\n * For more information about how instances of this class can be obtained see\n * {@link Chat#getMessages} or {@link Chat#getPendingMessages}.\n */\nexport class ChatMessage {\n\t/** @protected */\n\tstatic of(composer, data, {\n\t\tid = null,\n\t\tdirection = ChatMessageDirection.INCOMING,\n\t\ttype = ChatMessageType.TEXT,\n\t\tstatus = ChatMessageStatus.SENDING,\n\t\tprogress = 0,\n\t\ttimestamp = null,\n\t} = {}) {\n\t\treturn new ChatMessage(composer, data, id, direction, type, status, progress, timestamp);\n\t}\n\n\t/** @private */\n\tconstructor(composer, data, id, direction, type, status, progress, timestamp) {\n\t\t/** @private */\n\t\tthis.composer = composer;\n\t\t/** @private */\n\t\tthis.data = data;\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.direction = direction;\n\t\t/** @private */\n\t\tthis.type = type;\n\t\t/** @private */\n\t\tthis.status = status;\n\t\t/** @private */\n\t\tthis.progress = progress;\n\t\t/** @private */\n\t\tthis.timestamp = timestamp;\n\t\tObject.freeze(this);\n\t}\n\n\t/**\n\t * @protected\n\t * Returns a new ChatMessage with the provided values updated.\n\t * @return {ChatMessage}\n\t */\n\twith({\n\t\tdata = this.data,\n\t\tid = this.id,\n\t\ttype = this.type,\n\t\tstatus = this.status,\n\t\tprogress = this.progress,\n\t\ttimestamp = this.timestamp,\n\t} = {}) {\n\t\treturn new ChatMessage(this.composer, data, id, this.direction, type, status, progress, timestamp);\n\t}\n\n\t/**\n\t * Returns the ID of the message.\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * Returns the direction of the direction of the message.\n\t * @return {ChatMessageDirection}\n\t */\n\tgetDirection() {\n\t\treturn this.direction;\n\t}\n\n\t/**\n\t * Returns the type of the message.\n\t * @return {ChatMessageType}\n\t */\n\tgetType() {\n\t\treturn this.type;\n\t}\n\n\t/**\n\t* Returns the address of the composer of the message.\n\t* @return {string}\n\t*/\n\tgetComposer() {\n\t\treturn this.composer;\n\t}\n\n\t/**\n\t * Returns the data of the message.\n\t * @return {string|ChatMessageFile}\n\t */\n\tgetData() {\n\t\treturn this.data;\n\t}\n\n\t/**\n\t * Returns the timestamp when the message was send.\n\t * @return {number}\n\t */\n\tgetTimestamp() {\n\t\treturn this.timestamp;\n\t}\n\n\t/**\n\t * Returns a number between 0 and 100 indicating the percentage of the message\n\t * that was sent. Note that text messages can only have two values: 0 and 100.\n\t * @return {number}\n\t */\n\tgetProgress() {\n\t\treturn this.progress;\n\t}\n\n\t/**\n\t * Returns the current status of the message.\n\t * @return {ChatMessageStatus}\n\t */\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\t/**\n\t * Returns true when the current status of the message is the specified.\n\t * @param {ChatMessageStatus} status\n\t * @return {boolean}\n\t */\n\thasStatus(status) {\n\t\treturn this.status === status;\n\t}\n}\n","/**\n * Enum containing the possible types of a chat. Possible values:\n * - INDIVIDUAL\n * - GROUP\n * @type {Enum}\n */\nexport const ChatType = {\n\tINDIVIDUAL: 'chat',\n\tGROUP: 'groupchat',\n};\n","/**\n * Enum containing the possible roles of a chat participant. Possible values:\n * - MEMBER\n * - ADMIN\n * @type {Enum}\n */\nexport const ChatParticipantRole = {\n\tMEMBER: 'member',\n\tADMIN: 'owner',\n};\n","/**\n * Enum containing the possible states of chat participant. Possible values:\n * - ACTIVE\n * - INACTIVE\n * - GONE\n * - COMPOSING\n * - PAUSED\n * @type {Enum}\n */\nexport const ChatParticipantState = {\n\tACTIVE: 'active',\n\tINACTIVE: 'inactive',\n\tGONE: 'gone',\n\tCOMPOSING: 'composing',\n\tPAUSED: 'paused',\n};\n","/** @private */\nexport class AckCounter {\n\tconstructor() {\n\t\tthis.limit = 2;\n\t\tthis.data = [];\n\t\tthis.lastAckedBy = [];\n\t\tthis.olderAcked = false;\n\t}\n\n\t/**\n\t * Sets the number of times an element needs to be incremented to be removed\n\t * @param {number} limit\n\t */\n\tsetLimit(limit) {\n\t\tthis.limit = limit;\n\t}\n\n\t/**\n\t * Adds a new element at the end of the collection.\n\t * @param {string} element\n\t * @return {boolean} true if the element is correctly added, false otherwise\n\t */\n\tappend(element) {\n\t\tif (this.data.find(d => d.key === element)) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.data.push({key: element, value: new window.Set()});\n\t\treturn true;\n\t}\n\n\t/**\n\t * Adds a new element at the start of the collection.\n\t * @param {string} element\n\t */\n\tprepend(element) {\n\t\tif (this.olderAcked) {\n\t\t\treturn;\n\t\t}\n\t\t// If element has received no acks, copy last added element\n\t\tif (!this.data.find(d => d.key === element)) {\n\t\t\tfor (let i = this.data.length - 1; i >= 0; i--) {\n\t\t\t\tif (this.data[i].isAdded) {\n\t\t\t\t\tconst value = new window.Set(this.data[i].value);\n\t\t\t\t\tthis.data.splice(i, 0, {key: element, value});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// If there was no last added element, add new element as the newest element\n\t\tif (!this.data.find(d => d.key === element)) {\n\t\t\tthis.data.push({key: element, value: new window.Set()});\n\t\t}\n\n\t\tconst index = this.data.findIndex(({key}) => key === element);\n\t\tthis.data[index].isAdded = true;\n\t\tconst {value} = this.data[index];\n\t\tthis.olderAcked = value.size >= this.limit;\n\t}\n\n\t/**\n\t * Allows knowing if the specified element is currently in the collection\n\t * @param {string} element\n\t * @return {boolean}\n\t */\n\thasElement(element) {\n\t\treturn !!this.data.find(d => d.key === element);\n\t}\n\n\t/**\n\t * Adds a new ack to the specified element from the specified user\n\t * @param {string} element\n\t * @param {string} user\n\t * @returns {boolean} true if the element reached the limit, false otherwise\n\t */\n\tappendAck(element, user) {\n\t\tif (!this.data.find(d => d.key === element)) {\n\t\t\tthrow new Error(`${element} doesn't exist`);\n\t\t}\n\t\t// Add user until key is found\n\t\tfor (const {key, value} of this.data) {\n\t\t\tvalue.add(user);\n\t\t\tif (key === element) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t// When limit is reached, remove every element until the one that reach the limit\n\t\tlet keyAcked = false;\n\t\tfor (let i = this.data.length - 1; i >= 0; i--) {\n\t\t\tconst value = this.data[i].value;\n\t\t\tconst key = this.data[i].key;\n\t\t\tif (!keyAcked && value.size === this.limit) {\n\t\t\t\tkeyAcked = key;\n\t\t\t\tthis.olderAcked = true; // We can assure any older message is already acked\n\t\t\t}\n\t\t\tif (keyAcked) {\n\t\t\t\tthis.data.splice(i, 1);\n\t\t\t}\n\t\t}\n\t\tthis.lastAckedBy[user] = element;\n\t\treturn keyAcked;\n\t}\n\n\tprependAck(element, user) {\n\t\tif (this.olderAcked) {\n\t\t\treturn;\n\t\t}\n\t\t// If it is the first ACK for an element, copy oldest one\n\t\tif (!this.data.find(d => d.key === element)) {\n\t\t\tconst prevValue = new window.Set(this.data[0] && this.data[0].value);\n\t\t\tthis.data.unshift({key: element, value: prevValue});\n\t\t}\n\t\t// Add user until key is found\n\t\tfor (const {key, value} of this.data) {\n\t\t\tvalue.add(user);\n\t\t\tif (key === element) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!this.lastAckedBy[user]) {\n\t\t\tthis.lastAckedBy[user] = element;\n\t\t}\n\t}\n\n\tisOlderAcked() {\n\t\treturn this.olderAcked;\n\t}\n\n\tgetLastAckedBy(user) {\n\t\treturn this.lastAckedBy[user];\n\t}\n}\n","import {List, Map} from 'immutable';\nimport {BehaviorSubject, combineLatest} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils/bindMethods';\nimport {FileUploadStatus} from '../file-sharing/FileUploadStatus';\nimport {ChatMessageFile} from './ChatMessageFile';\nimport {ChatMessage} from './ChatMessage';\nimport {ChatMessageDirection} from './ChatMessageDirection';\nimport {ChatMessageStatus} from './ChatMessageStatus';\nimport {ChatMessageType} from './ChatMessageType';\nimport {ChatType} from './ChatType';\nimport {ChatParticipantRole} from './ChatParticipantRole';\nimport {ChatParticipantState} from './ChatParticipantState';\nimport {AckCounter} from './AckCounter';\n\n/**\n * Provides access to methods for managing a chat room.\n * See {@link ChatManager} to find how Chat objects are obtained\n *\n * # Events\n * - `name`: Emitted every time the name changes\n * - `subject`: Emitted every time the subject changes.\n * - `participants`: Emitted every time the participants Map changes.\n * - `remoteParticipants`: Emitted every time the remoteParticipants Map changes.\n * - `messages` Emitted every time the messages List changes. (deprecated)\n * - `fileMessages` Emitted every time a fileMessages List changes.\n * - `pendingMessages` Emitted every time the pendingMessages List changes.\n * - `firstUnreadMessage` Emitted every time the firstUnreadMessage changes. (deprecated)\n *\n * Some events are deprecated because an observable is also provided. The use of the observable\n * is encouraged and events will be removed at some time in the future.\n */\nexport class Chat {\n\t/**\n\t * @protected\n\t * @return {Chat}\n\t */\n\tstatic newInstance(chatService, fileManager, user, {id, type, name, subject, participants} = {}) {\n\t\treturn new Chat(chatService, fileManager, user, id, type, name, subject, participants);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tconstructor(chatService, fileManager, user, id, type, name, subject, participants) {\n\t\t/** @private */\n\t\tthis.ownAddress = user.getAddress().toLowerCase();\n\n\t\t/** @private */\n\t\tthis.chatService = chatService;\n\t\t/** @private */\n\t\tthis.fileManager = fileManager;\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.type = type;\n\t\t/** @private */\n\t\tthis.name = name;\n\t\t/** @private */\n\t\tthis.subject = subject;\n\t\t/** @private */\n\t\tthis.participants = Map();\n\t\tthis.participants = this.participants.withMutations((mutableMap) => {\n\t\t\tparticipants.forEach(p => mutableMap.set(p.jid, p.affiliation));\n\t\t});\n\t\t/** @private */\n\t\tthis.remoteParticipants = Map();\n\t\tthis.remoteParticipants = this.remoteParticipants.withMutations((mutableMap) => {\n\t\t\tparticipants.filter(p => p.jid !== this.ownAddress)\n\t\t\t\t.forEach(p => mutableMap.set(p.jid, ChatParticipantState.ACTIVE));\n\t\t});\n\t\t/** @private */\n\t\tthis.pendingMessages = new List();\n\t\t/** @private */\n\t\tthis.messagesSubject = new BehaviorSubject(new List());\n\t\t/** @private */\n\t\tthis.fileMessages = new List();\n\t\t/** @private */\n\t\tthis.uploads = new window.Map();\n\t\t/** @private */\n\t\tthis.firstUnreadMessageSubject = new BehaviorSubject();\n\t\t/** @private */\n\t\tthis.lastInvitationTimestamp = null;\n\n\t\t/** @private */\n\t\tthis.lastRecoveredMessageId = null;\n\t\t/** @private */\n\t\tthis.oldestMessageRecovered = false;\n\t\t/** @private */\n\t\tthis.receivedMarkCounter = new AckCounter();\n\t\tthis.receivedMarkCounter.setLimit(this.participants.count());\n\t\t/** @private */\n\t\tthis.displayedMarkCounter = new AckCounter();\n\t\tthis.displayedMarkCounter.setLimit(this.participants.count());\n\t\t/** @private */\n\t\tthis.ownMessageCache = new window.Map();\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\t\tbindMethods(this, [\n\t\t\t'onReceived',\n\t\t\t'onDisplayed',\n\t\t\t'onState',\n\t\t\t'onMessage',\n\t\t\t'onMessageSent',\n\t\t\t'onMucPresence',\n\t\t\t'onMucConfig',\n\t\t]);\n\t}\n\n\t/** @protected */\n\tbindEventListeners() {\n\t\tthis.chatService.emitter.on(['received', this.id], this.onReceived);\n\t\tthis.chatService.emitter.on(['displayed', this.id], this.onDisplayed);\n\t\tthis.chatService.emitter.on(['state', this.id], this.onState);\n\t\tthis.chatService.emitter.on(['message', this.id], this.onMessage);\n\t\tthis.chatService.emitter.on(['message:sent', this.id], this.onMessageSent);\n\t\tif (this.type === ChatType.GROUP) {\n\t\t\tthis.chatService.emitter.on(['mucPresence', this.id], this.onMucPresence);\n\t\t\tthis.chatService.emitter.on(['mucConfig', this.id], this.onMucConfig);\n\t\t}\n\t}\n\n\t/** @protected */\n\tunbindEventListeners() {\n\t\tthis.chatService.emitter.off(['received', this.id], this.onReceived);\n\t\tthis.chatService.emitter.off(['displayed', this.id], this.onDisplayed);\n\t\tthis.chatService.emitter.off(['state', this.id], this.onState);\n\t\tthis.chatService.emitter.off(['message', this.id], this.onMessage);\n\t\tthis.chatService.emitter.off(['message:sent', this.id], this.onMessageSent);\n\t\tif (this.type === ChatType.GROUP) {\n\t\t\tthis.chatService.emitter.off(['mucPresence', this.id], this.onMucPresence);\n\t\t\tthis.chatService.emitter.off(['mucConfig', this.id], this.onMucConfig);\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onMessageSent(event) {\n\t\tif (event.received) {\n\t\t\tthis.onReceived({\n\t\t\t\tid: event.received,\n\t\t\t\tfrom: this.ownAddress,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (event.displayed) {\n\t\t\tthis.onDisplayed({\n\t\t\t\tid: event.displayed,\n\t\t\t\tfrom: this.ownAddress,\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (this.type === ChatType.GROUP) {\n\t\t\tthis.ownMessageCache.set(event.id, true);\n\t\t}\n\t\tconst type = event.links ? ChatMessageType.FILE : ChatMessageType.TEXT;\n\t\tconst data = event.links ? new ChatMessageFile(event.links[0].description, event.links[0].url) : event.body;\n\t\tconst message = ChatMessage.of(this.ownAddress, data, {\n\t\t\tid: event.id,\n\t\t\ttype,\n\t\t\tdirection: ChatMessageDirection.OUTGOING,\n\t\t\tstatus: ChatMessageStatus.SENT,\n\t\t\ttimestamp: event.timestamp,\n\t\t\tprogress: 100,\n\t\t});\n\t\tthis.appendMessage(message);\n\t}\n\n\t/** @private */\n\tupdateMessages(untilId, status) {\n\t\tconst lastIndex = this.messages.findLastIndex(message => message.getId() === untilId);\n\t\tthis.messagesSubject.next(this.messages.map((message, i) => i <= lastIndex ? message.with({status}) : message));\n\t}\n\n\t/** @private */\n\tonReceived(event) {\n\t\tif (!this.receivedMarkCounter.hasElement(event.id)) {\n\t\t\treturn;\n\t\t}\n\t\tconst lastId = this.receivedMarkCounter.appendAck(event.id, event.from);\n\t\tif (!lastId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.updateMessages(lastId, ChatMessageStatus.RECEIVED);\n\t\tif (this.firstUnreadMessage) {\n\t\t\tthis.firstUnreadMessageSubject.next(this.messages.find(message => message.getId() === this.firstUnreadMessage.getId()));\n\t\t\tthis.emitter.emit('firstUnreadMessage');\n\t\t}\n\t\tthis.emitter.emit('messages');\n\n\t\tlet changed = false;\n\t\tthis.messages.forEach((message) => {\n\t\t\tif (message.getType() === ChatMessageType.FILE) {\n\t\t\t\tchanged = true;\n\t\t\t\tconst i = this.fileMessages.findIndex(fileMessage => fileMessage.getId() === message.getId());\n\t\t\t\tthis.fileMessages = this.fileMessages.set(i, message);\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tthis.emitter.emit('fileMessages');\n\t\t}\n\t}\n\n\t/** @private */\n\tonDisplayed(event) {\n\t\tif (event.from === this.ownAddress) {\n\t\t\tthis.updateFirstUnreadMessage(event.id);\n\t\t}\n\t\tif (this.receivedMarkCounter.hasElement(event.id)) {\n\t\t\tthis.receivedMarkCounter.appendAck(event.id, event.from);\n\t\t}\n\t\tif (!this.displayedMarkCounter.hasElement(event.id)) {\n\t\t\treturn;\n\t\t}\n\t\tconst lastId = this.displayedMarkCounter.appendAck(event.id, event.from);\n\t\tif (!lastId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.updateMessages(lastId, ChatMessageStatus.DISPLAYED);\n\t\tif (this.firstUnreadMessage) {\n\t\t\tthis.firstUnreadMessageSubject.next(this.messages.find(message => message.getId() === this.firstUnreadMessage.getId()));\n\t\t\tthis.emitter.emit('firstUnreadMessage');\n\t\t}\n\t\tthis.emitter.emit('messages');\n\n\t\tlet changed = false;\n\t\tthis.messages.forEach((message) => {\n\t\t\tif (message.getType() === ChatMessageType.FILE) {\n\t\t\t\tchanged = true;\n\t\t\t\tconst i = this.fileMessages.findIndex(fileMessage => fileMessage.getId() === message.getId());\n\t\t\t\tthis.fileMessages = this.fileMessages.set(i, message);\n\t\t\t}\n\t\t});\n\t\tif (changed) {\n\t\t\tthis.emitter.emit('fileMessages');\n\t\t}\n\t}\n\n\t/** @private */\n\tonState(event) {\n\t\tif (event.from === this.ownAddress) {\n\t\t\treturn;\n\t\t}\n\t\tthis.updateRemoteParticipant(event.from, event.state);\n\t}\n\n\t/** @private */\n\tasync onMessage(event) {\n\t\tif (this.type === ChatType.GROUP && this.ownMessageCache.has(event.id)) {\n\t\t\tthis.ownMessageCache.delete(event.id);\n\t\t\treturn;\n\t\t}\n\t\tconst type = event.links ? ChatMessageType.FILE : ChatMessageType.TEXT;\n\t\tconst data = event.links ? new ChatMessageFile(event.links[0].description, event.links[0].url) : event.body;\n\t\tconst direction = event.from === this.ownAddress ? ChatMessageDirection.OUTGOING : ChatMessageDirection.INCOMING;\n\t\tconst status = direction === ChatMessageDirection.OUTGOING ? ChatMessageStatus.SENT : ChatMessageStatus.RECEIVED;\n\t\tconst message = ChatMessage.of(event.from, data, {\n\t\t\tid: event.id,\n\t\t\ttype,\n\t\t\tdirection,\n\t\t\ttimestamp: event.timestamp,\n\t\t\tstatus,\n\t\t\tprogress: 100,\n\t\t});\n\t\tthis.appendMessage(message);\n\t\tif (!this.firstUnreadMessage) {\n\t\t\tthis.firstUnreadMessageSubject.next(this.messages.last());\n\t\t\tthis.emitter.emit('firstUnreadMessage');\n\t\t}\n\t}\n\n\t/** @private */\n\tonMucPresence(event) {\n\t\tconst state = event.affiliation && event.affiliation !== 'none' ?\n\t\t\tthis.remoteParticipants.get(event.jid) || ChatParticipantState.ACTIVE : undefined;\n\t\tconst role = event.affiliation && event.affiliation !== 'none' ? event.affiliation : undefined;\n\t\tthis.updateRemoteParticipant(event.jid, state);\n\t\tthis.updateParticipant(event.jid, role);\n\t}\n\n\t/** @private */\n\tonMucConfig(event) {\n\t\tif (typeof event.name === 'string' && this.name !== event.name) {\n\t\t\tthis.name = event.name;\n\t\t\tthis.emitter.emit('name');\n\t\t}\n\t\tif (typeof event.subject === 'string' && this.subject !== event.subject) {\n\t\t\tthis.subject = event.subject;\n\t\t\tthis.emitter.emit('subject');\n\t\t}\n\t}\n\n\t/** @private */\n\tupdateRemoteParticipant(id, state) {\n\t\tif (!state) {\n\t\t\tthis.remoteParticipants = this.remoteParticipants.delete(id);\n\t\t} else {\n\t\t\tthis.remoteParticipants = this.remoteParticipants.set(id, state);\n\t\t}\n\t\tthis.emitter.emit('remoteParticipants');\n\t}\n\n\t/** @private */\n\tupdateParticipant(id, role) {\n\t\tif (!role) {\n\t\t\tthis.participants = this.participants.delete(id);\n\t\t} else {\n\t\t\tthis.participants = this.participants.set(id, role);\n\t\t}\n\t\tthis.receivedMarkCounter.setLimit(this.participants.count());\n\t\tthis.displayedMarkCounter.setLimit(this.participants.count());\n\t\tthis.emitter.emit('participants');\n\t}\n\n\t/**\n\t * Recovers older messages of this chat. At least the number of messages specified is guaranteed\n\t * to be recovered from the server if available. Only if the oldest message is reached a lower\n\t * number of messages will be recovered. If that happens, it could be detected using\n\t * {@link Chat#isOldestMessageRecovered}.\n\t * Recovered messages will be included in the list of messages that is returned using {@link Chat#getMessages}.\n\t * and are guaranteed to be accessible when the promise returned by this method is resolved.\n\t * @param {number} [minimum=10] The minimum number of messages that will be retrieved if available.\n\t * @return {Promise<void>}\n\t */\n\tasync fetch(minimum = 10) {\n\t\tif (this.oldestMessageRecovered) {\n\t\t\tif (this.type === ChatType.GROUP && this.messages.isEmpty()) {\n\t\t\t\tconst res = await this.chatService.fetchMessages(this.id, 'chat', null, 1);\n\t\t\t\tif (res.results.length > 0) {\n\t\t\t\t\tconst message = res.results[0];\n\t\t\t\t\tthis.lastInvitationTimestamp = message.timestamp;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst history = await this.chatService.fetchMessages(this.id, this.type, this.lastRecoveredMessageId, 10 * minimum);\n\t\tfor (const item of history.results) {\n\t\t\tconst composer = item.from;\n\t\t\tif (item.received) {\n\t\t\t\tthis.receivedMarkCounter.prependAck(item.received, composer);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (item.displayed) {\n\t\t\t\tthis.receivedMarkCounter.prependAck(item.displayed, composer);\n\t\t\t\tthis.displayedMarkCounter.prependAck(item.displayed, composer);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst id = item.id;\n\t\t\tif (this.messages.find(message => id === message.getId())) {\n\t\t\t\tcontinue; // Duplicate message\n\t\t\t}\n\t\t\tthis.receivedMarkCounter.prepend(id);\n\t\t\tthis.displayedMarkCounter.prepend(id);\n\t\t\tconst direction = this.ownAddress === composer ? ChatMessageDirection.OUTGOING : ChatMessageDirection.INCOMING;\n\n\t\t\tconst nextMessage = this.messages.first();\n\t\t\tlet status;\n\t\t\tif (nextMessage && nextMessage.getStatus() === ChatMessageStatus.DISPLAYED || this.displayedMarkCounter.isOlderAcked()) {\n\t\t\t\tstatus = ChatMessageStatus.DISPLAYED;\n\t\t\t} else if (nextMessage && nextMessage.getStatus() === ChatMessageStatus.RECEIVED || this.receivedMarkCounter.isOlderAcked()) {\n\t\t\t\tstatus = ChatMessageStatus.RECEIVED;\n\t\t\t} else {\n\t\t\t\tstatus = ChatMessageStatus.SENT;\n\t\t\t}\n\n\t\t\tconst timestamp = item.timestamp;\n\t\t\tconst type = item.links ? ChatMessageType.FILE : ChatMessageType.TEXT;\n\t\t\tconst data = item.links ? new ChatMessageFile(item.links[0].description, item.links[0].url) : item.body;\n\t\t\tconst message = ChatMessage.of(composer, data, {id, direction, type, timestamp, status});\n\n\t\t\tminimum--;\n\t\t\tthis.messagesSubject.next(this.messages.unshift(message));\n\t\t}\n\t\tif (history.complete) {\n\t\t\tthis.oldestMessageRecovered = true;\n\t\t} else {\n\t\t\tthis.lastRecoveredMessageId = history.paging.first;\n\t\t}\n\n\t\tif (this.messages.count()) {\n\t\t\t// Mark as received latest message if not done before\n\t\t\tconst lastReceivedMessageId = this.receivedMarkCounter.getLastAckedBy(this.ownAddress);\n\t\t\tif (this.messages.last().getId() !== lastReceivedMessageId) {\n\t\t\t\tawait this.chatService.markReceived(this.id, this.messages.last().getId(), this.type);\n\t\t\t}\n\t\t\tthis.updateFirstUnreadMessage(this.displayedMarkCounter.getLastAckedBy(this.ownAddress));\n\t\t}\n\n\t\t// Request more messages if minimum quantity was not retrieved\n\t\tif (minimum > 0) {\n\t\t\treturn this.fetch(minimum);\n\t\t}\n\t\tthis.emitter.emit('messages');\n\t}\n\n\t/** @private */\n\tupdateFirstUnreadMessage(lastDisplayedMessageId) {\n\t\tconst oldFirstUnreadMessage = this.firstUnreadMessage;\n\t\tif (!lastDisplayedMessageId) {\n\t\t\tthis.firstUnreadMessageSubject.next(this.messages.first());\n\t\t} else {\n\t\t\tconst lastReadMessageIndex = this.messages.findIndex(message => message.getId() === lastDisplayedMessageId);\n\t\t\tthis.firstUnreadMessageSubject.next(this.messages.get(lastReadMessageIndex + 1));\n\t\t}\n\t\tif (this.firstUnreadMessage !== oldFirstUnreadMessage) {\n\t\t\tthis.emitter.emit('firstUnreadMessage');\n\t\t}\n\t}\n\n\t/**\n\t * Indicates if the oldest message of the chat has already been recovered.\n\t * @return {boolean}\n\t */\n\tisOldestMessageRecovered() {\n\t\treturn this.oldestMessageRecovered;\n\t}\n\n\t/**\n\t * Retrieves messages since last message fetching (new messages)\n\t *\n\t * This is to catch up from the server's MAM\n\t *\n\t * @return {Promise<void>}\n\t */\n\tasync sync() {\n\t\tconst lastMessage = this.messages.last();\n\t\tif (!lastMessage) {\n\t\t\treturn this.fetch();\n\t\t}\n\t\tconst since = lastMessage.getTimestamp();\n\t\tconst results = await this.chatService.sync(this.getId(), this.type, since);\n\t\tfor (const item of results) {\n\t\t\tif (item.received) {\n\t\t\t\tthis.onReceived({\n\t\t\t\t\tid: item.received,\n\t\t\t\t\tfrom: item.from,\n\t\t\t\t});\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (item.displayed) {\n\t\t\t\tthis.onDisplayed({\n\t\t\t\t\tid: item.displayed,\n\t\t\t\t\tfrom: item.from,\n\t\t\t\t});\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this.messages.find(message => message.getId() === item.id)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst type = item.links ? ChatMessageType.FILE : ChatMessageType.TEXT;\n\t\t\tconst data = item.links ? new ChatMessageFile(item.links[0].description, item.links[0].url) : item.body;\n\t\t\tconst direction = this.ownAddress === item.from ? ChatMessageDirection.OUTGOING : ChatMessageDirection.INCOMING;\n\t\t\tconst message = ChatMessage.of(item.from, data, {\n\t\t\t\tid: item.id,\n\t\t\t\ttype,\n\t\t\t\tdirection: direction,\n\t\t\t\tstatus: ChatMessageStatus.SENT,\n\t\t\t\ttimestamp: item.timestamp,\n\t\t\t});\n\t\t\tthis.appendMessage(message);\n\t\t\tif (!this.firstUnreadMessage) {\n\t\t\t\tthis.firstUnreadMessageSubject.next(this.messages.last());\n\t\t\t\tthis.emitter.emit('firstUnreadMessage');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * The ID of this chat. The ID is only locally unique as it is derived from the\n\t * remote participant in the case of individual chats and from the room address\n\t * for group chats.\n\t * @return {string} Unique identifier of the chat\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * Returns the type of the chat.\n\t * @return {ChatType} Type of the chat\n\t */\n\tgetType() {\n\t\treturn this.type;\n\t}\n\n\t/**\n\t * Returns the name of the chat. This is only applicable for group chats.\n\t * @return {string} Name of the chat\n\t */\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\t/**\n\t * Changes the name of the chat. This is only applicable for group chats.\n\t * @param {string} name The new name\n\t * @return {Promise}\n\t */\n\tasync setName(name) {\n\t\tawait this.chatService.setRoomName(this.id, name);\n\t\tthis.onMucConfig({name});\n\t}\n\n\t/**\n\t * Returns the subject of the chat. This is only applicable for group chats\n\t * @return {string} Subject of the chat\n\t */\n\tgetSubject() {\n\t\treturn this.subject;\n\t}\n\n\t/**\n\t * Changes the subject of the chat group. This is only applicable for group chats\n\t * @param {string} subject The new subject\n\t * @return {Promise}\n\t */\n\tasync setSubject(subject) {\n\t\tawait this.chatService.setRoomSubject(this.id, subject);\n\t\tthis.onMucConfig({subject});\n\t}\n\n\t/**\n\t * Returns the role of the user in the chat. This is only applicable for group chats.\n\t * @return {ChatParticipantRole} The role of this user in the chat\n\t */\n\tgetRole() {\n\t\treturn this.getParticipants().get(this.ownAddress);\n\t}\n\n\t/**\n\t * Returns a Map with the state of each remote participant.\n\t * @return {ImmutableMap<string, ChatParticipantState>}\n\t */\n\tgetRemoteParticipants() {\n\t\treturn this.remoteParticipants;\n\t}\n\n\t/**\n\t * Returns a Map with the role of each participant.\n\t * @return {ImmutableMap<string, ChatParticipantRole>}\n\t */\n\tgetParticipants() {\n\t\treturn this.participants;\n\t}\n\n\t/**\n\t * Adds a new participant to the chat.\n\t * @param {string} participant The address of the user that wants to be added\n\t * @return {Promise}\n\t */\n\tasync addParticipant(participant) {\n\t\tparticipant = participant.toLowerCase();\n\t\tawait this.chatService.invite(this.id, participant);\n\t\tthis.updateRemoteParticipant(participant, ChatParticipantState.ACTIVE);\n\t\tthis.updateParticipant(participant, ChatParticipantRole.MEMBER);\n\t}\n\n\t/**\n\t * Expels a participant from the chat.\n\t * @param {string} participant The address of the user that will be expelled\n\t * @return {Promise}\n\t */\n\texpelParticipant(participant) {\n\t\treturn this.chatService.expel(this.id, participant);\n\t}\n\n\t/**\n\t * Changes the role of a chat participant.\n\t * @param {string} participant The address of the user whose role wants to be changed\n\t * @param {ChatParticipantRole} role The new role of this participant\n\t * @return {Promise}\n\t */\n\tsetParticipantRole(participant, role) {\n\t\treturn this.chatService.setParticipantRole(this.id, participant, role);\n\t}\n\n\t/**\n\t * Leaves the group chat. Only group chats can be deleted and only members can leave them.\n\t * Admins need to stop being an admin before.\n\t * @return {Promise}\n\t */\n\tasync leave() {\n\t\tif (this.getRole() === ChatParticipantRole.ADMIN) {\n\t\t\tthrow Error('Admins cannot leave room');\n\t\t}\n\t\treturn this.chatService.leave(this.id);\n\t}\n\n\t/**\n\t * Removes the group chat. Only group chats can be deleted and only admins can delete them.\n\t * @return {Promise}\n\t */\n\tasync delete() {\n\t\tif (this.getType() !== ChatType.GROUP) {\n\t\t\tthrow Error('Only group chats can be deleted');\n\t\t}\n\t\tawait this.chatService.destroy(this.getId());\n\t}\n\n\t/**\n\t * Removes the chat from the list of chats. Only individual chats can be archived.\n\t * Group chats need to be leaved or deleted instead.\n\t * @return {Promise}\n\t */\n\tasync archive() {\n\t\tif (this.getType() !== ChatType.INDIVIDUAL) {\n\t\t\tthrow Error('Only individual chats can be archived');\n\t\t}\n\t\tawait this.chatService.deleteIndividualChat(this.getId());\n\t}\n\n\t/**\n\t * Updates the state of the local participant in the chat.\n\t * @param {ChatParticipantState} state the new state of the local particpant\n\t * @return {Promise}\n\t */\n\tsetState(state) {\n\t\treturn this.chatService.setState(this.getId(), this.type, state);\n\t}\n\n\t/** @private */\n\tappendMessage(message) {\n\t\tthis.receivedMarkCounter.append(message.getId());\n\t\tthis.displayedMarkCounter.append(message.getId());\n\t\tthis.messagesSubject.next(this.messages.push(message));\n\t\tthis.emitter.emit('messages', message);\n\t\tif (message.getType() === ChatMessageType.FILE) {\n\t\t\tthis.fileMessages = this.fileMessages.push(message);\n\t\t\tthis.emitter.emit('fileMessages', message);\n\t\t}\n\t}\n\n\t/**\n\t * Sends a new text message.\n\t * @param {string} text The text of the new message\n\t * @return {Promise} Resolved when the message is received by the server\n\t */\n\tasync sendText(text) {\n\t\tconst pendingMsg = ChatMessage.of(this.ownAddress, text, {\n\t\t\tdirection: ChatMessageDirection.OUTGOING,\n\t\t\ttimestamp: Date.now(),\n\t\t});\n\t\tthis.pendingMessages = this.pendingMessages.push(pendingMsg);\n\t\tthis.emitter.emit('pendingMessages');\n\t\ttry {\n\t\t\tawait this.chatService.sendMessage(this.id, this.type, text);\n\t\t} catch (error) {\n\t\t\tconst message = pendingMsg.with({status: ChatMessageStatus.ERROR});\n\t\t\tthis.pendingMessages = this.pendingMessages.map(msg => msg === pendingMsg ? message : msg);\n\t\t\tthis.emitter.emit('pendingMessages');\n\t\t\tthrow error;\n\t\t}\n\t\tthis.pendingMessages = this.pendingMessages.filter(msg => msg !== pendingMsg);\n\t\tthis.emitter.emit('pendingMessages');\n\t\tawait this.resetUnreadMessageCount();\n\t}\n\n\t/**\n\t * Sends a new file message.\n\t * @param {File} file A file that wants to be sent to this chat\n\t * @return {Promise} Resolved when the message is received by the server\n\t */\n\tasync sendFile(file) {\n\t\tconst fileUploadManager = await this.fileManager.getFileUploadManager();\n\t\tconst fileUploadId = await fileUploadManager.create(file);\n\t\tawait new Promise(resolve => fileUploadManager.emitter.once([fileUploadId, 'start'], resolve));\n\n\t\tlet pendingMsg = ChatMessage.of(this.ownAddress, new ChatMessageFile(file.name), {\n\t\t\tdirection: ChatMessageDirection.OUTGOING,\n\t\t\ttimestamp: Date.now(),\n\t\t\ttype: ChatMessageType.FILE,\n\t\t});\n\t\tthis.pendingMessages = this.pendingMessages.push(pendingMsg);\n\t\tthis.uploads.set(pendingMsg, fileUploadId);\n\t\tthis.emitter.emit('pendingMessages', pendingMsg, null);\n\n\t\tlet updatePendingMessage = () => {\n\t\t\tconst fileUpload = fileUploadManager.getFileUploads().get(fileUploadId);\n\t\t\tconst progress = fileUpload.getProgress();\n\t\t\tconst data = new ChatMessageFile(fileUpload.getName(), fileUpload.getUrl());\n\t\t\tconst nextMessage = pendingMsg.with({progress, data});\n\t\t\tthis.pendingMessages = this.pendingMessages.map(msg => msg === pendingMsg ? nextMessage : msg);\n\t\t\tthis.uploads.delete(pendingMsg);\n\t\t\tthis.uploads.set(nextMessage, fileUploadId);\n\t\t\tthis.emitter.emit('pendingMessages', nextMessage, pendingMsg);\n\t\t\tpendingMsg = nextMessage;\n\t\t};\n\t\tfileUploadManager.emitter.on([fileUploadId, 'progress'], updatePendingMessage);\n\n\t\ttry {\n\t\t\tthis.uploads.delete(pendingMsg);\n\t\t\tconst fileUpload = await fileUploadManager.waitForEnd(fileUploadId);\n\t\t\tif (fileUpload.getStatus() !== FileUploadStatus.COMPLETED) {\n\t\t\t\tthis.pendingMessages = this.pendingMessages.filter(msg => msg !== pendingMsg);\n\t\t\t\tthis.emitter.emit('pendingMessages');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.chatService.sendFile(this.id, this.type, fileUpload.getUrl(), fileUpload.getName());\n\t\t} catch (error) {\n\t\t\tconst newMessage = pendingMsg.with({status: ChatMessageStatus.ERROR});\n\t\t\tthis.pendingMessages = this.pendingMessages.map(msg => msg === pendingMsg ? newMessage : msg);\n\t\t\tthis.emitter.emit('pendingMessages');\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tconst fileUpload = fileUploadManager.getFileUploads().get(fileUploadId);\n\t\t\tfileUploadManager.emitter.off([fileUploadId, 'progress'], updatePendingMessage);\n\t\t\tfileUploadManager.remove(fileUpload);\n\t\t}\n\t\tthis.pendingMessages = this.pendingMessages.filter(msg => msg !== pendingMsg);\n\t\tthis.emitter.emit('pendingMessages');\n\t\tawait this.resetUnreadMessageCount();\n\t}\n\n\t/**\n\t * Cancels a pending file message. This is only applicable for file messages.\n\t * @param {ChatMessage} message The chat message that wants to be cancelled.\n\t * @return {Promise<void>}\n\t */\n\tasync cancelPendingMessage(message) {\n\t\tif (!this.pendingMessages.includes(message) || message.getType() !== ChatMessageType.FILE) {\n\t\t\tthrow Error('Invalid message');\n\t\t}\n\t\tconst fileUploadManager = await this.fileManager.getFileUploadManager();\n\t\tconst fileUploadId = this.uploads.get(message);\n\t\tconst fileUpload = fileUploadManager.getFileUploads().get(fileUploadId);\n\t\tawait fileUploadManager.abort(fileUpload);\n\t}\n\n\t/**\n\t * Returns the timestamp of the last sent or received message including group invitations\n\t * @return {number}\n\t */\n\tgetLastMessageTimestamp() {\n\t\tif (this.getMessages().size > 0) {\n\t\t\treturn this.getMessages().last().getTimestamp();\n\t\t}\n\t\treturn this.lastInvitationTimestamp;\n\t}\n\n\t/**\n\t * Returns the list of messages that have not been received by the server yet.\n\t * @return {ImmutableList<ChatMessage>}\n\t */\n\tgetPendingMessages() {\n\t\treturn this.pendingMessages;\n\t}\n\n\t/**\n\t * Returns the list of chat messages.\n\t * @return {ImmutableList<ChatMessage>}\n\t */\n\tgetMessages$() {\n\t\treturn this.messagesSubject.asObservable();\n\t}\n\n\t/**\n\t * Returns the list of chat messages.\n\t * @return {ImmutableList<ChatMessage>}\n\t */\n\tgetMessages() {\n\t\treturn this.messagesSubject.value;\n\t}\n\n\t/**\n\t * The list of chat messages.\n\t * @type {ImmutableList<ChatMessage>}\n\t */\n\tget messages() {\n\t\treturn this.messagesSubject.value;\n\t}\n\n\t/**\n\t * Returns the list of chat messages with file type.\n\t * @return {ImmutableList<ChatMessage>}\n\t */\n\tgetFileMessages() {\n\t\treturn this.fileMessages;\n\t}\n\n\t/**\n\t * Returns an Observable of the first unread message or undefined if every message is already read.\n\t * @return {Observable<ChatMessage>}\n\t */\n\tgetFirstUnreadMessage$() {\n\t\treturn this.firstUnreadMessageSubject.asObservable();\n\t}\n\n\t/**\n\t * Returns the first unread message or undefined if every message is already read.\n\t * @return {ChatMessage}\n\t */\n\tgetFirstUnreadMessage() {\n\t\treturn this.firstUnreadMessage;\n\t}\n\n\t/**\n\t * The the first unread message or undefined if every message is already read.\n\t * @type {ChatMessage}\n\t */\n\tget firstUnreadMessage() {\n\t\treturn this.firstUnreadMessageSubject.value;\n\t}\n\n\t/**\n\t * Returns the count of unread messages.\n\t * @return {number}\n\t */\n\tgetUnreadMessageCount() {\n\t\treturn this.messages.skipUntil(message => message === this.firstUnreadMessage).count();\n\t}\n\n\t/**\n\t * Returns an observable of the count of unread messages.\n\t * @return {Observable<number>}\n\t */\n\tgetUnreadMessageCount$() {\n\t\treturn combineLatest(this.messagesSubject, this.firstUnreadMessageSubject).pipe(\n\t\t\tmap(([messages, firstUnreadMessage]) => messages.skipUntil(message => message === firstUnreadMessage).count()),\n\t\t);\n\t}\n\n\t/**\n\t * Resets the count of unread messages.\n\t * @return {Promise}\n\t */\n\tasync resetUnreadMessageCount() {\n\t\tconst lastMessage = this.messages.last();\n\t\tif (!lastMessage || lastMessage.getStatus() === ChatMessageStatus.DISPLAYED) {\n\t\t\treturn;\n\t\t}\n\t\tawait this.chatService.markDisplayed(this.id, lastMessage.getId(), this.type);\n\t\tif (this.type === ChatType.GROUP) {\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tconst onDisplayed = (event) => {\n\t\t\t\t\tif (event.id === lastMessage.getId() && event.from === this.ownAddress) {\n\t\t\t\t\t\tthis.chatService.emitter.off(['displayed', this.id], onDisplayed);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.chatService.emitter.on(['displayed', this.id], onDisplayed);\n\t\t\t});\n\t\t}\n\t}\n}\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import {EventEmitter2} from 'eventemitter2';\nimport qs from 'query-string';\nimport generate from 'nanoid/generate';\nimport {JID} from 'stanza';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/ChatService');\n\nconst SERVER_CHAT_INVITE_REASONS = {\n\tCONFERENCE: \"You've been added to the conference's chat room\",\n\tSUPPORT: 'supportChat',\n};\n\nexport const CHAT_INVITE_REASONS = {\n\tCONFERENCE: 'conference',\n\tSUPPORT: 'support',\n};\n\nconst castServerReason = (reason) => {\n\tswitch (reason) {\n\t\tcase SERVER_CHAT_INVITE_REASONS.CONFERENCE:\n\t\t\treturn CHAT_INVITE_REASONS.CONFERENCE;\n\t\tcase SERVER_CHAT_INVITE_REASONS.SUPPORT:\n\t\t\treturn CHAT_INVITE_REASONS.SUPPORT;\n\t\tdefault:\n\t\t\treturn reason;\n\t}\n};\n\nexport class ChatService {\n\tconstructor(wacRequest, xmppClient, pushUri) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.xmppClient = xmppClient;\n\t\tthis.pushUri = pushUri;\n\t\tthis.emitter = new EventEmitter2({wildcard: true});\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, [\n\t\t\t'onIndividualChatChanges',\n\t\t\t'onMarkerReceived',\n\t\t\t'onMarkerDisplayed',\n\t\t\t'onMucInvite',\n\t\t\t'onMucLeave',\n\t\t\t'onMucTopic',\n\t\t\t'onMucOther',\n\t\t\t'onChat',\n\t\t\t'onChatState',\n\t\t\t'onPresence',\n\t\t\t'onMessage',\n\t\t\t'onMessageError',\n\t\t\t'onMessageSent',\n\t\t]);\n\t}\n\n\tstart() {\n\t\tthis.wacRequest.emitter.on('xmpp/individualChatList/*', this.onIndividualChatChanges);\n\t\tthis.xmppClient.emitter.on('marker:received', this.onMarkerReceived);\n\t\tthis.xmppClient.emitter.on('marker:displayed', this.onMarkerDisplayed);\n\t\tthis.xmppClient.emitter.on('muc:invite', this.onMucInvite);\n\t\tthis.xmppClient.emitter.on('muc:leave', this.onMucLeave);\n\t\tthis.xmppClient.emitter.on('muc:topic', this.onMucTopic);\n\t\tthis.xmppClient.emitter.on('muc:other', this.onMucOther);\n\t\tthis.xmppClient.emitter.on('chat', this.onChat);\n\t\tthis.xmppClient.emitter.on('groupchat', this.onChat);\n\t\tthis.xmppClient.emitter.on('chat:state', this.onChatState);\n\t\tthis.xmppClient.emitter.on('presence', this.onPresence);\n\t\tthis.xmppClient.emitter.on('message', this.onMessage);\n\t\tthis.xmppClient.emitter.on('message:sent', this.onMessageSent);\n\t\tthis.xmppClient.emitter.on('message:error', this.onMessageError);\n\t\treturn this.xmppClient.start();\n\t}\n\n\tstop() {\n\t\tthis.wacRequest.emitter.off('xmpp/individualChatList/*', this.onIndividualChatChanges);\n\t\tthis.xmppClient.emitter.off('marker:received', this.onMarkerReceived);\n\t\tthis.xmppClient.emitter.off('marker:displayed', this.onMarkerDisplayed);\n\t\tthis.xmppClient.emitter.off('muc:invite', this.onMucInvite);\n\t\tthis.xmppClient.emitter.off('muc:leave', this.onMucLeave);\n\t\tthis.xmppClient.emitter.off('muc:topic', this.onMucTopic);\n\t\tthis.xmppClient.emitter.off('muc:other', this.onMucOther);\n\t\tthis.xmppClient.emitter.off('chat', this.onChat);\n\t\tthis.xmppClient.emitter.off('groupchat', this.onChat);\n\t\tthis.xmppClient.emitter.off('chat:state', this.onChatState);\n\t\tthis.xmppClient.emitter.off('presence', this.onPresence);\n\t\tthis.xmppClient.emitter.off('message', this.onMessage);\n\t\tthis.xmppClient.emitter.off('message:sent', this.onMessageSent);\n\t\tthis.xmppClient.emitter.off('message:error', this.onMessageError);\n\t\treturn this.xmppClient.stop();\n\t}\n\n\tsuspend() {\n\t\treturn this.xmppClient.suspend();\n\t}\n\n\tresume() {\n\t\treturn this.xmppClient.resume();\n\t}\n\n\tonIndividualChatChanges(event) {\n\t\tconst participant = event.path.split('/').pop();\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\t\tthis.emitter.emit('individualChatAdded', participant);\n\t\t\t\tbreak;\n\t\t\tcase 'delete':\n\t\t\t\tthis.emitter.emit('individualChatDeleted', participant);\n\t\t\t\tbreak;\n\t\t\t// no default\n\t\t}\n\t}\n\n\tonMarkerReceived(event) {\n\t\tthis.emitter.emit(['received', JID.toBare(event.from)], {\n\t\t\tchat: JID.toBare(event.from),\n\t\t\tfrom: event.type === 'groupchat' ? JID.getResource(event.from) : JID.toBare(event.from),\n\t\t\tid: event.marker.id,\n\t\t});\n\t}\n\n\tonMarkerDisplayed(event) {\n\t\tthis.emitter.emit(['displayed', JID.toBare(event.from)], {\n\t\t\tchat: JID.toBare(event.from),\n\t\t\tfrom: event.type === 'groupchat' ? JID.getResource(event.from) : JID.toBare(event.from),\n\t\t\tid: event.marker.id,\n\t\t});\n\t}\n\n\tonChat(event) {\n\t\tconst from = event.type === 'groupchat' ? JID.getResource(event.from) : JID.toBare(event.from);\n\t\tconst timestamp = event.delay ? new Date(event.delay.timestamp).getTime() : Date.now();\n\t\tthis.emitter.emit('chat', {type: event.type, id: JID.toBare(event.from)});\n\t\tthis.emitter.emit(['message', JID.toBare(event.from)], {\n\t\t\tchat: JID.toBare(event.from),\n\t\t\ttype: event.type,\n\t\t\tid: event.id,\n\t\t\tfrom,\n\t\t\tto: JID.toBare(event.to),\n\t\t\ttimestamp,\n\t\t\tbody: event.body,\n\t\t\tlinks: event.links,\n\t\t});\n\t}\n\n\tonMucInvite(event) {\n\t\tthis.emitter.emit('mucInvite', {\n\t\t\tchatId: JID.toBare(event.room),\n\t\t\tconferenceChat: event.reason === SERVER_CHAT_INVITE_REASONS.CONFERENCE,\n\t\t\treason: castServerReason(event.reason),\n\t\t});\n\t}\n\n\tonMucLeave(event) {\n\t\tthis.emitter.emit('mucEnd', {chatId: JID.toBare(event.from)});\n\t}\n\n\tonMucTopic(event) {\n\t\tthis.emitter.emit(['mucConfig', JID.toBare(event.from)], {\n\t\t\tsubject: event.topic,\n\t\t});\n\t}\n\n\tasync onMucOther(event) {\n\t\tif (event.muc.jid) {\n\t\t\tif (JID.getLocal(event.muc.jid) === 'admin' || JID.equal(event.muc.jid, event.to)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emitter.emit(['mucPresence', event.from], {\n\t\t\t\tjid: JID.toBare(event.muc.jid),\n\t\t\t\taffiliation: event.muc.affiliation,\n\t\t\t\trole: event.muc.role,\n\t\t\t});\n\t\t} else if (event.muc.statusCodes && event.muc.statusCodes.includes('104')) {\n\t\t\tconst info = await this.getRoomInfo(event.from);\n\t\t\tthis.emitter.emit(['mucConfig', event.from], info);\n\t\t}\n\t}\n\n\tonChatState(event) {\n\t\tconst from = event.type === 'groupchat' ? JID.getResource(event.from) : JID.toBare(event.from);\n\t\tthis.emitter.emit(['state', JID.toBare(event.from)], {\n\t\t\tfrom,\n\t\t\tto: JID.toBare(event.to),\n\t\t\tstate: event.chatState,\n\t\t});\n\t}\n\n\tonPresence(event) {\n\t\tif (event.muc && event.muc.jid) {\n\t\t\tif (JID.getLocal(event.muc.jid) === 'admin') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (JID.equalBare(event.muc.jid, event.to)) {\n\t\t\t\tif (event.muc.affiliation === 'none') {\n\t\t\t\t\tthis.emitter.emit('mucEnd', {chatId: JID.toBare(event.from)});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.emitter.emit(['mucPresence', JID.toBare(event.from)], {\n\t\t\t\tjid: JID.toBare(event.muc.jid),\n\t\t\t\taffiliation: event.muc.affiliation,\n\t\t\t\trole: event.muc.role,\n\t\t\t});\n\t\t}\n\t}\n\n\tonMessageSent(event) {\n\t\tif (event.type !== 'chat' && event.type !== 'groupchat') {\n\t\t\treturn;\n\t\t}\n\t\tconst datum = {\n\t\t\tchat: JID.toBare(event.to),\n\t\t\ttype: event.type,\n\t\t\tid: event.id,\n\t\t\tto: JID.toBare(event.to),\n\t\t\ttimestamp: event.delay ? new Date(event.delay.timestamp).getTime() : Date.now(),\n\t\t\tbody: event.body,\n\t\t\tlinks: event.links,\n\t\t};\n\t\tif (event.marker) {\n\t\t\tif (event.marker.type === 'received') {\n\t\t\t\tdatum.received = event.marker.id;\n\t\t\t} else if (event.marker.type === 'displayed') {\n\t\t\t\tdatum.displayed = event.marker.id;\n\t\t\t}\n\t\t}\n\t\tthis.emitter.emit(['message:sent', JID.toBare(event.to)], datum);\n\t}\n\n\tonMessage(event) {\n\t\tif (event.body && event.id) {\n\t\t\tlocalStorage.setItem('sippo:lastXmppTimestamp', Date.now());\n\t\t}\n\t}\n\n\tonMessageError(event) {\n\t\tlog.error(event);\n\t}\n\n\tasync getIndividualChats() {\n\t\tconst res = await this.wacRequest.get('xmpp/individualChatList/');\n\t\treturn res.chats;\n\t}\n\n\taddIndividualChat(jid) {\n\t\treturn this.wacRequest.put(`xmpp/individualChatList/${jid}`);\n\t}\n\n\tdeleteIndividualChat(jid) {\n\t\treturn this.wacRequest.delete(`xmpp/individualChatList/${jid}`);\n\t}\n\n\tasync getRoomInfo(jid) {\n\t\tconst res = await this.xmppClient.getDiscoInfo(jid);\n\t\tconst fields = res.extensions[0].fields;\n\t\tlet ret = {};\n\t\tfor (const field of fields) {\n\t\t\tif (field.name === 'muc#roomconfig_roomname') {\n\t\t\t\tret.name = field.value || '';\n\t\t\t} else if (field.name === 'muc#roominfo_description') {\n\t\t\t\tret.subject = field.value || '';\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync getBookmarks() {\n\t\tconst bookmarks = await this.xmppClient.getBookmarks();\n\t\treturn bookmarks.map(group => group.jid);\n\t}\n\n\taddBookmark(jid) {\n\t\treturn this.xmppClient.addBookmark({jid});\n\t}\n\n\tremoveBookmark(jid) {\n\t\treturn this.xmppClient.removeBookmark(jid);\n\t}\n\n\tasync createRoom(creator, name = '', subject = '') {\n\t\tconst alphabet = '0123456789_abcdefghijklmnopqrstuvwxyz-';\n\t\tconst jid = `${generate(alphabet, 28)}@conference.${JID.getDomain(creator)}`;\n\t\tawait this.xmppClient.joinRoom(jid, creator);\n\t\tconst form = await this.xmppClient.getRoomConfig(jid);\n\t\tconst fields = form.fields.map((field) => {\n\t\t\tif (field.name === 'FORM_TYPE') {\n\t\t\t\treturn {name: field.name, value: field.value};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_roomname') {\n\t\t\t\treturn {name: field.name, value: name};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_roomdesc') {\n\t\t\t\treturn {name: field.name, value: subject};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_persistentroom') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_publicroom') {\n\t\t\t\treturn {name: field.name, value: '0'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_membersonly') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\tif (field.name === '{http://prosody.im/protocol/muc}roomconfig_allowmemberinvites') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_allowinvites') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_changesubject') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_moderatedroom') {\n\t\t\t\treturn {name: field.name, value: '0'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_whois') {\n\t\t\t\treturn {name: field.name, value: 'anyone'};\n\t\t\t}\n\t\t\tif (field.name === 'muc#roomconfig_enablearchiving') {\n\t\t\t\treturn {name: field.name, value: '1'};\n\t\t\t}\n\t\t\t// From XEP-0045. If the client wishes to receive no history, it MUST set the 'maxchars' attribute to a value of \"0\" (zero).\n\t\t\t// Even the client set maxchars to zero, the history is received. Until xmpp fix the bug, the room will not send the history.\n\t\t\tif (field.name === 'muc#roomconfig_historylength') {\n\t\t\t\treturn {name: field.name, value: '0'};\n\t\t\t}\n\t\t}).filter(field => field);\n\t\tawait this.xmppClient.configureRoom(jid, {fields});\n\t\treturn jid;\n\t}\n\n\tasync setRoomName(jid, name) {\n\t\ttry {\n\t\t\tconst form = await this.xmppClient.getRoomConfig(jid);\n\t\t\tconst fields = form.fields;\n\t\t\tfor (const field of fields) {\n\t\t\t\tif (field.name === 'muc#roomconfig_roomname') {\n\t\t\t\t\tfield.value = name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait this.xmppClient.configureRoom(jid, {fields});\n\t\t} catch (error) {\n\t\t\tthrow new Error(error.error.condition);\n\t\t}\n\t}\n\n\tsetRoomSubject(jid, subject) {\n\t\treturn this.xmppClient.setSubject(jid, subject);\n\t}\n\n\tasync getRoomMembers(jid) {\n\t\tconst res = await Promise.all([\n\t\t\tthis.xmppClient.getRoomMembers(jid, 'owner'),\n\t\t\tthis.xmppClient.getRoomMembers(jid, 'admin'),\n\t\t\tthis.xmppClient.getRoomMembers(jid, 'member'),\n\t\t]);\n\t\t// Array.prototype.flatMap is missing in some cellphones (eg: Huawei P20)\n\t\tconst flatMap = (f, xs) => xs.reduce((acc, x) => acc.concat(f(x)), []);\n\t\treturn flatMap(d => d.muc.users || [], res)\n\t\t\t.filter(d => JID.getLocal(d.jid) !== 'admin')\n\t\t\t.map(d => ({\n\t\t\t\taffiliation: d.affiliation,\n\t\t\t\tjid: JID.toBare(d.jid),\n\t\t\t}));\n\t}\n\n\tjoinRoom(jid, nick) {\n\t\treturn this.xmppClient.joinRoom(jid, nick, {muc: {type: 'join', history: {maxCharacters: 0}}});\n\t}\n\n\tinvite(room, to) {\n\t\tto = Array.isArray(to) ? to : [to];\n\t\treturn this.xmppClient.invite(room, [{to}]);\n\t}\n\n\texpel(room, to) {\n\t\treturn this.xmppClient.setRoomAffiliation(room, to, 'none');\n\t}\n\n\tasync setParticipantRole(room, to, role) {\n\t\ttry {\n\t\t\tawait this.xmppClient.setRoomAffiliation(room, to, role);\n\t\t} catch (error) {\n\t\t\tthrow new Error(error.error.condition);\n\t\t}\n\t}\n\n\tleave(room) {\n\t\treturn this.xmppClient.deleteAccount(room);\n\t}\n\n\tasync destroy(jid, reason = 'Room deleted by owner') {\n\t\ttry {\n\t\t\tawait this.xmppClient.destroyRoom(jid, {reason});\n\t\t} catch (error) {\n\t\t\tthrow new Error(error.error.condition);\n\t\t}\n\t}\n\n\tsetState(to, type, chatState) {\n\t\treturn this.xmppClient.sendMessage({to, type, chatState});\n\t}\n\n\tasync fetchMessages(jid, type, lastForwardedMessage, max = 50) {\n\t\tconst params = {\n\t\t\tto: type === 'groupchat' ? jid : undefined,\n\t\t\twith: type === 'chat' ? jid : undefined,\n\t\t\tpaging: {max, before: lastForwardedMessage ? lastForwardedMessage : true},\n\t\t};\n\t\tconst res = await this.xmppClient.searchHistory(params);\n\t\tconst results = this.processMamMessages(res.results.reverse());\n\t\treturn {\n\t\t\tresults,\n\t\t\tcomplete: res.complete,\n\t\t\tpaging: res.paging,\n\t\t};\n\t}\n\n\tasync sync(jid, type, start) {\n\t\tconst params = {\n\t\t\tto: type === 'groupchat' ? jid : undefined,\n\t\t\twith: type === 'chat' ? jid : undefined,\n\t\t};\n\t\tlet res = await this.xmppClient.searchHistory({...params, start: new Date(start)});\n\t\tlet results = res.results;\n\t\twhile (!res.complete) {\n\t\t\tconst paging = {after: res.paging.last};\n\t\t\tres = await this.xmppClient.searchHistory({...params, paging});\n\t\t\tresults = results.concat(res.results);\n\t\t}\n\t\treturn this.processMamMessages(res.results);\n\t}\n\n\tasync syncMucInvitations(to) {\n\t\tconst lastXmppTimestamp = parseInt(localStorage.getItem('sippo:lastXmppTimestamp'));\n\t\tif (lastXmppTimestamp > 0) {\n\t\t\tconst params = {to, start: new Date(lastXmppTimestamp)};\n\t\t\tlet res = await this.xmppClient.searchHistory(params);\n\t\t\tlet results = res.results;\n\t\t\twhile (!res.complete) {\n\t\t\t\tconst paging = {after: res.paging.last};\n\t\t\t\tres = await this.xmppClient.searchHistory({...params, paging});\n\t\t\t\tresults = results.concat(res.results);\n\t\t\t}\n\t\t\tfor (const {item} of results) {\n\t\t\t\tconst {muc} = item.message;\n\t\t\t\tif (muc && muc.action === 'invite' && muc.invite.some(({reason}) => reason !== SERVER_CHAT_INVITE_REASONS.CONFERENCE)) {\n\t\t\t\t\tthis.emitter.emit('mucInvite', {\n\t\t\t\t\t\tchatId: item.message.from,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t\t// FIXME Last received message information is not available available so MUC invitations could have been lost.\n\t\t// FIXME as we can't know since what point of past time we need to request all messages\n\t}\n\n\tsendMessage(to, type, body) {\n\t\treturn this.xmppClient.sendMessage({to, type, body, marker: {type: 'markable'}});\n\t}\n\n\tsendFile(to, type, url, description) {\n\t\treturn this.xmppClient.sendMessage({to, type, marker: {type: 'markable'}, links: [{url, description}]});\n\t}\n\n\tmarkReceived(to, id, type) {\n\t\treturn this.xmppClient.markReceived(to, id, type);\n\t}\n\n\tmarkDisplayed(to, id, type) {\n\t\treturn this.xmppClient.markDisplayed(to, id, type);\n\t}\n\n\tasync enableNotifications(config) {\n\t\tconst registerUri = `${this.pushUri}/v1/register`;\n\t\tconst headers = {'Content-Type': 'application/x-www-form-urlencoded'};\n\t\tconst body = qs.stringify({\n\t\t\tnode: config.node,\n\t\t\ttype: config.type,\n\t\t\ttoken: config.token,\n\t\t});\n\t\tconst res = await window.fetch(registerUri, {method: 'POST', headers, body});\n\t\tconst data = await res.text();\n\t\tconst parts = data.split('\\n');\n\t\tif (parts[0] !== 'OK') {\n\t\t\tthrow new Error('ERROR response from register: ' + data);\n\t\t}\n\t\tif (parts[1] !== config.node) {\n\t\t\tthrow new Error('Wrong node received from register: ' + parts[1]);\n\t\t}\n\t\tconst secret = parts[2];\n\t\tconst fields = [{name: 'secret', value: secret}];\n\t\treturn this.xmppClient.enableNotifications(config.jid, config.node, fields);\n\t}\n\n\tasync disableNotifications(config) {\n\t\tconst unregisterUri = `${this.pushUri}/v1/unregister`;\n\t\tconst headers = {'Content-Type': 'application/x-www-form-urlencoded'};\n\t\tconst body = qs.stringify({\n\t\t\tnode: config.node,\n\t\t\ttype: config.type,\n\t\t\ttoken: config.token,\n\t\t});\n\t\tconst res = await window.fetch(unregisterUri, {method: 'POST', headers, body});\n\t\tconst data = await res.text();\n\t\tconst parts = data.split('\\n');\n\t\tif (parts[0] !== 'OK') {\n\t\t\tthrow new Error('ERROR response from register: ' + data);\n\t\t}\n\t\tif (parts[1] !== config.node) {\n\t\t\tthrow new Error('Wrong node received from register: ' + parts[1]);\n\t\t}\n\t\treturn this.xmppClient.disableNotifications(config.jid, config.node);\n\t}\n\n\t/** @private */\n\tprocessMamMessages(results) {\n\t\treturn results.filter(({item}) => {\n\t\t\tconst marker = item.message.marker;\n\t\t\tconst body = item.message.body;\n\t\t\tconst links = item.message.links;\n\t\t\treturn body || links || marker && (marker.type === 'displayed' || marker.type === 'received');\n\t\t}).map(({item}) => {\n\t\t\tconst message = item.message;\n\t\t\treturn {\n\t\t\t\tid: message.id,\n\t\t\t\tfrom: message.type === 'groupchat' ? JID.getResource(message.from) : JID.toBare(message.from),\n\t\t\t\tto: message.to,\n\t\t\t\ttimestamp: new Date(item.delay.timestamp).getTime(),\n\t\t\t\tbody: message.body,\n\t\t\t\tlinks: message.links,\n\t\t\t\tdisplayed: message.marker && message.marker.type === 'displayed' ? message.marker.id : undefined,\n\t\t\t\treceived: message.marker && message.marker.type === 'received' ? message.marker.id : undefined,\n\t\t\t};\n\t\t});\n\t}\n\n\tcreateSupportChat(id, context) {\n\t\treturn this.wacRequest.post('/xmpp/supportChat', {id}, {context});\n\t}\n}\n","import {List, Map} from 'immutable';\n\nimport Logs from '../Logs';\nimport {bindMethods} from '../utils/bindMethods';\nimport {EventEmitter} from '../eventemitter';\nimport {Chat} from './Chat';\nimport {ChatType} from './ChatType';\nimport {ChatParticipantRole} from './ChatParticipantRole';\nimport {uuid} from 'stanza/Utils';\nimport {CHAT_INVITE_REASONS} from '../wac-proxy/wac-stack/ChatService';\nconst log = Logs.instance.getLogger('SippoJS/chat/ChatManager');\n\nfunction sortByTimestamp(chatA, chatB) {\n\tconst lastA = chatA.getLastMessageTimestamp();\n\tconst lastB = chatB.getLastMessageTimestamp();\n\tif (lastA < lastB) {\n\t\treturn 1;\n\t}\n\tif (lastA > lastB) {\n\t\treturn -1;\n\t}\n\treturn 0;\n}\n\n/**\n * Provides access to methods for using chat.\n * A Chat manager object is obtained by calling the {@link Session#getChatManager} method.\n *\n * # Events\n * - `chats` - Emitted every time the chat list changes.\n * - `conferenceChats` - Emitted every time the conference chats list changes.\n * - `file` - Emitted every time a new chat message containing a file is received.\n * - `message` - Emitted every time a new chat message is received.\n * - `messageDisplayed` - Emitted every time messages are marked as displayed by this user.\n * - `supportChat` - Emitted every time a support chat is received.\n *\n * @example <caption>Getting chats</caption>\n *   const chatManager = await session.getChatManager();\n *   const chats = chatManager.getChats();\n *\n * @example <caption>Obtaining an individual chat</caption>\n *   const chat = chatManager.getIndividualChat('alice@quobis');\n */\nexport class ChatManager {\n\t/**\n\t * @protected\n\t * @return {Promise<ChatManager>}\n\t */\n\tstatic async newInstance(chatService, fileManager, user, sessionToken) {\n\t\tconst chatManager = new ChatManager(chatService, fileManager, user, sessionToken);\n\t\treturn chatManager.init();\n\t}\n\n\t/** @private */\n\tconstructor(chatService, fileManager, user, sessionToken) {\n\t\t/** @private */\n\t\tthis.ownAddress = user.getAddress().toLowerCase();\n\n\t\t/** @private */\n\t\tthis.chatService = chatService;\n\t\t/** @private */\n\t\tthis.fileManager = fileManager;\n\t\t/** @private */\n\t\tthis.user = user;\n\t\t/** @private */\n\t\tthis.sessionToken = sessionToken;\n\t\t/** @private */\n\t\tthis.individualChats = new Map();\n\t\t/** @private */\n\t\tthis.groupChats = new Map();\n\t\t/** @private */\n\t\tthis.chats = new List();\n\t\t/** @private */\n\t\tthis.conferenceChats = new List();\n\t\tthis.supportChats = new List();\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\n\t\tbindMethods(this, [\n\t\t\t'onIndividualChatAdded',\n\t\t\t'onIndividualChatDeleted',\n\t\t\t'onMucInvite',\n\t\t\t'onMucEnd',\n\t\t\t'onChat',\n\t\t\t'onDisplayed',\n\t\t\t'onMessage',\n\t\t\t'onMessageSent',\n\t\t\t'onFile',\n\t\t]);\n\t}\n\n\t/** @private */\n\tasync init() {\n\t\tthis.bindEventHandlers();\n\t\tawait this.chatService.start();\n\t\treturn this;\n\t}\n\n\t/** @private */\n\tasync fetchIndividualChats() {\n\t\tconst jids = await this.chatService.getIndividualChats();\n\t\tthis.individualChats = this.deleteOutdatedChats(this.individualChats, jids);\n\t\tfor (const jid of jids) {\n\t\t\tif (this.individualChats.has(jid)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.onIndividualChatAdded(jid);\n\t\t}\n\t}\n\n\t/** @private */\n\tasync fetchGroupChats() {\n\t\tconst bookmarks = await this.chatService.getBookmarks();\n\t\tthis.groupChats = this.deleteOutdatedChats(this.groupChats, bookmarks);\n\t\tawait Promise.all(bookmarks.map(async (jid) => {\n\t\t\ttry {\n\t\t\t\tawait this.chatService.joinRoom(jid, this.ownAddress);\n\t\t\t\tif (this.groupChats.has(jid)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst chat = await this.newGroupChat(jid);\n\t\t\t\tthis.groupChats = this.groupChats.set(jid, chat);\n\t\t\t\tthis.chats = this.chats.unshift(chat);\n\t\t\t} catch (error) {\n\t\t\t\tlog.warn(`Unable to join MUC ${jid}`);\n\t\t\t\tlog.warn(error);\n\t\t\t\tthis.onMucEnd({chatId: jid});\n\t\t\t}\n\t\t}));\n\t}\n\n\t/** @private */\n\tdeleteOutdatedChats(immutableMap, validIds) {\n\t\tconst remotelyDeletedIds = [...immutableMap.keys()].filter(id => !validIds.includes(id));\n\t\tthis.chats = this.chats.filter(chat => !remotelyDeletedIds.includes(chat.getId()));\n\t\treturn immutableMap.withMutations((map) => {\n\t\t\tfor (const id of remotelyDeletedIds) {\n\t\t\t\tconst chat = map.get(id);\n\t\t\t\tchat.unbindEventListeners();\n\t\t\t\tmap.delete(id);\n\t\t\t}\n\t\t});\n\t}\n\n\t/** @protected */\n\tuninit() {\n\t\tthis.unbindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.chatService.emitter.on('individualChatAdded', this.onIndividualChatAdded);\n\t\tthis.chatService.emitter.on('individualChatDeleted', this.onIndividualChatDeleted);\n\t\tthis.chatService.emitter.on('mucInvite', this.onMucInvite);\n\t\tthis.chatService.emitter.on('mucEnd', this.onMucEnd);\n\t\tthis.chatService.emitter.on('chat', this.onChat);\n\t\tthis.chatService.emitter.on(['displayed', '*'], this.onDisplayed);\n\t\tthis.chatService.emitter.on(['message:sent', '*'], this.onMessageSent);\n\t\tthis.chatService.emitter.on(['message', '*'], this.onMessage);\n\t\tthis.chatService.emitter.on(['file', '*'], this.onFile);\n\t}\n\n\t/** @private */\n\tunbindEventHandlers() {\n\t\tthis.chatService.emitter.off('individualChatAdded', this.onIndividualChatAdded);\n\t\tthis.chatService.emitter.off('individualChatDeleted', this.onIndividualChatDeleted);\n\t\tthis.chatService.emitter.off('mucInvite', this.onMucInvite);\n\t\tthis.chatService.emitter.off('mucEnd', this.onMucEnd);\n\t\tthis.chatService.emitter.off('chat', this.onChat);\n\t\tthis.chatService.emitter.off(['displayed', '*'], this.onDisplayed);\n\t\tthis.chatService.emitter.off(['message:sent', '*'], this.onMessageSent);\n\t\tthis.chatService.emitter.off(['message', '*'], this.onMessage);\n\t\tthis.chatService.emitter.off(['file', '*'], this.onFile);\n\t}\n\n\t/** @private */\n\tnewIndividualChat(id) {\n\t\tconst type = ChatType.INDIVIDUAL;\n\t\tconst participants = [{\n\t\t\tjid: this.ownAddress,\n\t\t\taffiliation: ChatParticipantRole.MEMBER,\n\t\t}, {\n\t\t\tjid: id,\n\t\t\taffiliation: ChatParticipantRole.MEMBER,\n\t\t}];\n\t\tconst chat = Chat.newInstance(this.chatService, this.fileManager, this.user, {id, type, participants});\n\t\tchat.bindEventListeners();\n\t\treturn chat;\n\t}\n\n\t/** @private */\n\tasync newGroupChat(id) {\n\t\tconst participants = await this.chatService.getRoomMembers(id);\n\t\tconst info = await this.chatService.getRoomInfo(id);\n\t\tconst name = info.name;\n\t\tconst subject = info.subject;\n\t\tconst type = ChatType.GROUP;\n\t\tconst chat = Chat.newInstance(this.chatService, this.fileManager, this.user, {id, type, name, subject, participants});\n\t\tchat.bindEventListeners();\n\t\treturn chat;\n\t}\n\n\t/** @private */\n\tpromoteChat({jid, type}) {\n\t\tconst chat = type === 'chat' ? this.individualChats.get(jid) : this.groupChats.get(jid);\n\t\tconst index = this.chats.indexOf(chat);\n\t\tif (index > 0) {\n\t\t\tthis.chats = this.chats.delete(index).unshift(chat);\n\t\t\tthis.emitter.emit('chats');\n\t\t}\n\t}\n\n\t/** @private */\n\tonIndividualChatAdded(jid) {\n\t\tlet chat = this.individualChats.get(jid);\n\t\tif (!chat) {\n\t\t\tchat = this.newIndividualChat(jid);\n\t\t\tthis.individualChats = this.individualChats.set(jid, chat);\n\t\t\tthis.chats = this.chats.unshift(chat);\n\t\t\tthis.emitter.emit('chats');\n\t\t}\n\t}\n\n\t/** @private */\n\tonIndividualChatDeleted(jid) {\n\t\tconst chat = this.individualChats.get(jid);\n\t\tif (chat) {\n\t\t\tchat.unbindEventListeners();\n\t\t\tthis.individualChats = this.individualChats.remove(jid);\n\t\t\tthis.chats = this.chats.filter(c => c !== chat);\n\t\t\tthis.emitter.emit('chats');\n\t\t}\n\t}\n\n\t/** @private */\n\tonDisplayed(event) {\n\t\tif (event.from === this.ownAddress) {\n\t\t\tthis.emitter.emit('messageDisplayed');\n\t\t}\n\t}\n\n\t/** @private */\n\tonMessage(event) {\n\t\tthis.emitter.emit('message', {\n\t\t\tchat: event.chat, // jid we use for indexing\n\t\t\tfrom: event.from,\n\t\t\tto: event.to,\n\t\t\ttimestamp: event.timestamp,\n\t\t\tbody: event.body,\n\t\t\ttype: event.type,\n\t\t});\n\t\tthis.promoteChat({jid: event.chat, type: event.type});\n\t}\n\n\t/** @private */\n\tonMessageSent(event) {\n\t\tif (event.displayed) {\n\t\t\tthis.emitter.emit('messageDisplayed');\n\t\t} else if (event.links || event.body) {\n\t\t\tthis.promoteChat({jid: event.chat, type: event.type});\n\t\t}\n\t}\n\n\t/** @private */\n\tonFile(event) {\n\t\tthis.emitter.emit('file', {\n\t\t\tchat: event.chat,\n\t\t\tfrom: event.from,\n\t\t\tto: event.to,\n\t\t\ttimestamp: event.timestamp,\n\t\t\tdesc: event.desc,\n\t\t\turl: event.url,\n\t\t\ttype: event.type,\n\t\t});\n\t\tthis.promoteChat({jid: event.chat, type: event.type});\n\t}\n\n\t/** @private */\n\tonChat(event) {\n\t\tif (event.type === 'chat') {\n\t\t\tthis.getIndividualChat(event.id);\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onMucInvite(event) {\n\t\tconst id = event.chatId;\n\t\tlet chat = this.groupChats.get(id);\n\t\tif (!chat) {\n\t\t\tawait this.chatService.joinRoom(id, this.ownAddress);\n\t\t\tchat = await this.newGroupChat(id);\n\t\t\tthis.groupChats = this.groupChats.set(id, chat);\n\t\t\tawait chat.sync();\n\t\t\tif (event.conferenceChat) {\n\t\t\t\tthis.conferenceChats = this.conferenceChats.unshift(chat);\n\t\t\t\tthis.emitter.emit('conferenceChats', chat);\n\t\t\t} else if (event.reason === CHAT_INVITE_REASONS.SUPPORT) {\n\t\t\t\tthis.supportChats = this.supportChats.unshift(chat);\n\t\t\t\tthis.emitter.emit('supportChat', chat);\n\t\t\t} else {\n\t\t\t\tawait this.chatService.addBookmark(id);\n\t\t\t\tthis.chats = this.chats.unshift(chat);\n\t\t\t\tthis.emitter.emit('chats', chat);\n\t\t\t}\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onMucEnd(event) {\n\t\tconst chat = this.groupChats.get(event.chatId);\n\t\tif (!chat) {\n\t\t\treturn;\n\t\t}\n\t\tchat.unbindEventListeners();\n\t\tthis.groupChats = this.groupChats.remove(chat.getId());\n\t\tif (this.conferenceChats.includes(chat)) {\n\t\t\tthis.conferenceChats = this.conferenceChats.filter(c => c !== chat);\n\t\t\tthis.emitter.emit('conferenceChats', chat);\n\t\t} else {\n\t\t\tthis.chats = this.chats.filter(c => c !== chat);\n\t\t\tawait this.chatService.removeBookmark(event.chatId);\n\t\t\tthis.emitter.emit('chats', chat);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the Push Notifications service type and token.\n\t * @param {Object} config\n\t * @param {string} config.jid The bare JID of the Push Server (e.g.: push.sippo).\n\t * @param {\"fcm\"|\"apns\"} config.type The type of the Push Server. Supported values are fcm and apns.\n\t * @param {string} config.token The token obtained from the Push Service.\n\t */\n\tsetPushConfig({jid, type, token}) {\n\t\tconst node = this.sessionToken;\n\t\t/** @private */\n\t\tthis.pushConfig = {jid, type, token, node};\n\t}\n\n\t/**\n\t * Enables push notifications.\n\t * @return {Promise}\n\t */\n\tenablePushNotifications() {\n\t\treturn this.chatService.enableNotifications(this.pushConfig);\n\t}\n\n\t/**\n\t * Disables push notifications.\n\t * @return {Promise}\n\t */\n\tdisablePushNotifications() {\n\t\treturn this.chatService.disableNotifications(this.pushConfig);\n\t}\n\n\t/**\n\t * Creates a new group chat.\n\t * @param {string} [name=''] The name of the new group chat.\n\t * @param {string} [subject=''] The subject of the new group chat.\n\t * @returns {Promise<Chat>}\n\t */\n\tasync createChat(name = '', subject = '') {\n\t\tconst id = await this.chatService.createRoom(this.ownAddress, name, subject);\n\t\tawait this.chatService.addBookmark(id);\n\t\tconst chat = await this.newGroupChat(id);\n\t\tthis.groupChats = this.groupChats.set(id, chat);\n\t\tthis.chats = this.chats.unshift(chat);\n\t\tthis.emitter.emit('chats', chat);\n\t\treturn chat;\n\t}\n\n\t/**\n\t * Obtains an individual chat with the specified user.\n\t * @param {string} participant Address of the remote participant of the chat.\n\t * @return {Chat}\n\t */\n\tgetIndividualChat(participant) {\n\t\tparticipant = participant.toLowerCase();\n\t\tlet chat = this.individualChats.get(participant);\n\t\tif (!chat) {\n\t\t\tchat = this.newIndividualChat(participant);\n\t\t\tthis.individualChats = this.individualChats.set(participant, chat);\n\t\t\tthis.chatService.addIndividualChat(participant);\n\t\t\tthis.chats = this.chats.unshift(chat);\n\t\t\tthis.emitter.emit('chats');\n\t\t}\n\t\treturn chat;\n\t}\n\n\t/**\n\t * Obtains the specified group chat.\n\t * @param {String} id Address of the group chat.\n\t * @return {Chat}\n\t */\n\tgetGroupChat(id) {\n\t\tlet chat = this.groupChats.get(id);\n\t\tif (!chat) {\n\t\t\tthrow Error(`There is no group with id: ${id}`);\n\t\t}\n\t\treturn chat;\n\t}\n\n\t/**\n\t * Returns a list with all the chats except the associated with conference rooms.\n\t * @return {ImmutableList<Chat>}\n\t */\n\tgetChats() {\n\t\treturn this.chats;\n\t}\n\n\t/**\n\t * Returns a list with chats associated to conference rooms.\n\t * @return {ImmutableList<Chat>}\n\t */\n\tgetConferenceChats() {\n\t\treturn this.conferenceChats;\n\t}\n\n\t/**\n\t * Synchronizes latest chat messages from the sever and reorders the chat list.\n\t * This method needs to be called after initialization and every time session is\n\t * resumed.\n\t */\n\tasync sync() {\n\t\tawait Promise.all([\n\t\t\tthis.fetchIndividualChats(),\n\t\t\tthis.fetchGroupChats(),\n\t\t]);\n\t\tawait this.chatService.syncMucInvitations(this.ownAddress);\n\t\tawait Promise.all(this.chats.map(chat => chat.sync()));\n\t\tthis.chats = this.chats.sort(sortByTimestamp);\n\t\tthis.emitter.emit('chats');\n\t}\n\n\t/**\n\t * Creates a support chat, which is a group chat where a agent is added in the\n\t * moment of the creation.\n\t * @param {object} context Context of supportChat\n\t * @return {Promise<Chat>}\n\t */\n\tasync createSupportChat(context = {}) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst id = uuid();\n\t\t\tconst onSupportChat = (chat) => {\n\t\t\t\tresolve(chat);\n\t\t\t\tthis.emitter.off('supportChat', onSupportChat);\n\t\t\t};\n\t\t\tthis.emitter.on('supportChat', onSupportChat);\n\t\t\tthis.emitter.on('suppe', reject);\n\t\t\tthis.chatService.createSupportChat(id, context).catch(reject);\n\t\t});\n\t}\n}\n","export const PresenceActivity = {\n\t'unknown': 'unknown',\n\t'appointment': 'appointment',\n\t'away': 'away',\n\t'breakfast': 'breakfast',\n\t'busy': 'busy',\n\t'dinner': 'dinner',\n\t'holiday': 'holiday',\n\t'in-transit': 'in-transit',\n\t'looking-for-work': 'looking-for-work',\n\t'lunch': 'lunch',\n\t'meal': 'meal',\n\t'meeting': 'meeting',\n\t'on-the-phone': 'on-the-phone',\n\t'other': 'other',\n\t'performance': 'performance',\n\t'permanent-absence': 'permanent-absence',\n\t'playing': 'playing',\n\t'presentation': 'presentation',\n\t'shopping': 'shopping',\n\t'sleeping': 'sleeping',\n\t'spectator': 'spectator',\n\t'steering': 'steering',\n\t'travel': 'travel',\n\t'tv': 'tv',\n\t'vacation': 'vacation',\n\t'working': 'working',\n\t'worship': 'worship',\n};\n","export const PresenceMood = {\n\t'unknown': 'unknown',\n\t'afraid': 'afraid',\n\t'amazed': 'amazed',\n\t'angry': 'angry',\n\t'annoyed': 'annoyed',\n\t'anxious': 'anxious',\n\t'ashamed': 'ashamed',\n\t'bored': 'bored',\n\t'brave': 'brave',\n\t'calm': 'calm',\n\t'cold': 'cold',\n\t'confused': 'confused',\n\t'contented': 'contented',\n\t'cranky': 'cranky',\n\t'curious': 'curious',\n\t'depressed': 'depressed',\n\t'disappointed': 'disappointed',\n\t'disgusted': 'disgusted',\n\t'distracted': 'distracted',\n\t'embarrassed': 'embarrassed',\n\t'excited': 'excited',\n\t'flirtatious': 'flirtatious',\n\t'frustrated': 'frustrated',\n\t'grumpy': 'grumpy',\n\t'guilty': 'guilty',\n\t'happy': 'happy',\n\t'hot': 'hot',\n\t'humbled': 'humbled',\n\t'humiliated': 'humiliated',\n\t'hungry': 'hungry',\n\t'hurt': 'hurt',\n\t'impressed': 'impressed',\n\t'in_awe': 'in_awe',\n\t'in_love': 'in_love',\n\t'indignant': 'indignant',\n\t'interested': 'interested',\n\t'invincible': 'invincible',\n\t'jealous': 'jealous',\n\t'lonely': 'lonely',\n\t'mean': 'mean',\n\t'moody': 'moody',\n\t'nervous': 'nervous',\n\t'neutral': 'neutral',\n\t'offended': 'offended',\n\t'other': 'other',\n\t'playful': 'playful',\n\t'proud': 'proud',\n\t'relieved': 'relieved',\n\t'remorseful': 'remorseful',\n\t'restless': 'restless',\n\t'sad': 'sad',\n\t'sarcastic': 'sarcastic',\n\t'serious': 'serious',\n\t'shocked': 'shocked',\n\t'shy': 'shy',\n\t'sick': 'sick',\n\t'sleepy': 'sleepy',\n\t'stressed': 'stressed',\n\t'surprised': 'surprised',\n\t'thirsty': 'thirsty',\n\t'worried': 'worried',\n};\n","import {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport Logs from '../Logs';\nimport {PresenceActivity} from './PresenceActivity';\nimport {PresenceMood} from './PresenceMood';\n\nconst log = Logs.instance.getLogger('SippoJS/Presence');\n\n/**\n * This class must not be instantiated. Presence objects are automatically obtained\n * associated to {@link Contact} objects.\n *\n * ## Events\n *\n * - **`update`** -> triggered every time the presence object is updated.\n */\nexport class Presence extends EventEmitter {\n\n\t/**\n\t * Represents the different status of an user\n\t * @type {Enum<PresenceActivity>}\n\t * @deprecated Use \"import {PresenceActivity} from '@quobis/sippojs' instead\"\n\t */\n\tget ACTIVITY() {\n\t\tlog.warn('Presence.ACTIVITY is deprecated. Please use import {PresenceActivity} from \"@quobis/sippojs\" instead');\n\t\treturn PresenceActivity;\n\t}\n\n\t/**\n\t * Represents the different emotional states of an user\n\t * @type {Enum<PresenceMood>}\n\t * @deprecated Use \"import {PresenceMood} from '@quobis/sippojs' instead\"\n\t */\n\tget MOOD() {\n\t\tlog.warn('Presence.MOOD is deprecated. Please use import {PresenceMood} from \"@quobis/sippojs\" instead');\n\t\treturn PresenceMood;\n\t}\n\n\t/**\n\t * @param {PresenceManager} presenceManager\n\t * @param {string} address\n\t */\n\tconstructor(presenceManager, address) {\n\t\tsuper();\n\t\t/**\n\t\t * @type {PresenceManager}\n\t\t */\n\t\tthis._presenceManager = presenceManager;\n\n\t\t/**\n\t\t * @type {boolean}\n\t\t */\n\t\tthis._online = false;\n\n\t\t/**\n\t\t * @type {PresenceActivity}\n\t\t */\n\t\tthis._activity = PresenceActivity.unknown;\n\n\t\t/**\n\t\t * @type {PresenceMood}\n\t\t */\n\t\tthis._mood = PresenceMood.unknown;\n\n\t\t/**\n\t\t * @type {String}\n\t\t */\n\t\tthis._note = '';\n\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tthis._avatar = '';\n\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tthis._displayName = '';\n\n\t\tbindMethods(this, [\n\t\t\t'onPresenceUpdated',\n\t\t]);\n\t\tif (!address) {\n\t\t\tthis._initializing = Promise.resolve();\n\t\t}\n\t\tthis.address = address;\n\t}\n\n\t/**\n\t * Address associated with this presence\n\t * @type {String}\n\t */\n\tget address() {\n\t\treturn this._address;\n\t}\n\n\t/**\n\t * Update address associated with this presence\n\t * @type {String}\n\t */\n\tset address(address) {\n\t\tif (this._address === address) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._address) {\n\t\t\tthis._presenceManager.unsubscribeFromPresence(this._address);\n\t\t\tthis._presenceManager.emitter.off('updated', this.onPresenceUpdated);\n\t\t\tthis.update({\n\t\t\t\tonline: false,\n\t\t\t\tactivity: 'unknown',\n\t\t\t\tmood: 'unknown',\n\t\t\t\tnote: '',\n\t\t\t\tavatar: '',\n\t\t\t\tdisplayName: '',\n\t\t\t\taddress: '',\n\t\t\t});\n\t\t}\n\t\tthis._address = address;\n\t\tif (this._address) {\n\t\t\tthis._initializing = this._presenceManager.subscribeToPresence(this._address);\n\t\t\tthis._initializing.then((presence) => {\n\t\t\t\tthis.update(presence);\n\t\t\t});\n\t\t\tthis._presenceManager.emitter.on('updated', this.onPresenceUpdated);\n\t\t}\n\n\t}\n\n\t/**\n\t * User is online\n\t * @type {boolean}\n\t */\n\tget online() {\n\t\treturn this._online;\n\t}\n\n\t/**\n\t * User activity\n\t * @type {PresenceActivity}\n\t */\n\tget activity() {\n\t\treturn this._activity;\n\t}\n\n\t/**\n\t * User emotional state\n\t * @type {PresenceMood}\n\t */\n\tget mood() {\n\t\treturn this._mood;\n\t}\n\n\t/**\n\t * Short message defined by user\n\t * @type {String}\n\t */\n\tget note() {\n\t\treturn this._note;\n\t}\n\n\t/**\n\t * Avatar location\n\t * @type {String}\n\t */\n\tget avatar() {\n\t\treturn this._avatar;\n\t}\n\n\t/**\n\t * Display name\n\t * @type {String}\n\t */\n\tget displayName() {\n\t\treturn this._displayName;\n\t}\n\n\t/**\n\t * @return {Promise<void>}\n\t */\n\twaitUntilSynced() {\n\t\treturn this._initializing;\n\t}\n\n\t/**\n\t * Callback called when a presence update is received\n\t * @private\n\t * @param {Presence} presence new presence received\n\t */\n\tonPresenceUpdated(presence) {\n\t\tif (presence.address === this._address) {\n\t\t\tthis.update(presence);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the presence with new data\n\t * @protected\n\t * @param {Object} data\n\t * @param {boolean} data.online\n\t * @param {string} data.activity\n\t * @param {string} data.mood\n\t * @param {string} data.note\n\t * @param {string} data.avatar\n\t * @param {string} data.displayName\n\t */\n\tupdate(data) {\n\t\tthis._online = data.online;\n\t\tthis._activity = PresenceActivity[data.activity];\n\t\tthis._mood = PresenceMood[data.mood];\n\t\tthis._note = data.note;\n\t\tthis._avatar = data.avatar;\n\t\tthis._displayName = data.displayName;\n\t\tthis._address = data.address;\n\t\tthis.emit('update');\n\t}\n\n\t/**\n\t * Returns a JSON representation of the object.\n\t * @return {Object}\n\t * @property {boolean} online\n\t * @property {string} activity\n\t * @property {string} mood\n\t * @property {string} note\n\t * @property {string} avatar\n\t * @property {string} displayName\n\t */\n\ttoJSON() {\n\t\treturn {\n\t\t\taddress: this._address,\n\t\t\tonline: this._online,\n\t\t\tactivity: PresenceActivity[this._activity],\n\t\t\tmood: PresenceMood[this._mood],\n\t\t\tnote: this._note,\n\t\t\tavatar: this._avatar,\n\t\t\tdisplayName: this._displayName,\n\t\t};\n\t}\n}\n","import {Presence} from './Presence';\nimport {scaleImg} from '../utils';\nimport Logs from '../Logs';\nimport {PresenceActivity} from './PresenceActivity';\nimport {PresenceMood} from './PresenceMood';\n\nconst log = Logs.instance.getLogger('SippoJS/OwnPresence');\n/**\n * This class must not be instantiated. OwnPresence object can be accessed using\n * {@link ContactManager#OwnPresence}\n */\nexport class OwnPresence extends Presence {\n\n\tconstructor(stack, presenceManager, ownAddress) {\n\t\tsuper(presenceManager, ownAddress);\n\t\tthis._stack = stack;\n\t}\n\n\t/**\n\t * @type {boolean}\n\t */\n\tget online() {\n\t\treturn super.online;\n\t}\n\n\t/**\n\t * @type {boolean}\n\t */\n\tset online(online) {\n\t\tthis._online = online;\n\t\tthis._sendUpdate();\n\t}\n\n\t/**\n\t * @type {PresenceActivity}\n\t */\n\tget activity() {\n\t\treturn super.activity;\n\t}\n\n\t/**\n\t * @type {PresenceActivity}\n\t */\n\tset activity(activity) {\n\t\tif (!PresenceActivity[activity]) {\n\t\t\tthrow Error(`${activity} is not a valid activity`);\n\t\t}\n\t\tthis._activity = activity;\n\t\tthis._sendUpdate();\n\t}\n\n\t/**\n\t * @type {PresenceMood}\n\t */\n\tget mood() {\n\t\treturn super.mood;\n\t}\n\n\t/**\n\t * @type {PresenceMood}\n\t */\n\tset mood(mood) {\n\t\tif (!PresenceMood[mood]) {\n\t\t\tthrow Error(`${mood} is not a valid mood`);\n\t\t}\n\t\tthis._mood = mood;\n\t\tthis._sendUpdate();\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tget note() {\n\t\treturn super.note;\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tset note(note) {\n\t\tthis._note = note;\n\t\tthis._sendUpdate();\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tget avatar() {\n\t\treturn super.avatar;\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tset avatar(avatar) {\n\t\tthis._avatar = avatar;\n\t\tthis._sendUpdate();\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tget displayName() {\n\t\treturn super.displayName;\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tset displayName(displayName) {\n\t\tthis._displayName = displayName;\n\t\tthis._sendUpdate();\n\t}\n\n\tsetDisplayName(displayName) {\n\t\tthis._displayName = displayName;\n\t\treturn this._sendUpdate();\n\t}\n\n\t/**\n\t * Sends to the server the current values\n\t * @private\n\t * @return {Promise<undefined>}\n\t */\n\t_sendUpdate() {\n\t\treturn this._presenceManager.updatePresence(this.address, this.toJSON()).catch((err) => {\n\t\t\tlog.error(`Error updating presence: ${err}`);\n\t\t});\n\t}\n\n\tscaleImg(url, width, height) {\n\t\treturn scaleImg(url, width, height);\n\t}\n}\n","\n/**\n * @private\n * @typedef {Object} QueueItem\n * @property {Function} resolve The function to be called when resolution success.\n * @property {Function} reject The function to be called when resolution fails.\n * @property {Object} data The required data to be processed.\n */\n\n/**\n * @private\n * @typedef {Object} QueueObserver\n * @property {Function<Array<QueueItem>>} commit\n */\n\n/**\n * When a burst of calls to a function occurs, it stores all of\n * them and tries to get the result through an observer.\n * This allows to group those operations that can be carried out by\n * a single call.\n * @private\n */\nexport class Queue {\n\n\t/**\n\t * @param {QueueObserver} observer Burst end observer\n\t */\n\tconstructor(observer) {\n\n\t\t/**\n\t\t * List of queued request.\n\t\t * @private\n\t\t * @type {Array<QueueItem>}\n\t\t */\n\t\tthis._pending = [];\n\n\t\t/**\n\t\t * Commit timer reference.\n\t\t * @private\n\t\t * @type {Number}\n\t\t */\n\t\tthis._timer = null;\n\n\t\t/**\n\t\t * Commit function\n\t\t * @private\n\t\t * @type {QueueObserver}\n\t\t */\n\t\tthis._observer = observer;\n\t}\n\n\t/**\n\t * Burst end observer\n\t * @type {QueueObserver}\n\t */\n\tset observer(observer) {\n\t\tthis._observer = observer;\n\t}\n\n\t/**\n\t * Add an element to burst queue\n\t * @param {Object} data\n\t * @return {Promise} resolved on success by burst observer.\n\t */\n\taddToQueue(data) {\n\t\tif (this._timer) {\n\t\t\tclearTimeout(this._timer);\n\t\t\tthis._timer = null;\n\t\t}\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis._pending.push({\n\t\t\t\tresolve: resolve,\n\t\t\t\treject: reject,\n\t\t\t\tdata: data,\n\t\t\t});\n\t\t\tthis._timer = setTimeout(() => {\n\t\t\t\tlet pending = this._pending;\n\t\t\t\tthis._pending = [];\n\t\t\t\tthis._observer.commit(pending);\n\t\t\t}, 10);\n\t\t});\n\t}\n}\n","\nimport {Queue} from '../utils/Queue';\n\n/**\n * Class that interacts with WacProxy to translate addresses to WAC users.\n * This translation is not done immediately, the consecutive calls are queued\n * to use a single call.\n * All resolutions are stored in a collection so that future calls do not require\n * a new call to WacProxy.\n * @private\n */\nexport class ResolveQueue {\n\n\t/**\n\t * Creates a new resolver queue\n\t * @protected\n\t * @param {WacProxy} stack The wac proxy instance to interact.\n\t * @param {UserCollection} collection The collection where resolved elements\n\t * are stored.\n\t */\n\tconstructor(stack, collection) {\n\n\t\t/**\n\t\t * @private\n\t\t * @type {WacProxy}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {UserCollection}\n\t\t */\n\t\tthis._collection = collection;\n\n\t\t/**\n\t\t * List of queued request.\n\t\t * @private\n\t\t * @type {Array<ResolveQueueItem>}\n\t\t */\n\t\tthis._queue = new Queue(this);\n\t}\n\n\t/**\n\t * Add a new resolution request to queue.\n\t * If we are subscribed to requested address, undefined is returned.\n\t * When commit timer exists, it is canceled. A new commit timer is created.\n\t * @param {String} address element to resolve.\n\t * @return {Promise<User|undefined>} resolved on success with resolved user if resolution\n\t * success, undefined if no user was found or rejected with an error if something fails.\n\t */\n\tresolve(address) {\n\t\taddress = address.toLowerCase();\n\t\tif (this._collection.isSubscribedTo(address)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this._queue.addToQueue(address);\n\t}\n\n\t/**\n\t * Method that resolves any queued resolution request.\n\t * When a response is received from WacStack resolved and subscribed collections are updated.\n\t * @private\n\t */\n\tcommit(pending) {\n\t\tthis._stack.getResolver().resolveUsers(pending.map(x => x.data)).then((list) => {\n\t\t\tlist.resolved.forEach(x => this._collection.addUser(x));\n\t\t\tthis._collection.updateSubscribed(list.subscribed);\n\t\t\tpending.forEach(x => x.resolve(this._collection.resolve(x.data)));\n\t\t}).catch((error) => {\n\t\t\tpending.forEach(x => x.reject(error));\n\t\t});\n\t}\n}\n","/** @private */\nexport const USER_ADDRESS_PREFIX = 'wac-user:';\n/** @private */\nexport const USER_ADDRESS_PATTERN = RegExp(`^(${USER_ADDRESS_PREFIX})(\\\\w*)$`);\n\n/**\n * A local collection of resolved addresses and subscribed addresses.\n * @private\n */\nexport class UserCollection {\n\n\t/**\n\t * Constructs an users collection\n\t * @param {String} userDomain User's session domain\n\t * @protected\n\t */\n\tconstructor(userDomain) {\n\n\t\t/**\n\t\t * Users indexed by id field.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersById = {};\n\n\t\t/**\n\t\t * Users indexed by complete username (user@domain).\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersByCompleteUsername = {};\n\n\t\t/**\n\t\t * Users indexed by alias field.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersByAlias = {};\n\n\t\t/**\n\t\t * Users indexed by landLineNumber field.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersByLandLineNumber = {};\n\n\t\t/**\n\t\t * Users indexed by phone.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersByMobilePhone = {};\n\n\t\t/**\n\t\t * Users indexed by gatewayUsername\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._usersByGatewayUsername = {};\n\n\t\t/**\n\t\t * The user's session domain\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._userDomain = userDomain;\n\n\t\t/**\n\t\t * List of requested addresses.\n\t\t * @private\n\t\t * @type {Array<String>}\n\t\t */\n\t\tthis._subscribed = [];\n\t}\n\n\t/**\n\t * Check if we are subscribed to an address.\n\t * @param {String} address the address to query.\n\t * @return {Boolean} true if subscribed.\n\t */\n\tisSubscribedTo(address) {\n\t\treturn this._subscribed.includes(address);\n\t}\n\n\t/**\n\t * Update the list of subscribed address.\n\t * @param {Array<String>} addresses new subscribed addresses that will\n\t * replace existing one.\n\t */\n\tupdateSubscribed(addresses) {\n\t\tthis._subscribed = addresses;\n\t}\n\n\t/**\n\t * Add a user to the indexes.\n\t * @protected\n\t * @param {User} user the user to add.\n\t */\n\taddUser(user) {\n\t\tuser.getAddress = () => {\n\t\t\treturn USER_ADDRESS_PREFIX + user.id;\n\t\t};\n\t\tthis._usersById[user.id] = user;\n\t\tthis._usersByCompleteUsername[`${user.username}@${user.domain}`.toLowerCase()] = user;\n\t\tif (user.alias) {\n\t\t\tthis._usersByAlias[user.alias] = user;\n\t\t}\n\t\tif (user.landLineNumber) {\n\t\t\tthis._usersByLandLineNumber[user.landLineNumber] = user;\n\t\t}\n\t\tif (user.gatewayUsername) {\n\t\t\tthis._usersByGatewayUsername[user.gatewayUsername] = user;\n\t\t}\n\t\tuser.mobilePhone.forEach((mobilePhone) => {\n\t\t\tthis._usersByMobilePhone[mobilePhone] = user;\n\t\t});\n\t}\n\n\t/**\n\t * Updates all resolved users and subscribed elements.\n\t * @protected\n\t * @param {Array<User>} users The new resolved users.\n\t * @param {Array<String>} subscribed the new subscribed list.\n\t */\n\tupdateUsers(users, subscribed) {\n\t\tlet newUsers = [];\n\t\tusers.forEach((user) => {\n\t\t\tif (this._usersById[user.id]) {\n\t\t\t\tuser = Object.assign(this._usersById[user.id], user);\n\t\t\t}\n\t\t\tnewUsers.push(user);\n\t\t});\n\t\tthis._usersById = {};\n\t\tthis._usersByCompleteUsername = {};\n\t\tthis._usersByAlias = {};\n\t\tthis._usersByLandLineNumber = {};\n\t\tthis._usersByGatewayUsername = {};\n\t\tthis._usersByMobilePhone = {};\n\t\tthis._subscribed = subscribed;\n\t\tnewUsers.forEach(this.addUser.bind(this));\n\t}\n\n\t/**\n\t * Resolve an address searching in local collection.\n\t * @protected\n\t * @param {String} address the requested address to resolve\n\t * @return {User|undefined} If resolution success, the found User, undefined otherwise.\n\t */\n\tresolve(address) {\n\t\tif (USER_ADDRESS_PATTERN.test(address)) {\n\t\t\tlet id = USER_ADDRESS_PATTERN.exec(address)[2];\n\t\t\treturn this._usersById[id];\n\t\t}\n\t\treturn this._usersById[address]\n\t\t\t|| this._usersByCompleteUsername[address.toLowerCase()]\n\t\t\t|| this._usersByCompleteUsername[`${address}@${this._userDomain}`.toLowerCase()]\n\t\t\t|| this._usersByAlias[address]\n\t\t\t|| this._usersByLandLineNumber[address]\n\t\t\t|| this._usersByMobilePhone[address]\n\t\t\t|| this._usersByGatewayUsername[address];\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport {ResolveQueue} from './ResolveQueue';\nimport {\n\tUserCollection,\n\tUSER_ADDRESS_PATTERN,\n\tUSER_ADDRESS_PREFIX,\n} from './UserCollection';\n\n/** @private */\nexport const Events = {\n\t/** Resolved users changed event */\n\tUPDATED: 'updated',\n};\n\n/**\n * Element that enables user resolution.\n * Previously resolved users are stored in a local collection that is updated\n * when some of the requested addresses change.\n * @private\n */\nexport class UserManager extends EventEmitter {\n\n\t/**\n\t * Constructs an users manager\n\t * @protected\n\t */\n\tconstructor(wacProxy) {\n\t\tsuper();\n\n\t\t/**\n\t\t * Property used to determine if UserManager has been intialized\n\t\t * and wait until initialization success.\n\t\t * @private\n\t\t * @type {Promise}\n\t\t */\n\t\tthis._init = null;\n\n\t\t/**\n\t\t * WacProxy instance.\n\t\t * @private\n\t\t * @type {WacProxy}\n\t\t */\n\t\tthis._stack = wacProxy;\n\n\t\t/**\n\t\t * Collection of already resolved Users.\n\t\t * @private\n\t\t * @type {UserCollection}\n\t\t */\n\t\tthis._collection = null;\n\n\t\t/**\n\t\t * Queue that resolve addresses through WacProxy.\n\t\t * @private\n\t\t * @type {ResolveQueue}\n\t\t */\n\t\tthis._resolveQueue = null;\n\n\t\tthis.setMaxListeners(0);\n\n\t\tbindMethods(this, [\n\t\t\t'onResolveUpdated',\n\t\t]);\n\t}\n\n\t/**\n\t * Initialize UsersManager.\n\t * It retrieves already resolved Users and subscribed addresses from WacProxy\n\t * and subscribes to resolution updates.\n\t * @return {Promise} resolved after intialization.\n\t */\n\tinit() {\n\t\tif (!this._init) {\n\t\t\tthis._stack.getResolver().emitter.on('update', this.onResolveUpdated);\n\t\t\tthis._init = (async () => {\n\t\t\t\tconst items = await this._stack.getResolver().getResolvedUsers();\n\t\t\t\tthis._collection = new UserCollection(this._stack.getCurrentSession().domain);\n\t\t\t\tthis._collection.updateUsers(items.resolved, items.subscribed);\n\t\t\t\tthis._resolveQueue = new ResolveQueue(this._stack, this._collection);\n\t\t\t})();\n\t\t}\n\t\treturn this._init;\n\t}\n\n\t/**\n\t * Deinitialize UsersManager.\n\t */\n\tuninit() {\n\t\tthis._stack.getResolver().emitter.off('update', this.onResolveUpdated);\n\t\tthis._init = null;\n\t\tthis._collection = null;\n\t\tthis._resolveQueue = null;\n\t}\n\n\t/**\n\t * Get the address associated with given user Id.\n\t * @param {String} userId The user identifier used to build the user address.\n\t * @return {String} The user address.\n\t */\n\tgetAddress(userId) {\n\t\treturn `${USER_ADDRESS_PREFIX}${userId}`;\n\t}\n\n\t/**\n\t * Get the userId associated with given user address.\n\t * @param {String} address A user address.\n\t * @return {String} The user ID of that user address.\n\t */\n\tgetUserId(address) {\n\t\treturn address.replace(USER_ADDRESS_PATTERN, '$2');\n\t}\n\n\t/**\n\t * Checks if given address is a WAC user address\n\t * @param {String} address the address to check.\n\t * @return {Boolean} true if given address is a WAC user address.\n\t */\n\tisAddress(address) {\n\t\treturn USER_ADDRESS_PATTERN.test(address);\n\t}\n\n\t/**\n\t * Obtains own user WAC address\n\t * @return {String} address of current user\n\t */\n\tgetOwnAddress() {\n\t\treturn this.getAddress(this._stack.getCurrentSession().user);\n\t}\n\n\t/**\n\t * Checks if given address is own WAC user address\n\t * @param {String} address the address to check.\n\t * @return {Boolean} true if given address is own WAC user address.\n\t */\n\tisOwnAddress(address) {\n\t\treturn this.getUserId(address) === this._stack.getCurrentSession().user;\n\t}\n\n\t/**\n\t * Request an address resolution.\n\t * When there is an user in local collection that resolves given address, such user\n\t * will be returned.\n\t * Otherwise a resolution will be requested through resolve queue to WacStack. If resolution success\n\t * local collection will be updated.\n\t * @param {String} address The address to be resolved.\n\t * @return {Promise<User|undefined>} resolved user or undefined if there is no user that\n\t * conforms to given address.\n\t */\n\tasync resolveUser(address) {\n\t\tif (!this._init) {\n\t\t\tthrow new Error('not initialized');\n\t\t}\n\t\tawait this._init;\n\t\treturn this._collection.resolve(address) || this._resolveQueue.resolve(address);\n\t}\n\n\t/**\n\t * Returns an user username given a gateway username.\n\t * @param {String} gatewayUsername The gateway username to search.\n\t * @param {Boolean} [ignoreErrors=true] When true, if no user with such gateway\n\t * username is found, gatewayUsername value will be returned instead an error.\n\t * @return {Promise<String>} User username on success.\n\t */\n\tgetUsername(gatewayUsername, ignoreErrors = true) {\n\t\tlet localUser = this._collection.resolve(gatewayUsername);\n\t\tif (localUser && localUser.gatewayUsername === gatewayUsername) {\n\t\t\treturn Promise.resolve(localUser.username);\n\t\t}\n\t\treturn this._stack.getResolver().getUserByGatewayUsername(gatewayUsername)\n\t\t\t.then(userId => this.resolveUser(userId))\n\t\t\t.then(user => user.username)\n\t\t\t.catch((error) => {\n\t\t\t\tif (ignoreErrors) {\n\t\t\t\t\treturn gatewayUsername;\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t});\n\t}\n\n\t/**\n\t * Returns the gateway username associated with an user username.\n\t * @param {String} username The user's username.\n\t * @param {Boolean} [ignoreErrors=true] When true, if no user is found,\n\t * username value will be returned instead an error.\n\t * @return {Promise<String>} The gateway username on success.\n\t */\n\tgetGatewayUsername(username, ignoreErrors = true) {\n\t\treturn this.resolveUser(username)\n\t\t\t.then(user => user.gatewayUsername ? user.gatewayUsername : this._stack.getResolver().getGatewayUsernameByUser(user.id))\n\t\t\t.catch((error) => {\n\t\t\t\tif (ignoreErrors) {\n\t\t\t\t\treturn username;\n\t\t\t\t}\n\t\t\t\tthrow error;\n\t\t\t});\n\t}\n\n\tgetGatewayUsernames(usernames, ignoreErrors = true) {\n\t\treturn Promise.all(usernames.map(username => this.getGatewayUsername(username, ignoreErrors)));\n\t}\n\n\t/**\n\t * Callback called when WacProxy notifies that resolved and subscribed items\n\t * have changed. This can happen:\n\t *  - When a resolved user changes some of their fields or ceases to exist.\n\t *  - When a new user is created and satisfies one of the addresses to which we have subscribed\n\t * @private\n\t * @param {Object} items object that contains resolved users and subscribed addresses.\n\t */\n\tonResolveUpdated(items) {\n\t\tthis._collection.updateUsers(items.resolved, items.subscribed);\n\t\tthis.emit(Events.UPDATED);\n\t}\n}\n","const create = (data) => {\n\tlet {id, name = '', source = '', favorite = false} = data;\n\treturn {\n\t\tgetId: () => id,\n\t\tgetName: () => name,\n\t\tgetSource: () => source,\n\t\tisFavorite: () => favorite,\n\t\tsetName: (value) => {\n\t\t\tname = value;\n\t\t},\n\t\tsetFavorite: (value) => {\n\t\t\tfavorite = value;\n\t\t},\n\t\tsetSource: (value) => {\n\t\t\tsource = value;\n\t\t},\n\t\tsetId: (value) => {\n\t\t\tid = value;\n\t\t},\n\t};\n};\n\n/** @private */\nexport const BaseContact = {\n\tcreate,\n};\n","/** @private */\nexport const updateContact = (id, stack, data) => {\n\treturn id ?\n\t\tstack.updateContact(data) :\n\t\tundefined;\n};\n\n/** @private */\nexport const removeContact = (id, stack) => {\n\treturn stack.removeContact({\n\t\tid,\n\t});\n};\n","import {EventEmitter} from '../eventemitter';\nimport {\n\tEvents as UserManagerEvents,\n} from '../users/UserManager';\nimport {Presence} from './Presence';\nimport {BaseContact} from './BaseContact';\nimport {removeContact, updateContact} from './utils';\n\n/**\n * Represents a contact. This class must not be directly instantiated. Instead,\n * instances of this class are obtained by calling the {@link ContactManager#createContact}\n * or {@link ContactManager#getContacts} methods of {ContactManager}\n *\n * ## Events\n *\n * - **`update`** is emitted every time the contact is updated.\n * - **`delete`** is emitted when the contact is deleted.\n */\nexport class Contact extends EventEmitter {\n\n\t/**\n\t * Constructs a new contact\n\t * @protected\n\t * @param {WacStack} stack\n\t * @param {UserManager} userManager\n\t * @param {PresenceManager} presenceManager\n\t * @param {FavoriteContact} favoriteManager\n\t * @param {Object} data\n\t * @param {string} data.id\n\t * @param {string} data.name\n\t * @param {Object[]} data.phones\n\t * @param {Object[]} data.emails\n\t * @param {string} data.source\n\t * @param {boolean} data.favorite\n\t * @param {string} data.deviceId\n\t * @param {string} data.contactDeviceId\n\t * @param {string} data.avatar\n\t * @param {Presence} [data.presence]\n\t */\n\tconstructor(stack, userManager, presenceManager, favoriteManager, data = {}) {\n\t\tsuper();\n\n\t\t/**\n\t\t * @type {WacStack}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @type {UserManager}\n\t\t */\n\t\tthis._userManager = userManager;\n\n\t\t/**\n\t\t * @type {PresenceManager}\n\t\t */\n\t\tthis._presenceManager = presenceManager;\n\n\t\t/**\n\t\t * @type {FavoriteContact}\n\t\t */\n\t\tthis._favoriteManager = favoriteManager;\n\n\t\t/**\n\t\t * @type {BaseContact}\n\t\t * @private\n\t\t */\n\t\tthis._base = BaseContact.create(data);\n\n\t\t/**\n\t\t * @type {Object[]}\n\t\t */\n\t\tthis._phones = data.phones || [];\n\n\t\t/**\n\t\t * @type {Object[]}\n\t\t */\n\t\tthis._unnormalizedPhones = data.unnormalizedPhones || [];\n\n\t\t/**\n\t\t * @type {Object[]}\n\t\t */\n\t\tthis._emails = data.emails || [];\n\n\t\t/**\n\t\t * @type {Presence}\n\t\t */\n\t\tthis._presence = false; // Lazy initialization in the getter\n\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tthis._deviceId = data.deviceId || '';\n\n\t\t/**\n\t\t * @type {string}\n\t\t */\n\t\tthis._contactDeviceId = data.contactDeviceId || '';\n\n\t\t/**\n-\t\t * @type {string}\n-\t\t */\n\t\tthis._avatar = data.avatar || '';\n\n\t\t/**\n\t\t * @type {object}\n\t\t */\n\t\tthis._user = null;\n\n\t\tif (data.presence) {\n\t\t\tthis._presence = data.presence;\n\t\t}\n\n\t\tif (this._userManager) {\n\t\t\tthis._updateUser();\n\t\t\tthis._userManager.on(UserManagerEvents.UPDATED, this._updateUser.bind(this));\n\t\t}\n\t}\n\n\t/**\n\t * Contact unique identifier\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this._base.getId();\n\t}\n\n\t/**\n\t * Name associated with this contact\n\t * @type {string}\n\t */\n\tget name() {\n\t\treturn this._base.getName();\n\t}\n\n\t/**\n\t * Display name associated with this contact\n\t * @type {string}\n\t */\n\tset name(name) {\n\t\tthis._base.setName(name);\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\t/**\n\t * Returns the address associated with the user represented by this contact\n\t * @return {string}\n\t */\n\tget address() {\n\t\tif (!this.isWacUser) {\n\t\t\tthrow Error('Not implemented for contacts without associated user');\n\t\t}\n\t\treturn this._user.username + '@' + this._user.domain;\n\t}\n\n\tget phones() {\n\t\t// Empty phones for anonymous users\n\t\tif (this.isWacUser && this._user.id === this._user.username) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._phones;\n\t}\n\n\tset phones(phones) {\n\t\tthis._phones = phones;\n\t\tthis._updateUser();\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\tget phone() {\n\t\treturn this.phones.length ? this.phones[0].address : undefined;\n\t}\n\n\tset phone(phone) {\n\t\tthis.phones = [{name: '', address: phone}, ...this.phones.filter(p => p.name !== '')];\n\t}\n\n\tget unnormalizedPhones() {\n\t\treturn this._unnormalizedPhones;\n\t}\n\n\tset unnormalizedPhones(unnormalizedPhones) {\n\t\tthis._unnormalizedPhones = unnormalizedPhones;\n\t}\n\n\tget emails() {\n\t\treturn this._emails;\n\t}\n\n\tset emails(emails) {\n\t\tthis._emails = emails;\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\tget email() {\n\t\tconst defaultEmail = this.emails.find(email => email.type === '');\n\t\treturn defaultEmail ? defaultEmail.email : undefined;\n\t}\n\n\tset email(email) {\n\t\tthis.emails = [{type: '', email}, ...this.emails.filter(p => p.type !== '')];\n\t}\n\n\t/**\n\t * Presence associated with this contact\n\t * @type {Presence}\n\t */\n\tget presence() {\n\t\tif (!this._presence) {\n\t\t\tconst address = this._user ? this._user.getAddress() : undefined;\n\t\t\tthis._presence = new Presence(this._presenceManager, address);\n\t\t}\n\t\treturn this._presence;\n\t}\n\n\t/**\n\t * Source name of the contact's source\n\t * @type {string}\n\t */\n\tget source() {\n\t\treturn this._base.getSource();\n\t}\n\n\t/* Source the contact belongs to\n\t * @type {string}\n\t */\n\tset source(source) {\n\t\tthis._base.setSource(source);\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\t/*\n\t * @type {boolean}\n\t */\n\tget isErasable() {\n\t\treturn this.isEditable;\n\t}\n\n\t/*\n\t * @type {boolean}\n\t */\n\tget isEditable() {\n\t\treturn !['static', 'domain', 'users-group'].includes(this.source);\n\t}\n\n\t/**\n\t * Removes the contact\n\t * @return {Promise<undefined,Error>}\n\t */\n\tremove() {\n\t\treturn removeContact(this._base.getId(), this._stack)\n\t\t\t.then(() => this._remove());\n\t}\n\n\t/*\n\t * @type {boolean}\n\t */\n\tget favorite() {\n\t\treturn this._base.isFavorite();\n\t}\n\n\t/**\n\t * Whether the contact is favorite\n\t * @type {boolean}\n\t */\n\tset favorite(favorite) {\n\t\tthis._base.setFavorite(favorite);\n\t\tif (favorite) {\n\t\t\tthis._favoriteManager.saveFavorite(this.contactDeviceId);\n\t\t} else {\n\t\t\tthis._favoriteManager.removeFavorite(this.contactDeviceId);\n\t\t}\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\tget avatar() {\n\t\treturn this._avatar || this.presence.avatar;\n\t}\n\n\tset avatar(value) {\n\t\tthis._avatar = value;\n\t}\n\n\tget isWacUser() {\n\t\treturn !!this._user;\n\t}\n\n\tget deviceId() {\n\t\treturn this._deviceId;\n\t}\n\n\tset deviceId(value) {\n\t\tthis._deviceId = value;\n\t}\n\n\tget contactDeviceId() {\n\t\treturn this._contactDeviceId;\n\t}\n\n\tset contactDeviceId(value) {\n\t\tthis._contactDeviceId = value;\n\t}\n\n\tgetWacUserAddress() {\n\t\treturn this._user ? this._user.getAddress() : undefined;\n\t}\n\n\n\t/**\n\t * Updates the contact with the new data\n\t * @protected\n\t * @param {Contact} contact\n\t */\n\t_update(contact) {\n\t\tthis._base.setId(contact.id);\n\t\tthis._base.setName(contact.name);\n\t\tthis._base.setFavorite(contact.favorite);\n\t\tthis._base.setSource(contact.source);\n\t\tthis._phones = contact.phones;\n\t\tthis._unnormalizedPhones = contact.unnormalizedPhones;\n\t\tthis._emails = contact.emails;\n\t\tthis._updateUser();\n\t\tthis._deviceId = contact.deviceId;\n\t\tthis._contactDeviceId = contact.contactDeviceId;\n\t\tthis.emit('update');\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_updateUser() {\n\t\treturn Promise.all(this.phones.map((phone) => {\n\t\t\treturn this._userManager.resolveUser(phone.address).then((user) => {\n\t\t\t\treturn {user: user, phone: phone};\n\t\t\t});\n\t\t})).then((items) => {\n\t\t\tlet user;\n\t\t\tlet phone;\n\t\t\tlet phones = [];\n\t\t\titems.forEach((item) => {\n\t\t\t\tif (!user && !!item.user) {\n\t\t\t\t\tuser = item.user;\n\t\t\t\t\tphone = item.phone;\n\t\t\t\t} else {\n\t\t\t\t\tphones.push(item.phone);\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet emitUpdate = false; // Avoid emitting the event two times\n\t\t\tif (user) {\n\t\t\t\tthis._phones = [phone].concat(phones);\n\t\t\t\temitUpdate = true;\n\t\t\t}\n\t\t\tif (this._user !== user) {\n\t\t\t\tthis._user = user;\n\t\t\t\tif (this._presence) {\n\t\t\t\t\tthis._presence.address = this._user ? this._user.getAddress() : null;\n\t\t\t\t}\n\t\t\t\temitUpdate = true;\n\t\t\t}\n\t\t\tif (emitUpdate) {\n\t\t\t\tthis.emit('update');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Removes (locally) the contact\n\t * @protected\n\t */\n\t_remove() {\n\t\tthis._stack = null;\n\t\tthis._presence = null;\n\t\tthis.emit('delete');\n\t}\n\n\t/**\n\t * Returns a JS object with the JSON serialization representation of this object\n\t */\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tname: this.name,\n\t\t\tsource: this.source,\n\t\t\tfavorite: this.favorite,\n\t\t\tphones: this.phones,\n\t\t\tunnormalizedPhones: this.unnormalizedPhones,\n\t\t\temails: this.emails,\n\t\t\tdeviceId: this.deviceId,\n\t\t\tcontactDeviceId: this.contactDeviceId,\n\t\t\tisWacUser: this.isWacUser,\n\t\t};\n\t}\n}\n","import {getDeviceId} from '../utils';\n\nconst NUM_MAX_PHONES_BY_CONTACT = 10;\n\nfunction getAvatar(photos) {\n\tif (photos && photos.length > 0) {\n\t\treturn photos[0].value;\n\t}\n\treturn null;\n}\n\nfunction parsePhones(rawPhoneNumbers) {\n\treturn rawPhoneNumbers.slice(0, NUM_MAX_PHONES_BY_CONTACT).map((phone) => {\n\t\tconst name = phone.type;\n\t\tconst address = phone.value.replace(/\\s/g, '');\n\t\treturn {name, address};\n\t});\n}\n\nfunction parseEmails(rawEmails) {\n\tif (!rawEmails) {\n\t\treturn [];\n\t}\n\treturn rawEmails.map(email => ({\n\t\ttype: email.type,\n\t\temail: email.value,\n\t}));\n}\n\nfunction parseName(contact, phones) {\n\treturn contact.displayName || (contact.name && contact.name.formatted ? contact.name.formatted : phones[0].address);\n}\n\n/** @protected */\nexport const W3cContacts = (stack, window) => {\n\n\tconst navigator = window.navigator;\n\tconst deviceId = getDeviceId();\n\tconst ContactFindOptions = window.ContactFindOptions;\n\n\tfunction existDeviceId() {\n\t\tif (!deviceId) {\n\t\t\tthrow Error('W3C Contacts: Can`t get device ID');\n\t\t}\n\t}\n\n\tfunction w3cContactToWacContact(contact) {\n\t\texistDeviceId();\n\t\tlet phones = parsePhones(contact.phoneNumbers);\n\t\tlet emails = parseEmails(contact.emails);\n\t\tlet name = parseName(contact, phones);\n\t\treturn {\n\t\t\tcontactDeviceId: `w3c-contact-${contact.id}-${deviceId}`,\n\t\t\tname: name,\n\t\t\tsource: 'device',\n\t\t\tphones: phones,\n\t\t\temails: emails,\n\t\t\tavatar: getAvatar(contact.photos),\n\t\t\tdeviceId: deviceId,\n\t\t};\n\t}\n\n\tfunction avatarW3cContactToWacContact(contact) {\n\t\texistDeviceId();\n\t\treturn {\n\t\t\tcontactDeviceId: `w3c-contact-${contact.id}-${deviceId}`,\n\t\t\tavatar: getAvatar(contact.photos),\n\t\t};\n\t}\n\n\tfunction getW3cContacts() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet contactFindOptions = new ContactFindOptions();\n\t\t\tcontactFindOptions.multiple = true;\n\t\t\tcontactFindOptions.hasPhoneNumber = true;\n\t\t\tcontactFindOptions.desiredFields = [\n\t\t\t\tnavigator.contacts.fieldType.displayName,\n\t\t\t\tnavigator.contacts.fieldType.name,\n\t\t\t\tnavigator.contacts.fieldType.phoneNumbers,\n\t\t\t\tnavigator.contacts.fieldType.note,\n\t\t\t\tnavigator.contacts.fieldType.emails,\n\t\t\t];\n\t\t\tnavigator.contacts.find(['*'], resolve, reject, contactFindOptions);\n\t\t});\n\t}\n\n\tfunction getAvatarW3cContacts(fields = '*', filter = '') {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet contactFindOptions = new ContactFindOptions();\n\t\t\tcontactFindOptions.multiple = true;\n\t\t\tcontactFindOptions.hasPhoneNumber = true;\n\t\t\tcontactFindOptions.desiredFields = [\n\t\t\t\tnavigator.contacts.fieldType.photos,\n\t\t\t];\n\t\t\tif (filter) {\n\t\t\t\tcontactFindOptions.filter = filter;\n\t\t\t}\n\t\t\tnavigator.contacts.find([fields], resolve, reject, contactFindOptions);\n\t\t});\n\t}\n\n\tfunction allowedContacts() {\n\t\treturn stack.getCapabilities().includes('w3c-contacts-api') && navigator.contacts;\n\t}\n\n\tasync function getContacts() {\n\t\tif (!allowedContacts()) {\n\t\t\treturn [];\n\t\t}\n\t\tconst contacts = await getW3cContacts();\n\t\treturn contacts\n\t\t\t.filter(contact => contact.phoneNumbers && contact.phoneNumbers.length > 0)\n\t\t\t.map(w3cContactToWacContact);\n\t}\n\n\tasync function getAvatarContacts() {\n\t\tif (!allowedContacts()) {\n\t\t\treturn [];\n\t\t}\n\t\tconst contacts = await getAvatarW3cContacts();\n\t\treturn contacts.map(avatarW3cContactToWacContact);\n\t}\n\n\treturn {\n\t\tgetContacts: getContacts,\n\t\tgetAvatarContacts: getAvatarContacts,\n\t};\n};\n","import {W3cContacts} from './W3cContacts';\nimport {\n\tisDevice,\n\tgetDeviceId,\n} from '../utils';\n\nexport class ContactRetriever {\n\n\t/**\n\t * Constructs a get contacts instance\n\t * @param {WacProxy} stack\n\t */\n\tconstructor(stack) {\n\t\t/**\n\t\t * @type {WacProxy}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @type {W3cContacts}\n\t\t */\n\t\tthis._w3cContacts = W3cContacts(this._stack, window || {});\n\n\t\t/**\n\t\t * @type {String}\n\t\t */\n\t\tthis._deviceId = getDeviceId();\n\t}\n\n\t/**\n\t * If we are on device, get the contacts from the WAC without the device contacts.\n\t * In other case, get all the contacts stored in the WAC\n\t *\n\t * Return type :  <wac-contact>[]\n\t */\n\tasync getContactsWac() {\n\t\tlet filter = {};\n\t\tif (isDevice()) {\n\t\t\tfilter['deviceId'] = -1;\n\t\t}\n\t\treturn this._stack.getContacts(filter);\n\t}\n\n\t/**\n\t * Get the device contacts\n\t * Return type :  <wac-contact>[]\n\t */\n\tgetContactsDevice() {\n\t\treturn this._w3cContacts.getContacts();\n\t}\n\n\t/**\n\t * Get the avatar for all device contacts\n\t * @return {Map} A map with contactDeviceId as key and avatar as value\n\t */\n\tgetAvatarDeviceContacts() {\n\t\treturn this._w3cContacts.getAvatarContacts().then((avatars) => {\n\t\t\tlet avatarsContacts = new Map();\n\t\t\tavatars = avatars.filter(avatar => !!avatar.avatar);\n\t\t\tavatars.forEach((avatarElem) => {\n\t\t\t\tavatarsContacts.set(avatarElem.contactDeviceId, avatarElem.avatar);\n\t\t\t});\n\t\t\treturn avatarsContacts;\n\t\t});\n\t}\n}\n","import Hashes from 'jshashes';\nimport {\n\tgetItem,\n\tsetItem,\n\tremoveItem,\n} from '../utils';\n\nconst VALID_CACHE = 'validCache';\nconst SAVED_USER = 'savedUser';\nconst SAVED_DEVICE_CONTACTS = 'savedDeviceContacts';\nconst SAVED_DEVICE_WAC_CONTACTS = 'savedDeviceWacContacts';\nconst SAVED_WAC_CONTACTS = 'savedWacContacts';\nconst HASH_DEVICE_CONTACTS = 'hashDeviceContacts';\nconst HASH_WAC_CONTACTS = 'hashWacContacts';\nconst SAVED_AVATAR_DEVICE_CONTACTS = 'savedAvatarDeviceContacts';\nconst SAVED_FAVORITE_CONTACTS = 'favoriteContacts';\n\nfunction doHash(data) {\n\tlet md5 = new Hashes.MD5();\n\treturn md5.hex(JSON.stringify(data));\n}\n\n/** @private */\nexport function getDeviceWacContacts() {\n\treturn getItem(SAVED_DEVICE_WAC_CONTACTS);\n}\n\n/** @private */\nexport function setDeviceWacContacts(deviceWacContacts) {\n\tsetItem(SAVED_DEVICE_WAC_CONTACTS, deviceWacContacts);\n}\n\n/** @private */\nexport function setAvatarDeviceContacts(avatars) {\n\tsetItem(SAVED_AVATAR_DEVICE_CONTACTS, avatars);\n}\n\n/** @private */\nexport function getAvatarDeviceContacts() {\n\treturn getItem(SAVED_AVATAR_DEVICE_CONTACTS);\n}\n\n/** @private */\nexport function setWacContacts(wacContacts) {\n\tsetItem(SAVED_WAC_CONTACTS, wacContacts);\n\tsetItem(HASH_WAC_CONTACTS, doHash(wacContacts));\n}\n\n/** @private */\nexport function getWacContacts() {\n\treturn getItem(SAVED_WAC_CONTACTS);\n}\n\n/** @private */\nexport function setDeviceContacts(deviceContacts) {\n\tsetItem(HASH_DEVICE_CONTACTS, doHash(deviceContacts));\n\tsetItem(SAVED_DEVICE_CONTACTS, deviceContacts);\n}\n\n/** @private */\nexport function validateCache() {\n\tsetItem(VALID_CACHE, true);\n}\n\n/** @private */\nexport function invalidateCache() {\n\tsetItem(VALID_CACHE, false);\n\tremoveItem(SAVED_DEVICE_CONTACTS);\n\tremoveItem(HASH_DEVICE_CONTACTS);\n\tremoveItem(SAVED_AVATAR_DEVICE_CONTACTS);\n}\n\n/** @private */\nexport function isValidCache() {\n\treturn getItem(VALID_CACHE);\n}\n\n/** @private */\nexport function isCacheUpdated(deviceContacts) {\n\tlet hashSavedContacts = getItem(HASH_DEVICE_CONTACTS);\n\tlet hashDeviceContacts = doHash(deviceContacts);\n\treturn hashSavedContacts === hashDeviceContacts;\n}\n\n/** @private */\nexport function getFavoriteContacts() {\n\treturn getItem(SAVED_FAVORITE_CONTACTS);\n}\n\n/** @private */\nexport function updateFavoriteContacts(favorites) {\n\tsetItem(SAVED_FAVORITE_CONTACTS, favorites);\n}\n\n/** @private */\nexport function emptyAllContactData() {\n\tremoveItem(SAVED_DEVICE_WAC_CONTACTS);\n\tremoveItem(SAVED_WAC_CONTACTS);\n\tremoveItem(HASH_WAC_CONTACTS);\n\tremoveItem(SAVED_USER);\n\tinvalidateCache();\n}\n\n/** @private */\nexport function invalidateCacheIfNeeded(stack) {\n\tif (stack.getCurrentSession().user === getItem(SAVED_USER)) {\n\t\treturn;\n\t}\n\temptyAllContactData();\n\tsetItem(SAVED_USER, stack.getCurrentSession().user);\n}\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import baseIsEqual from './_baseIsEqual.js';\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\nexport default isEqual;\n","import {EventEmitter} from '../eventemitter';\nimport {ContactRetriever} from './ContactRetriever';\nimport {\n\tisDevice,\n\tgetDeviceId,\n} from '../utils';\nimport * as ContactCache from './ContactCache';\nimport {isEqual} from 'lodash-es';\nimport Logs from '../Logs';\n\nlet log = Logs.instance.getLogger('SippoJS/ContactSynchronizer');\nconst NUM_CONTACTS_ALLOW_UPLOAD_ONE_BY_ONE = 30;\n\n/**\n * Get an object without some fields\n * @param {Object} contact\n * @return {Object} New object without some fields\n */\nfunction _getContactToCompare(contact) {\n\tlet objContact = Object.assign({}, contact);\n\tdelete objContact.user;\n\tdelete objContact.favorite;\n\tdelete objContact.id;\n\tdelete objContact.unnormalizedPhones;\n\tobjContact.avatar = null;\n\tobjContact.phones = contact.unnormalizedPhones;\n\treturn objContact;\n}\n\nfunction _prepareToUpdate(oldContact, newContact) {\n\treturn Object.assign(oldContact, newContact);\n}\n\nconst _isNeededUploadCompleteListAgain = (arrayOfArrays) => {\n\treturn arrayOfArrays.reduce((counter, actual) => {\n\t\tcounter += actual.length;\n\t\treturn counter;\n\t}, 0) >= NUM_CONTACTS_ALLOW_UPLOAD_ONE_BY_ONE;\n};\n\nconst _onErrorSyncContacts = (err) => {\n\treturn err.message === 'not-sync-avatars' ?\n\t\tPromise.resolve() :\n\t\tPromise.reject(err);\n};\n\n/**\n * Keeps the wac contacts up to date with device contacts.\n */\nexport class ContactSynchronizer extends EventEmitter {\n\tconstructor(stack, favoriteContact) {\n\t\tsuper();\n\t\tthis._stack = stack;\n\t\tthis._retriever = new ContactRetriever(stack);\n\t\tthis._deviceId = getDeviceId();\n\t\tthis._favoriteContacts = favoriteContact;\n\t}\n\n\t/**\n\t * Init the contact sync at first time\n\t * @param {*} deviceContacts : <W3cContact>[]\n\t */\n\tsyncContacts(deviceContacts) {\n\t\tif (this._isAllowDeviceContacts()) {\n\t\t\treturn this._invalidateAndSyncContacts(deviceContacts);\n\t\t}\n\t\tthis.emit('stop-synchronizing');\n\t}\n\n\t/**\n\t * Launch the synchronizing to check if a change has occurred\n\t */\n\tlaunchSynchronize() {\n\t\tlet devSync = Promise.resolve();\n\t\tif (this._isAllowDeviceContacts()) {\n\t\t\tdevSync = this._retriever.getContactsDevice().then((deviceContacts) => {\n\t\t\t\tif (!ContactCache.isCacheUpdated(deviceContacts)) {\n\t\t\t\t\tthis.emit('start-synchronizing');\n\t\t\t\t\tlet deviceContactsStored = ContactCache.getDeviceWacContacts();\n\t\t\t\t\tContactCache.invalidateCache();\n\t\t\t\t\tlet contactsToDelete = this._getContactsToDeleted(deviceContactsStored, deviceContacts);\n\t\t\t\t\tlet [contactsToUpdate, contactsToInsert] = this._getContactsToSynchronize(deviceContactsStored, deviceContacts);\n\t\t\t\t\treturn _isNeededUploadCompleteListAgain([contactsToDelete, contactsToUpdate, contactsToInsert]) ?\n\t\t\t\t\t\tthis._uploadAllContactsAgain(deviceContacts) :\n\t\t\t\t\t\tthis._sendUpdatesToWac(contactsToDelete, contactsToUpdate, contactsToInsert, deviceContacts);\n\t\t\t\t}\n\t\t\t\tthis.emit('stop-synchronizing');\n\t\t\t})\n\t\t\t\t.then(() => this.launchSynchronizeAvatars())\n\t\t\t\t.catch(_onErrorSyncContacts);\n\t\t}\n\t\treturn devSync;\n\t}\n\n\t/**\n\t * Get an array with contacts to update and to insert\n\t * @param {Array} oldListContacts\n\t * @param {Array} newListContacts\n\t * @return {Array} Two elements. First a list of contacts to update and\n\t *                 second element with a list of contact to insert\n\t */\n\t_getContactsToSynchronize(oldListContacts, newListContacts) {\n\t\tlet mapOldDeviceContacts = new Map(oldListContacts.map(contact => [contact.contactDeviceId, contact]));\n\t\tlet contactsToUpdate = [];\n\t\tlet contactsToInsert = [];\n\t\tnewListContacts.forEach((contact) => {\n\t\t\tif (mapOldDeviceContacts.has(contact.contactDeviceId)) {\n\t\t\t\tlet oContactStored = mapOldDeviceContacts.get(contact.contactDeviceId);\n\t\t\t\treturn !isEqual(contact, _getContactToCompare(oContactStored)) ?\n\t\t\t\t\tcontactsToUpdate.push(_prepareToUpdate(oContactStored, contact)) :\n\t\t\t\t\tundefined;\n\t\t\t}\n\t\t\treturn contactsToInsert.push(contact);\n\t\t});\n\t\treturn [contactsToUpdate, contactsToInsert];\n\t}\n\n\t/**\n\t * Get the list of contacts to delete\n\t * @param {Array} oldListContacts\n\t * @param {Array} newListContacts\n\t * @return {Array} A list with contacts to delete\n\t */\n\t_getContactsToDeleted(oldListContacts, newListContacts) {\n\t\tlet mapNewListContacts = new Map(newListContacts.map(contact => [contact.contactDeviceId, contact]));\n\t\treturn oldListContacts.map((contact) => {\n\t\t\tif (!mapNewListContacts.has(contact.contactDeviceId)) {\n\t\t\t\treturn contact;\n\t\t\t}\n\t\t}).filter(contact => !!contact);\n\t}\n\n\t/**\n\t * Update the new changes to the WAC\n\t * @param {Array} contactsToDelete\n\t * @param {Array} contactsToUpdate\n\t * @param {Array} contactsToInsert\n\t * @param {Array} deviceContacts\n\t * @return {Promise} Fulfilled if success\n\t */\n\t_sendUpdatesToWac(contactsToDelete, contactsToUpdate, contactsToInsert, deviceContacts) {\n\t\tcontactsToUpdate = this._favoriteContacts.updateContactsWithFavoriteFlag(contactsToUpdate);\n\t\treturn Promise.all([\n\t\t\tthis._removeContacts(contactsToDelete),\n\t\t\tthis._addContacts(contactsToInsert),\n\t\t\tthis._updateContacts(contactsToUpdate),\n\t\t]).then(() => {\n\t\t\tContactCache.setDeviceContacts(deviceContacts);\n\t\t\tContactCache.validateCache();\n\t\t});\n\t}\n\n\n\t/**\n\t * Sync the avatars of the device contacts\n\t */\n\tlaunchSynchronizeAvatars() {\n\t\tif (this._isAllowDeviceContacts()) {\n\t\t\treturn this._retriever.getAvatarDeviceContacts().then((avatars) => {\n\t\t\t\tContactCache.setAvatarDeviceContacts(Array.from(avatars));\n\t\t\t\tthis.emit('update-avatars-contacts', avatars);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Invalidate list of contacts for this device and upload all contacts\n\t */\n\t_invalidateAndSyncContacts(deviceContacts) {\n\t\tlog.info('device contacts out of sync, uploading new list');\n\t\tthis.emit('sync-all-device-contacts');\n\t\treturn this._stack.invalidateContacts(this._deviceId)\n\t\t\t.then(() => this._uploadContacts(deviceContacts))\n\t\t\t.then(() => {\n\t\t\t\tContactCache.setDeviceContacts(deviceContacts);\n\t\t\t\tContactCache.validateCache();\n\t\t\t});\n\t}\n\n\t/**\n\t * Invalidate list of contacts for this device,\n\t * upload all contacts and avoid to sync avatars\n\t */\n\t_uploadAllContactsAgain(deviceContacts) {\n\t\treturn this._invalidateAndSyncContacts(deviceContacts)\n\t\t\t.then(() => {\n\t\t\t\tthrow new Error('not-sync-avatars');\n\t\t\t});\n\t}\n\n\n\t/**\n\t * Upload a list of contacts to the WAC.\n\t * @param {*} contactList\n\t */\n\t_uploadContacts(contactList) {\n\t\treturn contactList.length ? this._stack.insertMany({\n\t\t\tcontacts: contactList,\n\t\t\tsource: 'device',\n\t\t}) : Promise.resolve();\n\t}\n\n\t/**\n\t * Add new contacts to the WAC.\n\t * @param {*} contactList\n\t */\n\t_addContacts(contactList) {\n\t\tif (contactList.length) {\n\t\t\treturn Promise.all(contactList.map(contact => this._stack.addContact(contact)));\n\t\t}\n\t}\n\n\t/**\n\t * Update a list of contacts to the WAC.\n\t * @param {*} contactList\n\t */\n\t_updateContacts(contactList) {\n\t\tif (contactList.length) {\n\t\t\treturn Promise.all(contactList.map(contact => this._stack.updateContact(contact)));\n\t\t}\n\t}\n\n\t/**\n\t * Remove contacts in the WAC.\n\t * @param {*} contactsList\n\t */\n\t_removeContacts(contactsList) {\n\t\tif (contactsList.length) {\n\t\t\treturn Promise.all(contactsList.map(contact => this._stack.removeContact(contact)));\n\t\t}\n\t}\n\n\t_isAllowDeviceContacts() {\n\t\treturn isDevice() && this._stack.getCapabilities().includes('w3c-contacts-api');\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\nimport {BaseContact} from './BaseContact';\nimport {\n\tupdateContact,\n\tremoveContact,\n} from './utils';\n\nconst isValidParticipants = participants =>\n\t!(Array.isArray(participants) && participants.length > 0);\n\n/**\n * Represents a group contact. This class must not be directly instantiated. Instead,\n * instances of this class are obtained by calling the {@link ContactManager#createGroupContact}\n * or {@link ContactManager#getContacts} methods of {ContactManager}\n *\n * ## Events\n *\n * - **`update`** is emitted every time the contact is updated.\n * - **`delete`** is emitted when the contact is deleted.\n */\nexport class GroupContact extends EventEmitter {\n\n\t/**\n\t * Constructs a new contact\n\t * @protected\n\t * @param {WacStack} stack\n\t * @param {Object} data\n\t * @param {string} data.id\n\t * @param {string} data.name\n\t * @param {string} data.source\n\t * @param {boolean} data.favorite\n\t * @param {Object[]} data.participants\n\t * @property {string} data.participants.name\n\t * @property {string} data.participants.address\n\t */\n\tconstructor(stack, data = {}) {\n\t\tsuper();\n\n\t\t/**\n\t\t * @type {WacStack}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @type {BaseContact}\n\t\t * @private\n\t\t */\n\t\tthis._base = BaseContact.create(data);\n\n\t\t/**\n\t\t * @type {Object[]}\n\t\t */\n\t\tthis._participants = data.participants || [];\n\t}\n\n\t/**\n\t * Contact unique identifier\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this._base.getId();\n\t}\n\n\t/**\n\t * Name associated with this contact\n\t * @type {string}\n\t */\n\tget name() {\n\t\treturn this._base.getName();\n\t}\n\n\t/**\n\t * Source name of the contact's source\n\t * @type {string}\n\t */\n\tget source() {\n\t\treturn this._base.getSource();\n\t}\n\n\t/*\n\t * @type {boolean}\n\t */\n\tget favorite() {\n\t\treturn this._base.isFavorite();\n\t}\n\n\t/**\n\t * Source name of the contact's source\n\t * @type {string}\n\t */\n\tget participants() {\n\t\treturn this._participants;\n\t}\n\n\n\t/**\n\t * Display name associated with this contact\n\t * @type {string}\n\t */\n\tset name(name) {\n\t\tthis._base.setName(name);\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\t/**\n\t * Whether the contact is favorite\n\t * @type {boolean}\n\t */\n\tset favorite(favorite) {\n\t\tthis._base.setFavorite(favorite);\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\t/**\n\t * Update the participants\n\t * @type {boolean}\n\t */\n\tset participants(participants) {\n\t\tif (isValidParticipants(participants)) {\n\t\t\tthrow Error('participants must be an array');\n\t\t}\n\t\tthis._participants = participants;\n\t\tupdateContact(this._base.getId(), this._stack, this.toJSON());\n\t}\n\n\n\t/**\n\t * Removes the contact\n\t * @return {Promise<undefined,Error>}\n\t */\n\tremove() {\n\t\treturn removeContact(this._base.getId(), this._stack)\n\t\t\t.then(() => this._remove());\n\t}\n\n\t/**\n\t * Updates the contact with the new data\n\t * @protected\n\t * @param {Contact} contact\n\t */\n\t_update(contact) {\n\t\tthis._base.setName(contact.name);\n\t\tthis._base.setFavorite(contact.favorite);\n\t\tthis._participants = contact.participants;\n\t\tthis.emit('update');\n\t}\n\n\t/**\n\t * Removes (locally) the contact\n\t * @protected\n\t */\n\t_remove() {\n\t\tthis._stack = null;\n\t\tthis.emit('delete');\n\t}\n\n\t/**\n\t * Returns a JS object with the JSON serialization representation of this object\n\t */\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tname: this.name,\n\t\t\tsource: this.source,\n\t\t\tfavorite: this.favorite,\n\t\t\tparticipants: this.participants,\n\t\t};\n\t}\n}\n\n","import {\n\tgetFavoriteContacts,\n\tupdateFavoriteContacts,\n} from './ContactCache';\n\nexport class FavoriteContact {\n\tconstructor() {\n\t\tthis._favoriteContacts = new Set(getFavoriteContacts() || []);\n\t}\n\n\tsaveFavorite(contactDeviceId) {\n\t\tthis._favoriteContacts.add(contactDeviceId);\n\t\tupdateFavoriteContacts(Array.from(this._favoriteContacts));\n\t}\n\n\tremoveFavorite(contactDeviceId) {\n\t\tif (this._favoriteContacts.delete(contactDeviceId)) {\n\t\t\tupdateFavoriteContacts(Array.from(this._favoriteContacts));\n\t\t}\n\t}\n\n\tgetFavoriteContacts() {\n\t\treturn this._favoriteContacts;\n\t}\n\n\tupdateContactsWithFavoriteFlag(contacts) {\n\t\treturn contacts.map((contact) => {\n\t\t\tcontact.favorite = this.getFavoriteContacts().has(contact.contactDeviceId);\n\t\t\treturn contact;\n\t\t});\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\nimport {\n\tbindMethods,\n\tisDevice,\n\tgetDeviceId,\n} from '../utils';\nimport {Presence} from './Presence';\nimport {OwnPresence} from './OwnPresence';\nimport {Contact} from './Contact';\nimport {ContactSynchronizer as Synchronizer} from './ContactSynchronizer';\nimport {ContactRetriever} from './ContactRetriever';\nimport {ContactFactory} from './ContactFactory';\nimport {FavoriteContact} from './FavoriteContact';\nimport {GroupContact} from './GroupContact';\nimport * as ContactCache from './ContactCache';\nimport Logs from '../Logs';\n\nlet log = Logs.instance.getLogger('SippoJS/ContactManager');\n\n// https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-contacts/#contacterror\nconst CODE_ERRORS_CORDOVA = [0, 1, 2, 3, 4, 5, 6, 20];\n\n/**\n * Check if a contact belongs to a device\n * @param contact\n * @returns {boolean}\n * @private\n */\nfunction _isFromDevice(contact) {\n\treturn contact.deviceId !== '';\n}\n\n/**\n * Check if the error was emitted by cordova\n * @param err\n * @return boolean\n * https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-contacts/#contacterror\n */\nfunction errorGettingDeviceContacts(err) {\n\t// When the app is used in a android device, cordova returns a number primitive\n\t// instead of an object\n\tlet code = typeof err === 'number' ? err : err.code;\n\treturn code ? CODE_ERRORS_CORDOVA.includes(code) : false;\n}\n\n/**\n * Remove device contacts from the list\n * @param {Array} contacts\n */\nfunction removeDeviceContactFromList(contacts) {\n\treturn contacts.filter(contact => contact.source !== 'device');\n}\n\n/**\n * ContactManager instance is obtained by calling the {@link Session#getContactManager}\n * method of {@link Session} and must not be directly instantiated.\n * Once the ContactManager instance is obtained {@link ContactManager#init} method\n * must be called to initialize it.\n *\n * ## Events\n *\n * - **`create`** is emitted every time a new contact is added to the contact list.\n *   - {@link Contact} `contact` The contact that has just been created.\n * - **`contact-added`** is emitted every time a new contact is added to the cache after have been created\n *   - {@link Contact} `contact` The contact that has just been created.\n * - **`update`** is emitted when some contact is updated.\n *   - {@link Contact} `contact` The contact that has just been updated.\n * - **`delete`** is emitted when some contact is deleted.\n *   - {@link Contact} `contact` The contact that has just been deleted.\n * - ** start-synchronizing ** is emitted when a synchronizing process starts\n * - ** start-synchronizing-background ** is emitted when a synchronizing process starts in background\n * - ** start-synchronizing-avatars ** is emitted when a avatar synchronizing process starts\n * - ** stop-synchronizing ** is emitted when a synchronizing process ends\n * - ** sync-all-device-contacts ** is emitted when all device contacts are going to be uploaded\n *\n * You can check EventEmitter2 documentation for additional information about\n * adding and removing listeners for this events events.\n *\n * @see https://github.com/asyncly/EventEmitter2#api\n *\n * @example <caption>Get contact list</caption>\n * contactManager.init().then(function() {\n *   contactManager.getContacts().forEach(function(contact) {\n *     console.log(contact.name);\n *   });\n * });\n *\n * To sync contacts, a new function must be called (contact Manager has to be initialized previously)\n * @example <caption>Try the sync process</caption>\n * contactManager.launchSynchronize().then(function() {\n *   contactManager.getContacts().forEach(function(contact) {\n *     console.log(contact.name);\n *   });\n * });\n */\nexport class ContactManager extends EventEmitter {\n\n\t/**\n\t * Constructs a contact manager\n\t * @protected\n\t * @param {WacProxy} stack\n\t * @param {UserManager} userManager\n\t * @param {PresenceManager} presenceManager\n\t */\n\tconstructor(stack, userManager, presenceManager) {\n\t\tsuper();\n\n\t\t/**\n\t\t * @type {WacProxy}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @type {UserManager}\n\t\t */\n\t\tthis._userManager = userManager;\n\n\t\t/**\n\t\t * @type {PresenceManager}\n\t\t */\n\t\tthis._presenceManager = presenceManager;\n\n\t\t/**\n\t\t * @type {Array<Contact>}\n\t\t */\n\t\tthis._contacts = [];\n\n\t\t/**\n\t\t * @type {Promise}\n\t\t */\n\t\tthis._initializing = null;\n\n\t\t/**\n\t\t * @type {String}\n\t\t */\n\t\tthis._deviceId = getDeviceId();\n\n\t\tconst ownAddress = userManager.getAddress(stack.getCurrentSession().user);\n\t\t/**\n\t\t * Allows to change the presence of this session\n\t\t * @type {OwnPresence}\n\t\t */\n\t\tthis.ownPresence = new OwnPresence(stack, presenceManager, ownAddress);\n\n\t\t/**\n\t\t * It's in charge of getting the contacts\n\t\t * @type {ContactRetriever}\n\t\t */\n\t\tthis._retriever = new ContactRetriever(stack);\n\n\t\t/**\n\t\t * Manage the favorite contacts\n\t\t * @type {FavoriteContact}\n\t\t */\n\t\tthis._favorite = new FavoriteContact();\n\n\t\t/**\n\t\t * It's in charge of synchronizing contacts\n\t\t * @type {ContactSynchronizer}\n\t\t */\n\t\tthis._synchronizer = new Synchronizer(stack, this._favorite);\n\n\t\t/**\n\t\t * Create a contact factory\n\t\t */\n\t\tthis._contactFactory = ContactFactory({\n\t\t\tstack: this._stack,\n\t\t\tuserManager: this._userManager,\n\t\t\tpresenceManager: this._presenceManager,\n\t\t\tfavoriteManager: this._favorite,\n\t\t});\n\n\t\tbindMethods(this, [\n\t\t\t'onContactAdd',\n\t\t\t'onContactUpdate',\n\t\t\t'onContactRemove',\n\t\t\t'onContactAddMany',\n\t\t\t'onUpdateListContacts',\n\t\t\t'onUpdateAvatarsContacts',\n\t\t\t'_addContact',\n\t\t\t'_onSyncProcessError',\n\t\t]);\n\t\tbindMethods(this, [\n\t\t\t'onLocalContactRemove',\n\t\t], true);\n\t}\n\n\t/**\n\t * @returns {Object} Returns an object with the prototypes to allow customizing\n\t * the getters with any kind of application specific behaviours\n\t * @property {Object} Contact The prototype for Contact objects\n\t * @property {Object} GroupContact The prototype for Group Contact objects\n\t * @property {Object} Presence The prototype for Presence objects\n\t * @property {Object} OwnPresence The prototype for Own Presence objects\n\t */\n\tget prototypes() {\n\t\treturn {\n\t\t\tContact: Contact.prototype,\n\t\t\tGroupContact: GroupContact.prototype,\n\t\t\tPresence: Presence.prototype,\n\t\t\tOwnPresence: OwnPresence.prototype,\n\t\t};\n\t}\n\n\t/**\n\t * Initializes the contact manager\n\t * @returns {Promise<ContactManager, Error>} A promise that returns when fulfilled\n\t * the contact manager instance\n\t */\n\tinit() {\n\t\tif (!this._initializing) {\n\t\t\tthis._initializing = (async () => {\n\t\t\t\tContactCache.invalidateCacheIfNeeded(this._stack);\n\t\t\t\tthis._initCallbacks();\n\n\t\t\t\tlet savedContacts = ContactCache.getDeviceWacContacts();\n\t\t\t\tconst validCache = ContactCache.isValidCache();\n\t\t\t\tconst wacContacts = await this._retriever.getContactsWac();\n\t\t\t\tContactCache.setWacContacts(wacContacts);\n\n\t\t\t\tif (savedContacts && validCache) {\n\t\t\t\t\tsavedContacts = this._favorite.updateContactsWithFavoriteFlag(savedContacts);\n\t\t\t\t\tsavedContacts = this._updateAvatarOfContacts(savedContacts, new Map(ContactCache.getAvatarDeviceContacts() || []));\n\t\t\t\t\tconst allContacts = savedContacts.concat(wacContacts);\n\t\t\t\t\tallContacts.forEach(this._addContact);\n\t\t\t\t} else {\n\t\t\t\t\tthis.emit('start-synchronizing');\n\t\t\t\t\tthis._insertWACContact(wacContacts);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst deviceContacts = await this._retriever.getContactsDevice();\n\t\t\t\t\t\tawait this._synchronizer.syncContacts(deviceContacts);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tthis._onSyncProcessError(err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\t\treturn this._initializing;\n\t}\n\n\t/**\n\t * Uninitializes the contact manager\n\t * @returns {Promise<undefined, Error>} A promise that is fulfilled when unitialization finishes\n\t */\n\tuninit() {\n\t\tif (this._initializing === null) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this._initializing.finally(() => {\n\t\t\tthis._unInitCallbacks();\n\t\t\tthis._contacts = [];\n\t\t\tthis._initializing = null;\n\t\t});\n\t}\n\n\n\t/**\n\t * Call stack.addContact once the manager is initialized and return a promise.\n\t *\n\t * If the contact is successfully created the promise will be resolved, otherwise will be rejected.\n\t * The wac will send a qs-contact-add event to every session.\n\t *\n\t * @param {String} displayName The name of the new contact\n\t * @param {string | {name: string, address: string}[]} phones Phone or phones of the new contact\n\t * @param {{email: string}[]} emails Email or emails of the new contact\n\t */\n\tcreateContact(displayName, phones, emails) {\n\t\tif (!Array.isArray(phones)) {\n\t\t\tphones = [{\n\t\t\t\tname: '',\n\t\t\t\taddress: phones,\n\t\t\t}];\n\t\t}\n\t\tlet contactData = {\n\t\t\tid: '',\n\t\t\tphones,\n\t\t\temails,\n\t\t\tname: displayName,\n\t\t\tsource: 'wac',\n\t\t};\n\t\treturn this._initializing.then(() => this._stack.addContact(contactData));\n\t}\n\n\t/**\n\t * If the contact is successfully created the promise will be resolved, otherwise will be rejected.\n\t * The wac will send a qs-contact-add event to every session.\n\t *\n\t * @param {String} displayName The name of the new contact\n\t * @param {Object} participants\n\t * @param {String} participants.name The name associated to the phone of the participant\n\t * @param {String} participants.address The phone of the participant\n\t */\n\tcreateGroupContact(displayName, participants) {\n\t\tif (!participants) {\n\t\t\treturn Promise.reject('a list of participants must be given');\n\t\t}\n\t\tlet contactData = {\n\t\t\tname: displayName,\n\t\t\tsource: 'group',\n\t\t\tparticipants,\n\t\t};\n\t\treturn this._initializing\n\t\t\t.then(() => this._stack.addContact(contactData));\n\t}\n\n\n\t/**\n\t * Retrieves a list with the available contacts\n\t * @return {Array<Contact>}\n\t */\n\tgetContacts() {\n\t\treturn this._contacts;\n\t}\n\n\t/**\n\t * Retrieves a contact given a WAC id\n\t * @return {Contact}\n\t */\n\tgetContactByWacId(wacId) {\n\t\treturn this.getContactByAddress(this._userManager.getAddress(wacId));\n\t}\n\n\t/**\n\t * Retrieves the presence of a user given its WAC id\n\t * @return {Contact}\n\t */\n\tgetPresenceByWacId(wacId) {\n\t\treturn new Presence(this._presenceManager, this._userManager.getAddress(wacId));\n\t}\n\n\t/**\n\t * Retrieves a contact given an email\n\t * @param {String} email\n\t * @return {Contact|undefined}\n\t */\n\tgetContactByEmail(email) {\n\t\treturn this._contacts.find((c) => {\n\t\t\treturn c.emails && c.emails.some(elem => elem.email === email);\n\t\t});\n\t}\n\n\t/**\n\t * Retrieves a contact given an address\n\t * @param {String} address\n\t * @param {boolean} [sync=true] If false returns a Promise of a contact\n\t * @return {Contact}\n\t */\n\tgetContactByAddress(address, sync = true) {\n\t\tlet contact;\n\t\tif (address.includes('@')) {\n\t\t\tconst [username, domain] = address.split('@');\n\t\t\tcontact = this._contacts.find(c => c._user && c._user.username.toLowerCase() === username.toLowerCase() && c._user.domain === domain);\n\t\t} else if (this._userManager.isAddress(address)) {\n\t\t\tlet userId = this._userManager.getUserId(address);\n\t\t\tcontact = this._contacts.find(c => c._user && c._user.id === userId);\n\t\t\tif (contact) {\n\t\t\t\tlog.warn(`getContacByAddress: ${address} is not a valid address. Deprecated fallback searching for old style address obtained a match.`);\n\t\t\t}\n\t\t} else {\n\t\t\tcontact = this._contacts.find((c) => {\n\t\t\t\treturn c.phones ? c.phones.some(phone => phone.address === address) : undefined;\n\t\t\t});\n\t\t\tif (contact) {\n\t\t\t\tlog.warn(`getContacByAddress: ${address} is not a valid address. Deprecated fallback searching in phones obtained a match.`);\n\t\t\t}\n\t\t}\n\t\tif (contact) {\n\t\t\treturn sync ? contact : Promise.resolve(contact);\n\t\t}\n\t\tcontact = this._contactFactory.create({});\n\t\tlet task = this._userManager.resolveUser(address).then((user) => {\n\t\t\tlet phone = user ? user.alias || user.username : address;\n\t\t\tif (!user) {\n\t\t\t\tcontact.name = address;\n\t\t\t}\n\t\t\tcontact.phone = phone;\n\t\t});\n\t\tif (sync) {\n\t\t\treturn contact;\n\t\t} else {\n\t\t\treturn task.then(() => contact);\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves the presence of a user given an address\n\t * @return {Promise<Presence>}\n\t */\n\tgetPresenceByAddress(address) {\n\t\treturn this._userManager.resolveUser(address).then((user) => {\n\t\t\treturn user ? this.getPresenceByWacId(user.id) : undefined;\n\t\t});\n\t}\n\n\t/**\n\t * Returns a new local only contact with the specified parameters\n\t * @param {object} options\n\t * @param {string} options.id\n\t * @param {string} [name]\n\t * @param {Presence} [presence]\n\t * @param {string} [avatar]\n\t * @param {string} [phone]\n\t * @param {string} [email]\n\t */\n\tgetFakeContact({\n\t\tid,\n\t\tname,\n\t\tpresence,\n\t\tavatar,\n\t\tphone,\n\t\temail,\n\t}) {\n\t\tconst phones = phone ? [{name: '', address: phone}] : [];\n\t\tconst emails = email ? [{type: '', email: email}] : [];\n\t\treturn new Contact(null, null, null, null, {\n\t\t\tid,\n\t\t\tname,\n\t\t\tphones,\n\t\t\temails,\n\t\t\tsource: '',\n\t\t\tfavorite: false,\n\t\t\tdeviceId: '',\n\t\t\tcontactDeviceId: '',\n\t\t\tavatar,\n\t\t\tpresence,\n\t\t});\n\t}\n\n\t/**\n\t * Launch the sinchronizing to check if a change has occured\n\t * @return {Promise} if success\n\t */\n\tlaunchSynchronize() {\n\t\treturn this._synchronizer.launchSynchronize()\n\t\t\t.catch(this._onSyncProcessError);\n\t}\n\n\t/**\n\t * Treat the error when a sync process fails\n\t * @param err\n\t * @returns {Promise}\n\t * @private\n\t */\n\t_onSyncProcessError(err) {\n\t\tlog.error('Failed sync process: ', err);\n\t\tif (!errorGettingDeviceContacts(err)) {\n\t\t\tlog.error(err);\n\t\t\tthrow err;\n\t\t}\n\t\tthis._contacts = removeDeviceContactFromList(this.getContacts());\n\t\treturn this._stack.invalidateContacts(this._deviceId).then(() => {\n\t\t\tthis.clearContactsDataFromPersistentStorage();\n\t\t}).catch((invalidatingErr) => {\n\t\t\tlog.error('Failed invalidating contacts: ', invalidatingErr);\n\t\t\tthrow invalidatingErr;\n\t\t}).then(() => {\n\t\t\tthrow err;\n\t\t});\n\t}\n\n\t/**\n\t * Internal callback for Contact event\n\t * @private\n\t * @param {Contact} contact\n\t */\n\tonLocalContactRemove(contact) {\n\t\tif (this._rmContact(contact.id) !== undefined) {\n\t\t\tthis.emit('delete', contact);\n\t\t}\n\t}\n\n\t/**\n\t * Internal callback for WAC event\n\t *\n\t * When the contacts arrive after a synchronizing, insert the contacts in the contacts list\n\t * and update the contact list stored in the navigator when:\n\t *   - The contacts that arrive belong to the device that has done the synchronizing\n\t *   - We are on desktop.\n\t * @private\n\t * @param  {Array<Contact>} contacts Contacts retrieved from the WAC\n\t */\n\tonContactAddMany(contacts) {\n\t\tthis._emptyContactList();\n\t\tlet savedWacContacts = ContactCache.getWacContacts();\n\t\treturn Promise.resolve().then(() => {\n\t\t\tif (!isDevice()) {\n\t\t\t\tsavedWacContacts = savedWacContacts.filter(contact => contact.deviceId !== contacts[0].deviceId);\n\t\t\t\tsavedWacContacts = savedWacContacts.concat(contacts);\n\t\t\t\tContactCache.setWacContacts(savedWacContacts);\n\t\t\t\tsavedWacContacts.forEach(this._addContact);\n\t\t\t\tthis.emit('stop-synchronizing');\n\t\t\t} else if (this._isFromThisDevice(contacts[0])) {\n\t\t\t\tContactCache.setDeviceWacContacts(contacts);\n\t\t\t\tcontacts = contacts.concat(savedWacContacts);\n\t\t\t\tcontacts.forEach(this._addContact);\n\t\t\t\tthis.emit('stop-synchronizing');\n\t\t\t\tthis.emit('start-synchronizing-avatars');\n\t\t\t\tthis._synchronizer.launchSynchronizeAvatars();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Internal callback for WAC event\n\t * @private\n\t * @param {Contact} contact\n\t */\n\tonContactAdd(contact) {\n\t\tcontact = this._addContact(contact);\n\t\tif (this._isFromThisDevice(contact)) {\n\t\t\tlet deviceContacts = ContactCache.getDeviceWacContacts();\n\t\t\tdeviceContacts.push(contact);\n\t\t\tContactCache.setDeviceWacContacts(deviceContacts);\n\t\t} else {\n\t\t\tlet savedWacContacts = ContactCache.getWacContacts();\n\t\t\tsavedWacContacts = savedWacContacts.concat(contact);\n\t\t\tContactCache.setWacContacts(savedWacContacts);\n\t\t}\n\t\tthis.emit('contact-added', contact);\n\t}\n\n\t/**\n\t * Internal callback for WAC event\n\t * @private\n\t * @param {Contact} contact\n\t */\n\tonContactUpdate(contact) {\n\t\tlet contactToUpdate = this._contacts.find(el => contact.id === el.id);\n\t\tif (contactToUpdate) {\n\t\t\tcontactToUpdate._update(contact);\n\t\t\tif (this._isFromThisDevice(contact)) {\n\t\t\t\tlet deviceContacts = ContactCache.getDeviceWacContacts();\n\t\t\t\tlet index = deviceContacts.findIndex(deviceContact => deviceContact.id === contact.id);\n\t\t\t\tdeviceContacts[index] = contact;\n\t\t\t\tContactCache.setDeviceWacContacts(deviceContacts);\n\t\t\t}\n\t\t\tthis.emit('update', contact);\n\t\t}\n\t}\n\n\t/**\n\t * Internal callback for Synchronizer event\n\t * @param  {Array} contacts To insert in contact list\n\t */\n\tonUpdateListContacts(contacts) {\n\t\tthis._emptyContactList();\n\t\tcontacts = contacts.concat(ContactCache.getDeviceWacContacts());\n\t\tcontacts.forEach(this._addContact);\n\t}\n\n\t/**\n\t * Internal callback for WAC event\n\t * @private\n\t * @param {Contact} contactDeleted\n\t */\n\tonContactRemove(contactDeleted) {\n\t\tlet contact = this._rmContact(`${contactDeleted.id}@${contactDeleted.source}`);\n\t\tif (contact !== undefined) {\n\t\t\tcontact._remove();\n\t\t\tif (this._isFromThisDevice(contactDeleted)) {\n\t\t\t\tlet deviceContacts = ContactCache.getDeviceWacContacts();\n\t\t\t\tdeviceContacts = deviceContacts.filter(deviceContact => deviceContact.contactDeviceId !== contact.contactDeviceId);\n\t\t\t\tContactCache.setDeviceWacContacts(deviceContacts);\n\t\t\t}\n\t\t\tthis.emit('delete', contact);\n\t\t}\n\t}\n\n\t/**\n\t * Internal callback for Synchronizer event. Update contacts\n\t * with his avatar.\n\t *\n\t * @param {Map} avatarsContacts A map with contactDeviceId as key and avatar as value\n\t */\n\tonUpdateAvatarsContacts(avatarsContacts) {\n\t\tthis._contacts = this._updateAvatarOfContacts(this._contacts, avatarsContacts);\n\t\tthis.emit('stop-synchronizing-avatars');\n\t}\n\n\t/**\n\t * Clears all user contacts data and invalidates the cache from the persistent storage\n\t */\n\tclearContactsDataFromPersistentStorage() {\n\t\tContactCache.emptyAllContactData();\n\t}\n\n\t/**\n\t * Update contacts with the avatars stored\n\t * @param {Array<Contact>} contacts\n\t * @param {Map} avatarMap\n\t * @return A list of contacts updated\n\t */\n\t_updateAvatarOfContacts(contacts, avatarMap) {\n\t\tif (!avatarMap.size) {\n\t\t\treturn contacts;\n\t\t}\n\t\treturn contacts.map((contact) => {\n\t\t\tif (avatarMap.has(contact.contactDeviceId)) {\n\t\t\t\tcontact.avatar = avatarMap.get(contact.contactDeviceId);\n\t\t\t}\n\t\t\treturn contact;\n\t\t});\n\t}\n\n\n\t/**\n\t * Bind the callbacks\n\t */\n\t_initCallbacks() {\n\t\tthis._stack.on('qs-contact-add', this.onContactAdd);\n\t\tthis._stack.on('qs-contact-add-many', this.onContactAddMany);\n\t\tthis._stack.on('qs-contact-update', this.onContactUpdate);\n\t\tthis._stack.on('qs-contact-remove', this.onContactRemove);\n\t\tthis._synchronizer.on('update-list-contacts', this.onUpdateListContacts);\n\t\tthis._synchronizer.on('update-avatars-contacts', this.onUpdateAvatarsContacts);\n\t\tthis._synchronizer.on('start-synchronizing', () => {\n\t\t\tthis.emit('start-synchronizing-background');\n\t\t});\n\t\tthis._synchronizer.on('sync-all-device-contacts', () => {\n\t\t\tthis.emit('sync-all-device-contacts');\n\t\t});\n\t\tthis._synchronizer.on('stop-synchronizing', () => {\n\t\t\tthis.emit('stop-synchronizing');\n\t\t});\n\t}\n\n\n\t/**\n\t * Unbind the callbacks\n\t */\n\t_unInitCallbacks() {\n\t\tthis._stack.off('qs-contact-add', this.onContactAdd);\n\t\tthis._stack.off('qs-contact-add-many', this.onContactAddMany);\n\t\tthis._stack.off('qs-contact-update', this.onContactUpdate);\n\t\tthis._stack.off('qs-contact-remove', this.onContactRemove);\n\t\tthis._synchronizer.off('update-list-contacts', this.onUpdateListContacts);\n\t\tthis._synchronizer.off('update-avatars-contacts', this.onUpdateAvatarsContacts);\n\t}\n\n\t/**\n\t * When the contacts arrive, insert the contacts in the contacts list when:\n\t *   - The contact is not from a device.\n\t *   - We are on desktop.\n\t * @private\n\t * @param  {Array<Contact>} contacts Contacts retrieved from the WAC\n\t */\n\t_insertWACContact(contacts) {\n\t\tcontacts.forEach((contact) => {\n\t\t\tif (!_isFromDevice(contact) || !this._deviceId) {\n\t\t\t\tthis._addContact(contact);\n\t\t\t}\n\t\t});\n\t}\n\n\n\t/**\n\t * Adds a new contact to the list\n\t * @private\n\t * @param {Object} data\n\t * @param {string} data.id\n\t * @param {string} data.name\n\t * @param {Object[]} data.phones\n\t * @param {Object[]} data.emails\n\t * @param {string} data.source\n\t * @param {boolean} data.favorite\n\t * @param {string} data.deviceId\n\t * @param {string} data.contactDeviceId\n\t * @return {Contact} The new created contact\n\t */\n\t_addContact(data) {\n\t\tlet contact = this._contactFactory.create(data);\n\t\tthis._contacts.push(contact);\n\t\tcontact.once('delete', this.onLocalContactRemove);\n\t\tthis.emit('create', contact);\n\t\treturn contact;\n\t}\n\n\t/**\n\t * Remove an existing contact from the list\n\t * @private\n\t * @param {string} id ID of the contact to remove\n\t * @return {Contact} The just removed contact if any\n\t */\n\t_rmContact(id) {\n\t\tlet index = this._contacts.findIndex(contact => contact.id === id);\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet contact = this._contacts.splice(index, 1)[0];\n\t\tcontact.off('delete', this.onLocalContactRemove);\n\t\treturn contact;\n\t}\n\n\t_emptyContactList() {\n\t\tthis._contacts.length = 0;\n\t}\n\n\t_isFromThisDevice(contact) {\n\t\treturn contact.deviceId === this._deviceId && !!this._deviceId;\n\t}\n}\n","import {Contact} from './Contact';\nimport {GroupContact} from './GroupContact';\n\n/** @protected */\nexport function ContactFactory({stack, userManager, presenceManager, favoriteManager}) {\n\tconst create = (contact) => {\n\t\tswitch (contact.source) {\n\t\t\tcase 'group':\n\t\t\t\treturn new GroupContact(stack, contact);\n\t\t\tdefault:\n\t\t\t\treturn new Contact(stack, userManager, presenceManager, favoriteManager, contact);\n\t\t}\n\t};\n\n\treturn Object.freeze({\n\t\tcreate,\n\t});\n}\n","/**\n * Provides access to methods for uploading a file.\n * A file transfer object is obtained by calling the\n * {@link FileSharingManager#createFileTransfer} method.\n *\n * # Events\n * - `status` status : {@link FileTransferStatus}, error? : Error -\n *    Emitted every time the status of the file transfer changes.\n * - `progress` value : number - Emitted every time the progress changes\n *\n */\nexport class FileUpload {\n\t/** @protected */\n\tstatic valueOf({id, name, type, size, status, bytesSent = 0, url = null} = {}) {\n\t\treturn new FileUpload(id, name, type, size, status, bytesSent, url);\n\t}\n\n\t/** @private */\n\tconstructor(id, name, type, size, status, bytesSent, url) {\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.name = name;\n\t\t/** @private */\n\t\tthis.type = type;\n\t\t/** @private */\n\t\tthis.size = size;\n\t\t/** @private */\n\t\tthis.status = status;\n\t\t/** @private */\n\t\tthis.bytesSent = bytesSent;\n\t\t/** @private */\n\t\tthis.url = url;\n\t}\n\n\t/** @protected */\n\twith({bytesSent = this.bytesSent, status = this.status, url = this.url} = {}) {\n\t\treturn new FileUpload(this.id, this.name, this.type, this.size, status, bytesSent, url);\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetType() {\n\t\treturn this.type;\n\t}\n\n\t/**\n\t * @return {number}\n\t */\n\tgetSize() {\n\t\treturn this.size;\n\t}\n\n\t/**\n\t * @return {FileUploadStatus}\n\t */\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\t/**\n\t * @param {FileUploadStatus} statuses\n\t * @return {boolean}\n\t */\n\thasStatus(...statuses) {\n\t\treturn statuses.includes(this.status);\n\t}\n\n\t/**\n\t * @return {number}\n\t */\n\tgetBytesSent() {\n\t\treturn this.bytesSent;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetUrl() {\n\t\treturn this.url;\n\t}\n\n\t/**\n\t * @return {number} File transfer progress.\n\t */\n\tgetProgress() {\n\t\treturn this.bytesSent / this.size;\n\t}\n}\n","import {Map} from 'immutable';\n\nimport Logs from '../Logs';\nimport {FileUpload} from './FileUpload';\nimport {bindMethods} from '../utils/bindMethods';\nimport {EventEmitter} from '../eventemitter';\nimport {FileUploadStatus} from './FileUploadStatus';\n\nconst log = Logs.instance.getLogger('SippoJS/FileUploadManager');\n\n/**\n * FileUploadManager objects allows creating and receiving file transfers\n * They are obtained by calling the {@link Session#createFileSharingManager}\n * method of a {@link Session} object\n * @experimental\n */\nexport class FileUploadManager {\n\t/** @protected */\n\tstatic newInstance(fileSharingService) {\n\t\tconst fileSharingManager = new FileUploadManager(fileSharingService);\n\t\tfileSharingManager.initialize();\n\t\treturn Promise.resolve(fileSharingManager);\n\t}\n\n\t/** @private */\n\tconstructor(fileSharingService) {\n\t\t/** @private */\n\t\tthis.fileSharingService = fileSharingService;\n\t\t/** @private */\n\t\tthis.fileUploads = new Map();\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter({\n\t\t\twildcard: true,\n\t\t\tdelimiter: '/',\n\t\t});\n\n\t\tbindMethods(this, [\n\t\t\t'onStart',\n\t\t\t'onStream',\n\t\t\t'onComplete',\n\t\t\t'onError',\n\t\t\t'onAbort',\n\t\t\t'onFile',\n\t\t]);\n\t}\n\n\t/** @private */\n\tinitialize() {\n\t\tthis.fileSharingService.emitter.on('start', this.onStart);\n\t\tthis.fileSharingService.emitter.on('stream', this.onStream);\n\t\tthis.fileSharingService.emitter.on('complete', this.onComplete);\n\t\tthis.fileSharingService.emitter.on('error', this.onError);\n\t\tthis.fileSharingService.emitter.on('abort', this.onAbort);\n\t\tthis.fileSharingService.emitter.on('file', this.onFile);\n\t}\n\n\t/** @private */\n\tonStart(fileInfo) {\n\t\tlog.log('start', fileInfo);\n\t\tconst id = fileInfo.uploadId;\n\t\tconst status = FileUploadStatus.SENDING;\n\t\tconst fileUpload = this.fileUploads.get(id).with({status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\tthis.emitter.emit([id, 'start'], fileUpload);\n\t}\n\n\t/** @private */\n\tonStream(fileInfo) {\n\t\tlog.log('stream', fileInfo);\n\t\tconst id = fileInfo.uploadId;\n\t\tconst bytesSent = fileInfo.sent;\n\t\tconst status = FileUploadStatus.SENDING;\n\t\tconst fileUpload = this.fileUploads.get(id).with({bytesSent, status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\tthis.emitter.emit([id, 'progress'], fileUpload);\n\t}\n\n\t/** @private */\n\tonComplete(fileInfo) {\n\t\tlog.log('complete', fileInfo);\n\t\tconst id = fileInfo.uploadId;\n\t\tconst bytesSent = fileInfo.wrote;\n\t\tconst status = FileUploadStatus.SENDING;\n\t\tconst fileUpload = this.fileUploads.get(id).with({bytesSent, status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\tthis.emitter.emit([id, 'progress'], fileUpload);\n\t}\n\n\t/** @private */\n\tonError(error, fileInfo) {\n\t\tlog.error('error', error);\n\t\tconst id = fileInfo.uploadId;\n\t\tconst status = FileUploadStatus.ERROR;\n\t\tconst fileUpload = this.fileUploads.get(id).with({status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\tthis.emitter.emit([id, 'error'], fileUpload);\n\t}\n\n\t/** @private */\n\tonAbort(fileInfo) {\n\t\tlog.log('abort', fileInfo);\n\t\tconst id = fileInfo.uploadId;\n\t\tconst bytesSent = fileInfo.sent;\n\t\tconst status = FileUploadStatus.ABORTED;\n\t\tconst fileUpload = this.fileUploads.get(id).with({bytesSent, status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\tthis.emitter.emit([id, 'abort'], fileUpload);\n\t}\n\n\t/** @private */\n\tasync onFile(event) {\n\t\tlog.log('file', event);\n\t\tconst id = event.uploadId;\n\t\tif (event.file.size <= 0) {\n\t\t\tconst fileUpload = this.fileUploads.get(id).with({status: FileUploadStatus.ERROR});\n\t\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\t\tthis.emitter.emit([id, 'error'], fileUpload);\n\t\t} else {\n\t\t\tconst url = await this.fileSharingService.createSharedFile(event.file.key);\n\t\t\tconst fileUpload = this.fileUploads.get(id).with({status: FileUploadStatus.COMPLETED, url});\n\t\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\t\tthis.emitter.emit([id, 'end'], fileUpload);\n\t\t}\n\t}\n\n\twaitForEnd(id) {\n\t\tlet onEnd, onAbort, onError;\n\t\tconst endPromise = new Promise((resolve) => {\n\t\t\tonEnd = resolve;\n\t\t\tthis.emitter.on([id, 'end'], onEnd);\n\t\t});\n\t\tconst abortPromise = new Promise((resolve) => {\n\t\t\tonAbort = resolve;\n\t\t\tthis.emitter.on([id, 'abort'], onAbort);\n\t\t});\n\t\tconst errorPromise = new Promise((resolve, reject) => {\n\t\t\tonError = reject;\n\t\t\tthis.emitter.on([id, 'error'], onError);\n\t\t});\n\t\treturn Promise.race([endPromise, abortPromise, errorPromise]).finally(() => {\n\t\t\tthis.emitter.off([id, 'end'], onEnd);\n\t\t\tthis.emitter.off([id, 'abort'], onAbort);\n\t\t\tthis.emitter.off([id, 'error'], onError);\n\t\t});\n\t}\n\n\t/**\n\t * Returns an immutable map with file uploads\n\t * @return {InmutableMap<string, FileUpload}\n\t */\n\tgetFileUploads() {\n\t\treturn this.fileUploads;\n\t}\n\n\t/**\n\t * Starts uploading a new file\n\t * @param {File} file Local file\n\t * @return {Promise<string>} id of the new file upload\n\t */\n\tasync create(file) {\n\t\tconst id = await this.fileSharingService.upload(file);\n\t\tconst name = file.name;\n\t\tconst type = file.type;\n\t\tconst size = file.size;\n\t\tconst status = FileUploadStatus.LOADING;\n\t\tconst fileUpload = FileUpload.valueOf({id, name, type, size, status});\n\t\tthis.fileUploads = this.fileUploads.set(id, fileUpload);\n\t\treturn id;\n\t}\n\n\t/**\n\t * Aborts a currently in progress file upload\n\t * @param {FileUpload} fileUpload\n\t * @return {Promise<void>}\n\t */\n\tabort(fileUpload) {\n\t\tconst id = fileUpload.getId();\n\t\treturn Promise.all([this.fileSharingService.abort(id), this.waitForEnd(id)]);\n\t}\n\n\t/**\n\t * Removes a file upload from the list\n\t * @param {FileUpload} fileUpload\n\t */\n\tremove(fileUpload) {\n\t\tif (!fileUpload.hasStatus(FileUploadStatus.COMPLETED, FileUploadStatus.ABORTED, FileUploadStatus.ERROR)) {\n\t\t\tthrow new Error(`File Upload in ${fileUpload.getStatus().toString()} status can't be removed`);\n\t\t}\n\t\tthis.fileUploads = this.fileUploads.delete(fileUpload.getId());\n\t}\n}\n","import {FileUploadManager} from './FileUploadManager';\n\nexport class FileManager {\n\t/** @protected */\n\tstatic newInstance(fileSharingService) {\n\t\treturn new FileManager(fileSharingService);\n\t}\n\n\t/** @private */\n\tconstructor(fileSharingService) {\n\t\t/** @private */\n\t\tthis.fileSharingService = fileSharingService;\n\t}\n\n\t/**\n\t * @return {Promise<FileUploadManager>}\n\t */\n\tgetFileUploadManager() {\n\t\tif (!this._fileUploadManager) {\n\t\t\tthis._fileUploadManager = FileUploadManager.newInstance(this.fileSharingService);\n\t\t}\n\t\treturn this._fileUploadManager;\n\t}\n\n\t// TODO Allow obtaining files of the user and removing them.\n}\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nexport default arrayEach;\n","import getNative from './_getNative.js';\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nexport default defineProperty;\n","import defineProperty from './_defineProperty.js';\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nexport default baseAssignValue;\n","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignValue;\n","import assignValue from './_assignValue.js';\nimport baseAssignValue from './_baseAssignValue.js';\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nexport default copyObject;\n","import copyObject from './_copyObject.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nexport default baseAssign;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default nativeKeysIn;\n","import isObject from './isObject.js';\nimport isPrototype from './_isPrototype.js';\nimport nativeKeysIn from './_nativeKeysIn.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeysIn;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeysIn from './_baseKeysIn.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nexport default keysIn;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nexport default baseAssignIn;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nexport default copyArray;\n","import copyObject from './_copyObject.js';\nimport getSymbols from './_getSymbols.js';\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nexport default copySymbols;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","import arrayPush from './_arrayPush.js';\nimport getPrototype from './_getPrototype.js';\nimport getSymbols from './_getSymbols.js';\nimport stubArray from './stubArray.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nexport default getSymbolsIn;\n","import copyObject from './_copyObject.js';\nimport getSymbolsIn from './_getSymbolsIn.js';\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nexport default copySymbolsIn;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbolsIn from './_getSymbolsIn.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nexport default getAllKeysIn;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nexport default initCloneArray;\n","import Uint8Array from './_Uint8Array.js';\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nexport default cloneArrayBuffer;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nexport default cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nexport default cloneRegExp;\n","import Symbol from './_Symbol.js';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nexport default cloneSymbol;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nexport default cloneTypedArray;\n","import cloneArrayBuffer from './_cloneArrayBuffer.js';\nimport cloneDataView from './_cloneDataView.js';\nimport cloneRegExp from './_cloneRegExp.js';\nimport cloneSymbol from './_cloneSymbol.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nexport default initCloneByTag;\n","import isObject from './isObject.js';\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nexport default baseCreate;\n","import baseCreate from './_baseCreate.js';\nimport getPrototype from './_getPrototype.js';\nimport isPrototype from './_isPrototype.js';\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nexport default initCloneObject;\n","import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nexport default baseIsMap;\n","import baseIsMap from './_baseIsMap.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nexport default isMap;\n","import getTag from './_getTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nexport default baseIsSet;\n","import baseIsSet from './_baseIsSet.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nexport default isSet;\n","import Stack from './_Stack.js';\nimport arrayEach from './_arrayEach.js';\nimport assignValue from './_assignValue.js';\nimport baseAssign from './_baseAssign.js';\nimport baseAssignIn from './_baseAssignIn.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport copyArray from './_copyArray.js';\nimport copySymbols from './_copySymbols.js';\nimport copySymbolsIn from './_copySymbolsIn.js';\nimport getAllKeys from './_getAllKeys.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\nimport getTag from './_getTag.js';\nimport initCloneArray from './_initCloneArray.js';\nimport initCloneByTag from './_initCloneByTag.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isMap from './isMap.js';\nimport isObject from './isObject.js';\nimport isSet from './isSet.js';\nimport keys from './keys.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nexport default baseClone;\n","import baseClone from './_baseClone.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nexport default cloneDeep;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import assignValue from './_assignValue.js';\nimport castPath from './_castPath.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.set`.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {Array|string} path The path of the property to set.\n * @param {*} value The value to set.\n * @param {Function} [customizer] The function to customize path creation.\n * @returns {Object} Returns `object`.\n */\nfunction baseSet(object, path, value, customizer) {\n  if (!isObject(object)) {\n    return object;\n  }\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      lastIndex = length - 1,\n      nested = object;\n\n  while (nested != null && ++index < length) {\n    var key = toKey(path[index]),\n        newValue = value;\n\n    if (index != lastIndex) {\n      var objValue = nested[key];\n      newValue = customizer ? customizer(objValue, key, nested) : undefined;\n      if (newValue === undefined) {\n        newValue = isObject(objValue)\n          ? objValue\n          : (isIndex(path[index + 1]) ? [] : {});\n      }\n    }\n    assignValue(nested, key, newValue);\n    nested = nested[key];\n  }\n  return object;\n}\n\nexport default baseSet;\n","import baseGet from './_baseGet.js';\nimport baseSet from './_baseSet.js';\nimport castPath from './_castPath.js';\n\n/**\n * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} paths The property paths to pick.\n * @param {Function} predicate The function invoked per property.\n * @returns {Object} Returns the new object.\n */\nfunction basePickBy(object, paths, predicate) {\n  var index = -1,\n      length = paths.length,\n      result = {};\n\n  while (++index < length) {\n    var path = paths[index],\n        value = baseGet(object, path);\n\n    if (predicate(value, path)) {\n      baseSet(result, castPath(path, object), value);\n    }\n  }\n  return result;\n}\n\nexport default basePickBy;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import basePickBy from './_basePickBy.js';\nimport hasIn from './hasIn.js';\n\n/**\n * The base implementation of `_.pick` without support for individual\n * property identifiers.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} paths The property paths to pick.\n * @returns {Object} Returns the new object.\n */\nfunction basePick(object, paths) {\n  return basePickBy(object, paths, function(value, path) {\n    return hasIn(object, path);\n  });\n}\n\nexport default basePick;\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","import arrayPush from './_arrayPush.js';\nimport isFlattenable from './_isFlattenable.js';\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nexport default baseFlatten;\n","import baseFlatten from './_baseFlatten.js';\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nexport default flatten;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import flatten from './flatten.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * A specialized version of `baseRest` which flattens the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @returns {Function} Returns the new function.\n */\nfunction flatRest(func) {\n  return setToString(overRest(func, undefined, flatten), func + '');\n}\n\nexport default flatRest;\n","import basePick from './_basePick.js';\nimport flatRest from './_flatRest.js';\n\n/**\n * Creates an object composed of the picked `object` properties.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [paths] The property paths to pick.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.pick(object, ['a', 'c']);\n * // => { 'a': 1, 'c': 3 }\n */\nvar pick = flatRest(function(object, paths) {\n  return object == null ? {} : basePick(object, paths);\n});\n\nexport default pick;\n","/**\n * MediaStream ImageCapture polyfill\n *\n * @license\n * Copyright 2018 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport let ImageCapture = window.ImageCapture;\n\nif (typeof ImageCapture === 'undefined') {\n  ImageCapture = class {\n\n    /**\n     * TODO https://www.w3.org/TR/image-capture/#constructors\n     *\n     * @param {MediaStreamTrack} videoStreamTrack - A MediaStreamTrack of the 'video' kind\n     */\n    constructor(videoStreamTrack) {\n      if (videoStreamTrack.kind !== 'video')\n        throw new DOMException('NotSupportedError');\n\n      this._videoStreamTrack = videoStreamTrack;\n      if (!('readyState' in this._videoStreamTrack)) {\n        // Polyfill for Firefox\n        this._videoStreamTrack.readyState = 'live';\n      }\n\n      // MediaStream constructor not available until Chrome 55 - https://www.chromestatus.com/feature/5912172546752512\n      this._previewStream = new MediaStream([videoStreamTrack]);\n      this.videoElement = document.createElement('video');\n      this.videoElementPlaying = new Promise(resolve => {\n        this.videoElement.addEventListener('playing', resolve);\n      });\n      if (HTMLMediaElement) {\n        this.videoElement.srcObject = this._previewStream;  // Safari 11 doesn't allow use of createObjectURL for MediaStream\n      } else {\n        this.videoElement.src = URL.createObjectURL(this._previewStream);\n      }\n      this.videoElement.muted = true;\n      this.videoElement.setAttribute('playsinline', ''); // Required by Safari on iOS 11. See https://webkit.org/blog/6784\n      this.videoElement.play();\n\n      this.canvasElement = document.createElement('canvas');\n      // TODO Firefox has https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas\n      this.canvas2dContext = this.canvasElement.getContext('2d');\n    }\n\n    /**\n     * https://w3c.github.io/mediacapture-image/index.html#dom-imagecapture-videostreamtrack\n     * @return {MediaStreamTrack} The MediaStreamTrack passed into the constructor\n     */\n    get videoStreamTrack() {\n      return this._videoStreamTrack;\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-getphotocapabilities\n     * @return {Promise<PhotoCapabilities>} Fulfilled promise with\n     * [PhotoCapabilities](https://www.w3.org/TR/image-capture/#idl-def-photocapabilities)\n     * object on success, rejected promise on failure\n     */\n    getPhotoCapabilities() {\n      return new Promise(function executorGPC(resolve, reject) {\n        // TODO see https://github.com/w3c/mediacapture-image/issues/97\n        const MediaSettingsRange = {\n          current: 0, min: 0, max: 0,\n        };\n        resolve({\n          exposureCompensation: MediaSettingsRange,\n          exposureMode: 'none',\n          fillLightMode: 'none',\n          focusMode: 'none',\n          imageHeight: MediaSettingsRange,\n          imageWidth: MediaSettingsRange,\n          iso: MediaSettingsRange,\n          redEyeReduction: false,\n          whiteBalanceMode: 'none',\n          zoom: MediaSettingsRange,\n        });\n        reject(new DOMException('OperationError'));\n      });\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-setoptions\n     * @param {Object} photoSettings - Photo settings dictionary, https://www.w3.org/TR/image-capture/#idl-def-photosettings\n     * @return {Promise<void>} Fulfilled promise on success, rejected promise on failure\n     */\n    setOptions(photoSettings = {}) {\n      return new Promise(function executorSO(resolve, reject) {\n        // TODO\n      });\n    }\n\n    /**\n     * TODO\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-takephoto\n     * @return {Promise<Blob>} Fulfilled promise with [Blob](https://www.w3.org/TR/FileAPI/#blob)\n     * argument on success; rejected promise on failure\n     */\n    takePhoto() {\n      const self = this;\n      return new Promise(function executorTP(resolve, reject) {\n        // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n        // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n        if (self._videoStreamTrack.readyState !== 'live') {\n          return reject(new DOMException('InvalidStateError'));\n        }\n        self.videoElementPlaying.then(() => {\n          try {\n            self.canvasElement.width = self.videoElement.videoWidth;\n            self.canvasElement.height = self.videoElement.videoHeight;\n            self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n            self.canvasElement.toBlob(resolve);\n          } catch (error) {\n            reject(new DOMException('UnknownError'));\n          }\n        });\n      });\n    }\n\n    /**\n     * Implements https://www.w3.org/TR/image-capture/#dom-imagecapture-grabframe\n     * @return {Promise<ImageBitmap>} Fulfilled promise with\n     * [ImageBitmap](https://www.w3.org/TR/html51/webappapis.html#webappapis-images)\n     * argument on success; rejected promise on failure\n     */\n    grabFrame() {\n      const self = this;\n      return new Promise(function executorGF(resolve, reject) {\n        // `If the readyState of the MediaStreamTrack provided in the constructor is not live,\n        // return a promise rejected with a new DOMException whose name is \"InvalidStateError\".`\n        if (self._videoStreamTrack.readyState !== 'live') {\n          return reject(new DOMException('InvalidStateError'));\n        }\n        self.videoElementPlaying.then(() => {\n          try {\n            self.canvasElement.width = self.videoElement.videoWidth;\n            self.canvasElement.height = self.videoElement.videoHeight;\n            self.canvas2dContext.drawImage(self.videoElement, 0, 0);\n            // TODO polyfill https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmapFactories/createImageBitmap for IE\n            resolve(window.createImageBitmap(self.canvasElement));\n          } catch (error) {\n            reject(new DOMException('UnknownError'));\n          }\n        });\n      });\n    }\n  };\n}\n\nwindow.ImageCapture = ImageCapture;\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible status of a stream recorder. Possible values:\n * - INACTIVE\n * - RECORDING\n * - PAUSED\n * @type {Enum}\n */\nexport const StreamRecorderStatus = Enum([\n\t'INACTIVE',\n\t'RECORDING',\n\t'PAUSED',\n]);\n","import {EventEmitter} from '../eventemitter';\nimport {StreamRecorderStatus} from './StreamRecorderStatus';\n\n/**\n * @typedef {Object} StopEvent\n * @property {Blob} data A Blob with the recorded data. For more information about\n * how to process a Blob you can check\n * [Sending and receiving Binary Data](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Sending_and_Receiving_Binary_Data)\n * or [FileSaver.js](https://github.com/eligrey/FileSaver.js/)\n * @property {number} startTime Timestamp when the recording was started\n * @property {number} stopTime Timestamp when the recording was stoped\n * @property {StreamRecorder} target The StreamRecorder object\n */\n\n/**\n * This class allows to record a stream. Instances of this class are normally obtained using\n * {@link Call#createLocalStreamRecorders} or {@link Call#createRemoteStreamRecorders}\n *\n * Note that this class uses internally a\n * [MediaRecorder](https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder).\n * According to its [specification](https://w3c.github.io/mediacapture-record/MediaRecorder.html),\n * there is not a list of supported container formats, audio codecs or video codecs that must\n * be supported for every browser and the default value for them is platform-specific.\n *\n * ## Events\n *\n * This class contains an instance of {EventEmitter} that emits the next events:\n *\n * - **`start`** is emitted after the recording is started.\n * - **`pause`** is emitted every time the recording is paused.\n * - **`resume`** is emitted every time the recording is resumed.\n * - **`stop`** is emitted after the recording is stoped. It contains a {@link StopEvent}\n *\n * You can check EventEmitter2 documentation for additional information about\n * adding and removing listeners for this events events.\n *\n * @see https://github.com/asyncly/EventEmitter2#api\n *\n * @example <caption>Basic usage</caption>\n * let streamRecorder = call.remoteStreams[0].createStreamRecorder();\n * streamRecorder.start();\n * streamRecorder.emitter.on('stop', (data) => {\n *   console.log(data);\n *   // Here you can download the data, upload to a server..\n * });\n * streamRecorder.stop();\n */\nexport class StreamRecorder {\n\t/**\n\t * @param {MediaStream} mediaStream The media stream that is going to be recorded\n\t */\n\tconstructor(mediaStream) {\n\t\t/**\n\t\t * @private\n\t\t * @type {MediaStream}\n\t\t */\n\t\tthis._mediaStream = mediaStream;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {MediaRecorder}\n\t\t */\n\t\tthis._mediaRecorder = null;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Blob[]}\n\t\t */\n\t\tthis._chunks = [];\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Status}\n\t\t */\n\t\tthis._status = StreamRecorderStatus.INACTIVE;\n\n\t\t/**\n\t\t * @type {EventEmitter}\n\t\t */\n\t\tthis.emitter = new EventEmitter();\n\n\t\t/**\n\t\t * Indicates if the audio of the call must be recorded\n\t\t * @type {boolean}\n\t\t */\n\t\tthis.isAudioRecordingEnabled = true;\n\n\t\t/**\n \t\t * Indicates if the video of the call must be recorded\n \t\t * @type {boolean}\n \t\t */\n\t\tthis.isVideoRecordingEnabled = true;\n\t}\n\n\t/**\n\t * @type {StreamRecorderStatus}\n\t */\n\tget status() {\n\t\treturn this._status;\n\t}\n\n\t/**\n\t * Starts the recording\n\t * @returns {undefined}\n\t */\n\tstart() {\n\t\tif (this._mediaRecorder !== null) {\n\t\t\tthrow Error('The StreamRecorder object must be stopped before starting it again');\n\t\t}\n\t\tlet mediaStream;\n\t\tswitch (true) {\n\t\t\tcase this.isAudioRecordingEnabled && this.isVideoRecordingEnabled:\n\t\t\t\tmediaStream = this._mediaStream;\n\t\t\t\tbreak;\n\t\t\tcase this.isAudioRecordingEnabled && !this.isVideoRecordingEnabled:\n\t\t\t\tmediaStream = window.MediaStream(this._mediaStream.getAudioTracks());\n\t\t\t\tbreak;\n\t\t\tcase !this.isAudioRecordingEnabled && this.isVideoRecordingEnabled:\n\t\t\t\tmediaStream = window.MediaStream(this._mediaStream.getVideoTracks());\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow Error('At least audio or video recording must be enabled');\n\t\t}\n\t\tthis._mediaRecorder = new window.MediaRecorder(mediaStream);\n\n\t\tthis._mediaRecorder.onstart = () => {\n\t\t\tthis._status = StreamRecorderStatus.RECORDING;\n\t\t\tthis._recordingStartTime = Date.now();\n\t\t\tthis.emitter.emit('start');\n\t\t};\n\t\tthis._mediaRecorder.onstop = () => {\n\t\t\tthis._status = StreamRecorderStatus.INACTIVE;\n\t\t\tthis.emitter.emit('stop', {\n\t\t\t\tdata: new Blob(this._chunks, {\n\t\t\t\t\ttype: this._chunks[0].type,\n\t\t\t\t}),\n\t\t\t\tstartTime: this._recordingStartTime,\n\t\t\t\tendTime: Date.now(),\n\t\t\t\ttarget: this,\n\t\t\t});\n\t\t\tthis._chunks = [];\n\t\t};\n\t\tthis._mediaRecorder.ondataavailable = (event) => {\n\t\t\tthis._chunks.push(event.data);\n\t\t};\n\t\tthis._mediaRecorder.onpause = () => {\n\t\t\tthis._status = StreamRecorderStatus.PAUSED;\n\t\t\tthis.emitter.emit('pause');\n\t\t};\n\t\tthis._mediaRecorder.onresume = () => {\n\t\t\tthis._status = StreamRecorderStatus.RECORDING;\n\t\t\tthis.emitter.emit('resume');\n\t\t};\n\t\tthis._mediaRecorder.onerror = (event) => {\n\t\t\tthis.emitter.emit('error', event);\n\t\t};\n\n\t\tthis._mediaRecorder.start();\n\t}\n\n\t/**\n\t * Stops the recording\n\t *\n\t * This method can only be called after the {@link MediaStream#start} method has between\n\t * called. The stop event is received after calling this method with the recorded data.\n\t * @returns {undefined}\n\t */\n\tstop() {\n\t\tif (this._mediaRecorder === null) {\n\t\t\tthrow Error('The StreamRecorder object must be started before');\n\t\t}\n\t\tthis._mediaRecorder.stop();\n\t\tthis._mediaRecorder = null;\n\t}\n\n\t/**\n\t * Pauses the recording\n\t * @returns {undefined}\n\t */\n\tpause() {\n\t\tif (this._mediaRecorder === null) {\n\t\t\tthrow Error('The StreamRecorder object must be started before');\n\t\t}\n\t\tthis._mediaRecorder.pause();\n\t}\n\n\t/**\n\t * Resumes the recording\n\t * @returns {undefined}\n\t */\n\tresume() {\n\t\tif (this._mediaRecorder === null) {\n\t\t\tthrow Error('The StreamRecorder object must be started before');\n\t\t}\n\t\tthis._mediaRecorder.resume();\n\t}\n\n}\n","import {ImageCapture} from 'image-capture';\nimport nanoid from 'nanoid';\n\nimport {StreamRecorder} from './StreamRecorder';\n\n/**\n * This class provides access to media control functions during a call\n * This class must never be directly instantiated\n */\nexport class ManagedStream {\n\tprivate mediaStream: MediaStream;\n\tprivate local: boolean;\n\tprivate id: string;\n\n\t/** @ignore */\n\tpublic constructor(mediaStream: MediaStream, local = false) {\n\t\t/** @private */\n\t\tthis.mediaStream = mediaStream;\n\t\t/** @private */\n\t\tthis.local = local;\n\t\t/** @private */\n\t\tthis.id = nanoid();\n\t}\n\n\t/**\n\t * @desc The id of this stream\n\t * @return {boolean}\n\t */\n\tpublic getId(): string {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @desc Indicates if this managed stream is local. This means that its sources are\n\t * local devices of this machine and that it was obtained of a getUserMedia call\n\t * and not from a RTCPeerConnection\n\t * @return {boolean}\n\t */\n\tpublic isLocal(): boolean {\n\t\treturn this.local;\n\t}\n\n\t/**\n\t * @desc Indicates if this managed stream is remote. This means that its sources are not\n\t * local devices of this machine and that it was obtained from a RTCPeerConnection\n\t * and not from a getUserMedia call\n\t * @return {boolean}\n\t */\n\tpublic isRemote(): boolean {\n\t\treturn !this.local;\n\t}\n\n\t/**\n\t * @desc Provides access to the underlying WebRTC MediaStream object\n\t * @return {MediaStream}\n\t */\n\tpublic getMediaStream(): MediaStream {\n\t\treturn this.mediaStream;\n\t}\n\n\t/**\n\t * @desc Provides access to all the tracks of the managed stream\n\t * @return {MediaStreamTrack[]}\n\t */\n\tpublic getTracks(): MediaStreamTrack[] {\n\t\treturn this.mediaStream.getTracks();\n\t}\n\n\t/**\n\t * @desc Provides access to the audio tracks of the managed stream\n\t * @return {MediaStreamTrack[]}\n\t */\n\tpublic getAudioTracks(): MediaStreamTrack[] {\n\t\treturn this.mediaStream.getAudioTracks();\n\t}\n\n\t/**\n\t * @desc Provides access to the video tracks of the managed stream\n\t * @return {MediaStreamTrack[]}\n\t */\n\tpublic getVideoTracks(): MediaStreamTrack[] {\n\t\treturn this.mediaStream.getVideoTracks();\n\t}\n\n\t/**\n\t * @desc Provides access to the video tracks that are not a screen of the managed stream\n\t * @return {MediaStreamTrack[]}\n\t */\n\tpublic getCameraTracks(): MediaStreamTrack[] {\n\t\treturn this.mediaStream.getVideoTracks().filter(track => !track.label.includes('screen'));\n\t}\n\n\t/**\n\t * @desc Provides access to the screen tracks of the managed stream\n\t * @return {MediaStreamTrack[]}\n\t */\n\tpublic getScreenTracks(): MediaStreamTrack[] {\n\t\treturn this.mediaStream.getVideoTracks().filter(\n\t\t\ttrack => ['screen', 'window', 'web-contents-media-stream'].some(p => track.label.startsWith(p + ':')),\n\t\t);\n\t}\n\n\t/**\n\t * @desc Allows to know if the managed stream has audio tracks\n\t * @return {boolean} A boolean value indicating if the managed stream has at least one audio track\n\t */\n\tpublic hasAudioTracks(): boolean {\n\t\treturn this.getAudioTracks().length > 0;\n\t}\n\n\t/**\n\t * @desc Allows to know if the managed stream has video tracks\n\t * @return {boolean} A boolean value indicating if the managed stream has at least one video track\n\t */\n\tpublic hasVideoTracks(): boolean {\n\t\treturn this.getVideoTracks().length > 0;\n\t}\n\n\t/**\n\t * @desc Allows to know if the managed stream has camera tracks\n\t * @return {boolean} A boolean value indicating if the managed stream has at least one camera track\n\t */\n\tpublic hasCameraTracks(): boolean {\n\t\treturn this.getCameraTracks().length > 0;\n\t}\n\n\t/**\n\t * @desc Allows to know if the managed stream has screen tracks\n\t * @return {boolean} A boolean value indicating if the managed stream has at least one screen track\n\t */\n\tpublic hasScreenTracks(): boolean {\n\t\treturn this.getScreenTracks().length > 0;\n\t}\n\n\t/**\n\t * @desc Stops every track of the underlying MediaStream\n\t * @return {ManagedStream}\n\t */\n\tpublic stop(): void {\n\t\tthis.getTracks().forEach((track) => {\n\t\t\tif (track.enabled) {\n\t\t\t\ttrack.stop();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * @desc Indicates if every audio track is muted\n\t * @return {boolean}\n\t */\n\tpublic isAudioMuted(): boolean {\n\t\treturn this.getAudioTracks().every(track => !track.enabled);\n\t}\n\n\t/**\n\t * @desc Indicates if every video track is muted\n\t * @return {boolean}\n\t */\n\tpublic isVideoMuted(): boolean {\n\t\treturn this.getVideoTracks().every(track => !track.enabled);\n\t}\n\n\t/**\n\t * @desc Indicates if every screen track is muted\n\t * @return {boolean}\n\t */\n\tpublic isScreenMuted(): boolean {\n\t\treturn this.getScreenTracks().every(track => !track.enabled);\n\t}\n\n\t/**\n\t * @desc Mutes or unmutes audio tracks of this stream\n\t * @param {boolean} [mute] If true disables audio tracks, if false enables them\n\t * If not argument is provided it toggles the mute state on audio tracks\n\t */\n\tpublic muteAudio(mute = !this.isAudioMuted()): void {\n\t\tthis.getAudioTracks().forEach(track => track.enabled = !mute);\n\t}\n\n\t/**\n\t * @desc Mutes or unmutes video tracks of this stream\n\t * @param {boolean} [mute] If true disables video tracks, if false enables them\n\t * If not argument is provided it toggles the mute state on video tracks\n\t */\n\tpublic muteVideo(mute = !this.isVideoMuted()): void {\n\t\tthis.getVideoTracks().forEach(track => track.enabled = !mute);\n\t}\n\n\t/**\n\t * @desc Mutes or unmutes screen tracks of this stream\n\t * @param {boolean} [mute] If true disables screen tracks, if false enables them\n\t * If not argument is provided it toggles the mute state on screen tracks\n\t */\n\tpublic muteScreen(mute = !this.isScreenMuted()): void {\n\t\tthis.getScreenTracks().forEach(track => track.enabled = !mute);\n\t}\n\n\t/**\n\t * @desc Allows taking captures of the video tracks of this stream\n\t * @return {Promise<Blob[]>} A promise containing an array of Blobs with a capture\n\t * of the video. One Blob for each video track of this stream\n\t */\n\tpublic takePhotos(): Promise<Blob[]> {\n\t\tconst photos = this.mediaStream.getVideoTracks()\n\t\t\t.map(track => new ImageCapture(track))\n\t\t\t.map(captureDevice => (captureDevice.takePhoto() as Promise<Blob>));\n\t\treturn Promise.all(photos);\n\t}\n\n\t/**\n\t * @desc Creates a StreamRecorder object that will allow recording the stream\n\t * @return {StreamRecorder}\n\t */\n\tpublic createStreamRecorder(): StreamRecorder {\n\t\treturn new StreamRecorder(this.mediaStream);\n\t}\n}\n","import baseClone from './_baseClone.js';\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * Creates a shallow clone of `value`.\n *\n * **Note:** This method is loosely based on the\n * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n * and supports cloning arrays, array buffers, booleans, date objects, maps,\n * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n * arrays. The own enumerable properties of `arguments` objects are cloned\n * as plain objects. An empty object is returned for uncloneable values such\n * as error objects, functions, DOM nodes, and WeakMaps.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to clone.\n * @returns {*} Returns the cloned value.\n * @see _.cloneDeep\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var shallow = _.clone(objects);\n * console.log(shallow[0] === objects[0]);\n * // => true\n */\nfunction clone(value) {\n  return baseClone(value, CLONE_SYMBOLS_FLAG);\n}\n\nexport default clone;\n","import bowser from 'bowser';\nimport EventEmitter from 'eventemitter3';\nimport {clone, cloneDeep} from 'lodash-es';\n\nimport {MediaTypes} from '../types';\nimport {ManagedStream} from './ManagedStream';\n\ntype UpdateMedia = (\n\taudio: MediaStreamConstraints['audio'],\n\tvideo: MediaStreamConstraints['video'],\n\tscreen: boolean,\n) => Promise<void>;\n\ninterface Events {\n\tvideoStream: [];\n\t'*': [];\n}\n\n/**\n * Provides access to methods for managing actions related to local media. Instances of this class\n * are obtained calling {@link Call#getLocalMediaHandler} or {@link Conference#getLocalMediaHandler}\n *\n * ## Events\n *\n * - `videoStream` - Emitted every time videoStream changes.\n * - `*` - Emitted every time a change that can affect to any property happens.\n */\nexport class LocalMediaHandler {\n\tpublic readonly emitter: EventEmitter<Events> = new EventEmitter();\n\n\t/** @private */\n\tprivate mediaTypes: MediaTypes = {\n\t\taudio: true,\n\t\tvideo: true,\n\t\tscreen: false,\n\t};\n\tprivate mediaConstraints: MediaStreamConstraints;\n\tprivate updateMedia: UpdateMedia;\n\tprivate videoStream?: ManagedStream;\n\tprivate audioOnlyStream?: ManagedStream;\n\n\t/** @private */\n\tprivate availableAudioInputDevices: MediaDeviceInfo[] = [];\n\t/** @private */\n\tprivate availableAudioOutputDevices: MediaDeviceInfo[] = [];\n\t/** @private */\n\tprivate availableVideoInputDevices: MediaDeviceInfo[] = [];\n\tprivate activeVideoInputDevice?: MediaDeviceInfo;\n\n\t/** @private */\n\tprivate audioMuted = false;\n\t/** @private */\n\tprivate videoMuted = false;\n\t/** @private */\n\tprivate beforeShareScreenVideo = true;\n\n\t/** @ignore */\n\tpublic constructor(mediaConstraints: MediaStreamConstraints = {audio: true, video: true}, updateMedia: UpdateMedia) {\n\t\t/** @private */\n\t\tthis.mediaConstraints = cloneDeep(mediaConstraints);\n\t\t/** @private */\n\t\tthis.updateMedia = updateMedia;\n\t}\n\n\t/**\n\t * Return the media types configured for the call\n\t */\n\tpublic getMediaTypes(): MediaTypes {\n\t\treturn clone(this.mediaTypes);\n\t}\n\n\t/**\n\t * @desc Update the enabled local media. This feature is only available\n\t * when the call has already been connected if \"media-update\" capability is present.\n\t * @param {MediaTypes} mediaTypes The requested media\n\t *\n\t * @example <caption>Disable video</caption>\n\t * await call.setMediaTypes({audio: true, video: false, screen: false});\n\t * console.log(\"media updated\");\n\t */\n\tpublic async setMediaTypes(mediaTypes: MediaTypes): Promise<void> {\n\t\tif (mediaTypes.video && mediaTypes.screen) {\n\t\t\tthrow new Error('Simultaneous screen sharing and video is not supported');\n\t\t}\n\t\tconst {audio, video} = this.getCurrentMediaConstraints({mediaTypes});\n\t\tawait this.updateMedia(audio, video, mediaTypes.screen);\n\t\tthis.mediaTypes = clone(mediaTypes);\n\t\tthis.emitter.emit('*');\n\t}\n\n\t/**\n\t * Return the media constraints configured for the call\n\t */\n\tpublic getMediaConstraints(): MediaStreamConstraints {\n\t\treturn cloneDeep(this.mediaConstraints);\n\t}\n\n\t/**\n\t * @desc Update constraints of local media. This feature is only available when the call\n\t * has already been connected if \"media-update\" capability is present.\n\t * @param {MediaStreamConstraints} mediaConstraints The requested media constraints\n\t *\n\t * @example <caption>Change video resolution</caption>\n\t * const audio = true;\n\t * const video = {\n\t *   height: 256,\n\t *   width: 256,\n\t * };\n\t * await call.setMediaConstraints({audio, video});\n\t * console.log(\"media updated\");\n\t */\n\tpublic async setMediaConstraints(mediaConstraints: MediaStreamConstraints): Promise<void> {\n\t\tconst {audio, video} = this.getCurrentMediaConstraints({mediaConstraints});\n\t\tconst {screen} = this.getMediaTypes();\n\t\tawait this.updateMedia(audio, video, screen);\n\t\tthis.mediaConstraints = cloneDeep(mediaConstraints);\n\t\tthis.emitter.emit('*');\n\t}\n\n\t/**\n\t * @desc Obtains current enabled media stream constraints.\n\t * This is a combination of the media stream constraints configured\n\t * for the call and the current media types.\n\t * @param {{mediaTypes: ?MediaTypes, mediaConstraints: ?MediaStreamConstraints}} param\n\t * @return {MediaStreamConstraints}\n\t */\n\tpublic getCurrentMediaConstraints({\n\t\tmediaTypes = this.mediaTypes,\n\t\tmediaConstraints = this.mediaConstraints,\n\t} = {}): MediaStreamConstraints {\n\t\treturn {\n\t\t\taudio: mediaTypes.audio && cloneDeep(mediaConstraints.audio),\n\t\t\tvideo: mediaTypes.video && cloneDeep(mediaConstraints.video),\n\t\t};\n\t}\n\n\t/**\n\t * @desc Returns the local video stream\n\t * @return {ManagedStream|undefined}\n\t */\n\tpublic getVideoStream(): ManagedStream|undefined {\n\t\treturn this.videoStream || this.audioOnlyStream;\n\t}\n\n\t/** @ignore */\n\tpublic setVideoStream(stream?: MediaStream): void {\n\t\tif (this.videoStream && this.videoStream.getMediaStream() === stream) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.videoStream) {\n\t\t\tthis.videoStream.stop();\n\t\t\tdelete this.videoStream;\n\t\t}\n\t\tif (stream) {\n\t\t\t/** @private */\n\t\t\tthis.videoStream = new ManagedStream(stream, true);\n\t\t\t// Restore muted audio/video\n\t\t\tthis.muteAudio(this.audioMuted);\n\t\t\tthis.muteVideo(this.videoMuted);\n\t\t}\n\t\tthis.emitter.emit('videoStream');\n\t\tthis.emitter.emit('*');\n\t}\n\n\t/** @ignore */\n\tpublic setAudioOnlyStream(stream?: MediaStream): void {\n\t\tif (this.audioOnlyStream && this.audioOnlyStream.getMediaStream() === stream) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.audioOnlyStream) {\n\t\t\tthis.audioOnlyStream.stop();\n\t\t\tdelete this.audioOnlyStream;\n\t\t}\n\t\tif (stream) {\n\t\t\t/** @private */\n\t\t\tthis.audioOnlyStream = new ManagedStream(stream, true);\n\t\t}\n\t\tif (!this.videoStream) {\n\t\t\tthis.emitter.emit('videoStream');\n\t\t}\n\t\tthis.emitter.emit('*');\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if the call has a local audio track\n\t */\n\tpublic hasAudioTrack(): boolean {\n\t\tif (this.audioOnlyStream) {\n\t\t\treturn this.audioOnlyStream.hasAudioTracks();\n\t\t}\n\t\tif (this.videoStream) {\n\t\t\treturn this.videoStream.hasAudioTracks();\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if the call has a local video track\n\t */\n\tpublic hasVideoTrack(): boolean {\n\t\treturn !!this.videoStream && this.videoStream.hasVideoTracks();\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if local audio is muted\n\t */\n\tpublic isAudioMuted(): boolean {\n\t\tif (this.audioOnlyStream) {\n\t\t\treturn this.audioOnlyStream.isAudioMuted();\n\t\t}\n\t\tif (this.videoStream) {\n\t\t\treturn this.videoStream.isAudioMuted();\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * @desc Mutes or unmutes the audio. If no parameter is specified it toggles current value.\n\t * @param {boolean} [mute] If specified forces audio to be mute or unmute\n\t */\n\tpublic muteAudio(mute = !this.isAudioMuted()): void {\n\t\tif (this.audioOnlyStream) {\n\t\t\tthis.audioOnlyStream.muteAudio(mute);\n\t\t}\n\t\tif (this.videoStream) {\n\t\t\tthis.videoStream.muteAudio(mute);\n\t\t}\n\t\tthis.audioMuted = mute;\n\t}\n\n\t/**\n\t * Returns a boolean value indication if local video is muted\n\t */\n\tpublic isVideoMuted(): boolean {\n\t\treturn !!this.videoStream && this.videoStream.isVideoMuted();\n\t}\n\n\t/**\n\t * @desc Mutes or unmutes the video. If no parameter is specified it toggles current value.\n\t * @param {boolean} [mute] When specified forces video to be mute or unmute\n\t */\n\tpublic muteVideo(mute = !this.isVideoMuted()): void {\n\t\tif (this.videoStream) {\n\t\t\tthis.videoStream.muteVideo(mute);\n\t\t}\n\t\tthis.videoMuted = mute;\n\t}\n\n\t/**\n\t * Indicates if video can be enabled or disabled\n\t */\n\tpublic canToggleVideo(): boolean {\n\t\treturn this.availableVideoInputDevices.length > 0 && !this.mediaTypes.screen;\n\t}\n\n\t/**\n\t * @desc Enables or disables the video. If no parameter is specified it toggles current value.\n\t * @param {boolean} [video] If specified forces video to be enabled or not\n\t * @return {Promise}\n\t */\n\tpublic toggleVideo(video = !this.mediaTypes.video): Promise<void> {\n\t\tconst {audio, screen} = this.mediaTypes;\n\t\treturn this.setMediaTypes({audio, video, screen});\n\t}\n\n\t/**\n\t * @desc Shares the screen. This feature is only available if \"screen-sharing\" capability is present.\n\t * @param {boolean} [screen] send screen if true, camera if false.\n\t * If not specified it toggles from the last state.\n\t */\n\tpublic async toggleScreen(screen = !this.mediaTypes.screen): Promise<void> {\n\t\tconst {audio} = this.mediaTypes;\n\t\tlet {video} = this.mediaTypes;\n\t\tif (screen) {\n\t\t\tthis.beforeShareScreenVideo = video;\n\t\t\tvideo = false;\n\t\t} else {\n\t\t\tvideo = this.beforeShareScreenVideo;\n\t\t}\n\t\ttry {\n\t\t\tawait this.setMediaTypes({audio, video, screen});\n\t\t} catch (error) {\n\t\t\tswitch (error.message) {\n\t\t\t\tcase 'chrome-screensharing-plugin-missing':\n\t\t\t\t\tthrow new Error('plugin-missing-chrome');\n\t\t\t\tcase 'firefox-screensharing-plugin-missing':\n\t\t\t\t\tthrow new Error('plugin-missing-firefox');\n\t\t\t\tcase 'user-cancel':\n\t\t\t\t\tthrow new Error('user-cancel');\n\t\t\t\tdefault:\n\t\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @desc Updates media types adding video when screen is false or adds an internal mark to know video must be\n\t * enabled when screen sharing ends.\n\t * @return {Promise<void>}\n\t */\n\tpublic async addVideo(): Promise<void> {\n\t\tif (this.mediaTypes.screen) {\n\t\t\tthis.beforeShareScreenVideo = true;\n\t\t\treturn;\n\t\t}\n\t\tif (this.mediaTypes.video) {\n\t\t\treturn;\n\t\t}\n\t\tawait this.setMediaTypes({\n\t\t\taudio: this.mediaTypes.audio,\n\t\t\tvideo: true,\n\t\t\tscreen: this.mediaTypes.screen,\n\t\t});\n\t}\n\n\t/**\n\t * @desc Returns the list of available audio input devices\n\t * @return {MediaDeviceInfo[]} A list of MediaDeviceInfo objects that can be used as audio input\n\t */\n\tpublic getAvailableAudioInputDevices(): MediaDeviceInfo[] {\n\t\treturn this.availableAudioInputDevices;\n\t}\n\n\t/**\n\t * @desc Replaces the list of available audio input devices\n\t * @param {MediaDeviceInfo[]} availableAudioInputDevices The list of MediaDeviceInfo objects to be used as audio input\n\t * @return {Promise}\n\t */\n\tpublic setAvailableAudioInputDevices(availableAudioInputDevices: MediaDeviceInfo[]): Promise<void> {\n\t\tthis.availableAudioInputDevices = availableAudioInputDevices;\n\t\treturn this.setActiveAudioInputDevice(availableAudioInputDevices[0]);\n\t}\n\n\t/**\n\t * @desc Updates the audio input device in used to the specified one\n\t * @param {MediaDeviceInfo} [audioInputDevice] If no value is specified the default one is selected\n\t * @return {Promise}\n\t */\n\tpublic setActiveAudioInputDevice(audioInputDevice?: MediaDeviceInfo): Promise<void> {\n\t\tconst mediaConstraints = this.getMediaConstraints();\n\t\tif (audioInputDevice) {\n\t\t\tif (mediaConstraints.audio) {\n\t\t\t\tif (typeof mediaConstraints.audio === 'boolean') {\n\t\t\t\t\tmediaConstraints.audio = {};\n\t\t\t\t}\n\t\t\t\tconst deviceId = audioInputDevice.deviceId;\n\t\t\t\tmediaConstraints.audio.deviceId = bowser.ios ? deviceId : {exact: deviceId};\n\t\t\t}\n\t\t} else if (typeof mediaConstraints.audio === 'object') {\n\t\t\tdelete mediaConstraints.audio.deviceId;\n\t\t}\n\t\treturn this.setMediaConstraints(mediaConstraints);\n\t}\n\n\t/**\n\t * @desc Returns the list of available video input devices\n\t * @return {MediaDeviceInfo[]} A list of MediaDeviceInfo objects that can be used as video input\n\t */\n\tpublic getAvailableVideoInputDevices(): MediaDeviceInfo[] {\n\t\treturn this.availableVideoInputDevices;\n\t}\n\n\t/**\n\t * @desc Replaces the list of available video input devices\n\t * @param {MediaDeviceInfo[]} availableVideoInputDevices\n\t * The list of MediaDeviceInfo objects to be used as audio input\n\t * @return {Promise}\n\t */\n\tpublic setAvailableVideoInputDevices(availableVideoInputDevices: MediaDeviceInfo[]): Promise<void> {\n\t\tthis.availableVideoInputDevices = availableVideoInputDevices;\n\t\treturn this.setActiveVideoInputDevice(availableVideoInputDevices[0]);\n\t}\n\n\t/**\n\t * @desc Updates the video input device in used to the specified one\n\t * @param {MediaDeviceInfo} [videoInputDevice] If no value is specified the default one is selected\n\t * @return {Promise}\n\t */\n\tpublic setActiveVideoInputDevice(videoInputDevice?: MediaDeviceInfo): Promise<void> {\n\t\t/** @private */\n\t\tthis.activeVideoInputDevice = videoInputDevice;\n\t\tconst mediaConstraints = this.getMediaConstraints();\n\t\tif (videoInputDevice) {\n\t\t\tif (mediaConstraints.video) {\n\t\t\t\tif (typeof mediaConstraints.video === 'boolean') {\n\t\t\t\t\tmediaConstraints.video = {};\n\t\t\t\t} else {\n\t\t\t\t\tdelete mediaConstraints.video.facingMode;\n\t\t\t\t}\n\t\t\t\tconst deviceId = videoInputDevice.deviceId;\n\t\t\t\tmediaConstraints.video.deviceId = bowser.ios ? deviceId : {exact: deviceId};\n\t\t\t}\n\t\t} else if (typeof mediaConstraints.audio === 'object') {\n\t\t\tdelete mediaConstraints.audio.deviceId;\n\t\t}\n\t\treturn this.setMediaConstraints(mediaConstraints);\n\t}\n\n\t/**\n\t * @desc Returns the list of available audio output devices\n\t * @return {MediaDeviceInfo[]} A list of MediaDeviceInfo objects that can be used as audio output\n\t */\n\tpublic getAvailableAudioOutputDevices(): MediaDeviceInfo[] {\n\t\treturn this.availableAudioOutputDevices;\n\t}\n\n\t/**\n\t * Indicates if it is possible to change to a different camera\n\t */\n\tpublic canToggleCamera(): boolean {\n\t\treturn !!(this.availableVideoInputDevices.length > 1 && this.mediaTypes.video && this.mediaConstraints.video);\n\t}\n\n\t/**\n\t * Changes the local video stream to the next available camera.\n\t */\n\tpublic toggleCamera(): Promise<void> {\n\t\treturn this.setActiveVideoInputDevice(this.getNextVideoInputDevice());\n\t}\n\n\t/** @ignore */\n\tpublic async init(): Promise<void> {\n\t\tawait this.initializeDevices();\n\t}\n\n\t/** @private */\n\tprivate async initializeDevices(): Promise<void> {\n\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\n\t\tthis.availableAudioInputDevices = devices.filter(device => device.kind === 'audioinput');\n\t\tthis.availableVideoInputDevices = devices.filter(device => device.kind === 'videoinput');\n\t\tthis.availableAudioOutputDevices = devices.filter(device => device.kind === 'audiooutput');\n\t}\n\n\t/** @private */\n\tprivate getActiveVideoInputDeviceFromLocalStreams(): MediaDeviceInfo|undefined {\n\t\tif (!this.availableVideoInputDevices.length) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.videoStream || !this.videoStream.hasCameraTracks()) {\n\t\t\treturn this.availableVideoInputDevices[0];\n\t\t}\n\t\tconst videoTracks = this.videoStream.getCameraTracks();\n\t\tif (typeof videoTracks[0].getSettings !== 'function') {\n\t\t\treturn this.availableVideoInputDevices[0];\n\t\t}\n\t\tconst activeDeviceIds = videoTracks.map((track: MediaStreamTrack) => track.getSettings().deviceId);\n\t\treturn this.availableVideoInputDevices.find(device => activeDeviceIds.includes(device.deviceId));\n\t}\n\n\t/** @private */\n\tprivate getNextVideoInputDevice(): MediaDeviceInfo|undefined {\n\t\tconst activeDevice = this.activeVideoInputDevice ?\n\t\t\tthis.activeVideoInputDevice : this.getActiveVideoInputDeviceFromLocalStreams();\n\t\tif (!activeDevice) {\n\t\t\treturn;\n\t\t}\n\t\tconst getNext = (list: MediaDeviceInfo[], activeEl: MediaDeviceInfo): MediaDeviceInfo =>\n\t\t\tlist[(list.indexOf(activeEl) + 1) % list.length];\n\t\treturn getNext(this.availableVideoInputDevices, activeDevice);\n\t}\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible directions of a call. Possible values:\n * - INCOMING\n * - OUTGOING\n * @type {Enum}\n */\nexport const CallDirection = new Enum([\n\t'INCOMING',\n\t'OUTGOING',\n]);\n","import {Enum} from '../utils';\nimport Logs from '../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/CallEndReason');\n\n/**\n * Enum containing the possible end reasons of a call. Possible values:\n * - UNSPECIFIED\n * - NORMAL_CLEARING\n * - BROWSER_CLOSED\n * - BAD_REQUEST\n * - ORIGINATOR_CANCEL\n * - NOT_FOUND\n * - USER_BUSY\n * - NO_ANSWER\n * - MEDIA_ACCESS_ERROR\n * - SERVER_ERROR\n * @type {Enum}\n */\nexport const CallEndReason = new Enum([\n\t'UNSPECIFIED',\n\t'NORMAL_CLEARING',\n\t'BROWSER_CLOSED',\n\t'BAD_REQUEST',\n\t'ORIGINATOR_CANCEL',\n\t'NOT_FOUND',\n\t'USER_BUSY',\n\t'NO_ANSWER',\n\t'MEDIA_ACCESS_ERROR',\n\t'SERVER_ERROR',\n]);\n\n/** @protected */\nexport function getEndReasonFromWacValue(wacEndReason) {\n\tswitch (wacEndReason) {\n\t\tcase 'notfound':\n\t\tcase 'unavailable':\n\t\t\treturn CallEndReason.NOT_FOUND;\n\t\tcase 'unknown':\n\t\t\treturn CallEndReason.UNSPECIFIED;\n\t\tcase 'normal':\n\t\t\treturn CallEndReason.NORMAL_CLEARING;\n\t\tcase 'closebrowser':\n\t\t\treturn CallEndReason.BROWSER_CLOSED;\n\t\tcase 'rejected':\n\t\t\treturn CallEndReason.USER_BUSY;\n\t\tcase 'timeout':\n\t\tcase 'noattended':\n\t\t\treturn CallEndReason.NO_ANSWER;\n\t\tcase 'webrtcunsupported':\n\t\tcase 'webrtcerror':\n\t\tcase 'deniedmediaaccess':\n\t\t\treturn CallEndReason.MEDIA_ACCESS_ERROR;\n\t\tcase 'missed':\n\t\tcase 'leavesqueue':\n\t\t\treturn CallEndReason.ORIGINATOR_CANCEL;\n\t\tcase 'badrequest':\n\t\tcase 'notallowed':\n\t\t\treturn CallEndReason.BAD_REQUEST;\n\t\tcase 'cleanup':\n\t\tcase 'networkerror':\n\t\tcase 'servererror':\n\t\tdefault:\n\t\t\tlog.warn(`Unexpected end reason received from wac: ${wacEndReason}`);\n\t\t\treturn CallEndReason.SERVER_ERROR;\n\t}\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible status of a call. Possible values:\n * - UNCONNECTED\n * - TRYING\n * - QUEUED\n * - CONNECTING\n * - CONNECTED\n * - HOLD\n * - REMOTE_HOLD\n * - RECONNECTING\n * - DISCONNECTED\n * @type {Enum}\n */\nexport const CallStatus = new Enum([\n\t'UNCONNECTED',\n\t'TRYING',\n\t'QUEUED',\n\t'CONNECTING',\n\t'CONNECTED',\n\t'HOLD',\n\t'REMOTE_HOLD',\n\t'RECONNECTING',\n\t'DISCONNECTED',\n]);\n","import {EventEmitter} from '../eventemitter';\n\n/**\n * This class creates an instances that can indicate to the WAC\n * when he has to start/stop a recording using the source specified\n * by param\n */\nexport class CallRemoteRecorder extends EventEmitter {\n\tconstructor(wacProxy, idCall) {\n\t\tsuper();\n\t\tthis._wacproxy = wacProxy;\n\t\tthis._callId = idCall;\n\t}\n\n\t/**\n\t * Start a recording of a call and save it in\n\t * a file called \"filename\"\n\t *\n\t * @param  {String} filename Name file to save the recording\n\t * @return {Promise} Resolved promise if success\n\t */\n\tstart(filename) {\n\t\treturn this._wacproxy.startRecording(this._callId, filename);\n\t}\n\n\t/**\n\t * Stop a recording of a call\n\t *\n\t * @return {Promise} Resolved promise if success\n\t */\n\tstop() {\n\t\treturn this._wacproxy.stopRecording(this._callId);\n\t}\n\n\tpause() {\n\t\tthrow Error('Not implemented');\n\t}\n\n\t/**\n\t * Retrieve info about recordings\n\t *\n\t * @return {Promise<Array>} A list of recordings if success\n\t */\n\tgetRecordings() {\n\t\tlet filter = {};\n\t\tfilter.callIdWAC = this._callId;\n\t\treturn this._wacproxy.getRecordings(filter);\n\t}\n}\n","import {Set} from 'immutable';\nimport {cloneDeep, pick} from 'lodash-es';\nimport bowser from 'bowser';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport Logs from '../Logs';\n\nimport {ManagedStream} from '../media/ManagedStream';\nimport {LocalMediaHandler} from '../media/LocalMediaHandler';\nimport {CallDirection} from './CallDirection';\nimport {CallEndReason, getEndReasonFromWacValue} from './CallEndReason';\nimport {CallStatus} from './CallStatus';\nimport {CallRemoteRecorder} from './CallRemoteRecorder';\n\nconst log = Logs.instance.getLogger('SippoJS/Call');\n\n/**\n * @typedef {Object} MediaTypes\n * @property {boolean} audio\n * @property {boolean} video\n * @property {boolean} screen\n */\n\n/**\n * Provides access to methods for managing outgoing or incoming calls.\n * {@link Call} objects are obtained calling {@link CallManager#createCall} method or handling\n * the `onIncoming` event of a connected {@link CallManager} instance.\n *\n * ## Events\n *\n * - `localOnlyStreams` ({@link ImmutableSet}<{@link ManagedStream}> currentValue, {@link ImmutableSet}<{@link ManagedStream}> oldValue)\n *    - Emitted every time localOnlyStreams changes.\n * - `remoteStreams` ({@link ImmutableSet}<{@link ManagedStream}> currentValue, {@link ImmutableSet}<{@link ManagedStream}> oldValue)\n *    - Emitted every time remoteStreams changes.\n * - `transferred`\n *    - Emitted every time remote end of the call changes.\n * - `context` ({@link Object})\n *    - Emitted every time context changes.\n * - `status` ({@link CallStatus})\n *    - Emitted every time status changes.\n */\nexport class Call {\n\t/** @protected */\n\tstatic newInstance(wacProxy, userManager, {\n\t\tgatewayCaller,\n\t\tgatewayCallee,\n\t\tremoteUser,\n\t\tid = null,\n\t\tdirection = CallDirection.INCOMING,\n\t\tmediaConstraints = {audio: true, video: true},\n\t\tpollingCall = false,\n\t\tpullFrom = null,\n\t} = {}) {\n\t\tconst call = new Call(\n\t\t\twacProxy, userManager, gatewayCaller, gatewayCallee, remoteUser, id,\n\t\t\tdirection, mediaConstraints, pollingCall, pullFrom,\n\t\t);\n\t\treturn call.initialize().then(() => call);\n\t}\n\n\t/** @private */\n\tconstructor(\n\t\twacProxy, userManager, gatewayCaller, gatewayCallee, remoteUser, id,\n\t\tdirection, mediaConstraints, pollingCall, pullFrom,\n\t) {\n\t\t/** @private */\n\t\tthis.wacProxy = wacProxy;\n\t\t/** @private */\n\t\tthis.userManager = userManager;\n\t\t/** @private */\n\t\tthis.callService = wacProxy.getCallService();\n\t\t/** @private */\n\t\tthis.callAttemptService = wacProxy.getCallAttemptService();\n\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.wacId = '.invalid';\n\t\t/** @private */\n\t\tthis.direction = direction;\n\t\t/** @private */\n\t\tthis.gatewayCaller = gatewayCaller;\n\t\t/** @private */\n\t\tthis.gatewayCallee = gatewayCallee;\n\t\t/** @private */\n\t\tthis.originalGatewayCallee = gatewayCallee;\n\t\t/** @private */\n\t\tthis.remoteUser = remoteUser;\n\t\t/** @private */\n\t\tthis.pollingCall = pollingCall;\n\t\t/** @private */\n\t\tthis.pullFrom = pullFrom;\n\n\t\t/** @private */\n\t\tthis.beforeShareScreenVideo = true;\n\t\t/** @private */\n\t\tthis.status = direction === CallDirection.INCOMING ? CallStatus.TRYING : CallStatus.UNCONNECTED;\n\t\t/** @private */\n\t\tthis.endReason = CallEndReason.UNSPECIFIED;\n\t\t/** @private */\n\t\tthis.localOnlyStreams = new Set();\n\t\t/** @private */\n\t\tthis.localMediaHandler = new LocalMediaHandler(mediaConstraints, this.updateMedia.bind(this));\n\t\t/** @private */\n\t\tthis.remoteStreams = new Set();\n\t\t/** @private */\n\t\tthis.context = null;\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\t\tbindMethods(this, [\n\t\t\t'onRinging',\n\t\t\t'onEstablished',\n\t\t\t'onLocalStream',\n\t\t\t'onRemoteStream',\n\t\t\t'onEndCall',\n\t\t\t'onHoldReceived',\n\t\t\t'onResumeReceived',\n\t\t\t'onTransferred',\n\t\t\t'onCallAttemptRejected',\n\t\t]);\n\t}\n\n\t/** @private */\n\tinitialize() {\n\t\tif (this.direction === CallDirection.INCOMING) {\n\t\t\tthis.bindEventListeners();\n\t\t}\n\t\treturn this.localMediaHandler.init();\n\t}\n\n\t/** @private */\n\tbindEventListeners() {\n\t\tthis.wacProxy.on('qs-ringing', this.onRinging);\n\t\tthis.wacProxy.on('qs-established', this.onEstablished);\n\t\tthis.wacProxy.on('qs-localstream', this.onLocalStream);\n\t\tthis.wacProxy.on('qs-remotestream', this.onRemoteStream);\n\t\tthis.wacProxy.on('qs-end-call qs-lost-call', this.onEndCall);\n\t\tthis.wacProxy.on('qs-onhold-received', this.onHoldReceived);\n\t\tthis.wacProxy.on('qs-resume-received', this.onResumeReceived);\n\t\tthis.wacProxy.on('qs-transferred', this.onTransferred);\n\t\tthis.callAttemptService.emitter.on('rejected', this.onCallAttemptRejected);\n\t}\n\n\t/** @private */\n\tunbindEventListeners() {\n\t\tthis.wacProxy.off('qs-ringing', this.onRinging);\n\t\tthis.wacProxy.off('qs-established', this.onEstablished);\n\t\tthis.wacProxy.off('qs-localstream', this.onLocalStream);\n\t\tthis.wacProxy.off('qs-remotestream', this.onRemoteStream);\n\t\tthis.wacProxy.off('qs-end-call qs-lost-call', this.onEndCall);\n\t\tthis.wacProxy.off('qs-onhold-received', this.onHoldReceived);\n\t\tthis.wacProxy.off('qs-resume-received', this.onResumeReceived);\n\t\tthis.wacProxy.off('qs-transferred', this.onTransferred);\n\t\tthis.callAttemptService.emitter.off('rejected', this.onCallAttemptRejected);\n\t}\n\n\t/** @private */\n\tonRinging(event) {\n\t\tif (event.userid !== this.gatewayCaller || this.isPolling()) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.wacProxy.hasCapability('call-rehydration')) {\n\t\t\tthis.reconnect(event.callid);\n\t\t}\n\t}\n\n\t/** @private */\n\tonEstablished(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.updateCallControl('active').then(() => {\n\t\t\tthis.setStatus(CallStatus.CONNECTED);\n\t\t});\n\t}\n\n\t/** @private */\n\tonLocalStream(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.clearLocalOnlyStreams();\n\t\tthis.localMediaHandler.setVideoStream(event.stream);\n\t}\n\n\t/** @private */\n\tonRemoteStream(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tif (event.stream) {\n\t\t\t// Ignore stream updates of an already known stream\n\t\t\tif (this.remoteStreams.find(mS => mS.mediaStream === event.stream)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst managedStream = new ManagedStream(event.stream);\n\t\t\tconst old = this.remoteStreams;\n\t\t\tthis.remoteStreams = this.remoteStreams.add(managedStream);\n\t\t\tthis.emitter.emit('remoteStreams', this.remoteStreams, old);\n\t\t} else {\n\t\t\tthis.clearRemoteStreams();\n\t\t}\n\t}\n\n\t/** @private */\n\tonEndCall(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tconst endReason = getEndReasonFromWacValue(event.endReason);\n\t\tconst hasRehydration = this.wacProxy.hasCapability('call-rehydration');\n\t\tif (endReason === CallEndReason.NETWORK_ERROR && hasRehydration) {\n\t\t\treturn this.reconnect();\n\t\t}\n\t\tthis.sendStats();\n\t\tthis.updateCallControl('finished', event.endReason).then(() => {\n\t\t\tthis.setStatus(CallStatus.DISCONNECTED, endReason);\n\t\t});\n\t}\n\n\t/** @private */\n\tonHoldReceived(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setStatus(CallStatus.REMOTE_HOLD);\n\t}\n\n\t/** @private */\n\tonResumeReceived(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setStatus(CallStatus.CONNECTED);\n\t}\n\n\t/** @private */\n\tonTransferred(event) {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.id = event.to;\n\t\tif (this.direction === CallDirection.INCOMING) {\n\t\t\tthis.gatewayCaller = event.userid;\n\t\t} else {\n\t\t\tthis.gatewayCallee = event.userid;\n\t\t}\n\t\tthis.userManager.resolveUser(event.userid).then((user) => {\n\t\t\tthis.remoteUser = user;\n\t\t\tthis.setStatus(CallStatus.CONNECTED);\n\t\t\tthis.emitter.emit('transferred');\n\t\t});\n\t}\n\n\t/** @private */\n\tonCallAttemptRejected() {\n\t\tif (event.callid !== this.id) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setStatus(CallStatus.DISCONNECTED, CallEndReason.USER_BUSY);\n\t}\n\n\t/** @private */\n\tsendStats() {\n\t\tconst data = Object.assign({id: this.wacId}, this.stats);\n\t\tthis.wacProxy.sendStats('callcontrol', Date.now(), 'call-brief', data).then(() => {\n\t\t\tlog.debug('call brief sent');\n\t\t}).catch(() => {\n\t\t\tlog.error('unable to send call brief');\n\t\t});\n\t}\n\n\t/** @private */\n\tcreateCallControl() {\n\t\tif (!this.wacProxy.hasCapability('callcontrol')) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst caller = this.wacProxy.getCurrentCredential().data.username;\n\t\treturn this.callService.create({\n\t\t\tcaller,\n\t\t\tcallee: this.gatewayCallee,\n\t\t\tcontext: this.context,\n\t\t\tanonymousSessionId: this.sessionId,\n\t\t}).then((res) => {\n\t\t\tthis.wacId = res.id;\n\t\t\tthis.gatewayCallee = res.gatewayUsername;\n\t\t\tthis.context = res.context;\n\t\t\treturn res;\n\t\t}).catch((error) => {\n\t\t\tthis.setStatus(CallStatus.DISCONNECTED, CallEndReason.SERVER_ERROR);\n\t\t\tthrow error;\n\t\t});\n\t}\n\n\t/** @private */\n\tupdateCallControl(status, endReason = 'unknown') {\n\t\tif (!this.wacProxy.hasCapability('callcontrol')) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this.callService.update(this.wacId, {\n\t\t\tcaller: this.gatewayCaller,\n\t\t\tcallee: this.gatewayCallee,\n\t\t\tcontext: this.context,\n\t\t\tendReason: endReason,\n\t\t\tstatus: status,\n\t\t}).then((res) => {\n\t\t\tthis.wacId = res.id;\n\t\t\tthis.context = res.context;\n\t\t\tif (typeof this.context === 'object') {\n\t\t\t\tthis.emitter.emit('context', this.context);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/** @private */\n\tupdateMedia(audio, video, screen) {\n\t\tif (!this.hasStatus(CallStatus.UNCONNECTED, CallStatus.TRYING, CallStatus.DISCONNECTED)) {\n\t\t\treturn this.wacProxy.updateCallMedia(this.id, audio, video, screen);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Allows access to local streams and actions related to changing which local media is shared\n\t * @return {LocalMediaHandler}\n\t */\n\tgetLocalMediaHandler() {\n\t\treturn this.localMediaHandler;\n\t}\n\n\t/**\n\t * Returns the direction of the call\n\t * @return {CallDirection}\n\t */\n\tgetDirection() {\n\t\treturn this.direction;\n\t}\n\n\t/**\n\t * Returns a user object representing the remote user if exists\n\t * @return {User}\n\t */\n\tgetRemoteUser() {\n\t\treturn this.remoteUser;\n\t}\n\n\t/**\n\t * Returns a the remote gateway user\n\t * @return {string}\n\t */\n\tgetRemoteGatewayUser() {\n\t\treturn this.direction === CallDirection.INCOMING ? this.gatewayCaller : this.gatewayCallee;\n\t}\n\n\t/**\n\t * Returns the current status of the call\n\t * @return {CallStatus}\n\t */\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\t/**\n\t * Returns true if Call is in any of the specified status\n\t * @param {...CallStatus} args\n\t * @return {boolean}\n\t */\n\thasStatus(...args) {\n\t\treturn args.includes(this.status);\n\t}\n\n\t/**\n\t * Returns a promise that is resolved when the call changes to the requested status\n\t * @param {...CallStatus} statusList\n\t * @return {Promise<CallStatus>} A promise that is resolved with the received status\n\t */\n\twaitForStatus(...statusList) {\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.hasStatus(...statusList)) {\n\t\t\t\treturn resolve(this.status);\n\t\t\t}\n\t\t\tconst onStatus = (newStatus) => {\n\t\t\t\tif (!statusList.includes(newStatus)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emitter.off('status', onStatus);\n\t\t\t\tresolve(newStatus);\n\t\t\t};\n\t\t\tthis.emitter.on('status', onStatus);\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetStatus(status, endReason = CallEndReason.UNSPECIFIED) {\n\t\tif (this.status === status) {\n\t\t\treturn;\n\t\t}\n\t\tthis.status = status;\n\t\tif (status === CallStatus.DISCONNECTED) {\n\t\t\tthis.unbindEventListeners();\n\t\t\tthis.clearLocalOnlyStreams();\n\t\t\tthis.localMediaHandler.setVideoStream();\n\t\t\tthis.clearRemoteStreams();\n\t\t\tthis.endReason = endReason;\n\t\t}\n\t\tthis.emitter.emit('status', status);\n\t\tlog.log(this.direction, this.status, this.endReason);\n\t}\n\n\t/**\n\t * Returns the end reason of the call. This value is only specified when\n\t * the status of the call is DISCONNECTED\n\t * @return {CallEndReason}\n\t */\n\tgetEndReason() {\n\t\treturn this.endReason;\n\t}\n\n\t/**\n\t * Returns true if the Call is polling\n\t * @return {boolean}\n\t */\n\tisPolling() {\n\t\treturn this.pollingCall;\n\t}\n\n\t/**\n\t * Returns a set containing the local only streams\n\t * @return {ImmutableSet<ManagedStream>}\n\t */\n\tgetLocalOnlyStreams() {\n\t\treturn this.localOnlyStreams;\n\t}\n\n\t/**\n\t * Returns a set containing the remote streams\n\t * @return {ImmutableSet<ManagedStream>}\n\t */\n\tgetRemoteStreams() {\n\t\treturn this.remoteStreams;\n\t}\n\n\t/** @private */\n\tclearLocalOnlyStreams() {\n\t\tif (this.localOnlyStreams.isEmpty()) {\n\t\t\treturn;\n\t\t}\n\t\tthis.localOnlyStreams.forEach(mS => mS.stop());\n\t\tconst oldStreams = this.localOnlyStreams;\n\t\tthis.localOnlyStreams = this.localOnlyStreams.clear();\n\t\tthis.emitter.emit('localOnlyStreams', this.localOnlyStreams, oldStreams);\n\t}\n\n\t/** @private */\n\tclearRemoteStreams() {\n\t\tif (this.remoteStreams.isEmpty()) {\n\t\t\treturn;\n\t\t}\n\t\tconst old = this.remoteStreams;\n\t\tthis.remoteStreams = this.remoteStreams.clear();\n\t\tthis.emitter.emit('remoteStreams', this.remoteStreams, old);\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if the call has a local only video track\n\t * @return {boolean}\n\t */\n\thasLocalOnlyVideo() {\n\t\treturn this.localOnlyStreams.some(stream => stream.hasVideoTracks());\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if the call has a remote audio track\n\t * @return {boolean}\n\t */\n\thasRemoteAudio() {\n\t\treturn this.remoteStreams.some(stream => stream.hasAudioTracks());\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if the call has a remote video track\n\t * @return {boolean}\n\t */\n\thasRemoteVideo() {\n\t\treturn this.remoteStreams.some(stream => stream.hasVideoTracks());\n\t}\n\n\t/**\n\t * Returns actual call context\n\t * @return {Object} call context\n\t */\n\tgetContext() {\n\t\treturn this.context;\n\t}\n\n\t/**\n\t * Set some optional data that will be sent when creating the call.\n\t * Note that this method must be used before the call is connected.\n\t * @param {Object} context Any JSON serializable object that will be sent to\n\t * the server when the call starts\n\t * @return {Call}\n\t */\n\tsetContext(context) {\n\t\tif (typeof context !== 'object') {\n\t\t\tthrow new TypeError(`${context} is not a JSON serializable object`);\n\t\t}\n\t\tthis.context = cloneDeep(context);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Create an object to manage the remote recording\n\t * @param {String} [type='remote'] Type of the recording\n\t * @return {CallRemoteRecorder}\n\t */\n\tcreateCallRecorder(type) {\n\t\tif (type === 'remote' && this.wacProxy.hasCapability('recording')) {\n\t\t\treturn new CallRemoteRecorder(this.wacProxy, this.wacId);\n\t\t}\n\t}\n\n\t/**\n\t * Attempts to reach the call recipient and establish a connection.\n\t * @return {Promise<Call, Error>}\n\t */\n\tasync connect() {\n\t\ttry {\n\t\t\tif (this.getDirection() === CallDirection.OUTGOING) {\n\t\t\t\tawait this.connectOutgoing();\n\t\t\t} else {\n\t\t\t\tawait this.connectIncoming();\n\t\t\t}\n\t\t\treturn this;\n\t\t} catch (error) {\n\t\t\tlog.error('connect failed with error', error);\n\t\t\tif (!this.hasStatus(CallStatus.DISCONNECTED)) {\n\t\t\t\tawait this.updateCallControl('finished');\n\t\t\t\tthis.setStatus(CallStatus.DISCONNECTED);\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t/** @private */\n\tasync connectOutgoing() {\n\t\tif (this.getStatus === CallStatus.DISCONNECTED) {\n\t\t\tthis.setStatus(CallStatus.UNCONNECTED);\n\t\t}\n\t\tif (!this.hasStatus(CallStatus.UNCONNECTED)) {\n\t\t\tthrow new Error(`Invalid status. A call in ${CallStatus[this.status]} status can't be connected`);\n\t\t}\n\t\tthis.setStatus(CallStatus.TRYING);\n\t\tthis.wacProxy.once('qs-calling', (event) => {\n\t\t\tthis.id = event.callid;\n\t\t});\n\n\t\tthis.bindEventListeners();\n\t\tawait this.initializeLocalMedia();\n\t\tconst res = await this.createCallControl();\n\t\tif (res.state === 'queued') {\n\t\t\tawait this.waitWhileQueued();\n\t\t}\n\t\tif (this.pullFrom) {\n\t\t\treturn this.wacProxy.pullCallFromSession(this.pullFrom.id, this.pullFrom.session.id);\n\t\t}\n\t\tconst mediaConstraints = this.localMediaHandler.getCurrentMediaConstraints();\n\t\t// TODO Return here a rejected promise if wacProxy.call fails\n\t\treturn this.wacProxy.call(this.gatewayCallee, mediaConstraints, pick(this.context, 'recordFilename'));\n\t}\n\n\t/** @private */\n\tasync connectIncoming() {\n\t\tif (!this.hasStatus(CallStatus.TRYING)) {\n\t\t\tthrow new Error(`Invalid status. A call in ${CallStatus[this.status]} status can't be connected`);\n\t\t}\n\n\t\tif (this.isPolling()) {\n\t\t\treturn this.connectPollingCall();\n\t\t}\n\t\tawait this.updateCallControl('active');\n\t\tthis.setStatus(CallStatus.CONNECTING);\n\t\tthis.wacProxy.answer(this.id, this.localMediaHandler.getCurrentMediaConstraints());\n\t\treturn this.waitForStatus(CallStatus.CONNECTED);\n\t}\n\n\t/**\n\t * Create a local streams marked as localOnly stream\n\t * @private\n\t */\n\tinitializeLocalMedia() {\n\t\tif (bowser.msie || bowser.safari || bowser.firefox || bowser.ios) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tconst mediaConstraints = this.localMediaHandler.getCurrentMediaConstraints();\n\t\treturn navigator.mediaDevices.getUserMedia(mediaConstraints).then((mediaStream) => {\n\t\t\tconst managedStream = new ManagedStream(mediaStream, true);\n\t\t\tif (mediaConstraints.audio && !managedStream.hasAudioTracks()) {\n\t\t\t\tthrow new Error('Problem obtaining access to the microphone');\n\t\t\t}\n\t\t\tif (mediaConstraints.video && !managedStream.hasVideoTracks()) {\n\t\t\t\tthrow new Error('Problem obtaining access to the camera');\n\t\t\t}\n\t\t\tconst oldLocalOnlyStreams = this.localOnlyStreams;\n\t\t\tthis.localOnlyStreams = this.localOnlyStreams.add(managedStream);\n\t\t\tthis.emitter.emit('localOnlyStreams', this.localOnlyStreams, oldLocalOnlyStreams);\n\t\t\treturn managedStream;\n\t\t}).catch((error) => {\n\t\t\tthis.setStatus(CallStatus.DISCONNECTED, CallEndReason.MEDIA_ACCESS_ERROR);\n\t\t\tthrow error;\n\t\t});\n\t}\n\n\t/** @private */\n\twaitWhileQueued() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.setStatus(CallStatus.QUEUED);\n\t\t\tlet onCallUpdated = (event) => {\n\t\t\t\tif (event.id !== this.wacId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.context = event.context;\n\t\t\t\tthis.gatewayCallee = event.gatewayUsername;\n\t\t\t\tif (event.state === 'queued') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.callService.emitter.off('updated', onCallUpdated);\n\t\t\t\tif (event.state !== 'routed') {\n\t\t\t\t\tthis.setStatus(CallStatus.DISCONNECTED, getEndReasonFromWacValue(event.endReason));\n\t\t\t\t\treject(new Error('Call reached non routed state ' + event.state));\n\t\t\t\t} else {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.callService.emitter.on('updated', onCallUpdated);\n\t\t});\n\t}\n\n\t/** @private */\n\tconnectPollingCall() {\n\t\tconst pollingCallPromise = new Promise((resolve, reject) => {\n\t\t\tlet onPollingCallUpdate = (event) => {\n\t\t\t\tif (this.wacId !== event.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!['finished', 'active'].includes(event.state)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.callService.emitter.off('updated', onPollingCallUpdate);\n\t\t\t\tif (event.state === 'finished') {\n\t\t\t\t\tthis.setStatus(CallStatus.DISCONNECTED, getEndReasonFromWacValue(event.endReason));\n\t\t\t\t\treturn reject(new Error('Call was unexpectedly finished'));\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tthis.callService.emitter.on('updated', onPollingCallUpdate);\n\t\t});\n\t\tconst gatewayCallPromise = new Promise((resolve) => {\n\t\t\tconst onRinging = (event) => {\n\t\t\t\tif (event.userid !== this.gatewayCaller) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.wacProxy.off('qs-ringing', onRinging);\n\t\t\t\tthis.id = event.callid;\n\t\t\t\tresolve(this.connectIncoming());\n\t\t\t};\n\t\t\tthis.wacProxy.on('qs-ringing', onRinging);\n\t\t});\n\t\treturn Promise.all([\n\t\t\tgatewayCallPromise,\n\t\t\tpollingCallPromise,\n\t\t\tthis.callAttemptService.accept(this.wacId),\n\t\t]).then(() => {\n\t\t\tthis.pollingCall = false;\n\t\t});\n\t}\n\n\t/** @private */\n\treconnect(callId) {\n\t\tthis.localMediaHandler.setVideoStream();\n\t\tthis.remoteStreams.forEach(stream => stream.stop());\n\t\tthis.clearRemoteStreams();\n\t\tthis.setStatus(CallStatus.TRYING);\n\n\t\tif (this.direction === CallDirection.INCOMING) {\n\t\t\tthis.id = callId;\n\t\t\treturn this.connectIncoming();\n\t\t}\n\t\tthis.wacProxy.once('qs-calling', (event) => {\n\t\t\tthis.id = event.callid;\n\t\t});\n\t\tconst mediaConstraints = this.localMediaHandler.getCurrentMediaConstraints();\n\t\tthis.wacProxy.call(this.gatewayCallee, mediaConstraints, pick(this.context, 'recordFilename'));\n\t}\n\n\t/**\n\t * Disconnects or rejects the call\n\t * @return {Promise<Call>}\n\t */\n\tasync disconnect() {\n\t\tswitch (this.status) {\n\t\t\tcase CallStatus.UNCONNECTED:\n\t\t\tcase CallStatus.DISCONNECTED:\n\t\t\t\tthrow new Error(`Invalid status. A call in ${CallStatus[this.status]} status can't be disconnected`);\n\t\t\tcase CallStatus.TRYING:\n\t\t\t\tif (this.isPolling()) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.callAttemptService.reject(this.wacId);\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tthis.setStatus(CallStatus.DISCONNECTED, CallEndReason.USER_BUSY);\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tthis.wacProxy.hangup(this.id);\n\t\t\t\tawait this.waitForStatus(CallStatus.DISCONNECTED);\n\t\t\t\treturn this;\n\t\t\tcase CallStatus.QUEUED:\n\t\t\t\ttry {\n\t\t\t\t\tthis.updateCallControl('finished', 'leavesqueue');\n\t\t\t\t} finally {\n\t\t\t\t\tthis.setStatus(CallStatus.DISCONNECTED, CallEndReason.ORIGINATOR_CANCEL);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\tcase CallStatus.CONNECTING:\n\t\t\t\tawait this.waitForStatus(CallStatus.CONNECTED);\n\t\t\t\treturn this.disconnect();\n\t\t\tdefault:\n\t\t\t\tthis.wacProxy.hangup(this.id);\n\t\t\t\tawait this.waitForStatus(CallStatus.DISCONNECTED);\n\t\t\t\treturn this;\n\t\t}\n\t}\n\n\t/**\n\t * Holds this call\n\t * @return {Promise}\n\t */\n\thold() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet onSuccess, onError;\n\t\t\tconst unbind = () => {\n\t\t\t\tthis.wacProxy.off('qs-onhold-success', onSuccess);\n\t\t\t\tthis.wacProxy.off('qs-onhold-error', onError);\n\t\t\t};\n\t\t\tonSuccess = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\tthis.setStatus(CallStatus.HOLD);\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tonError = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\treject(event.reason);\n\t\t\t};\n\t\t\tthis.wacProxy.on('qs-onhold-success', onSuccess);\n\t\t\tthis.wacProxy.on('qs-onhold-error', onError);\n\t\t\tthis.wacProxy.hold(this.id);\n\t\t});\n\t}\n\n\t/**\n\t * Resumes this call\n\t * @return {Promise}\n\t */\n\tresume() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet onSuccess, onError;\n\t\t\tconst unbind = () => {\n\t\t\t\tthis.wacProxy.off('qs-resume-success', onSuccess);\n\t\t\t\tthis.wacProxy.off('qs-resume-error', onError);\n\t\t\t};\n\t\t\tonSuccess = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\tthis.setStatus(CallStatus.CONNECTED);\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tonError = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\treject(event.reason);\n\t\t\t};\n\t\t\tthis.wacProxy.on('qs-resume-success', onSuccess);\n\t\t\tthis.wacProxy.on('qs-resume-error', onError);\n\t\t\tthis.wacProxy.resume(this.id);\n\t\t});\n\t}\n\n\t/**\n\t * @param {string} to\n\t * @return {Promise<boolean, Error>} true if the call is correctly transferred and false if the\n\t * transfer is rejected or can not be done\n\t */\n\tasync transfer(to) {\n\t\tif (!this.hasStatus(CallStatus.CONNECTED, CallStatus.HOLD)) {\n\t\t\tthrow new Error(`Invalid status. A call in ${CallStatus[this.status]} status can't be transfered`);\n\t\t}\n\t\tconst gwUsername = await this.userManager.getGatewayUsername(to);\n\t\tthis.wacProxy.transfer(this.getRemoteGatewayUser(), gwUsername, this.id);\n\t\tawait this.waitForStatus(CallStatus.REMOTE_HOLD);\n\t\tconst res = await new Promise((resolve) => {\n\t\t\tlet onSuccess, onError;\n\t\t\tconst unbind = () => {\n\t\t\t\tthis.wacProxy.off('qs-end-call', onSuccess);\n\t\t\t\tthis.wacProxy.off('qs-resume-success', onError);\n\t\t\t};\n\t\t\tonSuccess = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\tresolve(true);\n\t\t\t};\n\t\t\tonError = (event) => {\n\t\t\t\tif (event.callid !== this.id) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tunbind();\n\t\t\t\tthis.setStatus(CallStatus.CONNECTED);\n\t\t\t\tresolve(false);\n\t\t\t};\n\t\t\tthis.wacProxy.on('qs-end-call', onSuccess);\n\t\t\tthis.wacProxy.on('qs-resume-success', onError);\n\t\t});\n\t\tif (res) {\n\t\t\tawait this.waitForStatus(CallStatus.DISCONNECTED);\n\t\t}\n\t\treturn res;\n\t}\n\n\t/** Send a DTMF tone\n\t * @param {string} key The key of the DTMF tone to send\n\t */\n\tsendDtmf(key) {\n\t\tthis.wacProxy.insertDTMF(this.id, key);\n\t}\n}\n","/**\n * This class is used to define a remote session where user has created\n * a session.\n */\nexport class RemoteSession {\n\n\t/**\n\t * Create a new RemoteSession instance with provided data\n\t *\n\t * @param {string} id session's identifier\n\t * @param {string} name session's name\n\t * @protected\n\t */\n\tconstructor(id, name) {\n\t\tif (typeof id !== 'string') {\n\t\t\tthrow new TypeError(`id parameter must be an string instead ${typeof id}`);\n\t\t}\n\t\tif (typeof name !== 'string') {\n\t\t\tthrow new TypeError(`name parameter must be an string instead ${typeof name}`);\n\t\t}\n\n\t\t/**\n\t\t * Session's identifier\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis._id = id;\n\n\t\t/**\n\t\t * Session's name\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis._name = name;\n\t}\n\n\t/**\n\t * Returns identifier associated with this session\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\t/**\n\t * Returns name associated with this session\n\t * @type {string}\n\t */\n\tget name() {\n\t\treturn this._name;\n\t}\n}\n","import {RemoteSession} from '../session/RemoteSession';\n\nexport class RemoteCall {\n\n\tconstructor(id, participants, session) {\n\t\tif (typeof id !== 'string') {\n\t\t\tthrow new TypeError(`id parameter must be an string instead ${typeof id}`);\n\t\t}\n\t\tif (!(participants instanceof Array)) {\n\t\t\tthrow new TypeError('participants parameter must be an Array instance');\n\t\t}\n\t\tif (!(session instanceof RemoteSession)) {\n\t\t\tthrow new TypeError('session parameter must be an RemoteSession instance');\n\t\t}\n\n\t\t/**\n\t\t * Call identifier\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._id = id;\n\n\t\t/**\n\t\t * Participants involved into this call\n\t\t * @private\n\t\t * @type {Array<String>}\n\t\t */\n\t\tthis._participants = participants;\n\n\t\t/**\n\t\t * Session where this call exists\n\t\t * @private\n\t\t * @type {RemoteSession}\n\t\t */\n\t\tthis._session = session;\n\t}\n\n\t/**\n\t * Returns identifier associated with this call\n\t * @type {String}\n\t */\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\t/**\n\t * List of participants associated with this call\n\t * @type {Array<String>}\n\t */\n\tget participants() {\n\t\treturn this._participants;\n\t}\n\n\t/**\n\t * Session where this call exists\n\t * @type {RemoteSession}\n\t */\n\tget session() {\n\t\treturn this._session;\n\t}\n}\n","import {CallDirection} from './CallDirection';\nimport {CallEndReason} from './CallEndReason';\nimport {CallStatus} from './CallStatus';\n\nexport class CallLogEntry {\n\t/**\n\t * @private\n\t */\n\tconstructor(id, callee, caller, target, from, to, status, endReason, direction, origin = {}, data = '') {\n\t\t/** @private */\n\t\tthis.id = id;\n\n\t\t/** @private */\n\t\tthis.callee = callee;\n\n\t\t/** @private */\n\t\tthis.caller = caller;\n\n\t\t/** @private */\n\t\tthis.target = target;\n\n\t\t/** @private */\n\t\tthis.from = from;\n\n\t\t/** @private */\n\t\tthis.to = to;\n\n\t\t/** @private */\n\t\tthis.status = status;\n\n\t\t/** @private */\n\t\tthis.endReason = endReason;\n\n\t\t/** @private */\n\t\tthis.direction = direction;\n\n\t\t/** @private */\n\t\tthis.origin = origin;\n\n\t\t/** @private */\n\t\tthis.data = data;\n\t}\n\n\t/**\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * Initial callee, before any redirection.\n\t * @return {CallDirection}\n\t */\n\tgetCallee() {\n\t\treturn this.callee;\n\t}\n\n\t/**\n\t * @return {String}\n\t */\n\tgetCaller() {\n\t\treturn this.caller;\n\t}\n\n\t/**\n\t * @return {String}\n\t */\n\tgetTarget() {\n\t\treturn this.target;\n\t}\n\n\t/**\n\t * Timestamp of call creation.\n\t * @return {Date}\n\t */\n\tgetFrom() {\n\t\treturn this.from;\n\t}\n\n\t/**\n\t * Timestamp of call finalization.\n\t * @return {Date}\n\t */\n\tgetTo() {\n\t\treturn this.to;\n\t}\n\n\t/**\n\t * @return {CallStatus}\n\t */\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\t/**\n\t * @type {CallEndReason}\n\t */\n\tgetEndReason() {\n\t\treturn this.endReason;\n\t}\n\n\t/**\n\t * @return {CallDirection}\n\t */\n\tgetDirection() {\n\t\treturn this.direction;\n\t}\n\n\t/**\n\t * @return {String}\n\t */\n\tgetOrigin() {\n\t\treturn this.origin;\n\t}\n\n\t/**\n\t * Origin caller information with next fields:\n\t * - useragent: caller's browser useragent\n\t * - language: caller's browser language\n\t * - location: URL loaded by caller\n\t * - ip: caller IP address\n\t * @return {Object}\n\t */\n\tgetData() {\n\t\treturn this.data;\n\t}\n\n\t/**\n\t * Get call duration in ms\n\t * @return {number} Call duration.\n\t */\n\tgetDuration() {\n\t\tif (this.status === CallStatus.CONNECTED) {\n\t\t\treturn Date.now() - this.from;\n\t\t}\n\t\treturn this.to - this.from;\n\t}\n\n\t/**\n\t * Gets the address of the remote participant. It can be a wac address if\n\t * it is from a wac user or not if it is from an external user\n\t * @returns {String}\n\t */\n\tgetRemoteAddress() {\n\t\treturn this.direction === CallDirection.INCOMING ? this.caller : this.callee;\n\t}\n\n\tisEnded() {\n\t\treturn this.status === CallStatus.FINISHED;\n\t}\n\n\tisIncoming() {\n\t\treturn this.direction === CallDirection.INCOMING;\n\t}\n\n\tisOutgoing() {\n\t\treturn this.direction === CallDirection.OUTGOING;\n\t}\n\n\tisMissed() {\n\t\treturn this.isIncoming() && (this.endReason === CallEndReason.NO_ANSWER ||\n\t\t\tthis.endReason === CallEndReason.ORIGINATOR_CANCEL);\n\t}\n}\n","import Logs from '../Logs';\nimport {bindMethods} from '../utils/bindMethods';\nimport {EventEmitter} from '../eventemitter';\nimport {CallLogEntry} from './CallLogEntry';\nimport {CallDirection} from './CallDirection';\nimport {CallStatus} from './CallStatus';\nimport {getEndReasonFromWacValue} from './CallEndReason';\n\n\nlet log = Logs.instance.getLogger('SippoJS/CallLog');\n\n/**\n * Manages the contacts and groups which they belongs to\n * CallLogManager instance is obtained by calling the {Session#getCallLogManager} method\n */\nexport class CallLog {\n\t/**\n\t * @protected\n\t */\n\tstatic create(callService, userManager) {\n\t\tlet callLog = new CallLog(callService, userManager);\n\t\treturn callLog.fetch().then(() => callLog);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tconstructor(callService, userManager) {\n\t\t/** @private */\n\t\tthis.callService = callService;\n\t\t/** @private */\n\t\tthis.userManager = userManager;\n\t\t/** @private */\n\t\tthis.entries = [];\n\t\t/** @private */\n\t\tthis.lastEntryRecovered = false;\n\n\t\t/**\n\t\t * Emits the next possible events:\n\t\t * - \"update\" event every time an existing entry is updated\n\t\t * - \"create\" event every time a new entry is prepended\n\t\t * - \"fetch\" event every time more entries are appended\n\t\t * @type {EventEmitter}\n\t\t*/\n\t\tthis.emitter = new EventEmitter();\n\n\t\tbindMethods(this, [\n\t\t\t'onUpdate',\n\t\t]);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindEventHandlers() {\n\t\tthis.callService.emitter.on('updated', this.onUpdate);\n\t\tthis.callService.emitter.on('created', this.onUpdate);\n\t}\n\n\t/**\n\t * Fetch more callLog entries\n\t * @param {number} [limit=20] The number of new entries to be fetched at most\n\t * @return {Promise} When resolved, the update was completed\n\t */\n\tfetch(limit = 20) {\n\t\tif (this.lastEntryRecovered) {\n\t\t\treturn;\n\t\t}\n\t\treturn this.callService.get({limit, sortBy: 'from'}).then((data) => {\n\t\t\tif (data.length <= 0) {\n\t\t\t\tthis.lastEntryRecovered = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.lastEntryRecovered = true; // Hack until lastRecoveredTimestamp is used\n\t\t\tthis.lastRecoveredTimestamp = data[data.length - 1].from;\n\t\t\tlet callLogs = data.map(datum => this.createCallLogEntry(datum));\n\t\t\tthis.entries = [...this.entries, ...callLogs];\n\t\t\tthis.emitter.emit('fetch');\n\t\t});\n\t}\n\n\t/**\n\t * Obtains the list with the available CallLog items\n\t * @return {CallLog[]}\n\t */\n\tgetEntries() {\n\t\treturn this.entries;\n\t}\n\n\t/**\n\t * Retrieves a CallLog by given its ID\n\t * @param {String} id\n\t * @return {CallLog}\n\t */\n\tgetById(id) {\n\t\treturn this.entries.find(callLog => callLog.id === id);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tcalculateStatus(status) {\n\t\tswitch (status) {\n\t\t\tcase 'active':\n\t\t\t\treturn CallStatus.CONNECTED;\n\t\t\tcase 'routed':\n\t\t\t\treturn CallStatus.TRYING;\n\t\t\tcase 'finished':\n\t\t\t\treturn CallStatus.DISCONNECTED;\n\t\t\tdefault:\n\t\t\t\tlog.error(`Unexpected status: ${status}`);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tcreateCallLogEntry(datum) {\n\t\tlet status = this.calculateStatus(datum.state);\n\t\tlet endReason = getEndReasonFromWacValue(datum.endReason);\n\t\tlet direction = this.userManager.isOwnAddress(datum.caller) ?\n\t\t\tCallDirection.OUTGOING : CallDirection.INCOMING;\n\n\t\treturn new CallLogEntry(\n\t\t\tdatum.id,\n\t\t\tdatum.callee,\n\t\t\tdatum.caller,\n\t\t\tdatum.target || datum.callee,\n\t\t\tnew Date(datum.from),\n\t\t\tnew Date(datum.to),\n\t\t\tstatus,\n\t\t\tendReason,\n\t\t\tdirection,\n\t\t\tdatum.origin,\n\t\t\tdatum.data,\n\t\t);\n\t}\n\n\t/**\n \t * @private\n \t */\n\tonUpdate(callLogDatum) {\n\t\tlet newEntry = this.createCallLogEntry(callLogDatum);\n\t\tlet oldEntry = this.entries.find(entry => entry.id === callLogDatum.id);\n\t\tif (oldEntry) {\n\t\t\tthis.entries = this.entries.map((entry) => {\n\t\t\t\treturn entry.getId() === callLogDatum.id ? newEntry : entry;\n\t\t\t});\n\t\t\tthis.emitter.emit('update', newEntry, oldEntry);\n\t\t} else {\n\t\t\tthis.entries = [newEntry, ...this.entries];\n\t\t\tthis.emitter.emit('create', newEntry);\n\t\t}\n\t}\n}\n","import {List, Set} from 'immutable';\nimport {cloneDeep} from 'lodash-es';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport Logs from '../Logs';\nimport {Call} from './Call';\nimport {CallStatus} from './CallStatus';\nimport {CallDirection} from './CallDirection';\nimport {RemoteCall} from './RemoteCall';\nimport {RemoteSession} from '../session/RemoteSession';\n\nimport {CallLog} from './CallLog';\n\nconst log = Logs.instance.getLogger('SippoJS/CallManager');\n\n/**\n * This class provides access to every call related feature\n * This class must never be directly instantiated, instances of this class\n * can be obtained using {@link Session#getCallManager}.\n *\n * ## Events\n *\n * - `incomingCall` ({@link Call}) - Emitted every time a new incoming call is received.\n */\nexport class CallManager {\n\t/**\n\t * @protected\n\t * @param {WacProxy} wacProxy\n\t * @param {UserManager} userManager\n\t * @param {string} ownGatewayUsername\n\t */\n\tstatic newInstance(wacProxy, userManager, ownGatewayUsername) {\n\t\treturn new CallManager(wacProxy, userManager, ownGatewayUsername);\n\t}\n\n\t/**\n\t * Creates a new call manager\n\t * @protected\n\t */\n\tconstructor(wacProxy, userManager, ownGatewayUsername) {\n\t\tthis._wacProxy = wacProxy;\n\t\tthis._callAttemptService = wacProxy.getCallAttemptService();\n\t\tthis._userManager = userManager;\n\t\tthis._defaultMediaConstraints = {\n\t\t\taudio: true,\n\t\t\tvideo: true,\n\t\t};\n\t\tthis._ownGatewayUsername = ownGatewayUsername;\n\n\t\tthis._pollingCalls = new List();\n\t\tthis._incomingCalls = new Set();\n\t\tthis._outgoingCalls = new Set();\n\t\tthis._callLog = null;\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\n\t\tbindMethods(this, [\n\t\t\t'_onCallAttemptCreated',\n\t\t\t'_onRinging',\n\t\t]);\n\t\tthis._bindEventHandlers();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_bindEventHandlers() {\n\t\tthis._callAttemptService.emitter.on('created', this._onCallAttemptCreated);\n\t\tthis._wacProxy.on('qs-ringing', this._onRinging);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onCallAttemptCreated(event) {\n\t\tthis.userManager.resolveUser(event.caller).then((user) => {\n\t\t\treturn Call.newInstance(this.wacProxy, this.userManager, {\n\t\t\t\tgatewayCaller: event.caller,\n\t\t\t\tgatewayCallee: this._ownGatewayUsername,\n\t\t\t\tremoteUser: user,\n\t\t\t\tpollingCall: true,\n\t\t\t});\n\t\t}).then((call) => {\n\t\t\tcall.setContext(event.context);\n\t\t\tthis._addIncomingCall(call);\n\t\t\tthis.emitter.emit('incomingCall', call);\n\t\t}).catch(error => log.error(error));\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _onRinging(event) {\n\t\tconst isDatapipe = event.media && event.media.data;\n\t\tconst isReconnection = this._incomingCalls.find(c => c.getRemoteGatewayUser() === event.userid);\n\t\tif (isDatapipe || isReconnection) {\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst user = await this._userManager.resolveUser(event.userid);\n\t\t\tconst call = await Call.newInstance(this._wacProxy, this._userManager, {\n\t\t\t\tid: event.callid,\n\t\t\t\tgatewayCaller: event.userid,\n\t\t\t\tgatewayCallee: this._ownGatewayUsername,\n\t\t\t\tremoteUser: user,\n\t\t\t\tmediaConstraints: this._defaultMediaConstraints,\n\t\t\t});\n\t\t\tawait call.getLocalMediaHandler().setMediaTypes({\n\t\t\t\taudio: event.media.audio,\n\t\t\t\tvideo: event.media.video,\n\t\t\t\tscreen: false,\n\t\t\t});\n\t\t\tthis._addIncomingCall(call);\n\t\t\tthis.emitter.emit('incomingCall', call);\n\t\t} catch (error) {\n\t\t\tlog.error(error);\n\t\t}\n\t}\n\n\t_addIncomingCall(call) {\n\t\tthis._incomingCalls = this._incomingCalls.add(call);\n\t\tcall.waitForStatus(CallStatus.DISCONNECTED).then(() => {\n\t\t\tthis._incomingCalls = this._incomingCalls.delete(call);\n\t\t});\n\t}\n\n\t_addOutgoingCall(call) {\n\t\tthis._outgoingCalls = this._outgoingCalls.add(call);\n\t\tcall.waitForStatus(CallStatus.DISCONNECTED).then(() => {\n\t\t\tthis._outgoingCalls = this._outgoingCalls.delete(call);\n\t\t});\n\t}\n\n\t/**\n\t * @return {MediaStreamConstraints}\n\t */\n\tgetDefaultMediaConstraints() {\n\t\treturn cloneDeep(this._defaultMediaConstraints);\n\t}\n\n\t/**\n\t * Sets the constraints that will be used as initial value for media requests when\n\t * initializing calls. For more information about valid values see\n\t * {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints}\n\t * @example <caption>Enabling noise reduction techniques</caption>\n\t * callManager.setDefaultMediaConstraints({\n\t *   audio: {\n\t *     autoGainControl: true,\n\t *     echoCancellation: true,\n\t *     noiseSuppression: true,\n\t *   },\n\t *   video: true,\n\t * });\n\t * @param {MediaStreamConstraints} defaultMediaConstraints\n\t */\n\tsetDefaultMediaConstraints(defaultMediaConstraints) {\n\t\tthis._defaultMediaConstraints = cloneDeep(defaultMediaConstraints);\n\t}\n\n\t/**\n\t * @return {Promise<CallLog>}\n\t */\n\tgetCallLog() {\n\t\tif (this._callLog === null) {\n\t\t\tconst callService = this._wacProxy.getCallService();\n\t\t\tthis._callLog = CallLog.create(callService, this._userManager);\n\t\t}\n\t\treturn this._callLog;\n\t}\n\n\t/**\n\t * Creates a new call instance for communication with the specified recipient.\n\t * @param {String} to The user identifier of the call recipient.\n\t * @return {Promise<Call, TypeError>}\n\t */\n\tcreateCall(to) {\n\t\tif (typeof to !== 'string') {\n\t\t\treturn Promise.reject(new TypeError(`${to} is not a string`));\n\t\t}\n\t\treturn this._userManager.resolveUser(to).then((user) => {\n\t\t\tconst gwUsername = user ? user.gatewayUsername : to;\n\t\t\treturn Call.newInstance(this._wacProxy, this._userManager, {\n\t\t\t\tdirection: CallDirection.OUTGOING,\n\t\t\t\tgatewayCaller: this._ownGatewayUsername,\n\t\t\t\tgatewayCallee: gwUsername,\n\t\t\t\tremoteUser: user,\n\t\t\t\tmediaConstraints: this._defaultMediaConstraints,\n\t\t\t});\n\t\t}).then((call) => {\n\t\t\tthis._addOutgoingCall(call);\n\t\t\treturn call;\n\t\t});\n\t}\n\n\t/**\n\t * Get a list of remote calls where user is currently participating\n\t * @return {Promise<RemoteCall[]>}\n\t */\n\tgetRemoteCalls() {\n\t\treturn Promise.resolve().then(() => this._wacProxy.getRemoteSessions()).then((sessions) => {\n\t\t\tlet calls = [];\n\t\t\tsessions.forEach((session) => {\n\t\t\t\tsession.calls.forEach((call) => {\n\t\t\t\t\tlet dev = new RemoteSession(session.id, session.name);\n\t\t\t\t\tlet item = new RemoteCall(call.id, call.participants, dev);\n\t\t\t\t\tcalls.push(item);\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn calls;\n\t\t});\n\t}\n\n\t/**\n\t * Pulls remote call from remote session.\n\t *\n\t * @example\n\t *  const callManager = await session.getCallManager();\n\t *  const calls = await callManager.getRemoteCalls();\n\t *  console.log('got remote calls', calls);\n\t *  if (!calls) {\n\t *    return;\n\t *  }\n\t *  const call = await cm.pull(calls[0]);\n\t *  await call.connect();\n\t *\n\t * @param {RemoteCall} remoteCall\n\t * @return {Promise<Call, Error>}\n\t */\n\tasync pull(remoteCall) {\n\t\tconst user = await this._userManager.resolveUser(remoteCall.participants[0]);\n\t\tlet call = await Call.newInstance(this._wacProxy, this._userManager, {\n\t\t\tdirection: CallDirection.OUTGOING,\n\t\t\tgatewayCaller: this._ownGatewayUsername,\n\t\t\tgatewayCallee: remoteCall.participants[0],\n\t\t\tremoteUser: user,\n\t\t\tdefaultMediaConstraints: this._defaultMediaConstraints,\n\t\t\tpullFrom: remoteCall,\n\t\t});\n\t\treturn call;\n\t}\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible end reasons of a conference. Possible values:\n * - UNSPECIFIED\n * - NORMAL_CLEARING\n * - MEDIA_ACCESS_ERROR\n * - SERVER_ERROR\n * @type {Enum}\n */\nexport const ConferenceEndReason = new Enum([\n\t'UNSPECIFIED',\n\t'NORMAL_CLEARING',\n\t'MEDIA_ACCESS_ERROR',\n\t'SERVER_ERROR',\n]);\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible status of a conference. Possible values:\n * - DESTROYED\n * - DISCONNECTED\n * - CONNECTING\n * - CONNECTED\n * - DISCONNECTING\n * @type {Enum}\n */\nexport const ConferenceStatus = new Enum([\n\t'DESTROYED',\n\t'DISCONNECTED',\n\t'CONNECTING',\n\t'CONNECTED',\n\t'DISCONNECTING',\n]);\n","/**\n * This class allows access to the details of each outgoing invitation in a Conference\n * @link {Conference#getOutgoingInvitations()} method should be used to obtain the list\n * of instances of this class.\n * This is an immutable object, the private setters return a new object instance.\n */\nexport class Invitation {\n\t/** @private */\n\tconstructor(toUser, to, mediaTypes, autoAccepted, responseCode, hasStreams, canceled) {\n\t\tthis._toUser = toUser;\n\t\tthis._to = to;\n\t\tthis._mediaTypes = mediaTypes;\n\t\tthis._autoAccepted = autoAccepted;\n\t\tthis._responseCode = responseCode;\n\t\tthis._hasStreams = hasStreams;\n\t\tthis._canceled = canceled;\n\t\tthis._timestamp = Date.now();\n\t\tObject.freeze(this);\n\t}\n\n\t/**\n\t * Obtains the User object representing the WAC user of the invited user\n\t * If we are not inviting a wac user, this will be empty.\n\t * @returns {Object}\n\t */\n\tgetToUser() {\n\t\treturn this._toUser;\n\t}\n\n\t/**\n\t * Obtains the \"gateway username\" of the invited user.\n\t * @returns {string}\n\t */\n\tgetTo() {\n\t\treturn this._to;\n\t}\n\n\t/**\n\t * Obtains the mediaTypes for this invitation.\n\t * This allow us to guess if we are inviting the user with audio & video, or only with audio and video\n\t * @returns {MediaTypes}\n\t */\n\tgetMediaTypes() {\n\t\treturn this._mediaTypes;\n\t}\n\n\t/**\n\t * Returns true when the invitation is marked as \"auto accepted\".\n\t * The \"auto accepted\" invitations are sent after accepting an invitation request and they are going to be accepted\n\t * automatically by the invited user.\n\t * @returns {boolean}\n\t */\n\tisAutoAccepted() {\n\t\treturn this._autoAccepted;\n\t}\n\n\t/**\n\t * Returns The response code of the invitation.\n\t * This will be a 200 (OK) when the invited user accepts the invitation.\n\t * @returns {number}\n\t */\n\tgetResponseCode() {\n\t\treturn this._responseCode;\n\t}\n\n\t/**\n\t * Returns true when the conference room has a stream associated to the invited user.\n\t * @returns {boolean}\n\t */\n\thasStreams() {\n\t\treturn this._hasStreams;\n\t}\n\n\t/**\n\t * Returns true when the user has cancelled this invitation.\n\t * @returns {boolean}\n\t */\n\tisCanceled() {\n\t\treturn this._canceled;\n\t}\n\n\t/**\n\t * Utility method that returns true when the invitation does not has a response code and it it not cancelled.\n\t * @returns {boolean}\n\t */\n\tisActive() {\n\t\treturn !this._responseCode && !this._canceled;\n\t}\n\n\t/**\n\t * Returns the timestamp when this invitation object was created.\n\t * This is useful to keep the client showing the invitations with errors for a period of time.\n\t * @returns {number}\n\t */\n\tgetTimestamp() {\n\t\treturn this._timestamp;\n\t}\n\n\t/** @private */\n\tsetTo(to) {\n\t\treturn new Invitation(this._toUser, to, this._mediaTypes, this._autoAccepted, this._responseCode, this._hasStreams, this._canceled);\n\t}\n\n\t/** @private */\n\tsetResponseCode(responseCode) {\n\t\treturn new Invitation(this._toUser, this._to, this._mediaTypes, this._autoAccepted, responseCode, this._hasStreams, this._canceled);\n\t}\n\n\t/** @private */\n\tsetCanceled(canceled) {\n\t\treturn new Invitation(this._toUser, this._to, this._mediaTypes, this._autoAccepted, this._responseCode, this._hasStreams, canceled);\n\t}\n\n\t/** @private */\n\tsetStreams(hasStreams) {\n\t\treturn new Invitation(this._toUser, this._to, this._mediaTypes, this._autoAccepted, this._responseCode, hasStreams, this._canceled);\n\t}\n}\n","export const ParticipantEvents = {\n\tPARTICIPANT_ADDED: 'participantAdded',\n\tPARTICIPANT_REMOVED: 'participantRemoved',\n\tPARTICIPANT_HOLD: 'participantHold',\n\tPARTICIPANT_UNHOLD: 'participantUnhold',\n};\n\nexport const StreamChangeEvents = {\n\tLOCAL_STREAM_CHANGED: 'localStreamChanged',\n\tLOCAL_STREAM_ADDED: 'localStreamAdded',\n\tLOCAL_STREAM_REMOVED: 'localStreamRemoved',\n\tREMOTE_STREAM_CHANGED: 'remoteStreamChanged',\n\tREMOTE_STREAM_ADDED: 'remoteStreamAdded',\n\tREMOTE_STREAM_REMOVED: 'remoteStreamRemoved',\n};\n\n","import {MediaTypes} from '../types';\n\n/**\n * This class allows access to the details of incoming Conference invitation.\n * This class must not be directly instantiated. Instead,\n * instances of this class are obtained by calling the {@link Conference#getInvite}\n */\nexport class ConferenceInvite {\n\n\tprivate id: string;\n\tprivate from: string;\n\tprivate mediaTypes: MediaTypes;\n\n\t/** @ignore */\n\tpublic constructor(id: string, from: string, mediaTypes: MediaTypes) {\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.from = from;\n\t\t/** @private */\n\t\tthis.mediaTypes = mediaTypes;\n\t}\n\n\t/**\n\t * @desc Obtains the ID of the incoming invitation\n\t * @returns {string}\n\t */\n\tpublic getId(): string {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @desc Obtains the \"gateway\" of the caller. This can be a user's gateway or pstn number.\n\t * @returns {string}\n\t */\n\tpublic getFrom(): string {\n\t\treturn this.from;\n\t}\n\n\t/**\n\t * @desc Obtains the mediaTypes for this conference invite.\n\t * This allow us to guess if we are invited with audio & video, or only with audio and video\n\t * @returns {MediaTypes}\n\t */\n\tpublic getMediaTypes(): MediaTypes {\n\t\treturn this.mediaTypes;\n\t}\n}\n","import {Map, Set} from 'immutable';\nimport {BehaviorSubject} from 'rxjs';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\n\nimport {ManagedStream} from '../media/ManagedStream';\nimport {LocalMediaHandler} from '../media/LocalMediaHandler';\nimport {ConferenceEndReason as EndReason} from './ConferenceEndReason';\nimport {ConferenceStatus as Status} from './ConferenceStatus';\nimport {Invitation} from './Invitation';\nimport {\n\tParticipantEvents,\n\tStreamChangeEvents,\n} from '../wac-proxy/stacks/ConferenceEvents';\n\nimport Logs from '../Logs';\nimport {ConferenceInvite} from './ConferenceInvite';\nconst log = Logs.instance.getLogger('SippoJS/calls/Conference');\n\nconst ALREADY_JOINED_ERROR = 'ALREADY_JOINED';\nconst CALL_TRANSFER_START_EVENT = 'callTransferStart';\nconst TEMPORARILY_UNAVAILABLE_RESPONSE = 480;\nconst OK_RESPONSE = 200;\n\nconst existUserButNotConnected = (code, invitation) =>\n\tcode === 404 && typeof invitation.getToUser() === 'object';\n\nconst getGatewayUri = (session, gtUsername) => {\n\treturn session ? gtUsername + `/${session}` : gtUsername;\n};\n\nconst userStatusAsKeyValue = ({user, status}) => ({[user]: status});\n\nconst makePlainUserStatus = (users) => {\n\tconst reducer = (acc, user) =>\n\t\tObject.assign(acc, userStatusAsKeyValue(user));\n\treturn users.reduce(reducer, {});\n};\n\n/**\n * @typedef {string} gatewayUsername\n */\n\n/**\n * @typedef {Object} EventInfo\n * @property {string} participant gatewayUsername of a participant in the conference\n * @property {string} [reason='IN_CALL'|'HOLD'] reason to know if the participant is on hold or not\n */\n\n/**\n * @typedef {Object} LocalStreamEvent\n * @property {string} participant gatewayUsername of the local stream\n * @property {@link ManagedStream} stream\n */\n\n/**\n * @typedef {Object} RemoteStreamAddedEvent\n * @property {string} participant gatewayUsername of the local stream\n * @property {string} [reason='NEW'|'UNHOLD'] reason of stream addition\n * @property {@link ManagedStream} stream\n */\n\n/**\n * @typedef {Object} RemoteStreamRemovedEvent\n * @property {string} participant gatewayUsername of the local stream\n * @property {string} [reason='GONE'|'HOLD'] reason of stream addition\n * @property {@link ManagedStream} stream\n */\n\n/**\n * Provides access to methods for managing outgoing or incoming conferences.\n * {@link Conference} objects are obtained calling {@link ConferenceManager#createConference} method or handling\n * the `onIncoming` event of a connected {@link ConferenceManager} instance.\n *\n * ## Events\n *\n * - `remoteStreams` ({@link ImmutableSet}<{@link ManagedStream}> currentValue, {@link ImmutableSet}<{@link ManagedStream}> oldValue, {@link EventInfo})\n *    - Emitted every time remoteStreams changes.\n * - `outgoingInvitations` ({@link ImmutableSet}<{@link Invitation}> currentValue, {@link Invitation}<{@link ManagedStream}> oldValue)\n *    - Emitted every a outgoingInvitation changes.\n * - `expelled`\n *    - Emitted when we are expelled from the conference.\n *      deprecated\n * - `destroyed`\n *    - Emitted when the conference is destroyed.\n *      deprecated\n * - `status` ({@link ConferenceStatus} currentValue, {@link ConferenceStatus}<{@link ManagedStream}> oldValue)\n *    - Emitted every time the conference status changes.\n *      deprecated\n * - `remoteParticipants` ({@link ImmutableMap}<{@link gatewayUsername}, 'IN_CALL'|'HOLD'> currentValue, {@link ImmutableMap}<{@link gatewayUsername}, 'IN_CALL'|'HOLD'> oldValue)\n *   - Emitted every time the participants list changes.\n * - `transferError`\n *   - Emitted when an error occurs in a transfer.\n * - `participantAdded` ({@link gatewayUsername} gatewayUsername)\n *   - Emitted when a new participant joins the conference\n * - `participantRemoved` ({@link gatewayUsername} gatewayUsername)\n *   - Emitted when a participant leaves the conference\n * - `participantHold` ({@link gatewayUsername} gatewayUsername)\n *   - Emitted when a participant starts holding the call\n * - `participantUnhold` ({@link gatewayUsername} gatewayUsername)\n *   - Emitted when a participant stops holding the call\n * - `localStreamAdded` ({@link LocalStreamEvent})\n *   - Emitted on a new local stream\n * - `localStreamRemoved` ({@link LocalStreamEvent})\n *   - Emitted on local stream removed\n * - `remoteStreamAdded` ({@link RemoteStreamAddedEvent})\n *   - Emitted on remote stream added\n * - `remoteStreamRemove` ({@link RemoteStreamRemovedEvent})\n *   - Emitted on remote stream removed\n */\nexport class Conference {\n\t/** @private */\n\tconstructor(userManager, room, mediaConstraints) {\n\t\tthis._userManager = userManager;\n\t\tthis._room = room;\n\t\tthis._status = new BehaviorSubject(Status.DISCONNECTED);\n\t\tthis._endReason = EndReason.UNSPECIFIED;\n\t\tthis._localMediaHandler = new LocalMediaHandler(mediaConstraints, this.updateMedia.bind(this));\n\t\tthis._transferingCall = false;\n\t\tthis._outgoingInvitations = new Set();\n\t\tthis._remoteParticipants = new Map();\n\n\t\tthis._remoteStreams = new Map();\n\t\tthis._remoteWacAddresses = new Set();\n\n\t\t/**\n\t\t * Use to keep the number of invitations sent in this conference\n\t\t * @type {boolean}\n\t\t */\n\t\tthis.invitationCount = 0;\n\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter({newListener: true});\n\t\tthis.emitter.on('newListener', (eventName) => {\n\t\t\tif (['status', 'destroyed', 'expelled'].includes(eventName)) {\n\t\t\t\tlog.warn(`${eventName} is deprecated. Please use getStatus() and/or getStatus$() instead`);\n\t\t\t}\n\t\t});\n\n\t\tbindMethods(this, [\n\t\t\t'_onLocalStreamChanged',\n\t\t\t'_onLocalStreamAdded',\n\t\t\t'_onLocalStreamRemoved',\n\t\t\t'_onRemoteStreamChanged',\n\t\t\t'_onRemoteStreamAdded',\n\t\t\t'_onRemoteStreamRemoved',\n\t\t\t'_onExpelled',\n\t\t\t'_onTransferingCall',\n\t\t\t'_onDestroyed',\n\t\t\t'_onParticipantAdded',\n\t\t\t'_onParticipantRemoved',\n\t\t\t'_onParticipantHold',\n\t\t\t'_onParticipantUnhold',\n\t\t]);\n\n\t\t// Asume at least someone was invited for recovered conferences\n\t\tif (room.recovered) {\n\t\t\tthis.invitationCount++;\n\t\t}\n\t}\n\n\t/**\n\t * @protected\n\t * @param {UserManager} userManager\n\t * @param {Room} room\n\t * @param {MediaStreamConstraints} mediaConstraints\n\t */\n\tstatic async create(userManager, room, mediaConstraints) {\n\t\tconst conference = new Conference(userManager, room, mediaConstraints);\n\t\tconference._bindEventHandlers();\n\t\tconference._owner = await userManager.resolveUser(room.owner);\n\t\tawait conference._localMediaHandler.init();\n\t\treturn conference;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_bindEventHandlers() {\n\t\tthis._room.on(StreamChangeEvents.LOCAL_STREAM_CHANGED, this._onLocalStreamChanged);\n\t\tthis._room.on(StreamChangeEvents.LOCAL_STREAM_ADDED, this._onLocalStreamAdded);\n\t\tthis._room.on(StreamChangeEvents.LOCAL_STREAM_REMOVED, this._onLocalStreamRemoved);\n\t\tthis._room.on(StreamChangeEvents.REMOTE_STREAM_CHANGED, this._onRemoteStreamChanged);\n\t\tthis._room.on(StreamChangeEvents.REMOTE_STREAM_ADDED, this._onRemoteStreamAdded);\n\t\tthis._room.on(StreamChangeEvents.REMOTE_STREAM_REMOVED, this._onRemoteStreamRemoved);\n\t\tthis._room.on('expelled', this._onExpelled);\n\t\tthis._room.on('transferingCall', this._onTransferingCall);\n\t\tthis._room.on('conference-destroyed', this._onDestroyed);\n\t\tthis._room.on(ParticipantEvents.PARTICIPANT_ADDED, this._onParticipantAdded);\n\t\tthis._room.on(ParticipantEvents.PARTICIPANT_REMOVED, this._onParticipantRemoved);\n\t\tthis._room.on(ParticipantEvents.PARTICIPANT_HOLD, this._onParticipantHold);\n\t\tthis._room.on(ParticipantEvents.PARTICIPANT_UNHOLD, this._onParticipantUnhold);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_unbindEventHandlers() {\n\t\tthis._room.off(StreamChangeEvents.LOCAL_STREAM_CHANGED, this._onLocalStreamChanged);\n\t\tthis._room.off(StreamChangeEvents.LOCAL_STREAM_ADDED, this._onLocalStreamAdded);\n\t\tthis._room.off(StreamChangeEvents.LOCAL_STREAM_REMOVED, this._onLocalStreamRemoved);\n\t\tthis._room.off(StreamChangeEvents.REMOTE_STREAM_CHANGED, this._onRemoteStreamChanged);\n\t\tthis._room.off(StreamChangeEvents.REMOTE_STREAM_ADDED, this._onRemoteStreamAdded);\n\t\tthis._room.off(StreamChangeEvents.REMOTE_STREAM_REMOVED, this._onRemoteStreamRemoved);\n\t\tthis._room.off('expelled', this._onExpelled);\n\t\tthis._room.off('transferingCall', this._onTransferingCall);\n\t\tthis._room.off('conference-destroyed', this._onDestroyed);\n\t\tthis._room.off(ParticipantEvents.PARTICIPANT_ADDED, this._onParticipantAdded);\n\t\tthis._room.off(ParticipantEvents.PARTICIPANT_REMOVED, this._onParticipantRemoved);\n\t\tthis._room.off(ParticipantEvents.PARTICIPANT_HOLD, this._onParticipantHold);\n\t\tthis._room.off(ParticipantEvents.PARTICIPANT_UNHOLD, this._onParticipantUnhold);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onLocalStreamChanged(event) {\n\t\tif (event.streams && event.streams.length > 0) {\n\t\t\tthis._localMediaHandler.setAudioOnlyStream(event.streams.find(s => s.getAudioTracks().length > 0));\n\t\t\tthis._localMediaHandler.setVideoStream(event.streams.find(s => s.getVideoTracks().length > 0));\n\t\t\t// Detect stopped screen track\n\t\t\tthis._localMediaHandler.getVideoStream().getScreenTracks().forEach((screenTrack) => {\n\t\t\t\tscreenTrack.onended = () => this._localMediaHandler.toggleScreen(false);\n\t\t\t});\n\t\t} else {\n\t\t\tthis._localMediaHandler.setVideoStream();\n\t\t\tthis._localMediaHandler.setAudioOnlyStream();\n\t\t}\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\t_onLocalStreamAdded({participant, stream}) {\n\t\tthis.emitter.emit(StreamChangeEvents.LOCAL_STREAM_ADDED, {\n\t\t\tparticipant,\n\t\t\tstream: new ManagedStream(stream, true),\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onLocalStreamRemoved({participant, stream}) {\n\t\tthis.emitter.emit(StreamChangeEvents.LOCAL_STREAM_REMOVED, {\n\t\t\tparticipant,\n\t\t\tstream: new ManagedStream(stream, true),\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onRemoteStreamAdded({participant, stream, reason}) {\n\t\tthis.emitter.emit(StreamChangeEvents.REMOTE_STREAM_ADDED, {\n\t\t\tparticipant,\n\t\t\treason,\n\t\t\tstream: this._getRemoteStream(stream) || new ManagedStream(stream),\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getRemoteStream(stream) {\n\t\tfor (const remoteStreams of this._remoteStreams.values()) {\n\t\t\tfor (const remoteStream of remoteStreams) {\n\t\t\t\tif (remoteStream && remoteStream.mediaStream === stream) {\n\t\t\t\t\treturn remoteStream;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onRemoteStreamRemoved({participant, stream, reason}) {\n\t\tthis.emitter.emit(StreamChangeEvents.REMOTE_STREAM_REMOVED, {\n\t\t\tparticipant,\n\t\t\treason,\n\t\t\tstream: this._getRemoteStream(stream) || new ManagedStream(stream),\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onRemoteStreamChanged(event) {\n\t\treturn Promise.resolve(event.participant ? this._userManager.resolveUser(event.participant) : null).then((user) => {\n\t\t\tconst oldRemoteStreams = this._remoteStreams;\n\t\t\tlet invitationToSetStreamsTrue;\n\t\t\tif (!event.streams || event.streams.length <= 0) {\n\t\t\t\tthis._remoteStreams = this._remoteStreams.delete(event.participant);\n\t\t\t\tif (user) {\n\t\t\t\t\tthis._remoteWacAddresses = this._remoteWacAddresses.delete(user.getAddress());\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet managedStreams = event.streams.map(stream => this._getRemoteStream(stream) || new ManagedStream(stream));\n\t\t\t\tthis._remoteStreams = this._remoteStreams.set(event.participant, managedStreams);\n\t\t\t\tif (user) {\n\t\t\t\t\tthis._remoteWacAddresses = this._remoteWacAddresses.add(user.getAddress());\n\t\t\t\t}\n\t\t\t\tinvitationToSetStreamsTrue = this._getOutgoingInvitation(event.participant);\n\t\t\t}\n\t\t\tthis.emitter.emit('remoteStreams', this._remoteStreams, oldRemoteStreams, {\n\t\t\t\tparticipant: event.participant,\n\t\t\t\treason: event.reason,\n\t\t\t});\n\t\t\tif (invitationToSetStreamsTrue) {\n\t\t\t\tthis._updateOutgoingInvitations(invitationToSetStreamsTrue.setStreams(true), invitationToSetStreamsTrue);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onExpelled() {\n\t\tthis._localMediaHandler.setVideoStream();\n\t\tthis._localMediaHandler.setAudioOnlyStream();\n\t\tthis._remoteStreams = new Map();\n\t\tthis.emitter.emit('expelled');\n\t\tthis._setStatus(Status.DESTROYED);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onDestroyed() {\n\t\tthis._localMediaHandler.setVideoStream();\n\t\tthis._localMediaHandler.setAudioOnlyStream();\n\t\tthis._remoteStreams = new Map();\n\t\tthis.emitter.emit('destroyed');\n\t\tthis._setStatus(Status.DESTROYED);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onTransferingCall(event) {\n\t\tthis._setTransferingCall(true);\n\t\treturn this._room.acceptCallTransfer(event.payload.callTransferID).then(() => {\n\t\t\tthis.emitter.emit(CALL_TRANSFER_START_EVENT);\n\t\t\treturn this.inviteParticipant(event.payload.to, undefined, event.payload.mediatypes).then((response) => {\n\t\t\t\tif (response != 200) {\n\t\t\t\t\tthis.emitter.emit('transferError', response);\n\t\t\t\t}\n\t\t\t}).finally(() => {\n\t\t\t\tthis._setTransferingCall(false);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _onParticipantAdded(participantObj) {\n\t\tlog.debug(`onParticipantAdded(participant) : ${participantObj}`);\n\t\tthis._updateParticipants(participants =>\n\t\t\tparticipants.set(participantObj.user, participantObj.status));\n\t\tthis.emitter.emit(ParticipantEvents.PARTICIPANT_ADDED, participantObj.user);\n\t}\n\n\t_updateParticipants(updater) {\n\t\tconst oldValue = this.getRemoteParticipants();\n\t\tconst currentValue = updater(oldValue);\n\t\tthis._remoteParticipants = currentValue;\n\t\tthis.emitter.emit('remoteParticipants', currentValue, oldValue);\n\t\treturn currentValue;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _onParticipantRemoved(participant) {\n\t\tlog.debug(`onParticipantRemoved(participant) : ${participant}`);\n\t\tthis._updateParticipants(participants =>\n\t\t\tparticipants.delete(participant));\n\t\tthis.emitter.emit(ParticipantEvents.PARTICIPANT_REMOVED, participant);\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} participant - Participant user name\n\t */\n\t_onParticipantHold(participant) {\n\t\tlog.debug(`onParticipantHold(participant) : ${participant}`);\n\t\tthis._updateParticipants(participants =>\n\t\t\tparticipants.set(participant, 'HOLD'));\n\t\tthis.emitter.emit(ParticipantEvents.PARTICIPANT_HOLD, participant);\n\t}\n\n\t/**\n\t * @private\n\t * @param {string} participant - Participant user name\n\t */\n\t_onParticipantUnhold(participant) {\n\t\tlog.debug(`onParticipantUnhold(participant) : ${participant}`);\n\t\tthis._updateParticipants(participants =>\n\t\t\tparticipants.set(participant, 'IN_CALL'));\n\t\tthis.emitter.emit(ParticipantEvents.PARTICIPANT_UNHOLD, participant);\n\t}\n\n\t/**\n\t * Manages the Invitations Set and events.\n\t * @private\n\t */\n\t_updateOutgoingInvitations(invitationToAdd, invitationToRemove) {\n\t\tconst oldOutgoingInvitations = this._outgoingInvitations;\n\t\tif (invitationToRemove) {\n\t\t\tthis._outgoingInvitations = this._outgoingInvitations.delete(invitationToRemove);\n\t\t}\n\t\tif (invitationToAdd) {\n\t\t\tthis._outgoingInvitations = this._outgoingInvitations.add(invitationToAdd);\n\t\t}\n\t\tthis.emitter.emit('outgoingInvitations', this._outgoingInvitations, oldOutgoingInvitations);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getOutgoingInvitation(gatewayUsername) {\n\t\treturn this._outgoingInvitations.find((invitation) => {\n\t\t\treturn invitation.getTo() === gatewayUsername;\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_hasActiveInvitation(gatewayUsername) {\n\t\treturn this._outgoingInvitations.some((i) => {\n\t\t\treturn i.getTo() === gatewayUsername && i.isActive();\n\t\t});\n\t}\n\n\t/**\n\t * This is assuming that if it does not has an invitation answered 200, it could never been in the room\n\t * Made to solve PSTN problems (users with early media cannot be re-invited)\n\t * TODO We need a proper way to check if the user is already joined\n\t * @private\n\t */\n\t_alreadyJoined(gatewayUsername) {\n\t\tconst invitation = this._getOutgoingInvitation(gatewayUsername);\n\t\tif (invitation) {\n\t\t\treturn invitation.getResponseCode() === OK_RESPONSE && this._remoteStreams.has(gatewayUsername);\n\t\t} else {\n\t\t\treturn this._remoteStreams.has(gatewayUsername);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_canSendInvitation(gatewayUsername) {\n\t\treturn !this._hasActiveInvitation(gatewayUsername) && !this._alreadyJoined(gatewayUsername);\n\t}\n\n\t/**\n\t * Returns the ID of the conference\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this._room.id;\n\t}\n\n\t/**\n\t * Returns the remote participants\n\t * @return {ImmutableMap<string, 'IN_CALL'|'HOLD'>}\n\t */\n\tgetRemoteParticipants() {\n\t\treturn this._remoteParticipants;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync fetchRemoteParticipants() {\n\t\tconst myAddress = this._userManager.getOwnAddress();\n\t\tconst myUser = await this._userManager.resolveUser(myAddress);\n\t\tconst notMyUser = ({user}) => user !== myUser.gatewayUsername;\n\t\tconst participantRetrieved = await this._room.getParticipants();\n\t\tconst remoteParticipants = participantRetrieved.filter(notMyUser);\n\t\tconst plainRemoteParticipants = makePlainUserStatus(remoteParticipants);\n\t\tthis._remoteParticipants = Map(plainRemoteParticipants);\n\t\treturn this._remoteParticipants;\n\t}\n\n\t/**\n\t * Returns the current status of the conference\n\t * @return {ConferenceStatus}\n\t */\n\tgetStatus() {\n\t\treturn this._status.value;\n\t}\n\n\t/**\n\t * Returns an observable for the status of the conference\n\t * @return {Observable<ConferenceStatus>}\n\t */\n\tgetStatus$() {\n\t\treturn this._status.asObservable();\n\t}\n\n\t/**\n\t * Returns the username of the conference's owner\n\t * @return {string}\n\t */\n\tgetOwner() {\n\t\treturn this._owner;\n\t}\n\n\t/**\n\t * Allows access to local streams and actions related to changing which local media is shared\n\t * @return {LocalMediaHandler}\n\t */\n\tgetLocalMediaHandler() {\n\t\treturn this._localMediaHandler;\n\t}\n\n\t/**\n\t * Returns a Map containing a list of ManagedStreams per participant (gateway user name)\n\t * @return {ImmutableMap<string, ManagedStream[]>}\n\t */\n\tgetRemoteStreams() {\n\t\treturn this._remoteStreams;\n\t}\n\n\t/**\n\t * Returns a Set of strings containing the gateway username of every\n\t * remote participant\n\t * @return {ImmutableSet<string>}\n\t */\n\tgetRemoteGatewayUsernames() {\n\t\treturn new Set(this._remoteStreams.keySeq().filter(x => !!x));\n\t}\n\n\t/**\n\t * Returns a Set of strings containing the address of remote participants (gateway user names)\n\t * that are also wac users\n\t * @return {ImmutableSet<string>}\n\t */\n\tgetRemoteWacAddresses() {\n\t\treturn this._remoteWacAddresses;\n\t}\n\n\t/**\n\t * Returns a Set of outgoing invitations\n\t * @return {ImmutableSet<Invitation>}\n\t */\n\tgetOutgoingInvitations() {\n\t\treturn this._outgoingInvitations;\n\t}\n\n\t/**\n\t * Check if a conference is being transfering\n\t * @return {boolean}\n\t */\n\tisBeingTransfered() {\n\t\treturn this._transferingCall;\n\t}\n\n\tupdateMedia(audio, video, screen) {\n\t\tif (this.getStatus() === Status.CONNECTED) {\n\t\t\treturn this._room.update({audio, video, screen});\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Returns a boolean value indicating if at least one of the remote conference participants\n\t * has a video track\n\t * @return {boolean}\n\t */\n\thasRemoteVideo() {\n\t\tfor (let [, [stream]] of this._remoteStreams) {\n\t\t\tif (stream.hasVideoTracks()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * @private\n\t * @param {ConferenceStatus} status\n\t */\n\t_setStatus(status) {\n\t\tconst oldStatus = this.getStatus();\n\t\tthis._status.next(status);\n\t\tthis.emitter.emit('status', status, oldStatus);\n\t\tif (status === Status.DISCONNECTED) {\n\t\t\tthis._unbindEventHandlers();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t * @param {boolean} value\n\t */\n\t_setTransferingCall(value) {\n\t\tthis._transferingCall = value;\n\t}\n\n\t/**\n\t * Indicates if participants can be invited to this conference or not\n\t * @return {boolean}\n\t */\n\tcanManage() {\n\t\treturn this._room.isOwner() || !this._room.hasOwner();\n\t}\n\n\t/**\n\t * @return {boolean}\n\t */\n\tisRecovered() {\n\t\treturn this._room.recovered;\n\t}\n\n\t/**\n\t * Returns the current participant count.\n\t * Includes in the count the users with active invitations.\n\t * @return {number}\n\t */\n\tgetCurrentParticipants() {\n\t\tvar participantCount = this._remoteStreams.size;\n\t\tthis._outgoingInvitations.forEach((invitation) => {\n\t\t\tif (invitation.isActive()) {\n\t\t\t\tparticipantCount++;\n\t\t\t}\n\t\t});\n\t\treturn participantCount;\n\t}\n\n\t/**\n\t * Returns the invitation to the conference if the participant was invited.\n\t * @return {ConferenceInvite}\n\t */\n\tgetInvite() {\n\t\tif (this._room.invite) {\n\t\t\tconst {id, from, mediaTypes} = this._room.invite;\n\t\t\treturn new ConferenceInvite(id, from, mediaTypes);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t/**\n\t * Invites a new participant to this conference\n\t * @throws {Error} throw error when a participant has already invited or is joined to the conference.\n\t * @param {String} participant\n\t * @param {String} [session]\n\t * @param {MediaTypes} [mediaTypes] the MediaTypes of this invitation\n\t * @param {boolean} [autoAccepted=false]\n\t * @param {string} [requestId] the ID of the request that generated this invitation.\n\t * @param {boolean} [resolve=true] indicates if participant address should be resolved to an user\n\t * gatewayUsername.\n\t * @param {object} [context] Arbitrary context that can be sent when making an invite\n\t * @returns {Promise<Object>} A promise with an object with two properties: SIP code and whoAccepted the invite\n\t * @property {number} code SIP code of the response\n\t * @property {string} whoAccepted User id of the participant that accepted the invite\n\t */\n\tasync inviteParticipant(participant, session, mediaTypes, autoAccepted = false, requestId, resolve = true, context = {}) {\n\t\tif (!mediaTypes) {\n\t\t\tmediaTypes = this._localMediaHandler.getMediaTypes();\n\t\t\tmediaTypes.screen = false;\n\t\t}\n\t\tlet gatewayUsername;\n\t\treturn this._userManager.resolveUser(participant).then((user) => {\n\t\t\tlog.debug('calls/Conference.js/inviteParticipant/resolveUser', participant, user);\n\t\t\tgatewayUsername = resolve && user && user.gatewayUsername ? user.gatewayUsername : participant;\n\n\t\t\tif (!this._canSendInvitation(gatewayUsername)) {\n\t\t\t\tlog.debug('calls/Conference.js/inviteParticipant/cannotSendInvite', gatewayUsername);\n\t\t\t\tthrow new Error(ALREADY_JOINED_ERROR);\n\t\t\t}\n\n\t\t\tthis._updateOutgoingInvitations(\n\t\t\t\tnew Invitation(user, gatewayUsername, mediaTypes, autoAccepted, undefined, false, false),\n\t\t\t\tthis._getOutgoingInvitation(gatewayUsername));\n\n\t\t\tthis.invitationCount++;\n\t\t\treturn this._room.inviteParticipant(getGatewayUri(session, gatewayUsername), mediaTypes, requestId, context);\n\t\t}).then((response) => {\n\t\t\tlog.debug('calls/Conference.js/inviteParticipant/room.inviteParticipant/response', response);\n\t\t\tconst oldInvitation = this._getOutgoingInvitation(gatewayUsername);\n\t\t\tif (existUserButNotConnected(response.code, oldInvitation)) {\n\t\t\t\tresponse.code = TEMPORARILY_UNAVAILABLE_RESPONSE;\n\t\t\t}\n\t\t\tlet newInvitation = oldInvitation.setResponseCode(response.code);\n\t\t\tif (response.whoAccepted) {\n\t\t\t\tgatewayUsername = response.whoAccepted;\n\t\t\t\tnewInvitation = newInvitation.setTo(response.whoAccepted);\n\t\t\t}\n\t\t\tif (this._remoteStreams.get(gatewayUsername)) {\n\t\t\t\tnewInvitation = newInvitation.setStreams(true);\n\t\t\t}\n\t\t\tthis._updateOutgoingInvitations(newInvitation, oldInvitation);\n\t\t\treturn response;\n\t\t}).catch((error) => {\n\t\t\tlog.error('calls/Conference.js/inviteParticipant', error);\n\t\t\tif (error.message !== ALREADY_JOINED_ERROR) {\n\t\t\t\tconst oldInvitation = this._getOutgoingInvitation(gatewayUsername);\n\t\t\t\tif (oldInvitation) {\n\t\t\t\t\tthis._updateOutgoingInvitations(oldInvitation.setCanceled(true), oldInvitation);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow error;\n\t\t});\n\t}\n\n\t/**\n\t * Expels a participant from this conference\n\t * @param {string} participant\n\t * @param {string} [session]\n\t * @returns {Promise}\n\t */\n\texpelParticipant(participant, session) {\n\t\tif (session) {\n\t\t\tparticipant += `/${session}`;\n\t\t}\n\t\treturn this._room.expelParticipant(participant);\n\t}\n\n\t/**\n\t * Cancels a invitation of this conference\n\t *\n\t * @param {Invitation} invitation\n\t * @param {string} [session]\n\t */\n\tcancelInvitation(invitation, session) {\n\t\tif (invitation.isCanceled()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!invitation.getResponseCode()) {\n\t\t\tthis._room.cancelInvitation(getGatewayUri(session, invitation.getTo()));\n\t\t}\n\t\tthis._updateOutgoingInvitations(invitation.setCanceled(true), invitation);\n\t}\n\n\t/**\n\t * Invites a list of new participant to this conference\n\t * @param {string[]} participants\n\t * @returns {Promise}\n\t */\n\tinviteParticipants(participants) {\n\t\treturn Promise.all(participants.map(p => this.inviteParticipant(p)));\n\t}\n\n\t/**\n\t * Expels a list of participant from this conference\n\t * @param {string[]} participants\n\t * @returns {Promise}\n\t */\n\texpelParticipants(participants) {\n\t\treturn Promise.all(participants.map(p => this.expelParticipant(p)));\n\t}\n\n\t/**\n\t * Connects to the conference\n\t * @returns {Promise}\n\t */\n\tasync join() {\n\t\tif (this.getStatus() !== Status.DISCONNECTED) {\n\t\t\treturn Promise.reject(Error(`You can't connect to a conference in ${Status[this.getStatus()]} status`));\n\t\t}\n\t\tthis._setStatus(Status.CONNECTING);\n\t\ttry {\n\t\t\tawait this._room.join(this._localMediaHandler.getCurrentMediaConstraints());\n\t\t\tawait this.fetchRemoteParticipants();\n\t\t\tthis._setStatus(Status.CONNECTED);\n\t\t} catch (error) {\n\t\t\tthis._setStatus(Status.DISCONNECTED);\n\t\t\tthis._room.leave();\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t/**\n\t * Leaves the conference\n\t * @param {number} errorCode the rejection cause when an invitation is received\n\t * and the conference has not been joined.\n\t * @returns {Promise}\n\t */\n\tasync leave(errorCode) {\n\t\tswitch (this.getStatus()) {\n\t\t\tcase Status.DESTROYED:\n\t\t\t\treturn;\n\t\t\tcase Status.DISCONNECTED:\n\t\t\t\treturn this._room.leave(errorCode);\n\t\t\tcase Status.DISCONNECTING:\n\t\t\t\tthrow Error(`You can't disconnect to a conference in ${Status[this.getStatus()]} status`);\n\t\t}\n\t\tthis._setStatus(Status.DISCONNECTING);\n\t\tif (this.canManage()) {\n\t\t\ttry {\n\t\t\t\tthis._outgoingInvitations.forEach((invitation) => {\n\t\t\t\t\tthis.cancelInvitation(invitation);\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tlog.error(error);\n\t\t\t}\n\t\t}\n\t\ttry {\n\t\t\treturn this._room.leave();\n\t\t} catch (error) {\n\t\t\tif (!error.message.match(/already disconnected/)) {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t} finally {\n\t\t\tthis._setStatus(Status.DISCONNECTED);\n\t\t}\n\t}\n\n\t/**\n\t * Local hold\n\t * Stop publishing and subscribing to the media in the conference\n\t * @return {Promise} resolved on success\n\t */\n\thold() {\n\t\treturn this._room.hold();\n\t}\n\n\n\t/**\n\t * Stop local hold\n\t * Republishes all previously published media, subscribes\n\t * to previously subscribed media and notifies new status to\n\t * other participants.\n\t * @return {Promise} resolved on success\n\t */\n\tunhold() {\n\t\treturn this._room.unhold();\n\t}\n\n\t/**\n\t * Check if conference is on hold state.\n\t * @type {boolean}\n\t */\n\tget isOnHold() {\n\t\treturn this._room.isOnHold;\n\t}\n\n\t/**\n\t * Create an unattendedCallTransfer towards a user in the system\n\t * @param {string} participant\n\t * @param {MediaTypes} [mediaTypes] the current media types will be used if nothing is specified\n\t * @returns {Promise}\n\t */\n\tunattendedCallTransfer(participant, mediaTypes = this._localMediaHandler.getMediaTypes()) {\n\t\treturn this._userManager.resolveUser(participant).then((user) => {\n\t\t\tlet gatewayUsername = user && user.gatewayUsername ? user.gatewayUsername : participant;\n\t\t\treturn this._room.unattendedCallTransfer(gatewayUsername, mediaTypes);\n\t\t});\n\t}\n\n\t/**\n\t * Send data to the audio's room\n\t * @param {string} value\n\t * @returns {Promise<undefined, Error}\n\t */\n\tsendDtmf(value) {\n\t\tif (this.getStatus() !== Status.CONNECTED) {\n\t\t\treturn Promise.reject(new Error('You aren\\'t joined to the conference'));\n\t\t}\n\t\treturn this._room.sendDtmf(value);\n\t}\n}\n","import {cloneDeep} from 'lodash-es';\n/**\n * @typedef Candidate\n * @type {object}\n * @property {string} address Identifier of the user that received the invite\n * @property {603 | 408 | 487 | 200} endReason A code that indicates if the candidates accepted or rejected\n * the invite and his reason\n */\n\n/**\n * @typedef MediaType\n * @type {object}\n * @property {boolean} audio Indicate if the creator of the invite wants to use audio in the conference\n * @property {boolean} video Indicate if the creator of the invite wants to use video in the conference\n */\n\n/**\n * @typedef {Object} Invite\n * @property {string} from who sent the invite\n * @property {string} to who received the invite\n * @property {string} state specify what happened with the invite\n * @property {Array<Candidate>} candidates List of candidates that received the invite\n * @property {boolean} group Set to true when the invite is sent to a group\n * @property {boolean} inviteRequest Set to true when the invite is related with an invitation request\n * @property {MediaType} mediaType Indicates the media used in the conference\n * @property {603 | 408 | 487 | ''} error Code error when an invite is declined\n */\n\n/**\n * @typedef Transfer\n * @type {object}\n * @property {string} from Who creates the call-transfer\n * @property {string} to Who has to receive the call transferred\n * @property {string} state State of the call transfer\n * @property {string} roomId Identifier of the room\n * @property {string} idInvite Identifier of the invite related with the transfer\n */\n\n/**\n * @typedef Participant\n * @type {object}\n * @property {string} address - Identifier of the user that entried in the room\n * @property {number} createdAt - Timestamp of when user inserted in the room\n * @property {number} finishedAt - Timestamp of when user left the room\n */\n\n/**\n * @private\n */\nconst getState = (state, direction) => {\n\tswitch (state) {\n\t\tcase 'ACCEPTED':\n\t\tcase 200:\n\t\t\treturn 'accepted';\n\t\tcase 'DECLINED':\n\t\tcase 603:\n\t\t\treturn 'rejected';\n\t\tcase 'DECLINED_BY_CREATOR':\n\t\t\treturn direction === 'outgoing' ?\n\t\t\t\t'rejected' :\n\t\t\t\t'missed';\n\t\tcase 'DECLINED_BY_TIMEOUT':\n\t\tcase 408:\n\t\t\treturn 'missed';\n\t\t// no default\n\t}\n};\n\n/**\n * This class allows access to the details of each entry of the conference log\n * @link {ConferenceLog#.getEntries()} method should be used to obtain the list\n * of instances of this class.\n */\nexport class ConferenceLogEntry {\n\t/**\n\t * @public\n\t * @return {ConferenceLogEntry}\n\t */\n\tstatic of(data) {\n\t\treturn Object.freeze(new ConferenceLogEntry(data));\n\t}\n\n\t/** @private */\n\tconstructor(conference) {\n\t\t/** @private */\n\t\tthis.raw = cloneDeep(conference);\n\n\t\t/** @private */\n\t\tthis.invites = Object.freeze((this.raw.invites || []).map((invite) => {\n\t\t\tinvite.getCandidates = () => invite.candidates.map(candidate => ({\n\t\t\t\taddress: candidate.address,\n\t\t\t\tstate: getState(invite.group ? candidate.endReason : invite.state, 'incoming'),\n\t\t\t\tdirection: 'incoming',\n\t\t\t\ttype: invite.inviteRequest ? 'inviteRequest' : 'invite',\n\t\t\t\tgroup: invite.group,\n\t\t\t}));\n\t\t\treturn invite;\n\t\t}));\n\n\t\t/** @private */\n\t\tthis.transfers = Object.freeze((this.raw.transfers || []).map((transfer) => {\n\t\t\ttransfer.getParticipants = () => [{\n\t\t\t\taddress: transfer.from,\n\t\t\t\tstate: getState(transfer.state, 'outgoing'),\n\t\t\t\tdirection: 'outgoing',\n\t\t\t}, {\n\t\t\t\taddress: transfer.to,\n\t\t\t\tstate: getState(transfer.state, 'incoming'),\n\t\t\t\tdirection: 'incoming',\n\t\t\t}];\n\t\t\treturn transfer;\n\t\t}));\n\n\t\t/** @private */\n\t\tthis.participants = Object.freeze(this.raw.participants);\n\t}\n\n\t/**\n\t * The unique id that identifies the conference log entry\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.raw.id;\n\t}\n\n\t/**\n\t * Conference length in ms\n\t * @return {number}\n\t */\n\tgetDuration() {\n\t\treturn this.raw.finishedAt - this.raw.createdAt;\n\t}\n\n\t/**\n\t * The time the conference started\n\t * @return {number}\n\t */\n\tgetStartTimestamp() {\n\t\treturn this.raw.createdAt;\n\t}\n\n\t/**\n\t * The time the conference started\n\t * @return {Date}\n\t */\n\tgetStartDateTime() {\n\t\treturn new Date(this.raw.createdAt);\n\t}\n\n\t/**\n\t * The time the conference ended\n\t * @return {Date}\n\t */\n\tgetEndDateTime() {\n\t\treturn new Date(this.raw.finishedAt);\n\t}\n\n\t/**\n\t * Get a list of users that has been inside the room\n\t * @return {Participant[]}\n\t */\n\tgetParticipants() {\n\t\treturn this.participants;\n\t}\n\n\t/**\n\t * Get a list of all invites that have been sent in the room\n\t * @return {Invite[]}\n\t */\n\tgetInvites() {\n\t\treturn this.invites;\n\t}\n\n\t/**\n\t * Get a list of all transfers that have been performed in the room\n\t * @return {Transfer[]}\n\t */\n\tgetTransfers() {\n\t\treturn this.transfers;\n\t}\n}\n","import {bindMethods} from '../utils/bindMethods';\nimport {ConferenceLogEntry} from './ConferenceLogEntry';\nimport {EventEmitter} from '../eventemitter';\n\n/**\n * This class allows access to the conference log. To obtain an instance of the\n * class @link {ConferenceManager#getConferenceLog} method must be used.\n */\nexport class ConferenceLog {\n\t/**\n\t * @private\n\t */\n\tconstructor(conferenceLogService) {\n\t\t/** @private */\n\t\tthis.conferenceLogService = conferenceLogService;\n\t\t/** @private */\n\t\tthis.entries = [];\n\t\t/** @private */\n\t\tthis.timestampOfTheLastEntryRecovered = null;\n\t\t/**\n\t\t * - \"create\" event every time a new entry is prepended\n\t\t * @type {EventEmitter}\n\t\t */\n\t\tthis.emitter = new EventEmitter();\n\t\tbindMethods(this, [\n\t\t\t'onCreate',\n\t\t]);\n\t\tthis.conferenceLogService.emitter.on('create', this.onCreate);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonCreate(newConferenceLog) {\n\t\tconst conferenceLogEntry = ConferenceLogEntry.of(newConferenceLog);\n\t\tthis.entries.unshift(conferenceLogEntry);\n\t\tthis.emitter.emit('create', conferenceLogEntry);\n\t}\n\n\t/**\n\t * Fetches more conference log entries.\n\t * @param {number} [limit=10] The number of new entries to be fetched at most\n\t * @returns {Promise<ConferenceLogEntry>} When resolved, the update was completed and get the new\n\t * conference log objects\n\t */\n\tasync fetch(limit = 10) {\n\t\tif (!this.timestampOfTheLastEntryRecovered) {\n\t\t\tthis.timestampOfTheLastEntryRecovered = Date.now();\n\t\t}\n\t\tconst res = await this.conferenceLogService.fetch(limit, this.timestampOfTheLastEntryRecovered);\n\t\tlet conferenceLogEntries = res.map(conference => ConferenceLogEntry.of(conference));\n\t\tthis.entries.push(...conferenceLogEntries);\n\t\tthis.timestampOfTheLastEntryRecovered = this.getTimestampOfTheLastEntry();\n\t\tthis.emitter.emit('fetch');\n\t\treturn conferenceLogEntries;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetTimestampOfTheLastEntry() {\n\t\treturn this.entries.slice(-1).length ? this.entries.slice(-1).pop().getStartTimestamp() : undefined;\n\t}\n\n\t/**\n\t * Allows access to the list of conferences\n\t * @return {ConferenceLogEntry[]}\n\t */\n\tgetEntries() {\n\t\treturn this.entries;\n\t}\n}\n","import {cloneDeep} from 'lodash-es';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\n\nimport {Conference} from './Conference';\nimport {ConferenceLog} from './ConferenceLog';\n\nimport Logs from '../Logs';\nconst log = Logs.instance.getLogger('SippoJS/calls/ConferenceManager');\n\n/**\n * This class provides access to every conference related feature\n * This class must never be directly instantiated, instances of this class\n * can be obtained using Session#getConferenceManager.\n *\n * ## Events\n *\n * - `conferenceInvitation` {@link Conference} - Emitted every time an invitation to\n *    a conference room is received\n * - `conferenceInvitationRequest` {@link any} - Emitted every time a request for\n *    an invitation to a conference room is received\n * - `conferenceInvitationRequestCancelled` {@link any} -\n */\nexport class ConferenceManager {\n\t/**\n\t * @protected\n\t * @param {WacProxy} wacProxy\n\t * @param {UserManager} userManager\n\t */\n\tstatic newInstance(wacProxy, userManager) {\n\t\treturn new ConferenceManager(wacProxy, userManager);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tconstructor(wacProxy, userManager) {\n\t\t/** @type {WacProxy} */\n\t\tthis._wacProxy = wacProxy;\n\t\t/** @type {UserManager} */\n\t\tthis._userManager = userManager;\n\t\tthis._defaultMediaConstraints = {\n\t\t\taudio: true,\n\t\t\tvideo: true,\n\t\t};\n\t\tthis._conferences = new Map();\n\t\tthis._conferenceLog = null;\n\t\t// [SIPPOJS-493] The cancel can arrive while the username is being resolved\n\t\t// This array keeps the invitation requests whose incoming process is in progress\n\t\tthis._incomingInvitationRequestIds = new Set();\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\n\t\tbindMethods(this, [\n\t\t\t'_onIncomingConference',\n\t\t\t'_onConferenceInvitationRequest',\n\t\t\t'_onConferenceInvitationRequestCancelled',\n\t\t]);\n\t\tthis._bindEventHandlers();\n\n\t\t/*\n\t\tlet existingConferences = this._wacProxy.conference.fetch() || [];\n\t\texistingConferences.forEach(stackConference => {\n\t\t\tthis._onIncomingConference(stackConference, mediaConstraints, true).catch(console.error);\n\t\t});\n\t\t*/\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_bindEventHandlers() {\n\t\tthis._wacProxy.conference.on('incomingConference', this._onIncomingConference);\n\t\tthis._wacProxy.conference.on('invitationRequest', this._onConferenceInvitationRequest);\n\t\tthis._wacProxy.conference.on('cancelInvitationRequest', this._onConferenceInvitationRequestCancelled);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _onIncomingConference(room, mediaTypes) {\n\t\tconst conference = await Conference.create(this._userManager, room, this._defaultMediaConstraints);\n\t\tawait conference.getLocalMediaHandler().setMediaTypes(mediaTypes);\n\t\tthis._conferences.set(room.id, conference);\n\t\tthis.emitter.emit('conferenceInvitation', conference);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onConferenceInvitationRequest(event) {\n\t\tthis._incomingInvitationRequestIds.add(event.id);\n\t\tlet [gatewayUsername, session] = event.user.split('/');\n\t\tlet call = {\n\t\t\tid: event.id,\n\t\t\tfrom: gatewayUsername,\n\t\t\thasRemoteVideo: () => event.video,\n\t\t\thasStatus: () => true,\n\t\t\tgetRemoteUser: () => call.remoteUser,\n\t\t\tgetRemoteGatewayUser: () => gatewayUsername,\n\t\t\tacceptInvitationRequest: () => event.accept(),\n\t\t\t_connect: (conference) => {\n\t\t\t\tcall.status = 'trying';\n\t\t\t\treturn conference.inviteParticipant(gatewayUsername, session, {\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: call.hasRemoteVideo(),\n\t\t\t\t}, true, event.id, false);\n\t\t\t},\n\t\t\t_disconnect: () => {\n\t\t\t\tevent.reject();\n\t\t\t},\n\t\t};\n\t\tthis._userManager.getUsername(gatewayUsername).then((username) => {\n\t\t\treturn this._userManager.resolveUser(username);\n\t\t}).then((user) => {\n\t\t\t// Detect if an invitation request cancel has arrived while we were resolving the user\n\t\t\tif (!this._incomingInvitationRequestIds.has(event.id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._incomingInvitationRequestIds.delete(event.id);\n\n\t\t\tcall.remoteUser = user || gatewayUsername;\n\t\t\tthis.emitter.emit('conferenceInvitationRequest', call);\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onConferenceInvitationRequestCancelled(event) {\n\t\tthis._incomingInvitationRequestIds.delete(event.id);\n\n\t\tthis.emitter.emit('conferenceInvitationRequestCancelled', event);\n\t}\n\n\t/**\n\t * @return {MediaStreamConstraints}\n\t */\n\tgetDefaultMediaConstraints() {\n\t\treturn cloneDeep(this._defaultMediaConstraints);\n\t}\n\n\t/**\n\t * Sets the constraints that will be used as initial value for media requests when\n\t * initializing conferences. For more information about valid values see\n\t * {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaStreamConstraints}\n\t * @example <caption>Enabling noise reduction techniques</caption>\n\t * conferenceManager.setDefaultMediaConstraints({\n\t *   audio: {\n\t *     autoGainControl: true,\n\t *     echoCancellation: true,\n\t *     noiseSuppression: true,\n\t *   },\n\t *   video: true,\n\t * });\n\t * @param {MediaStreamConstraints} defaultMediaConstraints\n\t */\n\tsetDefaultMediaConstraints(defaultMediaConstraints) {\n\t\tthis._defaultMediaConstraints = cloneDeep(defaultMediaConstraints);\n\t}\n\n\t/**\n\t * Creates a new conference room\n\t * @return {Promise<Conference>}\n\t */\n\tcreateConference() {\n\t\treturn this._wacProxy.conference.create().then((room) => {\n\t\t\treturn Conference.create(this._userManager, room, this._defaultMediaConstraints);\n\t\t});\n\t}\n\n\t/**\n\t * @return {ConferenceLog}\n\t */\n\tgetConferenceLog() {\n\t\tif (this._conferenceLog === null) {\n\t\t\tthis._conferenceLog = new ConferenceLog(this._wacProxy.getConferenceLogService());\n\t\t}\n\t\treturn this._conferenceLog;\n\t}\n\n\t/**\n\t * @param {string} participant\n\t * @param {object} mediaTypes\n\t * @returns {Promise<object>} fulfilled when the response is received\n\t */\n\trequestConferenceInvitation(participant, mediaTypes = {audio: true, video: true}) {\n\t\treturn this._userManager.resolveUser(participant).then((user) => {\n\t\t\tlet gwUsername = user && user.gatewayUsername ? user.gatewayUsername : participant;\n\t\t\tlet call = {\n\t\t\t\tgetRemoteUser: () => user,\n\t\t\t\tto: gwUsername,\n\t\t\t\thasLocalVideo: () => !!mediaTypes.video,\n\t\t\t\thasLocalOnlyVideo: () => false,\n\t\t\t\t_disconnect: () => {\n\t\t\t\t\tthis._wacProxy.conference.cancelInvitationRequest(gwUsername);\n\t\t\t\t},\n\t\t\t\t_connect: () => {\n\t\t\t\t\treturn this._wacProxy.conference.requestInvitation(gwUsername, mediaTypes);\n\t\t\t\t},\n\t\t\t};\n\t\t\treturn call;\n\t\t});\n\t}\n\n\tasync _getConferenceForRoom(room) {\n\t\tconst conference = await Conference.create(this._userManager, room, this._defaultMediaConstraints);\n\t\tawait conference.getLocalMediaHandler().setMediaTypes(room.invite.mediatypes);\n\t\tthis._conferences.set(room.id, conference);\n\t\treturn conference;\n\t}\n\n\t/**\n\t * Asks the server for the current invitations available to the user\n\t * @return {Promise<Conference[]>}\n\t */\n\tgetCurrentInvitations() {\n\t\tlog.debug('calls/ConferenceManager.js/getCurrentInvitations');\n\t\treturn this._wacProxy.conference.getCurrentInvitations().then((rooms) => {\n\t\t\tlog.debug('calls/ConferenceManager.js/getCurrentInvitations/rooms', rooms);\n\t\t\tlet conferences = rooms.map(async (room) => {\n\t\t\t\tif (room.isRequest) {\n\t\t\t\t\tdelete room.isRequest;\n\t\t\t\t\tthis._onConferenceInvitationRequest(room);\n\t\t\t\t\treturn room;\n\t\t\t\t} else {\n\t\t\t\t\tconst conf = await this._getConferenceForRoom(room);\n\t\t\t\t\tthis.emitter.emit('conferenceInvitation', conf);\n\t\t\t\t\treturn conf;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn Promise.all(conferences);\n\t\t});\n\t}\n\n\t/**\n\t * Get a Conference by uri\n\t *\n\t * @param {string} uri\n\t * @returns {Promise<Conference>} fulfilled when the response is received\n\t */\n\tasync getConferenceByUri(uri) {\n\t\tconst room = await this._wacProxy.conference.getRoomByUri(uri);\n\t\treturn await Conference.create(this._userManager, room, this._defaultMediaConstraints);\n\t}\n}\n","import {Set} from 'immutable';\n\n/**\n * This class allows access to the details of each group\n * @link {GroupManager#.getGroups()} method should be used to obtain the list\n * of instances of this class.\n */\nexport class Group {\n\t/** @protected */\n\tstatic of({id, name, participants, phonebook} = {}) {\n\t\treturn new Group(id, name, participants, phonebook);\n\t}\n\n\t/** @private */\n\tconstructor(id, name, participants, phonebook) {\n\t\t/** @private */\n\t\tthis.id = id;\n\t\t/** @private */\n\t\tthis.name = name;\n\t\t/** @private */\n\t\tthis.participants = new Set(participants);\n\t\t/** @private */\n\t\tthis.phonebook = new Set(phonebook);\n\n\t\tObject.freeze(this);\n\t}\n\n\t/**\n\t * The unique id that identifies the group\n\t * @return {string}\n\t */\n\tgetId() {\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * Get the name of a group\n\t * @return {string}\n\t */\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\t/**\n\t * Get a list of id of users that belong to the group\n\t * @return {ImmutableSet<string>}\n\t */\n\tgetParticipants() {\n\t\treturn this.participants;\n\t}\n\n\t/**\n\t * Returns the phonebook associated to this group\n\t * @return {ImmutableSet<Object>}\n\t * @property {string} name\n\t * @property {string} address\n\t */\n\tgetPhonebook() {\n\t\treturn this.phonebook;\n\t}\n\n\t/**\n\t * Creates a new Group object with the provided parameter changed\n\t * @param {Object} args\n\t * @param {string} [args.name]\n\t * @param {Iterable<string>} [args.participants]\n\t * @return {Group}\n\t */\n\twith({name = this.name, participants = this.participants} = {}) {\n\t\treturn new Group(this.id, name, participants);\n\t}\n\n\t/**\n\t * Creates a new Group object adding the provided participants\n\t * @param {...string} participants\n\t * @return {Group}\n\t */\n\tplusParticipants(...participants) {\n\t\treturn this.with({participants: this.participants.union(participants)});\n\t}\n\n\t/**\n\t * Creates a new Group object removing the provided participants\n\t * @param {...string} participants\n\t * @return {Group}\n\t */\n\tminusParticipants(...participants) {\n\t\treturn this.with({participants: this.participants.subtract(participants)});\n\t}\n}\n","import {List} from 'immutable';\nimport {bindMethods} from '../utils/bindMethods';\nimport {Group} from './Group';\nimport {EventEmitter} from '../eventemitter';\n\nfunction comparator(a, b) {\n\tif (a.name < b.name) {\n\t\treturn -1;\n\t}\n\tif (a.name > b.name) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\n/**\n * This class allows manager the groups. To obtain an instance of the\n * class @link {Session#getGroupManager} method must be used.\n *\n * # Events\n * - `groups` - Emitted every time a group list changes.\n */\nexport class GroupManager {\n\t/** @protected */\n\tstatic newInstance(groupService, phonebookService, userManager) {\n\t\tconst groupManager = new GroupManager(groupService, phonebookService, userManager);\n\t\treturn groupManager.init();\n\t}\n\n\t/** @private */\n\tconstructor(groupService, phonebookService, userManager) {\n\t\t/** @private */\n\t\tthis.groupService = groupService;\n\t\t/** @private */\n\t\tthis.phonebookService = phonebookService;\n\t\t/** @private */\n\t\tthis.userManager = userManager;\n\t\t/** @private */\n\t\tthis.groups = List();\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter();\n\t\tbindMethods(this, [\n\t\t\t'onDelete',\n\t\t\t'onPut',\n\t\t]);\n\t}\n\n\t/** @private */\n\tasync init() {\n\t\tthis.groupService.emitter.on('put', this.onPut);\n\t\tthis.groupService.emitter.on('delete', this.onDelete);\n\t\tconst groups = await this.groupService.fetch();\n\t\tfor (const group of groups) {\n\t\t\tgroup.participants = await this.convertToAddresses(group.participants);\n\t\t}\n\t\tthis.groups = List.of(...await Promise.all(groups.map(datum => this.newGroup(datum))));\n\t\tthis.groups = this.groups.sort(comparator);\n\t\treturn this;\n\t}\n\n\t/** @protected */\n\tuninit() {\n\t\tthis.groupService.emitter.off('put', this.onPut);\n\t\tthis.groupService.emitter.off('delete', this.onDelete);\n\t}\n\n\t/** @private */\n\tasync convertToAddresses(ids) {\n\t\tlet participants = [];\n\t\tfor (const id of ids) {\n\t\t\tconst user = await this.userManager.resolveUser(id);\n\t\t\tparticipants.push(`${user.username}@${user.domain}`);\n\t\t}\n\t\treturn participants;\n\t}\n\n\t/** @private */\n\tasync convertToIds(participants) {\n\t\tlet ids = [];\n\t\tfor (const participant of participants) {\n\t\t\tconst user = await this.userManager.resolveUser(participant);\n\t\t\tids.push(user.id);\n\t\t}\n\t\treturn ids;\n\t}\n\n\t/** @private */\n\tasync onPut(event) {\n\t\tevent.participants = await this.convertToAddresses(event.participants);\n\t\tconst index = this.groups.findIndex(group => group.getId() === event.id);\n\t\tconst group = await this.newGroup(event);\n\t\tif (index < 0) {\n\t\t\tthis.groups = this.groups.push(group);\n\t\t} else {\n\t\t\tthis.groups = this.groups.set(index, group);\n\t\t}\n\t\tthis.groups = this.groups.sort(comparator);\n\t\tthis.emitter.emit('groups');\n\t\treturn group;\n\t}\n\n\t/** @private */\n\tonDelete({id}) {\n\t\tthis.groups = this.groups.filter(group => group.getId() !== id);\n\t\tthis.emitter.emit('groups');\n\t}\n\n\t/** @private */\n\tasync newGroup({id, name, participants}) {\n\t\tconst res = await this.phonebookService.getPhonebooksBySubscriberId(id);\n\t\tconst phonebook = res.map(p => p.contacts).reduce((acc, value) => acc.concat(value), []);\n\t\treturn Group.of({id, name, participants, phonebook});\n\t}\n\n\t/**\n\t * Allows access to the list of groups\n\t * @return {ImmutableList<Group>}\n\t */\n\tgetGroups() {\n\t\treturn this.groups;\n\t}\n\n\t/**\n\t * Creates a new group\n\t * @param {string} name The name of the new group\n\t * @param {string[]} participants List of the addresses of the initial participants\n\t * @return {Promise<Group>}\n\t */\n\tasync createGroup(name, participants) {\n\t\tconst participantIds = await this.convertToIds(participants);\n\t\tconst datum = await this.groupService.create(name, participantIds);\n\t\tconst group = await this.onPut(datum);\n\t\treturn group;\n\t}\n\n\t/**\n\t * Saves a group (Still no WAC support)\n\t * @experimental\n\t * @param {Group} group The group to be persisted\n\t * @return {Promise}\n\t */\n\tasync saveGroup(group) {\n\t\tconst participantIds = await this.convertToIds(group.getParticipants().toJS());\n\t\tawait this.groupService.update(group.getId(), group.getName(), participantIds);\n\t}\n\n\t/**\n\t * Deletes a group\n\t * @param {Group} group The group to be deleted\n\t * @return {Promise}\n\t */\n\tasync deleteGroup(group) {\n\t\tawait this.groupService.delete(group.getId());\n\t\tawait this.onDelete({id: group.getId()});\n\t}\n\n\t/**\n\t * Obtain phonebooks asociated with a group. Phonebooks are a list of contacts\n\t * many groups can susbscribe to.\n\t *\n\t * @return {Array} containing the phonebooks asociated to the group\n\t * @property {string[]} subscribers ids of the group subscribers\n\t * @property {string} name phonebookName\n\t * @property {string} id phonebookId\n\t * @property {Object[]} contacts list of ponebook contacts\n\t * @property {string} contacts.name contact name\n\t * @property {string} contacts.address contact address\n\t * @deprecated\n\t */\n\tgetPhonebook(group) {\n\t\treturn this.phonebookService.getPhonebooksBySubscriberId(group.getId());\n\t}\n}\n","import {Enum} from '../utils/Enum';\n\n/**\n * Enum containing the possible types of an instant message. Possible values:\n * - INCOMING\n * - OUTGOING\n * @type {Enum}\n */\nexport const InstantMessageType = Enum([\n\t'INCOMING',\n\t'OUTGOING',\n]);\n","import {InstantMessageType} from './InstantMessageType';\n\n/**\n * @example <caption>Creating an InstantMessage</caption>\n * let im = session.createInstantMessage(recipient, text);\n * im.send().then(() => {\n *    console.warn(\"Message received by the server\");\n * })\n */\nexport class InstantMessage {\n\t/**\n\t * @protected\n\t */\n\tconstructor(wacProxy, type, sender, receiver, message) {\n\t\t/** @private */\n\t\tthis.wacProxy = wacProxy;\n\t\t/** @private */\n\t\tthis.type = type;\n\t\t/** @private */\n\t\tthis.sender = sender;\n\t\t/** @private */\n\t\tthis.receiver = receiver;\n\t\t/** @private */\n\t\tthis.message = message;\n\t}\n\n\t/**\n\t * Get the message's composer\n\t * @return {String} composer\n\t */\n\tgetSender() {\n\t\treturn this.sender;\n\t}\n\n\t/**\n\t * Get the message' receiver\n\t * @return {String} receiver\n\t */\n\tgetReceiver() {\n\t\treturn this.receiver;\n\t}\n\n\t/**\n\t * Get the message\n\t * @return {String} message\n\t */\n\tgetMessage() {\n\t\treturn this.message;\n\t}\n\n\t/**\n\t * Sends the message\n\t * @return {Promise}\n\t */\n\tsend() {\n\t\tif (this.type !== InstantMessageType.outgoing) {\n\t\t\tthrow new Error('Outgoing message can not be sent');\n\t\t}\n\t\treturn this.wacProxy.sendIm(this.receiver, this.message);\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\n\n/**\n * Represents a meeting. This class must not be directly instantiated. Instead,\n * instances of this class are obtained by calling the {@link MeetingManager#createMeeting}\n * or {@link MeetingManager#getMeetings} methods of {MeetingManager}\n *\n * ## Events\n *\n * - **`delete`** is emitted when the meeting is deleted.\n */\nexport default class Meeting extends EventEmitter {\n\t/**\n\t * Constructs a new meeting\n\t * @protected\n\t * @param {WacStack} stack\n\t * @param {Meeting} meeting\n\t * @property {String} meeting.id The ID of the meeting\n\t * @property {String} meeting.name The name for the meeting\n\t * @property {Array} meeting.participants The people participating of the meeting\n\t * @property {String} meeting.language The language for the meeting\n\t * @property {Integer} meeting.validSince The starting time for the meeting\n\t * @property {Integer} meeting.validUntil The ending time for the meeting\n\t * @property {String} meeting.url The link to access to the meeting\n\t * @property {String} meeting.phone Who will be called to access to the meeting\n\t */\n\tconstructor(stack, meeting) {\n\t\tsuper();\n\n\t\t/**\n\t\t * @private\n\t\t * @type {WacStack}\n\t\t */\n\t\tthis._stack = stack;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis._id = meeting.id;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._name = meeting.name;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Array}\n\t\t */\n\t\tthis._participants = meeting.participants;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._language = meeting.language;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Integer}\n\t\t */\n\t\tthis._validSince = meeting.validSince;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Integer}\n\t\t */\n\t\tthis._validUntil = meeting.validUntil;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._url = meeting.url;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {String}\n\t\t */\n\t\tthis._phone = meeting.phone;\n\t}\n\n\t/**\n\t * The ID of the meeting\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\t/**\n\t * The name for the meeting\n\t * @type {string}\n\t */\n\tget name() {\n\t\treturn this._name;\n\t}\n\n\t/**\n\t * The people participating of the meeting\n\t * @type {string}\n\t */\n\tget participants() {\n\t\treturn this._participants;\n\t}\n\n\t/**\n\t * The language for the meeting\n\t * @type {string}\n\t */\n\tget language() {\n\t\treturn this._language;\n\t}\n\n\t/**\n\t * The starting time for the meeting\n\t * @type {string}\n\t */\n\tget validSince() {\n\t\treturn this._validSince;\n\t}\n\n\t/**\n\t * The ending time for the meeting\n\t * @type {string}\n\t */\n\tget validUntil() {\n\t\treturn this._validUntil;\n\t}\n\n\t/**\n\t * The link to access to the meeting\n\t * @type {string}\n\t */\n\tget url() {\n\t\treturn this._url;\n\t}\n\n\t/**\n\t * Who will be called to access to the meeting\n\t * @type {string}\n\t */\n\tget phone() {\n\t\treturn this._phone;\n\t}\n\n\t/**\n\t * Update the ID of a meeting\n\t * @type {string}\n\t */\n\tset id(value) {\n\t\tthis._id = value;\n\t}\n\n\t/**\n\t * Update the phone of a meeting\n\t * @type {string}\n\t */\n\tset phone(value) {\n\t\tthis._phone = value;\n\t}\n\n\n\t/**\n\t * Resend the invitation to all participants\n\t * @return {Promise<Meeting>}\n\t */\n\treinvite() {\n\t\treturn this._stack.sendMeetingInvites(this._id).then(() => this);\n\t}\n\n\n\t/**\n\t * Removes the meeting\n\t * @return {Promise<undefined,Error>}\n\t */\n\tdestroy() {\n\t\treturn this._stack.delete(this._id).then(() => this._remove());\n\t}\n\n\n\t/**\n\t * Check if the participant in a meeting is online\n\t * @return {Boolean}\n\t */\n\tisOnline() {\n\t\treturn this.phone !== '';\n\t}\n\n\n\t/**\n\t * Removes (locally) the meeting\n\t * @protected\n\t */\n\t_remove() {\n\t\tthis._stack = null;\n\t\tthis.emit('delete');\n\t}\n\n\t/**\n\t * Returns a JS object with the JSON serialization representation of this object\n\t * @return {Object}\n\t * @property {String} id\n\t * @property {String} name\n\t * @property {Array} participants\n\t * @property {String} language\n\t * @property {Integer} validSince\n\t * @property {Integer} validUntil\n\t * @property {String} url\n\t * @property {String} phone\n\t */\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this._id,\n\t\t\tname: this._name,\n\t\t\tparticipants: this._participants,\n\t\t\tlanguage: this._language,\n\t\t\tvalidSince: this._source,\n\t\t\tvalidUntil: this._presence,\n\t\t\turl: this._url,\n\t\t\tphone: this._phone,\n\t\t};\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport Meeting from './Meeting';\n\n/**\n * ContactManager instance is obtained by calling the {@link Session#getMeetingManager}\n * method of {@link Session} and must not be directly instantiated.\n * Once the MeetingManager instance is obtained {@link MeetingManager#init} method\n * must be called to initialize it.\n *\n * ## Events\n *\n * - **`create`** is emitted every time a new meeting is created.\n *   - {@link Meeting} `meeting` The meeting that has just been created.\n * - **`delete`** is emitted when some meeting is deleted.\n *   - {@link Meeting} `meeting` The meeting that has just been deleted.\n *\n * @example <caption>Get meeting list</caption>\n * meetingManager.init().then(function() {\n *   meetingManager.getMeetings().forEach(function(meeting) {\n *     console.log(meeting.name);\n *   });\n * });\n */\nexport class MeetingManager extends EventEmitter {\n\n\t/** @protected */\n\tconstructor(meetingService) {\n\t\tsuper();\n\t\tthis._meetingService = meetingService;\n\n\t\t/**\n\t\t * @type {Array<Meeting>}\n\t\t */\n\t\tthis._meetings = [];\n\n\t\t/**\n\t\t * @type {Promise}\n\t\t */\n\t\tthis._initializing = null;\n\n\t\t/**\n\t\t * The text to be sent by SMS to the participants in the meetings. The {{url}} string will be expanded with the\n\t\t * meeting link\n\t\t *\n\t\t * @type {String}\n\t\t */\n\t\tthis._message = '';\n\n\t\tbindMethods(this, [\n\t\t\t'onUserInMeeting',\n\t\t\t'onLocalMeetingRemove',\n\t\t]);\n\t}\n\n\n\t/**\n\t * Initializes the meeting manager\n\t * @param {Object} query Object used for filtering the meetings\n\t * @returns {Promise<ContactManager, Error>} A promise that returns when fulfilled\n\t * the contact manager instance\n\t */\n\tinit(query = {}) {\n\t\tif (this._initializing !== null) {\n\t\t\treturn this._initializing;\n\t\t}\n\t\tthis._meetingService.emitter.on('update', this.onUserInMeeting);\n\t\tthis._initializing = this._meetingService.get(query).then((meetings) => {\n\t\t\tmeetings.forEach((meeting) => {\n\t\t\t\tif (this._meetings.some(elem => elem.id === meeting.id)) {\n\t\t\t\t\treturn meeting;\n\t\t\t\t}\n\t\t\t\tlet oMeeting = new Meeting(this._meetingService, meeting);\n\t\t\t\tthis._meetings.push(oMeeting);\n\t\t\t\tthis.emit('meeting-recovered', oMeeting);\n\t\t\t});\n\t\t\treturn this;\n\t\t});\n\t\treturn this._initializing;\n\t}\n\n\t/**\n\t * Uninitializes the meeting manager\n\t * @returns {Promise<undefined, Error>} A promise that is fulfilled when unitialization finishes\n\t */\n\tuninit() {\n\t\tif (this._initializing === null) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\treturn this._initializing.then(() => {\n\t\t\tthis._meetingService.emitter.off('update', this.onUserInMeeting);\n\t\t\tthis._meetings = [];\n\t\t\tthis._initializing = null;\n\t\t});\n\t}\n\n\n\t/**\n\t * Creates a meeting\n\t * @param {string} name The name of the meeting.\n\t * @param {Object[]} participants The participants of the new meeting session.\n\t * @param {number} validSince The timestamp of the moment when the meeting starts.\n\t * @param {boolean} [sendSmsViaWac=false] If true, an invitation for the meeting will be sent in an SMS by the server.\n\t * @return {Promise<Meeting>} The just created meeting\n\t */\n\tcreateMeeting(name, participants, validSince, sendSmsViaWac = false) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tthis._checkInitializingOfService();\n\t\t\tif (sendSmsViaWac) {\n\t\t\t\tparticipants = this._insertSendSMSFlagInParticipants(participants);\n\t\t\t}\n\t\t\treturn this._meetingService.create({name, participants, validSince});\n\t\t}).then((meetingCreated) => {\n\t\t\treturn {\n\t\t\t\tmeeting: this._addMeeting(meetingCreated),\n\t\t\t\tphones: this._getPhonesFromParticipants(participants),\n\t\t\t};\n\t\t});\n\t}\n\n\t/**\n\t * Update a meeting\n\t * @param {String} id Meeting id\n\t * @param {String} name Name of the meeting updated\n\t * @param {Array} participants Array with the participants of the meeting updated\n\t * @param {Object} validSince Updated date formatted string\n\t * @param {boolean} sendSmsViaWac Flag used to decided\n\t */\n\tupdateMeeting(id, name, participants, validSince, sendSmsViaWac) {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tthis._checkInitializingOfService();\n\t\t\tif (sendSmsViaWac) {\n\t\t\t\tparticipants = this._insertSendSMSFlagInParticipants(participants);\n\t\t\t}\n\t\t\treturn this._meetingService.update(id, {name, participants, validSince});\n\t\t}).then((meetingUpdated) => {\n\t\t\tthis._updateMeeting(meetingUpdated);\n\t\t\treturn meetingUpdated;\n\t\t});\n\t}\n\n\t/**\n\t * Insert a flag in each participant to indicate if the WAC\n\t * has to send the invite or not\n\t * @params {Array<Object>} participants\n\t * @return {Array<Object} Updated participants\n\t */\n\t_insertSendSMSFlagInParticipants(participants) {\n\t\treturn participants.map((participant) => {\n\t\t\tparticipant.sendSMS = true;\n\t\t\treturn participant;\n\t\t});\n\t}\n\n\n\t/**\n\t * Retrieves a list with the available meetings\n\t * @return {Array<Meetings>}\n\t */\n\tgetMeetings() {\n\t\treturn this._meetings;\n\t}\n\n\t/**\n\t * Set the message to send in a SMS\n\t * @param  {String} value Text for the SMS\n\t */\n\tset message(value) {\n\t\tthis._message = value;\n\t}\n\n\t/**\n\t * Adds a new contact to the list\n\t * @private\n\t * @param {Meeting} data\n\t * @return {Meeting} The new created meeting\n\t */\n\t_addMeeting(data) {\n\t\tif (this._meetings.some(meeting => meeting.id === data.id)) {\n\t\t\treturn;\n\t\t}\n\t\tconst meeting = new Meeting(this._meetingService, data);\n\t\tthis._meetings.push(meeting);\n\t\tthis.emit('create', meeting);\n\t\treturn meeting;\n\t}\n\n\t/**\n\t * Update an exisitng meeting in the meeting list\n\t * @private\n\t * @param {Meeting} data The updated meeting\n\t */\n\t_updateMeeting(data) {\n\t\tlet index = this._meetings.findIndex(meeting => meeting.id === data.id);\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis._meetings[index] = new Meeting(this._meetingService, data);\n\t}\n\n\t/**\n\t * Remove an existing meeting from the list\n\t * @private\n\t * @param {string} id ID of the meeting to remove\n\t * @return {Meeting} The just removed meeting if any\n\t */\n\t_rmMeeting(id) {\n\t\tlet index = this._meetings.findIndex(meeting => meeting.id === id);\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet meeting = this._meetings.splice(index, 1)[0];\n\t\tmeeting.off('delete', this.onLocalMeetingRemove);\n\t\treturn meeting;\n\t}\n\n\t/**\n\t * Internal callback for Meeting event\n\t * @private\n\t * @param {Meeting} meeting\n\t */\n\tonLocalMeetingRemove(meeting) {\n\t\tif (!this._rmMeeting(meeting.id)) {\n\t\t\tthis.emit('delete', meeting);\n\t\t}\n\t}\n\n\t/**\n\t * Internal callback for WAC event\n\t * @private\n\t * @param {Object} eventMeeting\n\t */\n\tonUserInMeeting(eventMeeting) {\n\t\tlet meeting = this._meetings.find(elem => eventMeeting.id === elem.id);\n\t\tif (!meeting) {\n\t\t\treturn;\n\t\t}\n\t\tmeeting.phone = eventMeeting.phone;\n\t\tif (meeting.phone !== '') {\n\t\t\tthis.emit('participant-connected');\n\t\t} else {\n\t\t\tthis.emit('participant-disconnected');\n\t\t}\n\t}\n\n\t_checkInitializingOfService() {\n\t\tif (this._initializing === null) {\n\t\t\tthrow new Error('MeetingManager not initialized');\n\t\t}\n\t}\n\n\t/**\n\t * Get phones that are used to create the meeting\n\t * @param  {string[]} participants A list of objects\n\t * @return {string[]} A list that contains phones\n\t */\n\t_getPhonesFromParticipants(participants) {\n\t\treturn participants.map(participant => participant.phone).filter(phone => phone);\n\t}\n\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible states of a datapipe. Possible values:\n * - UNCONNECTED\n * - CONNECTING: pipe has initiated an attempt to connect to remote parties.\n * - CONNECTED: pipe is connected and ready to send/receive data.\n * - REJECTED: an attempt to connect a pipe is explicitly rejected by the remote party..\n * - DISCONNECTED: pipe is disconnected.\n * @type {Enum}\n */\nexport const DataPipeStatus = Enum([\n\t'UNCONNECTED',\n\t'CONNECTING',\n\t'CONNECTED',\n\t'REJECTED',\n\t'DISCONNECTED',\n]);\n","import {EventEmitter2} from 'eventemitter2';\nimport {randomHash} from '../utils';\nimport {DataPipeStatus} from './DataPipeStatus';\n\n/**\n * Private fields addresses. These values are initialized when this file is loaded and hides\n * private vars addressing outside this scope.\n */\nvar priv = {\n\tid: Symbol('id'),\n\tinternalId: Symbol('internalId'),\n\ttype: Symbol('type'),\n\tstack: Symbol('stack'),\n\tparticipants: Symbol('participants'),\n\tlabel: Symbol('label'),\n\tstatus: Symbol('status'),\n};\n\nvar getStatusIndex = function(status) {\n\tswitch (status) {\n\t\tcase DataPipeStatus.UNCONNECTED:\n\t\t\treturn 0;\n\t\tcase DataPipeStatus.CONNECTING:\n\t\t\treturn 1;\n\t\tcase DataPipeStatus.CONNECTED:\n\t\t\treturn 2;\n\t\tcase DataPipeStatus.REJECTED:\n\t\t\treturn 3;\n\t\tcase DataPipeStatus.DISCONNECTED:\n\t\t\treturn 4;\n\t\tdefault:\n\t}\n};\n\n/**\n * Provides access to methods for managing an outgoing or an incoming data pipe\n * DataPipe objects are obtained by calling the {Session#createDataPipe} method or\n * handling the incomingDataPipe event of a connected {Session} instance.\n *\n * DataPipe allows data interchange between N users when pipe reaches 'connected' status.\n *\n * A DataPipe is identified by a label: shared string that will be available to any\n * peer.\n *\n * This class emits next events:\n *  - 'data'\n *  - 'data-with-info'\n *  - 'status'\n *\n * 'data' event:\n *  - Received data from another pipe peer.\n *  - Payload is a string that represents received data.\n *\n * 'data-with-info' event:\n *  - Received data with aditional info from another peer.\n *  - Event payload has next structure: {data: <String>, from: <sender>, ts: <timestamp>}\n *\n * 'status' event:\n *  - Pipe status changed.\n *  - Payload is a DataPipe.STATUS element\n *\n * @interface\n *\n * @example How to create a DataPipe\n *   pipe = session.createDataPipe(to)\n *   pipe.on(\"data\", function(dt) {\n *       console.log(\"received data\", dt);\n *   });\n *   pipe.when(DataPipeStatus.DISCONNECTED).then(function(){...});\n *   pipe.connect().then(function() {\n *       // Connecting code\n *       console.log(\"pipe connected, ready to send/receive\");\n *       pipe.send(\"Hello world\")\n *   });\n */\nexport class DataPipe extends EventEmitter2 {\n\t/**\n\t * @private\n\t *\n\t * @throws {TypeError}\n\t *\n\t * @param {String} id pipe identifier. Optional. Default is a random value.\n\t * @param {DataPipe.TYPE} type pipe type.\n\t * @param {WacStack} stack stack instance.\n\t * @param {Array<String>} participants pipe participants.\n\t * @param {String} label pipe label. Optional. Default is 'generic'\n\t */\n\tconstructor(id = randomHash(), type, stack, participants, label = 'generic') {\n\t\tsuper();\n\t\t/* Syntax check */\n\t\tif (!(participants instanceof Array)) {\n\t\t\tthrow new TypeError('invalid value for participants. An Array expected but an ' + typeof participants + ' received.');\n\t\t}\n\t\t/* Store values */\n\t\tthis[priv.id] = id;\n\t\tthis[priv.internalId] = null;\n\t\tthis[priv.type] = type;\n\t\tthis[priv.stack] = stack;\n\t\tthis[priv.participants] = participants;\n\t\tthis[priv.label] = label;\n\t\tthis[priv.status] = DataPipeStatus.UNCONNECTED;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tset status(status) {\n\t\tif (this[priv.status] != status) {\n\t\t\tthis[priv.status] = status;\n\t\t\tthis.emit('status', status);\n\t\t}\n\t}\n\n\t/**\n\t * Sets a private identifier for pipe implementation data.\n\t * @private\n\t */\n\tset internalId(value) {\n\t\tthis[priv.internalId] = value;\n\t}\n\n\t/**\n\t * Gets a unique identifier for the pipe\n\t *\n\t * @type {String}\n\t */\n\tget id() {\n\t\treturn this[priv.id];\n\t}\n\n\t/**\n\t * Returns a private identifier for pipe implementation data\n\t * @private\n\t * @type {String}\n\t */\n\tget internalId() {\n\t\tif (this[priv.internalId] !== null) {\n\t\t\treturn this[priv.internalId];\n\t\t} else {\n\t\t\treturn this.id;\n\t\t}\n\t}\n\n\t/**\n\t * Gets pipe type\n\t *\n\t * @type {DataPipe.TYPE}\n\t */\n\tget type() {\n\t\treturn this[priv.type];\n\t}\n\n\t/**\n\t * Gets stack\n\t *\n\t * @private\n\t *\n\t * @type {WacStack}\n\t */\n\tget stack() {\n\t\treturn this[priv.stack];\n\t}\n\n\t/**\n\t * Gets the identities of the peers attached to this pipe\n\t *\n\t * @type {Array<String>}\n\t */\n\tget participants() {\n\t\treturn this[priv.participants];\n\t}\n\n\t/**\n\t * Gets the identities of the remote peers attached to this pipe\n\t *\n\t * @type {Array<String>}\n\t */\n\tget remoteParticipants() {\n\t\treturn this[priv.participants].filter((participant) => {\n\t\t\treturn participant !== this.stack.wStack.getCurrentCredential().data.username;\n\t\t});\n\t}\n\n\t/**\n\t * Return label associated with this DataPipe. Requires DataPipe to be connected\n\t *\n\t * @type {String}\n\t */\n\tget label() {\n\t\treturn this[priv.label];\n\t}\n\n\t/**\n\t * Retrieves the current status of this pipe.\n\t *\n\t * @type {DataPipeStatus}\n\t */\n\tget status() {\n\t\treturn this[priv.status];\n\t}\n\n\t/**\n\t * Adds a participant to this pipe.\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'not allowed'\n\t *  - 'invalid-state' error when called on \"disconnected\" state\n\t *\n\t * @param {String} identity participant to add\n\t *\n\t * @returns {Promise<DataPipe, Error>} Resolved with the DataPipe object when\n\t * invitation sent to new participant or rejected with an {Error}.\n\t */\n\taddParticipant() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Removes a participant from this pipe.\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'not allowed'\n\t *  - 'invalid-state' error when called on \"disconnected\" state\n\t *\n\t * @param {String} identity participant to remove\n\t *\n\t * @returns {Promise<DataPipe, Error>} Resolved with the DataPipe object when\n\t * participant was removed or rejected with an {Error}.\n\t */\n\tremoveParticipant() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Attempts to reach the pipe recipient and establish a connection.\n\t * For an incoming pipe, calling this method explicitly joins/accepts the pipe.\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'invalid-state' error when called on state different than \"unconnected\" state\n\t *  - 'disconnected' pipe reaches disconnected state without being connected\n\t *\n\t * @return {Promise<DataPipe, Error>} Resolved with the DataPipe object when\n\t * pipe reaches \"connecting\" state or rejected with an {Error}.\n\t */\n\tconnect() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Ends an active pipe.\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'invalid-state' error when called on state different than \"connected\" state\n\t *\n\t * @return {Promise<DataPipe, Error>} Resolved with the DataPipe object when\n\t * pipe reaches \"disconnected\" state or rejected with an {Error}.\n\t */\n\tdisconnect() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Called when a user does not wish to accept an incoming pipe.\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'invalid-state' error when called on state different than \"unconnected\" state\n\t *  - 'invalid-state' error when called on outgoing pipes\n\t *\n\t * @return {Promise<DataPipe, Error>} Resolved with the DataPipe object when\n\t * pipe reaches \"disconnected\" state or rejected with an {Error}.\n\t */\n\treject() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Sends data to the DataPipe recipients\n\t *\n\t * When this method fails returned {Promise} is rejected with one of next {Error}\n\t *  - 'unimplemented'\n\t *  - 'invalid-state' error when called on state different than \"connected\" state\n\t *\n\t * @param {String} data data to send\n\t *\n\t * @return {Promise<DataPipe, Error>} Resolved with DataPipe object after data\n\t * delivery or rejected with an {Error}\n\t */\n\tsend() {\n\t\treturn Promise.reject(new Error('unimplemented'));\n\t}\n\n\t/**\n\t * Returns a Promise resolved when pipe reaches provided state\n\t *\n\t *  - \"unreachable state\" pipe can not reach this state\n\t *  - \"invalid state\" pipe state changed to an state that makes impossible reach\n\t *    desired state.\n\t *\n\t * @param {DataPipeStatus} status desired state\n\t *\n\t * @return {Promise<DataPipe, Error>} Resolved with DataPipe object when pipe reaches\n\t * provided state or rejected with an {Error}.\n\t */\n\twhen(status) {\n\t\tlet index = getStatusIndex(status);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (getStatusIndex(this[priv.status]) > index) {\n\t\t\t\treject(new Error('unreachable state'));\n\t\t\t} else if (getStatusIndex(this[priv.status]) == index) {\n\t\t\t\tresolve(this);\n\t\t\t} else {\n\t\t\t\tvar onStatus = (newStatus) => {\n\t\t\t\t\tlet newIndex = getStatusIndex(newStatus);\n\t\t\t\t\tif (newIndex == index) {\n\t\t\t\t\t\tthis.off('status', onStatus);\n\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t} else if (newIndex > index) {\n\t\t\t\t\t\tthis.off('status', onStatus);\n\t\t\t\t\t\treject(new Error('invalid state'));\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.on('status', onStatus);\n\t\t\t}\n\t\t});\n\t}\n}\n","/** @private */\nexport function randomHash() {\n\treturn Math.random().toString(16).substring(2);\n}\n","import {Enum} from '../utils';\n\n/**\n * Enum containing the possible directions of a datapipe. Possible values:\n * - INCOMING\n * - OUTGOING\n * @type {Enum}\n */\nexport const DataPipeType = Enum([\n\t'INCOMING',\n\t'OUTGOING',\n]);\n","import {DataPipe} from './DataPipe';\nimport {DataPipeStatus} from './DataPipeStatus';\nimport {DataPipeType} from './DataPipeType';\nimport {bindMethods} from '../utils';\n\nexport class WacDataPipe extends DataPipe {\n\tconstructor(id, type, stack, participants, label) {\n\t\tsuper(id, type, stack, participants, label);\n\t\tthis.datapipeService = stack.getDatapipeService();\n\t\tthis.gatewayUsername = stack.wStack.getCurrentCredential().data.username;\n\t\tbindMethods(this, ['onStatus', 'onData', 'onDelete', 'onUpdate']);\n\t\tthis.makeBindings();\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tasync connect() {\n\t\tif (this.status !== DataPipeStatus.UNCONNECTED) {\n\t\t\tthrow new Error('invalid-state');\n\t\t}\n\t\tthis.status = DataPipeStatus.CONNECTING;\n\t\ttry {\n\t\t\tif (this.type === DataPipeType.OUTGOING) {\n\t\t\t\tconst datapipe = await this.datapipeService.create(this.label, this.participants);\n\t\t\t\tthis.internalId = datapipe.id;\n\t\t\t}\n\t\t\tawait this.datapipeService.accept(this.internalId);\n\t\t\tawait this.when(DataPipeStatus.CONNECTED);\n\t\t} catch (error) {\n\t\t\tthis.status = DataPipeStatus.DISCONNECTED;\n\t\t\tthrow error;\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tasync disconnect() {\n\t\tif (this.status !== DataPipeStatus.CONNECTED) {\n\t\t\tthrow new Error('invalid-state');\n\t\t}\n\t\tawait this.datapipeService.delete(this.internalId);\n\t\tthis.status = DataPipeStatus.DISCONNECTED;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tasync reject() {\n\t\tif (this.status !== DataPipeStatus.UNCONNECTED || this.type !== DataPipeType.INCOMING) {\n\t\t\tthrow new Error('invalid-state');\n\t\t}\n\t\tawait this.datapipeService.delete(this.internalId);\n\t\tthis.status = DataPipeStatus.DISCONNECTED;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tasync send(data) {\n\t\tif (this.status !== DataPipeStatus.CONNECTED) {\n\t\t\tthrow new Error('invalid-state');\n\t\t}\n\t\tawait this.datapipeService.send(this.internalId, data);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t * @return {WacDataPipe}\n\t */\n\tmakeBindings() {\n\t\tthis.on('status', this.onStatus);\n\t\tthis.datapipeService.emitter.on('delete', this.onDelete);\n\t\tthis.datapipeService.emitter.on('data', this.onData);\n\t\tthis.datapipeService.emitter.on('update', this.onUpdate);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t * @return {WacDataPipe}\n\t */\n\tdestroyBindings() {\n\t\tthis.off('status', this.onStatus);\n\t\tthis.datapipeService.emitter.off('delete', this.onDelete);\n\t\tthis.datapipeService.emitter.off('data', this.onData);\n\t\tthis.datapipeService.emitter.off('update', this.onUpdate);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Destroy bindings when disconnected state reached.\n\t * @private\n\t */\n\tonStatus() {\n\t\tif (this.status === DataPipeStatus.DISCONNECTED) {\n\t\t\tthis.destroyBindings();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonDelete(event) {\n\t\tif (event.id === this.internalId) {\n\t\t\tthis.status = DataPipeStatus.DISCONNECTED;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonData(event) {\n\t\tif (event.id === this.internalId) {\n\t\t\tthis.emit('data', event.payload);\n\t\t\tthis.emit('data-with-info', {\n\t\t\t\tdata: event.payload,\n\t\t\t\tfrom: event.from,\n\t\t\t\tts: event.ts,\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonUpdate(event) {\n\t\tif (event.id === this.internalId && event.connected.includes(this.gatewayUsername)) {\n\t\t\tthis.status = DataPipeStatus.CONNECTED;\n\t\t}\n\t}\n}\n","import {DataPipe} from './DataPipe';\nimport {DataPipeStatus} from './DataPipeStatus';\nimport {DataPipeType} from './DataPipeType';\nimport {bindMethods} from '../utils';\n\nexport class DataChannelDataPipe extends DataPipe {\n\n\tconstructor(id, type, stack, participants, label) {\n\t\tsuper(id, type, stack, participants, label);\n\t\tif (participants.length !== 2) {\n\t\t\tthrow new TypeError('participants parameter must have 2 elements');\n\t\t}\n\t\tbindMethods(this, ['onStatus', 'onQsCalling', 'onQsEstablished', 'onQsEndCall', 'onQsData']);\n\t\tthis.rcv = 0;\n\t\tthis.handleCalling = this.type === DataPipeType.OUTGOING;\n\t\tthis.makeBindings();\n\t}\n\n\t_connectOutgoing() {\n\t\tthis.status = DataPipeStatus.CONNECTING;\n\t\tthis.stack.call(this.participants[1], {data: true});\n\t\treturn this.when(DataPipeStatus.CONNECTED);\n\t}\n\n\t_connectIncoming() {\n\t\tthis.status = DataPipeStatus.CONNECTING;\n\t\tthis.stack.answer(this.internalId, {data: true});\n\t\treturn this.when(DataPipeStatus.CONNECTED);\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tconnect() {\n\t\tif (this.status !== DataPipeStatus.UNCONNECTED) {\n\t\t\treturn Promise.reject(new Error('invalid-state'));\n\t\t} else if (this.type == DataPipeType.OUTGOING) {\n\t\t\treturn this._connectOutgoing();\n\t\t} else {\n\t\t\treturn this._connectIncoming();\n\t\t}\n\t}\n\n\t_reject() {\n\t\tthis.stack.hangup(this.internalId);\n\t\treturn this.when(DataPipeStatus.DISCONNECTED);\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tdisconnect() {\n\t\tif (this.status !== DataPipeStatus.CONNECTING && this.status !== DataPipeStatus.CONNECTED) {\n\t\t\treturn Promise.reject(new Error('invalid-state'));\n\t\t}\n\t\treturn this._reject();\n\t}\n\n\t/**\n\t * @Override\n\t */\n\treject() {\n\t\tif (this.status !== DataPipeStatus.UNCONNECTED) {\n\t\t\treturn Promise.reject(new Error('invalid-state'));\n\t\t} else if (this.type != DataPipeType.INCOMING) {\n\t\t\treturn Promise.reject(new Error('invalid-state'));\n\t\t}\n\t\treturn this._reject();\n\t}\n\n\t/**\n\t * @Override\n\t */\n\tsend(data) {\n\t\tif (this.status !== DataPipeStatus.CONNECTED) {\n\t\t\treturn Promise.reject(new Error('invalid-state'));\n\t\t}\n\t\tthis.stack.sendDataChannel(this.internalId, data);\n\t\treturn Promise.resolve(this);\n\t}\n\n\t/**\n\t * @private\n\t * @return {DataChannelDataPipe}\n\t */\n\tmakeBindings() {\n\t\tthis.on('status', this.onStatus);\n\t\tif (this.type === DataPipeType.OUTGOING) {\n\t\t\tthis.stack.on('qs-calling', this.onQsCalling);\n\t\t}\n\t\tthis.stack.on('qs-established', this.onQsEstablished);\n\t\tthis.stack.on('qs-end-call qs-lost-call', this.onQsEndCall);\n\t\tthis.stack.on('qs-data', this.onQsData);\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t * @return {DataChannelDataPipe}\n\t */\n\tdestroyBindings() {\n\t\tthis.off('status', this.onStatus);\n\t\tif (this.type === DataPipeType.OUTGOING) {\n\t\t\tthis.stack.off('qs-calling', this.onQsCalling);\n\t\t}\n\t\tthis.stack.off('qs-established', this.onQsEstablished);\n\t\tthis.stack.off('qs-end-call qs-lost-call', this.onQsEndCall);\n\t\tthis.stack.off('qs-data', this.onQsData);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Destroy bindings when disconnected state reached.\n\t * @private\n\t */\n\tonStatus() {\n\t\tif (this.status === DataPipeStatus.DISCONNECTED) {\n\t\t\tthis.destroyBindings();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonQsCalling(event) {\n\t\tif (this.handleCalling) {\n\t\t\tthis.internalId = event.callid;\n\t\t\tthis.handleCalling = false;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonQsEstablished(event) {\n\t\tif (event.callid !== this.internalId) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.type === DataPipeType.OUTGOING) {\n\t\t\tthis.stack.sendDataChannel(this.internalId, JSON.stringify({label: this.label}));\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonQsEndCall(event) {\n\t\tif (event.callid !== this.internalId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.status = DataPipeStatus.DISCONNECTED;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonQsData(event) {\n\t\tif (event.id !== this.internalId) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.rcv === 0) {\n\t\t\tif (this.type == DataPipeType.INCOMING) {\n\t\t\t\tvar data = JSON.parse(event.data);\n\t\t\t\tthis.label = data.label;\n\t\t\t\t/* Send back same message as ACK */\n\t\t\t\tthis.stack.sendDataChannel(this.internalId, event.data);\n\t\t\t}\n\t\t\tthis.status = DataPipeStatus.CONNECTED;\n\t\t} else {\n\t\t\tthis.emit('data', event.data);\n\t\t}\n\t\tthis.rcv++;\n\t}\n}\n","export const StreamChangeReason = {\n    STREAM_CHANGE_HOLD: 'HOLD',\n    STREAM_CHANGE_GONE: 'GONE',\n    STREAM_CHANGE_NEW: 'NEW',\n    STREAM_CHANGE_UNHOLD: 'UNHOLD',\n};\nexport const ParticipantStatus = {\n    PARTICIPANT_ON_HOLD: 'HOLD',\n    PARTICIPANT_IN_CALL: 'IN_CALL',\n};\nexport const JanusEvents = {\n    OPEN_COMPLETED: 'openCompleted',\n};\nexport const ParticipantEvents = {\n    PARTICIPANT_HOLD: 'participantHold',\n    PARTICIPANT_UNHOLD: 'participantUnhold',\n    PARTICIPANT_ADDED: 'participantAdded',\n    PARTICIPANT_REMOVED: 'participantRemoved',\n};\nexport const ConnectionEvents = {\n    CONNECTED: 'connected',\n    CONNECTION_CLOSED: 'closed',\n};\n","/**\n * Conference Media stream.\n * Class used to encapsulate a MediaStream and provide additional info\n * about it's procedence.\n */\nexport class ConferenceMediaStream {\n    /**\n     * Create a new ConferenceMediaStream instance with\n     * @param {string} feed associated user name.\n     * @param {boolean} local indicates if stream is local.\n     * @param {MediaStream} stream media stream.\n     */\n    constructor(feed, local, stream, medium) {\n        /**\n         * Associated user name.\n         * @type {string}\n         */\n        this.feed = feed;\n        /**\n         * Indicate if stream is local.\n         * @type {boolean}\n         */\n        this.local = local;\n        /**\n         * Media stream\n         * @type {MediaStream}\n         */\n        this.stream = stream;\n        this.medium = medium;\n    }\n}\n","import { EventEmitter2 } from 'eventemitter2';\nimport { ConferenceMediaStream } from './ConferenceMediaStream';\n/**\n * Stream added event.\n * Fired when a new stream is available.\n * @event STREAM_ADDED\n * @type {ConferenceMediaStream}\n */\nexport const STREAM_ADDED = 'streamAdded';\n/**\n * Stream removed event.\n * Fired when a stream becomes unavailable.\n * @event STREAM_REMOVED\n * @type {ConferenceMediaStream}\n */\nexport const STREAM_REMOVED = 'streamRemoved';\nconst _feed = Symbol('feed');\nconst _localStream = Symbol('localStream');\nconst _remoteStream = Symbol('remoteStream');\n/**\n * Class that manages local and remote streams associated\n * with a Conference Media feed.\n *\n * @fires STREAM_ADDED\n * @fires STREAM_REMOVED\n *\n * @extends EventEmitter2\n */\nexport class ConferenceMediaFeed extends EventEmitter2 {\n    /**\n     * Creates a new ConferenceMediaFeed instance.\n     * @param {string} feed associated user name.\n     */\n    constructor(feed) {\n        super();\n        /**\n         * Subscribed user name\n         * @private\n         * @type {string}\n         */\n        this[_feed] = feed;\n        /**\n         * Local user media\n         * @private\n         * @type {ConferenceMediaStream}\n         */\n        this[_localStream] = null;\n        /**\n         * Remote user media\n         * @private\n         * @type {ConferenceMediaStream}\n         */\n        this[_remoteStream] = null;\n    }\n    /**\n     * User name associated with this media.\n     * @type {string}\n     */\n    get feed() {\n        return this[_feed];\n    }\n    /**\n     * Get published stream.\n     * @type {ConferenceMediaStream}\n     */\n    get localStream() {\n        return this[_localStream];\n    }\n    /**\n     * Get remote stream (if any).\n     * @type {ConferenceMediaStream}\n     */\n    get remoteStream() {\n        return this[_remoteStream];\n    }\n    /**\n     * Updates local stream and fires STREAM_REMOVED and/or\n     * STREAM_ADDED events\n     * @protected\n     * @param {MediaStream} stream new local stream\n     */\n    setLocalStream(stream, medium) {\n        if (this[_localStream]) {\n            const oldStream = this[_localStream];\n            this[_localStream] = null;\n            this.emit(STREAM_REMOVED, oldStream);\n        }\n        if (stream) {\n            const janusMedia = new ConferenceMediaStream(this.feed, true, stream, medium);\n            this[_localStream] = janusMedia;\n            this.emit(STREAM_ADDED, janusMedia);\n        }\n    }\n    /**\n     * Updates remote stream and fires STREAM_ADDED and/or\n     * STREAM_REMOVED events\n     * @protected\n     * @param {MediaStream} stream new remote stream\n     */\n    setRemoteStream(stream, medium) {\n        if (this[_remoteStream]) {\n            const oldStream = this[_remoteStream];\n            this[_remoteStream] = null;\n            this.emit(STREAM_REMOVED, oldStream);\n        }\n        if (stream) {\n            const janusMedia = new ConferenceMediaStream(this.feed, false, stream, medium);\n            this[_remoteStream] = janusMedia;\n            this.emit(STREAM_ADDED, janusMedia);\n        }\n    }\n}\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport arrayMap from './_arrayMap.js';\nimport baseUnary from './_baseUnary.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseDifference;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","import baseDifference from './_baseDifference.js';\nimport baseRest from './_baseRest.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Creates an array excluding all given values using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * **Note:** Unlike `_.pull`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...*} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.xor\n * @example\n *\n * _.without([2, 1, 2, 3], 1, 2);\n * // => [3]\n */\nvar without = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, values)\n    : [];\n});\n\nexport default without;\n","/**\n * @protected\n */\nexport function bindMethods(instance, methods, appendEmitter = true) {\n    methods.forEach((method) => {\n        if (appendEmitter) {\n            instance[method] = function (...args) {\n                args.push(this);\n                return Object.getPrototypeOf(instance)[method].apply(instance, args);\n            };\n        }\n        else {\n            instance[method] = Object.getPrototypeOf(instance)[method].bind(instance);\n        }\n    });\n}\nexport function checkRTCDependency(deps, propertyExpected) {\n    if (deps[propertyExpected]) {\n        return;\n    }\n    throw Error(`${propertyExpected} is needed as dependency`);\n}\n;\n","import { EventEmitter2 } from 'eventemitter2';\nimport { without } from 'lodash-es';\nimport { bindMethods } from '../utils';\nimport { STREAM_ADDED, STREAM_REMOVED } from './ConferenceMediaFeed';\nimport { DefaultConferenceStreamHandler } from './DefaultConferenceStreamHandler';\nconst _list = Symbol('list');\n/**\n * Collection of ConferenceMediaFeed items.\n *\n * Captures and forwards any ConferenceMediaFeed event and provides getters\n * to obtain local and remote streams.\n *\n * @fires STREAM_ADDED\n * @fires STREAM_REMOVED\n *\n * @extends EventEmitter2\n */\nexport class ConferenceMediaList extends EventEmitter2 {\n    /**\n     * Creates a new ConferenceMediaList instance\n     */\n    constructor(streamEventHandler) {\n        super();\n        /**\n         * Media list.\n         * @private\n         * @type {Array<ConferenceMediaFeed|ConferenceMediaList>}\n         */\n        this[_list] = [];\n        this.streamEventHandler = streamEventHandler;\n        const createStreamEventHandler = () => {\n            if (streamEventHandler) {\n                return streamEventHandler;\n            }\n            return DefaultConferenceStreamHandler();\n        };\n        this.streamEventHandler = createStreamEventHandler();\n        bindMethods(this, [\n            'onStreamAdded',\n            'onStreamRemoved',\n        ]);\n    }\n    /**\n     * Access managed ConferenceMediaFeed elements.\n     * @return {Array<ConferenceMediaFeed|ConferenceMediaList>}\n     */\n    get items() {\n        return this[_list];\n    }\n    /**\n     * Get local streams.\n     * @type {Array<ConferenceMediaStream>}\n     */\n    get localStreams() {\n        let streams = [];\n        this[_list].forEach((item) => {\n            if (item.localStream) {\n                streams.push(item.localStream);\n            }\n            if (item.localStreams) {\n                streams = streams.concat(item.localStreams);\n            }\n        });\n        return streams;\n    }\n    /**\n     * Get remote streams.\n     * @type {Array<ConferenceMediaStream>}\n     */\n    get remoteStreams() {\n        let streams = [];\n        this[_list].forEach((item) => {\n            if (item.remoteStream) {\n                streams.push(item.remoteStream);\n            }\n            if (item.remoteStreams) {\n                streams = streams.concat(item.remoteStreams);\n            }\n        });\n        return streams;\n    }\n    /**\n     * Add a ConferenceMediaFeed to the list of managed ConferenceMediaFeed.\n     * This method also initialize ConferenceMediaFeed event listeners.\n     * @private\n     * @param {ConferenceMediaFeed|ConferenceMediaList} item elemen to add.\n     * @return {Promise} resolved on success\n     */\n    _addItem(item) {\n        if (!this[_list].includes(item)) {\n            item.on(STREAM_ADDED, this.onStreamAdded);\n            item.on(STREAM_REMOVED, this.onStreamRemoved);\n            this[_list].push(item);\n        }\n        return Promise.resolve();\n    }\n    /**\n     * Removes a ConferenceMediaFeed from the list of managed ConferenceMediaFeed.\n     * This method also deinitialize ConferenceMediaFeed event listeners.\n     * @private\n     * @param {ConferenceMediaFeed|ConferenceMediaList} item elemen to add.\n     * @return {Promise} resolved on success\n     */\n    _removeItem(item) {\n        if (this[_list].includes(item)) {\n            item.off(STREAM_ADDED, this.onStreamAdded);\n            item.off(STREAM_REMOVED, this.onStreamRemoved);\n            this[_list] = without(this[_list], item);\n        }\n        return Promise.resolve();\n    }\n    /**\n     * Callback called when a ConferenceMediaFeed notifies a new stream.\n     * @private\n     * @param {ConferenceMediaStream} stream notified stream\n     */\n    onStreamAdded(stream) {\n        this.streamEventHandler.onStreamAdded(this, stream);\n    }\n    /**\n     * Callback called when a ConferenceMediaFeed notifies that a stream is\n     * not available anymore.\n     * @private\n     * @param {ConferenceMediaStream} stream notified stream\n     */\n    onStreamRemoved(stream) {\n        this.streamEventHandler.onStreamRemoved(this, stream);\n    }\n}\n","import { STREAM_ADDED, STREAM_REMOVED, } from './ConferenceMediaFeed';\nexport function DefaultConferenceStreamHandler() {\n    return {\n        onStreamAdded(conferenceMediaList, stream) {\n            conferenceMediaList.emit(STREAM_ADDED, stream);\n        },\n        onStreamRemoved(conferenceMediaList, stream) {\n            conferenceMediaList.emit(STREAM_REMOVED, stream);\n        }\n    };\n}\n;\n","import { STREAM_ADDED, STREAM_REMOVED } from '../conference-media/ConferenceMediaFeed';\nimport { ConferenceMediaList } from '../conference-media/ConferenceMediaList';\nimport { StreamChangeReason } from '../Constants';\nconst withReason = (data, reason) => Object.assign({}, data, { reason });\nexport function HoldableConferenceMediaList(heldParticipants) {\n    return new ConferenceMediaList({\n        onStreamAdded(conferenceMediaList, stream) {\n            const addReason = heldParticipants.isOnHold(stream.feed)\n                ? StreamChangeReason.STREAM_CHANGE_UNHOLD\n                : StreamChangeReason.STREAM_CHANGE_NEW;\n            const data = withReason(stream, addReason);\n            conferenceMediaList.emit(STREAM_ADDED, data);\n        },\n        onStreamRemoved(conferenceMediaList, stream) {\n            const addReason = heldParticipants.isOnHold(stream.feed)\n                ? StreamChangeReason.STREAM_CHANGE_HOLD\n                : StreamChangeReason.STREAM_CHANGE_GONE;\n            const data = withReason(stream, addReason);\n            conferenceMediaList.emit(STREAM_REMOVED, data);\n        }\n    });\n}\n;\n","import { EventEmitter2 as EventEmitter } from 'eventemitter2';\nexport const HOLD_MESSAGE_TYPES = {\n    HOLD: 'hold',\n    UNHOLD: 'unhold'\n};\nexport function HoldAPI(client) {\n    const emitter = new EventEmitter();\n    client.emitter.on(HOLD_MESSAGE_TYPES.HOLD, (eventData) => emitter.emit(HOLD_MESSAGE_TYPES.HOLD, eventData));\n    client.emitter.on(HOLD_MESSAGE_TYPES.UNHOLD, (eventData) => emitter.emit(HOLD_MESSAGE_TYPES.UNHOLD, eventData));\n    const sendWithEmptyPayload = (messageType) => () => client.send(messageType, {});\n    const hold = sendWithEmptyPayload(HOLD_MESSAGE_TYPES.HOLD);\n    const unhold = sendWithEmptyPayload(HOLD_MESSAGE_TYPES.UNHOLD);\n    return {\n        hold,\n        unhold,\n        emitter,\n    };\n}\n","export const JANUS_EVENTS = {\n    JANUS_FEED_NEW: 'new',\n    JANUS_FEED_GONE: 'gone',\n};\n","import * as log from 'js-logger';\nimport { JANUS_EVENTS } from './JanusEvents';\nexport function BaseJanusFeedEventHandler() {\n    const onJanusFeed = (room, data) => {\n        switch (data.event) {\n            case JANUS_EVENTS.JANUS_FEED_NEW:\n                return onNewFeed(room, data);\n            case JANUS_EVENTS.JANUS_FEED_GONE:\n                return onFeedGone(room, data);\n            default:\n                return Promise.resolve();\n        }\n    };\n    const onNewFeed = (room, data) => {\n        return room.getSubscribers().subscribe(data.feed.feed, data.feed.medium)\n            .catch(() => { });\n    };\n    const onFeedGone = (room, data) => {\n        const subscribers = room.getSubscribers();\n        return subscribers.unsubscribe(data.feed.feed, data.feed.medium)\n            .catch(() => { })\n            .then(() => {\n            // @TODO: should maintain this unsubscription\n            if (data.feed.medium === 'sipcall' && isSubscribedToVideo(subscribers, data.feed.feed)) {\n                return subscribers.unsubscribe(data.feed.feed, 'sfuvideo').catch((error) => {\n                    log.error(`Unable to unsubscribe from feed ${data.feed.feed} with error: ${error}`);\n                });\n            }\n        });\n    };\n    const isSubscribedToVideo = (subscribers, feed) => !!subscribers.get(feed, 'sfuvideo');\n    return {\n        onJanusFeed,\n    };\n}\n;\n","export class LoginAPI {\n    constructor(client) {\n        this.client = client;\n    }\n    /**\n     * Authenticate at the wrapper and join a room\n     * @param {string} username user name to register\n     * @param {string} room room identifier\n     * @param {string} token token assigned to user in room\n     * @return {Promise} resolved on success\n     */\n    login(username, room, token) {\n        return this.client.send('login', {\n            username: username,\n            token: token,\n            room: room,\n        });\n    }\n    /**\n     * Leave a room at the wrapper\n     * @return {Promise} resolved on success\n     */\n    logout() {\n        return this.client.send('logout', {});\n    }\n}\n","import { JanusEvents } from '../Constants';\nexport class MediaAPI {\n    constructor(client) {\n        this.client = client;\n    }\n    publish(medium, sdp) {\n        const payload = {\n            medium: medium,\n            jsep: {\n                type: 'offer',\n                sdp: sdp,\n            },\n        };\n        if (this.parallelSipExtension) {\n            payload.parallelSipExtension = this.parallelSipExtension;\n        }\n        return this.client.send('open', payload);\n    }\n    waitPublishComplete(medium) {\n        const { emitter } = this.client;\n        const { OPEN_COMPLETED } = JanusEvents;\n        return new Promise((resolve) => {\n            const onOpenCompleted = (stream) => {\n                if (stream.medium === medium) {\n                    emitter.off(OPEN_COMPLETED, onOpenCompleted);\n                    resolve();\n                }\n            };\n            emitter.on(OPEN_COMPLETED, onOpenCompleted);\n        });\n    }\n    unpublish(medium) {\n        return this.client.send('close', {\n            medium: medium,\n        });\n    }\n    subscribe(medium, feed) {\n        const payload = {\n            medium: medium,\n            feed: feed,\n        };\n        return this.client.send('open', payload);\n    }\n    unsubscribe(medium, feed) {\n        return this.client.send('close', {\n            feed: feed,\n            medium: medium,\n        });\n    }\n    answer(medium, feed, sdp) {\n        const payload = {\n            feed: feed,\n            medium: medium,\n            jsep: {\n                type: 'answer',\n                sdp: sdp,\n            },\n        };\n        return this.client.send('answer', payload);\n    }\n    /**\n     * Send a tricke message to Janus wrapper\n     * @param {string} medium media type\n     * @param {RTCIceCandidate} candidate RTC ice candidate to send. null means 'no more candidates'\n     * @param {string} feed subscribed username. Optional\n     * @return {Promise} resolved on success\n     */\n    trickle(medium, candidate, feed) {\n        const payload = {\n            medium: medium,\n        };\n        if (candidate) {\n            payload.candidate = {\n                sdpMid: candidate.sdpMid,\n                sdpMLineIndex: candidate.sdpMLineIndex,\n                candidate: candidate.candidate,\n            };\n        }\n        else {\n            payload.candidate = {\n                completed: true,\n            };\n        }\n        if (feed) {\n            payload.feed = feed;\n        }\n        return this.client.send('trickle', payload);\n    }\n    bitrate(bitrate) {\n        return this.client.send('bitrate', { bitrate: bitrate });\n    }\n    setParallelSipExtension(extension) {\n        this.parallelSipExtension = extension;\n    }\n}\n","export function UserAPI(client) {\n    const getAll = () => client.send('getParticipants', {});\n    return {\n        getAll,\n    };\n}\n","var Transport;\n(function (Transport) {\n    Transport[\"WEBSOCKET\"] = \"websocket\";\n    Transport[\"SOCKETIO\"] = \"socketio\";\n})(Transport || (Transport = {}));\nexport class ServerAddress {\n    constructor(address, transport) {\n        this.address = address;\n        this.transport = transport;\n    }\n    static fromUnknownAddress(address) {\n        return typeof address === 'string' ? this.fromSocketIo(address) : address;\n    }\n    static fromSocketIo(address) {\n        return new ServerAddress(address, Transport.SOCKETIO);\n    }\n    static fromWebsocket(address) {\n        return new ServerAddress(address, Transport.WEBSOCKET);\n    }\n    getAddress() {\n        return this.address;\n    }\n    getTransport() {\n        return this.transport;\n    }\n}\nServerAddress.Transport = Transport;\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isFunction(x) {\n    return typeof x === 'function';\n}\n//# sourceMappingURL=isFunction.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar _enable_super_gross_mode_that_will_cause_bad_things = false;\nexport var config = {\n    Promise: undefined,\n    set useDeprecatedSynchronousErrorHandling(value) {\n        if (value) {\n            var error = /*@__PURE__*/ new Error();\n            /*@__PURE__*/ console.warn('DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \\n' + error.stack);\n        }\n        else if (_enable_super_gross_mode_that_will_cause_bad_things) {\n            /*@__PURE__*/ console.log('RxJS: Back to a better error behavior. Thank you. <3');\n        }\n        _enable_super_gross_mode_that_will_cause_bad_things = value;\n    },\n    get useDeprecatedSynchronousErrorHandling() {\n        return _enable_super_gross_mode_that_will_cause_bad_things;\n    },\n};\n//# sourceMappingURL=config.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function hostReportError(err) {\n    setTimeout(function () { throw err; });\n}\n//# sourceMappingURL=hostReportError.js.map\n","/** PURE_IMPORTS_START _config,_util_hostReportError PURE_IMPORTS_END */\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\nexport var empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) {\n        if (config.useDeprecatedSynchronousErrorHandling) {\n            throw err;\n        }\n        else {\n            hostReportError(err);\n        }\n    },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArray = Array.isArray || (function (x) { return x && typeof x.length === 'number'; });\n//# sourceMappingURL=isArray.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isObject(x) {\n    return x !== null && typeof x === 'object';\n}\n//# sourceMappingURL=isObject.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nfunction UnsubscriptionErrorImpl(errors) {\n    Error.call(this);\n    this.message = errors ?\n        errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ') : '';\n    this.name = 'UnsubscriptionError';\n    this.errors = errors;\n    return this;\n}\nUnsubscriptionErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);\nexport var UnsubscriptionError = UnsubscriptionErrorImpl;\n//# sourceMappingURL=UnsubscriptionError.js.map\n","/** PURE_IMPORTS_START _util_isArray,_util_isObject,_util_isFunction,_util_UnsubscriptionError PURE_IMPORTS_END */\nimport { isArray } from './util/isArray';\nimport { isObject } from './util/isObject';\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nvar Subscription = /*@__PURE__*/ (function () {\n    function Subscription(unsubscribe) {\n        this.closed = false;\n        this._parent = null;\n        this._parents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var hasErrors = false;\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parent = _a._parent, _parents = _a._parents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parent = null;\n        this._parents = null;\n        this._subscriptions = null;\n        var index = -1;\n        var len = _parents ? _parents.length : 0;\n        while (_parent) {\n            _parent.remove(this);\n            _parent = ++index < len && _parents[index] || null;\n        }\n        if (isFunction(_unsubscribe)) {\n            try {\n                _unsubscribe.call(this);\n            }\n            catch (e) {\n                hasErrors = true;\n                errors = e instanceof UnsubscriptionError ? flattenUnsubscriptionErrors(e.errors) : [e];\n            }\n        }\n        if (isArray(_subscriptions)) {\n            index = -1;\n            len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject(sub)) {\n                    try {\n                        sub.unsubscribe();\n                    }\n                    catch (e) {\n                        hasErrors = true;\n                        errors = errors || [];\n                        if (e instanceof UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(e.errors));\n                        }\n                        else {\n                            errors.push(e);\n                        }\n                    }\n                }\n            }\n        }\n        if (hasErrors) {\n            throw new UnsubscriptionError(errors);\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var subscription = teardown;\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription === this || subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (!(subscription instanceof Subscription)) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default: {\n                if (!teardown) {\n                    return Subscription.EMPTY;\n                }\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n            }\n        }\n        if (subscription._addParent(this)) {\n            var subscriptions = this._subscriptions;\n            if (subscriptions) {\n                subscriptions.push(subscription);\n            }\n            else {\n                this._subscriptions = [subscription];\n            }\n        }\n        return subscription;\n    };\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        if (_parent === parent) {\n            return false;\n        }\n        else if (!_parent) {\n            this._parent = parent;\n            return true;\n        }\n        else if (!_parents) {\n            this._parents = [parent];\n            return true;\n        }\n        else if (_parents.indexOf(parent) === -1) {\n            _parents.push(parent);\n            return true;\n        }\n        return false;\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nexport { Subscription };\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var rxSubscriber = typeof Symbol === 'function'\n    ? /*@__PURE__*/ Symbol('rxSubscriber')\n    : '@@rxSubscriber_' + /*@__PURE__*/ Math.random();\nexport var $$rxSubscriber = rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { empty as emptyObserver } from './Observer';\nimport { Subscription } from './Subscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\nimport { config } from './config';\nimport { hostReportError } from './util/hostReportError';\nvar Subscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Subscriber, _super);\n    function Subscriber(destinationOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this.syncErrorValue = null;\n        _this.syncErrorThrown = false;\n        _this.syncErrorThrowable = false;\n        _this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                _this.destination = emptyObserver;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    _this.destination = emptyObserver;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        _this.destination = destinationOrNext;\n                        destinationOrNext.add(_this);\n                    }\n                    else {\n                        _this.syncErrorThrowable = true;\n                        _this.destination = new SafeSubscriber(_this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                _this.syncErrorThrowable = true;\n                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);\n                break;\n        }\n        return _this;\n    }\n    Subscriber.prototype[rxSubscriberSymbol] = function () { return this; };\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        this._parent = null;\n        this._parents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parent = _parent;\n        this._parents = _parents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar SafeSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        _this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = _this;\n        if (isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== emptyObserver) {\n                context = Object.create(observerOrNext);\n                if (isFunction(context.unsubscribe)) {\n                    _this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = _this.unsubscribe.bind(_this);\n            }\n        }\n        _this._context = context;\n        _this._next = next;\n        _this._error = error;\n        _this._complete = complete;\n        return _this;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;\n            if (this._error) {\n                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                if (useDeprecatedSynchronousErrorHandling) {\n                    throw err;\n                }\n                hostReportError(err);\n            }\n            else {\n                if (useDeprecatedSynchronousErrorHandling) {\n                    _parentSubscriber.syncErrorValue = err;\n                    _parentSubscriber.syncErrorThrown = true;\n                }\n                else {\n                    hostReportError(err);\n                }\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                throw err;\n            }\n            else {\n                hostReportError(err);\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        if (!config.useDeprecatedSynchronousErrorHandling) {\n            throw new Error('bad call');\n        }\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                parent.syncErrorValue = err;\n                parent.syncErrorThrown = true;\n                return true;\n            }\n            else {\n                hostReportError(err);\n                return true;\n            }\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\n//# sourceMappingURL=Subscriber.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var observable = typeof Symbol === 'function' && Symbol.observable || '@@observable';\n//# sourceMappingURL=observable.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function noop() { }\n//# sourceMappingURL=noop.js.map\n","/** PURE_IMPORTS_START _noop PURE_IMPORTS_END */\nimport { noop } from './noop';\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\nexport function pipeFromArray(fns) {\n    if (!fns) {\n        return noop;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map\n","/** PURE_IMPORTS_START _util_canReportError,_util_toSubscriber,_internal_symbol_observable,_util_pipe,_config PURE_IMPORTS_END */\nimport { canReportError } from './util/canReportError';\nimport { toSubscriber } from './util/toSubscriber';\nimport { observable as Symbol_observable } from '../internal/symbol/observable';\nimport { pipeFromArray } from './util/pipe';\nimport { config } from './config';\nvar Observable = /*@__PURE__*/ (function () {\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            sink.add(operator.call(sink, this.source));\n        }\n        else {\n            sink.add(this.source || (config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable) ?\n                this._subscribe(sink) :\n                this._trySubscribe(sink));\n        }\n        if (config.useDeprecatedSynchronousErrorHandling) {\n            if (sink.syncErrorThrowable) {\n                sink.syncErrorThrowable = false;\n                if (sink.syncErrorThrown) {\n                    throw sink.syncErrorValue;\n                }\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            if (config.useDeprecatedSynchronousErrorHandling) {\n                sink.syncErrorThrown = true;\n                sink.syncErrorValue = err;\n            }\n            if (canReportError(sink)) {\n                sink.error(err);\n            }\n            else {\n                console.warn(err);\n            }\n        }\n    };\n    Observable.prototype.forEach = function (next, promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                try {\n                    next(value);\n                }\n                catch (err) {\n                    reject(err);\n                    if (subscription) {\n                        subscription.unsubscribe();\n                    }\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        return source && source.subscribe(subscriber);\n    };\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipeFromArray(operations)(this);\n    };\n    Observable.prototype.toPromise = function (promiseCtor) {\n        var _this = this;\n        promiseCtor = getPromiseCtor(promiseCtor);\n        return new promiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\nexport { Observable };\nfunction getPromiseCtor(promiseCtor) {\n    if (!promiseCtor) {\n        promiseCtor = config.Promise || Promise;\n    }\n    if (!promiseCtor) {\n        throw new Error('no Promise impl found');\n    }\n    return promiseCtor;\n}\n//# sourceMappingURL=Observable.js.map\n","/** PURE_IMPORTS_START _Subscriber,_symbol_rxSubscriber,_Observer PURE_IMPORTS_END */\nimport { Subscriber } from '../Subscriber';\nimport { rxSubscriber as rxSubscriberSymbol } from '../symbol/rxSubscriber';\nimport { empty as emptyObserver } from '../Observer';\nexport function toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriberSymbol]) {\n            return nextOrObserver[rxSubscriberSymbol]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber(emptyObserver);\n    }\n    return new Subscriber(nextOrObserver, error, complete);\n}\n//# sourceMappingURL=toSubscriber.js.map\n","/** PURE_IMPORTS_START _Subscriber PURE_IMPORTS_END */\nimport { Subscriber } from '../Subscriber';\nexport function canReportError(observer) {\n    while (observer) {\n        var _a = observer, closed_1 = _a.closed, destination = _a.destination, isStopped = _a.isStopped;\n        if (closed_1 || isStopped) {\n            return false;\n        }\n        else if (destination && destination instanceof Subscriber) {\n            observer = destination;\n        }\n        else {\n            observer = null;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=canReportError.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isPromise(value) {\n    return !!value && typeof value.subscribe !== 'function' && typeof value.then === 'function';\n}\n//# sourceMappingURL=isPromise.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArrayLike = (function (x) { return x && typeof x.length === 'number' && typeof x !== 'function'; });\n//# sourceMappingURL=isArrayLike.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function getSymbolIterator() {\n    if (typeof Symbol !== 'function' || !Symbol.iterator) {\n        return '@@iterator';\n    }\n    return Symbol.iterator;\n}\nexport var iterator = /*@__PURE__*/ getSymbolIterator();\nexport var $$iterator = iterator;\n//# sourceMappingURL=iterator.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var subscribeToArray = function (array) {\n    return function (subscriber) {\n        for (var i = 0, len = array.length; i < len && !subscriber.closed; i++) {\n            subscriber.next(array[i]);\n        }\n        if (!subscriber.closed) {\n            subscriber.complete();\n        }\n    };\n};\n//# sourceMappingURL=subscribeToArray.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription,_util_subscribeToArray PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { subscribeToArray } from '../util/subscribeToArray';\nexport function fromArray(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToArray(input));\n    }\n    else {\n        return new Observable(function (subscriber) {\n            var sub = new Subscription();\n            var i = 0;\n            sub.add(scheduler.schedule(function () {\n                if (i === input.length) {\n                    subscriber.complete();\n                    return;\n                }\n                subscriber.next(input[i++]);\n                if (!subscriber.closed) {\n                    sub.add(this.schedule());\n                }\n            }));\n            return sub;\n        });\n    }\n}\n//# sourceMappingURL=fromArray.js.map\n","/** PURE_IMPORTS_START _hostReportError PURE_IMPORTS_END */\nimport { hostReportError } from './hostReportError';\nexport var subscribeToPromise = function (promise) {\n    return function (subscriber) {\n        promise.then(function (value) {\n            if (!subscriber.closed) {\n                subscriber.next(value);\n                subscriber.complete();\n            }\n        }, function (err) { return subscriber.error(err); })\n            .then(null, hostReportError);\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToPromise.js.map\n","/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nexport var subscribeToIterable = function (iterable) {\n    return function (subscriber) {\n        var iterator = iterable[Symbol_iterator]();\n        do {\n            var item = iterator.next();\n            if (item.done) {\n                subscriber.complete();\n                break;\n            }\n            subscriber.next(item.value);\n            if (subscriber.closed) {\n                break;\n            }\n        } while (true);\n        if (typeof iterator.return === 'function') {\n            subscriber.add(function () {\n                if (iterator.return) {\n                    iterator.return();\n                }\n            });\n        }\n        return subscriber;\n    };\n};\n//# sourceMappingURL=subscribeToIterable.js.map\n","/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeToObservable = function (obj) {\n    return function (subscriber) {\n        var obs = obj[Symbol_observable]();\n        if (typeof obs.subscribe !== 'function') {\n            throw new TypeError('Provided object does not correctly implement Symbol.observable');\n        }\n        else {\n            return obs.subscribe(subscriber);\n        }\n    };\n};\n//# sourceMappingURL=subscribeToObservable.js.map\n","/** PURE_IMPORTS_START _Observable,_subscribeToArray,_subscribeToPromise,_subscribeToIterable,_subscribeToObservable,_isArrayLike,_isPromise,_isObject,_symbol_iterator,_symbol_observable PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { subscribeToArray } from './subscribeToArray';\nimport { subscribeToPromise } from './subscribeToPromise';\nimport { subscribeToIterable } from './subscribeToIterable';\nimport { subscribeToObservable } from './subscribeToObservable';\nimport { isArrayLike } from './isArrayLike';\nimport { isPromise } from './isPromise';\nimport { isObject } from './isObject';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport var subscribeTo = function (result) {\n    if (result instanceof Observable) {\n        return function (subscriber) {\n            if (result._isScalar) {\n                subscriber.next(result.value);\n                subscriber.complete();\n                return undefined;\n            }\n            else {\n                return result.subscribe(subscriber);\n            }\n        };\n    }\n    else if (!!result && typeof result[Symbol_observable] === 'function') {\n        return subscribeToObservable(result);\n    }\n    else if (isArrayLike(result)) {\n        return subscribeToArray(result);\n    }\n    else if (isPromise(result)) {\n        return subscribeToPromise(result);\n    }\n    else if (!!result && typeof result[Symbol_iterator] === 'function') {\n        return subscribeToIterable(result);\n    }\n    else {\n        var value = isObject(result) ? 'an invalid object' : \"'\" + result + \"'\";\n        var msg = \"You provided \" + value + \" where a stream was expected.\"\n            + ' You can provide an Observable, Promise, Array, or Iterable.';\n        throw new TypeError(msg);\n    }\n};\n//# sourceMappingURL=subscribeTo.js.map\n","/** PURE_IMPORTS_START _Observable,_util_isPromise,_util_isArrayLike,_util_isInteropObservable,_util_isIterable,_fromArray,_fromPromise,_fromIterable,_fromObservable,_util_subscribeTo PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { isPromise } from '../util/isPromise';\nimport { isArrayLike } from '../util/isArrayLike';\nimport { isInteropObservable } from '../util/isInteropObservable';\nimport { isIterable } from '../util/isIterable';\nimport { fromArray } from './fromArray';\nimport { fromPromise } from './fromPromise';\nimport { fromIterable } from './fromIterable';\nimport { fromObservable } from './fromObservable';\nimport { subscribeTo } from '../util/subscribeTo';\nexport function from(input, scheduler) {\n    if (!scheduler) {\n        if (input instanceof Observable) {\n            return input;\n        }\n        return new Observable(subscribeTo(input));\n    }\n    if (input != null) {\n        if (isInteropObservable(input)) {\n            return fromObservable(input, scheduler);\n        }\n        else if (isPromise(input)) {\n            return fromPromise(input, scheduler);\n        }\n        else if (isArrayLike(input)) {\n            return fromArray(input, scheduler);\n        }\n        else if (isIterable(input) || typeof input === 'string') {\n            return fromIterable(input, scheduler);\n        }\n    }\n    throw new TypeError((input !== null && typeof input || input) + ' is not observable');\n}\n//# sourceMappingURL=from.js.map\n","/** PURE_IMPORTS_START _symbol_observable PURE_IMPORTS_END */\nimport { observable as Symbol_observable } from '../symbol/observable';\nexport function isInteropObservable(input) {\n    return input && typeof input[Symbol_observable] === 'function';\n}\n//# sourceMappingURL=isInteropObservable.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription,_symbol_observable,_util_subscribeToObservable PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { observable as Symbol_observable } from '../symbol/observable';\nimport { subscribeToObservable } from '../util/subscribeToObservable';\nexport function fromObservable(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToObservable(input));\n    }\n    else {\n        return new Observable(function (subscriber) {\n            var sub = new Subscription();\n            sub.add(scheduler.schedule(function () {\n                var observable = input[Symbol_observable]();\n                sub.add(observable.subscribe({\n                    next: function (value) { sub.add(scheduler.schedule(function () { return subscriber.next(value); })); },\n                    error: function (err) { sub.add(scheduler.schedule(function () { return subscriber.error(err); })); },\n                    complete: function () { sub.add(scheduler.schedule(function () { return subscriber.complete(); })); },\n                }));\n            }));\n            return sub;\n        });\n    }\n}\n//# sourceMappingURL=fromObservable.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription,_util_subscribeToPromise PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { subscribeToPromise } from '../util/subscribeToPromise';\nexport function fromPromise(input, scheduler) {\n    if (!scheduler) {\n        return new Observable(subscribeToPromise(input));\n    }\n    else {\n        return new Observable(function (subscriber) {\n            var sub = new Subscription();\n            sub.add(scheduler.schedule(function () {\n                return input.then(function (value) {\n                    sub.add(scheduler.schedule(function () {\n                        subscriber.next(value);\n                        sub.add(scheduler.schedule(function () { return subscriber.complete(); }));\n                    }));\n                }, function (err) {\n                    sub.add(scheduler.schedule(function () { return subscriber.error(err); }));\n                });\n            }));\n            return sub;\n        });\n    }\n}\n//# sourceMappingURL=fromPromise.js.map\n","/** PURE_IMPORTS_START _symbol_iterator PURE_IMPORTS_END */\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nexport function isIterable(input) {\n    return input && typeof input[Symbol_iterator] === 'function';\n}\n//# sourceMappingURL=isIterable.js.map\n","/** PURE_IMPORTS_START _Observable,_Subscription,_symbol_iterator,_util_subscribeToIterable PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { Subscription } from '../Subscription';\nimport { iterator as Symbol_iterator } from '../symbol/iterator';\nimport { subscribeToIterable } from '../util/subscribeToIterable';\nexport function fromIterable(input, scheduler) {\n    if (!input) {\n        throw new Error('Iterable cannot be null');\n    }\n    if (!scheduler) {\n        return new Observable(subscribeToIterable(input));\n    }\n    else {\n        return new Observable(function (subscriber) {\n            var sub = new Subscription();\n            var iterator;\n            sub.add(function () {\n                if (iterator && typeof iterator.return === 'function') {\n                    iterator.return();\n                }\n            });\n            sub.add(scheduler.schedule(function () {\n                iterator = input[Symbol_iterator]();\n                sub.add(scheduler.schedule(function () {\n                    if (subscriber.closed) {\n                        return;\n                    }\n                    var value;\n                    var done;\n                    try {\n                        var result = iterator.next();\n                        value = result.value;\n                        done = result.done;\n                    }\n                    catch (err) {\n                        subscriber.error(err);\n                        return;\n                    }\n                    if (done) {\n                        subscriber.complete();\n                    }\n                    else {\n                        subscriber.next(value);\n                        this.schedule();\n                    }\n                }));\n            }));\n            return sub;\n        });\n    }\n}\n//# sourceMappingURL=fromIterable.js.map\n","/** PURE_IMPORTS_START _Observable PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nexport var EMPTY = /*@__PURE__*/ new Observable(function (subscriber) { return subscriber.complete(); });\nexport function empty(scheduler) {\n    return scheduler ? emptyScheduled(scheduler) : EMPTY;\n}\nexport function emptyScheduled(scheduler) {\n    return new Observable(function (subscriber) { return scheduler.schedule(function () { return subscriber.complete(); }); });\n}\n//# sourceMappingURL=empty.js.map\n","/** PURE_IMPORTS_START _Observable,_from,_empty PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { from } from './from';\nimport { empty } from './empty';\nexport function defer(observableFactory) {\n    return new Observable(function (subscriber) {\n        var input;\n        try {\n            input = observableFactory();\n        }\n        catch (err) {\n            subscriber.error(err);\n            return undefined;\n        }\n        var source = input ? from(input) : empty();\n        return source.subscribe(subscriber);\n    });\n}\n//# sourceMappingURL=defer.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function map(project, thisArg) {\n    return function mapOperation(source) {\n        if (typeof project !== 'function') {\n            throw new TypeError('argument is not a function. Are you looking for `mapTo()`?');\n        }\n        return source.lift(new MapOperator(project, thisArg));\n    };\n}\nvar MapOperator = /*@__PURE__*/ (function () {\n    function MapOperator(project, thisArg) {\n        this.project = project;\n        this.thisArg = thisArg;\n    }\n    MapOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new MapSubscriber(subscriber, this.project, this.thisArg));\n    };\n    return MapOperator;\n}());\nexport { MapOperator };\nvar MapSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(MapSubscriber, _super);\n    function MapSubscriber(destination, project, thisArg) {\n        var _this = _super.call(this, destination) || this;\n        _this.project = project;\n        _this.count = 0;\n        _this.thisArg = thisArg || _this;\n        return _this;\n    }\n    MapSubscriber.prototype._next = function (value) {\n        var result;\n        try {\n            result = this.project.call(this.thisArg, value, this.count++);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.destination.next(result);\n    };\n    return MapSubscriber;\n}(Subscriber));\n//# sourceMappingURL=map.js.map\n","/** PURE_IMPORTS_START _Observable,_util_isArray,_util_isFunction,_operators_map PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { isArray } from '../util/isArray';\nimport { isFunction } from '../util/isFunction';\nimport { map } from '../operators/map';\nvar toString = Object.prototype.toString;\nexport function fromEvent(target, eventName, options, resultSelector) {\n    if (isFunction(options)) {\n        resultSelector = options;\n        options = undefined;\n    }\n    if (resultSelector) {\n        return fromEvent(target, eventName, options).pipe(map(function (args) { return isArray(args) ? resultSelector.apply(void 0, args) : resultSelector(args); }));\n    }\n    return new Observable(function (subscriber) {\n        function handler(e) {\n            if (arguments.length > 1) {\n                subscriber.next(Array.prototype.slice.call(arguments));\n            }\n            else {\n                subscriber.next(e);\n            }\n        }\n        setupSubscription(target, eventName, handler, subscriber, options);\n    });\n}\nfunction setupSubscription(sourceObj, eventName, handler, subscriber, options) {\n    var unsubscribe;\n    if (isEventTarget(sourceObj)) {\n        var source_1 = sourceObj;\n        sourceObj.addEventListener(eventName, handler, options);\n        unsubscribe = function () { return source_1.removeEventListener(eventName, handler, options); };\n    }\n    else if (isJQueryStyleEventEmitter(sourceObj)) {\n        var source_2 = sourceObj;\n        sourceObj.on(eventName, handler);\n        unsubscribe = function () { return source_2.off(eventName, handler); };\n    }\n    else if (isNodeStyleEventEmitter(sourceObj)) {\n        var source_3 = sourceObj;\n        sourceObj.addListener(eventName, handler);\n        unsubscribe = function () { return source_3.removeListener(eventName, handler); };\n    }\n    else if (sourceObj && sourceObj.length) {\n        for (var i = 0, len = sourceObj.length; i < len; i++) {\n            setupSubscription(sourceObj[i], eventName, handler, subscriber, options);\n        }\n    }\n    else {\n        throw new TypeError('Invalid event target');\n    }\n    subscriber.add(unsubscribe);\n}\nfunction isNodeStyleEventEmitter(sourceObj) {\n    return sourceObj && typeof sourceObj.addListener === 'function' && typeof sourceObj.removeListener === 'function';\n}\nfunction isJQueryStyleEventEmitter(sourceObj) {\n    return sourceObj && typeof sourceObj.on === 'function' && typeof sourceObj.off === 'function';\n}\nfunction isEventTarget(sourceObj) {\n    return sourceObj && typeof sourceObj.addEventListener === 'function' && typeof sourceObj.removeEventListener === 'function';\n}\n//# sourceMappingURL=fromEvent.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isScheduler(value) {\n    return value && typeof value.schedule === 'function';\n}\n//# sourceMappingURL=isScheduler.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar InnerSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(InnerSubscriber, _super);\n    function InnerSubscriber(parent, outerValue, outerIndex) {\n        var _this = _super.call(this) || this;\n        _this.parent = parent;\n        _this.outerValue = outerValue;\n        _this.outerIndex = outerIndex;\n        _this.index = 0;\n        return _this;\n    }\n    InnerSubscriber.prototype._next = function (value) {\n        this.parent.notifyNext(this.outerValue, value, this.outerIndex, this.index++, this);\n    };\n    InnerSubscriber.prototype._error = function (error) {\n        this.parent.notifyError(error, this);\n        this.unsubscribe();\n    };\n    InnerSubscriber.prototype._complete = function () {\n        this.parent.notifyComplete(this);\n        this.unsubscribe();\n    };\n    return InnerSubscriber;\n}(Subscriber));\nexport { InnerSubscriber };\n//# sourceMappingURL=InnerSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from './Subscriber';\nvar OuterSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(OuterSubscriber, _super);\n    function OuterSubscriber() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    OuterSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    OuterSubscriber.prototype.notifyError = function (error, innerSub) {\n        this.destination.error(error);\n    };\n    OuterSubscriber.prototype.notifyComplete = function (innerSub) {\n        this.destination.complete();\n    };\n    return OuterSubscriber;\n}(Subscriber));\nexport { OuterSubscriber };\n//# sourceMappingURL=OuterSubscriber.js.map\n","/** PURE_IMPORTS_START tslib,_util_subscribeToResult,_OuterSubscriber,_InnerSubscriber,_map,_observable_from PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { subscribeToResult } from '../util/subscribeToResult';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { map } from './map';\nimport { from } from '../observable/from';\nexport function mergeMap(project, resultSelector, concurrent) {\n    if (concurrent === void 0) {\n        concurrent = Number.POSITIVE_INFINITY;\n    }\n    if (typeof resultSelector === 'function') {\n        return function (source) { return source.pipe(mergeMap(function (a, i) { return from(project(a, i)).pipe(map(function (b, ii) { return resultSelector(a, b, i, ii); })); }, concurrent)); };\n    }\n    else if (typeof resultSelector === 'number') {\n        concurrent = resultSelector;\n    }\n    return function (source) { return source.lift(new MergeMapOperator(project, concurrent)); };\n}\nvar MergeMapOperator = /*@__PURE__*/ (function () {\n    function MergeMapOperator(project, concurrent) {\n        if (concurrent === void 0) {\n            concurrent = Number.POSITIVE_INFINITY;\n        }\n        this.project = project;\n        this.concurrent = concurrent;\n    }\n    MergeMapOperator.prototype.call = function (observer, source) {\n        return source.subscribe(new MergeMapSubscriber(observer, this.project, this.concurrent));\n    };\n    return MergeMapOperator;\n}());\nexport { MergeMapOperator };\nvar MergeMapSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(MergeMapSubscriber, _super);\n    function MergeMapSubscriber(destination, project, concurrent) {\n        if (concurrent === void 0) {\n            concurrent = Number.POSITIVE_INFINITY;\n        }\n        var _this = _super.call(this, destination) || this;\n        _this.project = project;\n        _this.concurrent = concurrent;\n        _this.hasCompleted = false;\n        _this.buffer = [];\n        _this.active = 0;\n        _this.index = 0;\n        return _this;\n    }\n    MergeMapSubscriber.prototype._next = function (value) {\n        if (this.active < this.concurrent) {\n            this._tryNext(value);\n        }\n        else {\n            this.buffer.push(value);\n        }\n    };\n    MergeMapSubscriber.prototype._tryNext = function (value) {\n        var result;\n        var index = this.index++;\n        try {\n            result = this.project(value, index);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        this.active++;\n        this._innerSub(result, value, index);\n    };\n    MergeMapSubscriber.prototype._innerSub = function (ish, value, index) {\n        var innerSubscriber = new InnerSubscriber(this, undefined, undefined);\n        var destination = this.destination;\n        destination.add(innerSubscriber);\n        subscribeToResult(this, ish, value, index, innerSubscriber);\n    };\n    MergeMapSubscriber.prototype._complete = function () {\n        this.hasCompleted = true;\n        if (this.active === 0 && this.buffer.length === 0) {\n            this.destination.complete();\n        }\n        this.unsubscribe();\n    };\n    MergeMapSubscriber.prototype.notifyNext = function (outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n        this.destination.next(innerValue);\n    };\n    MergeMapSubscriber.prototype.notifyComplete = function (innerSub) {\n        var buffer = this.buffer;\n        this.remove(innerSub);\n        this.active--;\n        if (buffer.length > 0) {\n            this._next(buffer.shift());\n        }\n        else if (this.active === 0 && this.hasCompleted) {\n            this.destination.complete();\n        }\n    };\n    return MergeMapSubscriber;\n}(OuterSubscriber));\nexport { MergeMapSubscriber };\n//# sourceMappingURL=mergeMap.js.map\n","/** PURE_IMPORTS_START _InnerSubscriber,_subscribeTo PURE_IMPORTS_END */\nimport { InnerSubscriber } from '../InnerSubscriber';\nimport { subscribeTo } from './subscribeTo';\nexport function subscribeToResult(outerSubscriber, result, outerValue, outerIndex, destination) {\n    if (destination === void 0) {\n        destination = new InnerSubscriber(outerSubscriber, outerValue, outerIndex);\n    }\n    if (destination.closed) {\n        return;\n    }\n    return subscribeTo(result)(destination);\n}\n//# sourceMappingURL=subscribeToResult.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function identity(x) {\n    return x;\n}\n//# sourceMappingURL=identity.js.map\n","/** PURE_IMPORTS_START _mergeMap,_util_identity PURE_IMPORTS_END */\nimport { mergeMap } from './mergeMap';\nimport { identity } from '../util/identity';\nexport function mergeAll(concurrent) {\n    if (concurrent === void 0) {\n        concurrent = Number.POSITIVE_INFINITY;\n    }\n    return mergeMap(identity, concurrent);\n}\n//# sourceMappingURL=mergeAll.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nfunction ArgumentOutOfRangeErrorImpl() {\n    Error.call(this);\n    this.message = 'argument out of range';\n    this.name = 'ArgumentOutOfRangeError';\n    return this;\n}\nArgumentOutOfRangeErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);\nexport var ArgumentOutOfRangeError = ArgumentOutOfRangeErrorImpl;\n//# sourceMappingURL=ArgumentOutOfRangeError.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber,_util_ArgumentOutOfRangeError,_observable_empty PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nimport { ArgumentOutOfRangeError } from '../util/ArgumentOutOfRangeError';\nimport { empty } from '../observable/empty';\nexport function take(count) {\n    return function (source) {\n        if (count === 0) {\n            return empty();\n        }\n        else {\n            return source.lift(new TakeOperator(count));\n        }\n    };\n}\nvar TakeOperator = /*@__PURE__*/ (function () {\n    function TakeOperator(total) {\n        this.total = total;\n        if (this.total < 0) {\n            throw new ArgumentOutOfRangeError;\n        }\n    }\n    TakeOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new TakeSubscriber(subscriber, this.total));\n    };\n    return TakeOperator;\n}());\nvar TakeSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(TakeSubscriber, _super);\n    function TakeSubscriber(destination, total) {\n        var _this = _super.call(this, destination) || this;\n        _this.total = total;\n        _this.count = 0;\n        return _this;\n    }\n    TakeSubscriber.prototype._next = function (value) {\n        var total = this.total;\n        var count = ++this.count;\n        if (count <= total) {\n            this.destination.next(value);\n            if (count === total) {\n                this.destination.complete();\n                this.unsubscribe();\n            }\n        }\n    };\n    return TakeSubscriber;\n}(Subscriber));\n//# sourceMappingURL=take.js.map\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { defer, fromEvent, merge } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport * as socketFactory from './socketFactory';\nconst asPayloadOrError = (response) => {\n    if (response.response === 'error') {\n        const errorPayload = response.payload;\n        const error = Error(errorPayload.reason);\n        error.code = errorPayload.code;\n        throw error;\n    }\n    return response.payload || {};\n};\nexport class SocketIoClient {\n    constructor(socket) {\n        this.socket = socket;\n    }\n    static async connect(server, dependencies = {}) {\n        const socketIo = (await socketFactory.create(server.getAddress(), dependencies));\n        return new SocketIoClient(socketIo);\n    }\n    request(request) {\n        return defer(() => {\n            const { endpoint } = request, requestData = __rest(request, [\"endpoint\"]);\n            const legacyRequest = Object.assign({ request: endpoint }, requestData);\n            const response = fromEvent(this.socket, request.id).pipe(take(1), map(asPayloadOrError));\n            this.socket.emit('message', legacyRequest);\n            return response;\n        });\n    }\n    getEvents() {\n        const fromSocketMethod = (eventName) => fromEvent(this.socket, eventName).pipe(map((payload) => ({ eventName, payload })));\n        return merge(fromSocketMethod('disconnect'), fromSocketMethod('feed'), fromSocketMethod('webrtc'), fromSocketMethod('destroyed'), fromSocketMethod('disconnected'), fromSocketMethod('participantAdded'), fromSocketMethod('participantRemoved'), fromSocketMethod('hold'), fromSocketMethod('unhold'), fromSocketMethod('openCompleted'));\n    }\n    disconnect() {\n        this.socket.disconnect();\n    }\n}\n","/** PURE_IMPORTS_START _Observable,_util_isScheduler,_operators_mergeAll,_fromArray PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { isScheduler } from '../util/isScheduler';\nimport { mergeAll } from '../operators/mergeAll';\nimport { fromArray } from './fromArray';\nexport function merge() {\n    var observables = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        observables[_i] = arguments[_i];\n    }\n    var concurrent = Number.POSITIVE_INFINITY;\n    var scheduler = null;\n    var last = observables[observables.length - 1];\n    if (isScheduler(last)) {\n        scheduler = observables.pop();\n        if (observables.length > 1 && typeof observables[observables.length - 1] === 'number') {\n            concurrent = observables.pop();\n        }\n    }\n    else if (typeof last === 'number') {\n        concurrent = observables.pop();\n    }\n    if (scheduler === null && observables.length === 1 && observables[0] instanceof Observable) {\n        return observables[0];\n    }\n    return mergeAll(concurrent)(fromArray(observables, scheduler));\n}\n//# sourceMappingURL=merge.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function filter(predicate, thisArg) {\n    return function filterOperatorFunction(source) {\n        return source.lift(new FilterOperator(predicate, thisArg));\n    };\n}\nvar FilterOperator = /*@__PURE__*/ (function () {\n    function FilterOperator(predicate, thisArg) {\n        this.predicate = predicate;\n        this.thisArg = thisArg;\n    }\n    FilterOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new FilterSubscriber(subscriber, this.predicate, this.thisArg));\n    };\n    return FilterOperator;\n}());\nvar FilterSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(FilterSubscriber, _super);\n    function FilterSubscriber(destination, predicate, thisArg) {\n        var _this = _super.call(this, destination) || this;\n        _this.predicate = predicate;\n        _this.thisArg = thisArg;\n        _this.count = 0;\n        return _this;\n    }\n    FilterSubscriber.prototype._next = function (value) {\n        var result;\n        try {\n            result = this.predicate.call(this.thisArg, value, this.count++);\n        }\n        catch (err) {\n            this.destination.error(err);\n            return;\n        }\n        if (result) {\n            this.destination.next(value);\n        }\n    };\n    return FilterSubscriber;\n}(Subscriber));\n//# sourceMappingURL=filter.js.map\n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nfunction ObjectUnsubscribedErrorImpl() {\n    Error.call(this);\n    this.message = 'object unsubscribed';\n    this.name = 'ObjectUnsubscribedError';\n    return this;\n}\nObjectUnsubscribedErrorImpl.prototype = /*@__PURE__*/ Object.create(Error.prototype);\nexport var ObjectUnsubscribedError = ObjectUnsubscribedErrorImpl;\n//# sourceMappingURL=ObjectUnsubscribedError.js.map\n","/** PURE_IMPORTS_START tslib,_Subscription PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscription } from './Subscription';\nvar SubjectSubscription = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SubjectSubscription, _super);\n    function SubjectSubscription(subject, subscriber) {\n        var _this = _super.call(this) || this;\n        _this.subject = subject;\n        _this.subscriber = subscriber;\n        _this.closed = false;\n        return _this;\n    }\n    SubjectSubscription.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        var subject = this.subject;\n        var observers = subject.observers;\n        this.subject = null;\n        if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n            return;\n        }\n        var subscriberIndex = observers.indexOf(this.subscriber);\n        if (subscriberIndex !== -1) {\n            observers.splice(subscriberIndex, 1);\n        }\n    };\n    return SubjectSubscription;\n}(Subscription));\nexport { SubjectSubscription };\n//# sourceMappingURL=SubjectSubscription.js.map\n","/** PURE_IMPORTS_START tslib,_Observable,_Subscriber,_Subscription,_util_ObjectUnsubscribedError,_SubjectSubscription,_internal_symbol_rxSubscriber PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Observable } from './Observable';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\nimport { rxSubscriber as rxSubscriberSymbol } from '../internal/symbol/rxSubscriber';\nvar SubjectSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(SubjectSubscriber, _super);\n    function SubjectSubscriber(destination) {\n        var _this = _super.call(this, destination) || this;\n        _this.destination = destination;\n        return _this;\n    }\n    return SubjectSubscriber;\n}(Subscriber));\nexport { SubjectSubscriber };\nvar Subject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(Subject, _super);\n    function Subject() {\n        var _this = _super.call(this) || this;\n        _this.observers = [];\n        _this.closed = false;\n        _this.isStopped = false;\n        _this.hasError = false;\n        _this.thrownError = null;\n        return _this;\n    }\n    Subject.prototype[rxSubscriberSymbol] = function () {\n        return new SubjectSubscriber(this);\n    };\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype.next = function (value) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        if (!this.isStopped) {\n            var observers = this.observers;\n            var len = observers.length;\n            var copy = observers.slice();\n            for (var i = 0; i < len; i++) {\n                copy[i].next(value);\n            }\n        }\n    };\n    Subject.prototype.error = function (err) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.hasError = true;\n        this.thrownError = err;\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].error(err);\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.complete = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].complete();\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = true;\n        this.closed = true;\n        this.observers = null;\n    };\n    Subject.prototype._trySubscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else {\n            return _super.prototype._trySubscribe.call(this, subscriber);\n        }\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else if (this.hasError) {\n            subscriber.error(this.thrownError);\n            return Subscription.EMPTY;\n        }\n        else if (this.isStopped) {\n            subscriber.complete();\n            return Subscription.EMPTY;\n        }\n        else {\n            this.observers.push(subscriber);\n            return new SubjectSubscription(this, subscriber);\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\nexport { Subject };\nvar AnonymousSubject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        var _this = _super.call(this) || this;\n        _this.destination = destination;\n        _this.source = source;\n        return _this;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var destination = this.destination;\n        if (destination && destination.next) {\n            destination.next(value);\n        }\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var destination = this.destination;\n        if (destination && destination.error) {\n            this.destination.error(err);\n        }\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var destination = this.destination;\n        if (destination && destination.complete) {\n            this.destination.complete();\n        }\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        if (source) {\n            return this.source.subscribe(subscriber);\n        }\n        else {\n            return Subscription.EMPTY;\n        }\n    };\n    return AnonymousSubject;\n}(Subject));\nexport { AnonymousSubject };\n//# sourceMappingURL=Subject.js.map\n","import ReconnectingWebSocket from 'reconnecting-websocket';\nimport { Subject } from 'rxjs';\nexport class WebSocketConnection {\n    constructor(socket, messages) {\n        this.socket = socket;\n        this.messages = messages;\n    }\n    static fromSocket(socket, messages) {\n        return new WebSocketConnection(socket, messages);\n    }\n    static async connect(address, socketFactory) {\n        const createSocket = socketFactory ||\n            ((addr) => new ReconnectingWebSocket(addr, WebSocketConnection.PROTOCOL));\n        const socket = createSocket(address);\n        return new Promise((res, rej) => {\n            const messages = new Subject();\n            socket.onopen = () => res(WebSocketConnection.fromSocket(socket, messages));\n            socket.onerror = () => rej(Error('Unable to connect'));\n            socket.onmessage = (e) => {\n                messages.next(JSON.parse(e.data));\n            };\n        });\n    }\n    send(payload) {\n        this.socket.send(JSON.stringify(payload));\n    }\n    getMessages() {\n        return this.messages.asObservable();\n    }\n    disconnect() {\n        this.socket.close();\n    }\n}\nWebSocketConnection.PROTOCOL = 'janus-protocol';\n","export const isValidResponse = (request) => (response) => typeof response.payload === 'object' &&\n    response.payload !== null &&\n    response.payload.id === request.id;\nexport const asLegacyResponse = (response) => {\n    var _a, _b;\n    const { payload } = response;\n    if (payload.endpoint === 'error') {\n        const error = Error(((_a = payload.payload) === null || _a === void 0 ? void 0 : _a.reason) || 'Error response received');\n        error.code = ((_b = payload.payload) === null || _b === void 0 ? void 0 : _b.code) || 1;\n        throw error;\n    }\n    return payload.payload || {};\n};\nexport const isValidEvent = (event) => event.type === 'event' &&\n    event.payload !== null &&\n    typeof event.payload === 'object' &&\n    typeof event.payload.eventName === 'string';\nexport const asLegacyEvent = (event) => event.payload;\n","import { defer } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\nimport { WebSocketConnection } from './WebSocketConnection';\nimport { asLegacyEvent, asLegacyResponse, isValidEvent, isValidResponse, } from './WebSocketWrapperApi';\nexport class WebSocketClient {\n    constructor(connection) {\n        this.connection = connection;\n    }\n    static async connect(server, dependencies = {}) {\n        const createWebSocket = (address) => new (dependencies.webSocketClient || WebSocket)(address, WebSocketConnection.PROTOCOL);\n        const connection = await WebSocketConnection.connect(server.getAddress(), createWebSocket);\n        return new WebSocketClient(connection);\n    }\n    request(request) {\n        return defer(() => {\n            const response = this.connection\n                .getMessages()\n                .pipe(filter(isValidResponse(request)), map(asLegacyResponse), take(1));\n            this.connection.send({ type: 'request', payload: request });\n            return response;\n        });\n    }\n    getEvents() {\n        return this.connection.getMessages().pipe(filter(isValidEvent), map(asLegacyEvent));\n    }\n    disconnect() {\n        this.connection.disconnect();\n    }\n}\n","import { ServerAddress } from './ServerAddress';\nimport { SocketIoClient } from './SocketIoClient';\nimport { WebSocketClient } from './WebSocketClient';\nexport class ClientFactory {\n    constructor(dependencies) {\n        this.dependencies = dependencies;\n    }\n    static from(dependencies) {\n        return new ClientFactory(dependencies);\n    }\n    async createClient(serverAddress) {\n        const parsedAddress = ServerAddress.fromUnknownAddress(serverAddress);\n        if (parsedAddress.getTransport() === ServerAddress.Transport.WEBSOCKET) {\n            return WebSocketClient.connect(parsedAddress, this.dependencies);\n        }\n        return SocketIoClient.connect(parsedAddress, this.dependencies);\n    }\n}\n","import { EventEmitter2 } from 'eventemitter2';\nimport * as log from 'js-logger';\nimport nanoid from 'nanoid';\nimport { ClientFactory } from './ClientFactory';\nclass ClientFacade {\n    constructor(dependencies) {\n        this.dependencies = dependencies;\n        this.clientEmitter = new EventEmitter2();\n    }\n    static of(dependencies = {}) {\n        return new ClientFacade(dependencies);\n    }\n    async init(server) {\n        if (this.client !== undefined) {\n            throw Error('already connected');\n        }\n        const clientFactory = ClientFactory.from(this.dependencies);\n        this.client = await clientFactory.createClient(server);\n        this.client\n            .getEvents()\n            .subscribe((e) => this.clientEmitter.emit(e.eventName, e.payload));\n    }\n    async uninit() {\n        if (this.client === undefined) {\n            throw Error('already disconnected');\n        }\n        this.client.disconnect();\n        this.client = undefined;\n    }\n    async send(endpoint, payload) {\n        if (this.client === undefined) {\n            throw new Error('not connected');\n        }\n        const request = { endpoint, payload, id: nanoid() };\n        log.debug('send message', request);\n        try {\n            const response = await this.client.request(request).toPromise();\n            log.debug(`received ${request.id} response`, response);\n            return response;\n        }\n        catch (e) {\n            log.error(`received ${request.id} error response: `, e.message);\n            throw e;\n        }\n    }\n    get emitter() {\n        return this.clientEmitter;\n    }\n    isConnected() {\n        return this.client !== undefined;\n    }\n}\nexport const Client = ClientFacade.of;\n","import baseGetTag from './_baseGetTag.js';\nimport isArray from './isArray.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nexport default isString;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseProperty from './_baseProperty.js';\n\n/**\n * Gets the size of an ASCII `string`.\n *\n * @private\n * @param {string} string The string inspect.\n * @returns {number} Returns the string size.\n */\nvar asciiSize = baseProperty('length');\n\nexport default asciiSize;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsZWJ = '\\\\u200d';\n\n/** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\nvar reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n/**\n * Checks if `string` contains Unicode symbols.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n */\nfunction hasUnicode(string) {\n  return reHasUnicode.test(string);\n}\n\nexport default hasUnicode;\n","/** Used to compose unicode character classes. */\nvar rsAstralRange = '\\\\ud800-\\\\udfff',\n    rsComboMarksRange = '\\\\u0300-\\\\u036f',\n    reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n    rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n    rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n    rsVarRange = '\\\\ufe0e\\\\ufe0f';\n\n/** Used to compose unicode capture groups. */\nvar rsAstral = '[' + rsAstralRange + ']',\n    rsCombo = '[' + rsComboRange + ']',\n    rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n    rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n    rsNonAstral = '[^' + rsAstralRange + ']',\n    rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n    rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n    rsZWJ = '\\\\u200d';\n\n/** Used to compose unicode regexes. */\nvar reOptMod = rsModifier + '?',\n    rsOptVar = '[' + rsVarRange + ']?',\n    rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n    rsSeq = rsOptVar + reOptMod + rsOptJoin,\n    rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n/** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\nvar reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n/**\n * Gets the size of a Unicode `string`.\n *\n * @private\n * @param {string} string The string inspect.\n * @returns {number} Returns the string size.\n */\nfunction unicodeSize(string) {\n  var result = reUnicode.lastIndex = 0;\n  while (reUnicode.test(string)) {\n    ++result;\n  }\n  return result;\n}\n\nexport default unicodeSize;\n","import asciiSize from './_asciiSize.js';\nimport hasUnicode from './_hasUnicode.js';\nimport unicodeSize from './_unicodeSize.js';\n\n/**\n * Gets the number of symbols in `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the string size.\n */\nfunction stringSize(string) {\n  return hasUnicode(string)\n    ? unicodeSize(string)\n    : asciiSize(string);\n}\n\nexport default stringSize;\n","import baseKeys from './_baseKeys.js';\nimport getTag from './_getTag.js';\nimport isArrayLike from './isArrayLike.js';\nimport isString from './isString.js';\nimport stringSize from './_stringSize.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/**\n * Gets the size of `collection` by returning its length for array-like\n * values or the number of own enumerable string keyed properties for objects.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object|string} collection The collection to inspect.\n * @returns {number} Returns the collection size.\n * @example\n *\n * _.size([1, 2, 3]);\n * // => 3\n *\n * _.size({ 'a': 1, 'b': 2 });\n * // => 2\n *\n * _.size('pebbles');\n * // => 7\n */\nfunction size(collection) {\n  if (collection == null) {\n    return 0;\n  }\n  if (isArrayLike(collection)) {\n    return isString(collection) ? stringSize(collection) : collection.length;\n  }\n  var tag = getTag(collection);\n  if (tag == mapTag || tag == setTag) {\n    return collection.size;\n  }\n  return baseKeys(collection).length;\n}\n\nexport default size;\n","function hasToUseMediaStreams(deps = {}) {\n    // We keep using media streams in cordova with the iosrtc plugin\n    return deps.window && deps.window.cordova && deps.window.cordova.platformId === 'ios';\n}\n;\n/**\n * This class provides same interface (at least methods/properties we currently use) of RTCPeerConnection.\n * It should be used when RTCPeerConnection methods do not return a Promise: IE and Safari\n * browser with Temasys plugin.\n */\nconst adapter = class RTCPeerConnectionAdapter {\n    constructor(config, constraints, RTCPeerConnection, deps = {}) {\n        this._pc = new RTCPeerConnection(config, constraints);\n        this.deps = deps;\n    }\n    close() {\n        return this._pc.close();\n    }\n    get signalingState() {\n        return this._pc.signalingState;\n    }\n    set onicecandidate(fn) {\n        this._pc.onicecandidate = fn;\n    }\n    set onaddstream(fn) {\n        this._pc.onaddstream = fn;\n    }\n    set ontrack(fn) {\n        this._pc.ontrack = fn;\n    }\n    set onremovestream(fn) {\n        this._pc.onremovestream = fn;\n    }\n    set onconnectionstatechange(fn) {\n        this._pc.onconnectionstatechange = fn;\n    }\n    addStream(stream) {\n        return this._pc.addStream(stream);\n    }\n    addTrack(track, stream) {\n        return this._pc.addTrack(track, stream);\n    }\n    remoteStreamHandlers(callback) {\n        if (hasToUseMediaStreams(this.deps)) {\n            this.onaddstream = (evt) => {\n                callback(evt.stream);\n            };\n            this.onremovestream = () => {\n                callback(null);\n            };\n        }\n        else {\n            this.ontrack = (evt) => {\n                const stream = evt.streams[0];\n                stream.onremovetrack = () => {\n                    callback(null);\n                };\n                callback(evt.streams[0]);\n            };\n        }\n    }\n    addStreamToPeerConnection(stream, track) {\n        if (hasToUseMediaStreams(this.deps)) {\n            this.addStream(stream);\n        }\n        else {\n            this.addTrack(track, stream);\n        }\n    }\n    createOffer(options) {\n        return new Promise((resolve, reject) => this._pc.createOffer(resolve, reject, options));\n    }\n    createAnswer(options) {\n        return new Promise((resolve, reject) => this._pc.createAnswer(resolve, reject, options));\n    }\n    setLocalDescription(description) {\n        return new Promise((resolve, reject) => this._pc.setLocalDescription(description, resolve, reject));\n    }\n    setRemoteDescription(description) {\n        return new Promise((resolve, reject) => this._pc.setRemoteDescription(description, resolve, reject));\n    }\n};\nexport { adapter as RTCPeerConnectionAdapter };\n","import * as log from 'js-logger';\nimport { pick, size } from 'lodash-es';\nimport { ConferenceMediaFeed } from '../conference-media/ConferenceMediaFeed';\nimport { RTCPeerConnectionAdapter } from '../RTCPeerConnectionAdapter';\nimport { checkRTCDependency } from '../utils';\nconst _room = Symbol('room');\nconst _constraints = Symbol('constraints');\nconst _pc = Symbol('pc');\n/**\n * Media publisher.\n * Used to manage local media sent to Janus server.\n * Due 3rd party restrictions only one constraint is supported\n * for a Publisher.\n *\n * @extends ConferenceMediaFeed\n */\nexport class Publisher extends ConferenceMediaFeed {\n    /**\n     * Create a new Publisher.\n     * Constraints format: constraints parameter is an object with next format\n     *  - audio: {Boolean} or {MediaTrackConstraints} defines if audio track should be enabled\n     *  - video: {Boolean} or {MediaTrackConstraints} defines if camera track should be enabled\n     *  - screen: {Boolean} or {MediaTrackConstraints} defines if screen track should be enabled\n     * @protected\n     * @param {string} feed associated user name.\n     * @param {object} constraints local constraints.\n     */\n    constructor(feed, room, constraints = {}, deps) {\n        super(feed);\n        constraints = pick(constraints, 'audio', 'video', 'screen');\n        if (size(constraints) > 1) {\n            throw new Error('only one constraint (audio,video,screen) is supported');\n        }\n        /**\n         * Janus wrapper room\n         * @private\n         */\n        this[_room] = room;\n        /**\n         * Published media types\n         * @private\n         * @type {object}\n         */\n        this[_constraints] = constraints;\n        /**\n         * Peer connection\n         * @private\n         * @type {RTCPeerConnection}\n         */\n        this[_pc] = null;\n        checkRTCDependency(deps, 'RTCPeerConnection');\n        checkRTCDependency(deps, 'RTCSessionDescription');\n        checkRTCDependency(deps, 'getUserMedia');\n        this.deps = deps;\n    }\n    /**\n     * Get configured constraints\n     * @type {object}\n     */\n    get constraints() {\n        return this[_constraints];\n    }\n    /**\n     * Indicate if publisher enables audio sharing\n     * @private\n     * @type {boolean}\n     */\n    get hasAudio() {\n        return !!this[_constraints].audio;\n    }\n    /**\n     * Indicate if publisher enables video sharing\n     * @private\n     * @type {boolean}\n     */\n    get hasVideo() {\n        return !!this[_constraints].video || !!this[_constraints].screen;\n    }\n    /**\n     * Medium used by Publisher\n     * @private\n     * @type {string}\n     */\n    get medium() {\n        return this.hasVideo ? 'sfuvideo' : 'sipcall';\n    }\n    /**\n     * Indicate if {Publisher} has been published.\n     * @type {boolean}\n     */\n    get published() {\n        return !!this[_pc] && this[_pc].signalingState === 'connected';\n    }\n    /**\n     * Update publisher bitrate.\n     * @param {number} bitrate in kbps.\n     * @return {Promise} resolved on success.\n     */\n    setBitrate(bitrate) {\n        return this[_room].api.media.bitrate(bitrate);\n    }\n    /**\n     * Mute published audio (local or remote).\n     * @param {boolean} muted should mute or unmute audio.\n     */\n    muteAudio(muted) {\n        if (!this.hasAudio) {\n            return;\n        }\n        if (this.localStream && this.localStream.stream) {\n            this.localStream.stream.getAudioTracks().forEach(track => track.enabled = !muted);\n        }\n        if (this.remoteStream && this.remoteStream.stream) {\n            this.remoteStream.stream.getAudioTracks().forEach(track => track.enabled = !muted);\n        }\n    }\n    /**\n     * Start publishing.\n     * This method requires configured media, creates RTCPeerConnection and interchanges\n     * messages with Janus wrapper server to establish multimedia conectivity.\n     * @return {Promise} resolved on success\n     */\n    publish() {\n        const constraints = this[_constraints];\n        if (!size(constraints)) {\n            return Promise.resolve();\n        }\n        return this.deps.getUserMedia(constraints).then((stream) => {\n            this.setLocalStream(stream, this.medium);\n            const track = stream.getTracks()[0];\n            const pcConfig = {\n                iceServers: this[_room].ice,\n            };\n            const pcConstraints = {\n                'optional': [\n                    { 'DtlsSrtpKeyAgreement': true },\n                ],\n            };\n            this[_pc] = new RTCPeerConnectionAdapter(pcConfig, pcConstraints, this.deps.RTCPeerConnection, this.deps);\n            this[_pc].onicecandidate = (evt) => {\n                this[_room].api.media.trickle(this.medium, evt.candidate);\n            };\n            this[_pc].remoteStreamHandlers((remoteStream) => this.setRemoteStream(remoteStream, this.medium));\n            this[_pc].onconnectionstatechange = () => {\n                if (this[_pc] && this[_pc].connectionState === 'closed') {\n                    this[_pc] = null;\n                }\n            };\n            this[_pc].addStreamToPeerConnection(stream, track);\n            return Promise.all([\n                this[_room].api.media.waitPublishComplete(this.medium),\n                this.createWebRTCConnection(),\n            ]);\n        }).catch((error) => {\n            log.error(error);\n            this.unpublish();\n            throw error;\n        });\n    }\n    async createWebRTCConnection() {\n        const { media: mediaApi } = this[_room].api;\n        const offer = await this[_pc].createOffer({\n            offerToReceiveAudio: this.hasAudio,\n            offerToReceiveVideo: this.hasVideo,\n        });\n        await this[_pc].setLocalDescription(offer);\n        const answer = await mediaApi.publish(this.medium, offer.sdp);\n        const remoteSdp = new this.deps.RTCSessionDescription(answer.jsep);\n        return this[_pc].setRemoteDescription(remoteSdp);\n    }\n    /**\n     * Stop publishing\n     * @return {Promise} resolved on success\n     */\n    unpublish() {\n        if (this.localStream) {\n            this.localStream.stream.getTracks().forEach(function (track) {\n                track.stop();\n            });\n            this.setLocalStream(null, this.medium);\n        }\n        if (this[_pc]) {\n            this[_pc].close();\n        }\n        return this[_room].api.media.unpublish(this.medium);\n    }\n}\n","import { isEqual, pick } from 'lodash-es';\nimport { ConferenceMediaList } from '../conference-media/ConferenceMediaList';\nimport { Publisher } from './Publisher';\nconst _room = Symbol('room');\nconst _mediatypes = Symbol('mediatypes');\n/**\n * Class that manage multiple local media publishers.\n * The main responsability is create and publish required Publisher\n * to satisfy desired mediatypes and unpublish those that are not\n * needed anymore.\n *\n * To a complete reference of 'mediatypes' structure see\n * getUserMediaWithMediatypes documentation.\n *\n * @extends ConferenceMediaList\n */\nexport class Publishers extends ConferenceMediaList {\n    /**\n     * Creates a new Publishers instance\n     */\n    constructor(room, deps) {\n        super();\n        /**\n         * Janus room\n         * @private\n         */\n        this[_room] = room;\n        /**\n         * Current mediatypes.\n         * Used internally to restore previous mediatypes when an update fails.\n         * Initialized to only audio to try requesting only audio by default if\n         * initial request can not be satisfied.\n         * @private\n         * @type {object}\n         */\n        this[_mediatypes] = {\n            audio: true,\n        };\n        this.deps = deps;\n    }\n    /**\n     * Current mediatypes.\n     * @type {object}\n     */\n    get mediatypes() {\n        return this[_mediatypes];\n    }\n    /**\n     * Update published mediatypes by creating and destroying managed\n     * Publisher instances.\n     * If an error is detected when Publisher list is updated previous state\n     * is recovered.\n     * @param {object} mediatypes new mediatypes to publish.\n     * @param {boolean} [restoreOnErrors=true] try to restore previous publishers on error\n     * @return {Promise} resolved on success\n     */\n    // @TODO: when an error occurs, it's needed to restore the publish\n    update(mediatypes = {}, restoreOnErrors = true) {\n        return Promise.resolve().then(() => {\n            if (mediatypes.video && mediatypes.screen) {\n                throw new Error('screen and camera can not be enabled at same time');\n            }\n            const remove = this._getUselessPublishers(mediatypes);\n            return Promise.all(remove.map((publisher) => this._removeItem(publisher)));\n        }).then(() => {\n            return this.getPublishersAndStartToPublish(mediatypes);\n        }).then(() => {\n            this[_mediatypes] = mediatypes;\n        }).catch((error) => {\n            // Prevent loops\n            if (mediatypes === this[_mediatypes] || !restoreOnErrors) {\n                throw error;\n            }\n            // Restore previous constraints\n            return this.update(this[_mediatypes]).then(() => {\n                throw error;\n            });\n        });\n    }\n    getPublishersAndStartToPublish(mediatypes) {\n        const add = this._getRequiredPublishers(mediatypes);\n        return Promise.all(add.map(p => this._addItem(p)));\n    }\n    unpublishAll() {\n        return Promise.all(this.items.map(publisher => this._removeItem(publisher)));\n    }\n    republishAllMediums() {\n        return this.getPublishersAndStartToPublish(this.mediatypes);\n    }\n    /**\n     * Return a list of those Publisher that are not needed to satisfy especified\n     * constraints.\n     * @private\n     * @param {object} constraints\n     * @return {Array<Publisher>} list of publisher not needed to update published\n     * media to especified constraints.\n     */\n    _getUselessPublishers(constraints) {\n        return this.items.filter((publisher) => {\n            return !!Object.keys(publisher.constraints).find((name) => {\n                return !isEqual(constraints[name], publisher.constraints[name]);\n            });\n        });\n    }\n    /**\n     * Create a list of Publisher that are needed to satisfy especified constraints.\n     * @private\n     * @param {object} constraints\n     * @return {Array<Publisher>} list of publisher needed to update published\n     * media to especified constraints.\n     */\n    _getRequiredPublishers(constraints) {\n        const add = [];\n        for (const name in constraints) {\n            const constraint = constraints[name];\n            if (!constraint) {\n                continue;\n            }\n            const isPublished = this.items.find((publisher) => {\n                return isEqual(publisher.constraints[name], constraint);\n            });\n            if (!isPublished) {\n                add.push(pick(constraints, name));\n            }\n        }\n        return add.map((constraint) => this.createPublisher(constraint));\n    }\n    createPublisher(constraint) {\n        const PublisherIF = this.deps.Publisher || Publisher;\n        return new PublisherIF(null, this[_room], constraint, this.deps);\n    }\n    /**\n     * @override\n     */\n    _addItem(publisher) {\n        super._addItem(publisher);\n        return publisher.publish().catch((error) => {\n            return this._removeItem(publisher).then(() => {\n                throw error;\n            }).catch(() => {\n                throw error;\n            });\n        });\n    }\n    /**\n     * @override\n     */\n    _removeItem(publisher) {\n        return publisher.unpublish().then(() => {\n            super._removeItem(publisher);\n        }).catch((error) => {\n            super._removeItem(publisher);\n            throw error;\n        });\n    }\n}\n","import * as log from 'js-logger';\nimport { ConferenceMediaFeed } from '../conference-media/ConferenceMediaFeed';\nimport { RTCPeerConnectionAdapter } from '../RTCPeerConnectionAdapter';\nimport { checkRTCDependency } from '../utils';\nconst _room = Symbol('room');\nconst _medium = Symbol('medium');\nconst _pc = Symbol('pc');\n/**\n * Media subscriber.\n * Used to manage remote media sent from Janus server.\n *\n * @extends ConferenceMediaFeed\n */\nexport class Subscriber extends ConferenceMediaFeed {\n    /**\n     * Create a new Subscriber.\n     * @protected\n     * @param {string} feed associated user name.\n     * @param {string} medium remote media type.\n     */\n    constructor(feed, room, medium = 'sfuvideo', deps = {}) {\n        super(feed);\n        /**\n         * Janus wrapper room\n         * @private\n         * @type {JanusRoom}\n         */\n        this[_room] = room;\n        /**\n         * Remote medium type\n         * @private\n         * @type {string}\n         */\n        this[_medium] = medium;\n        this.deps = deps;\n        checkRTCDependency(deps, 'RTCPeerConnection');\n        checkRTCDependency(deps, 'RTCSessionDescription');\n        checkRTCDependency(deps, 'MediaStream');\n    }\n    /**\n     * Check if this Subscriber has the same feed and medium\n     * properties.\n     * @param {string} feed subscribed user name.\n     * @param {string} medium remote medium type.\n     * @return {boolean} true if feed and medium properties matches.\n     */\n    provides(feed, medium) {\n        return this.feed === feed && this[_medium] === medium;\n    }\n    /**\n     * Check if this is an audio subscription\n     * @type {boolean}\n     */\n    get hasAudio() {\n        return this[_medium] === 'sipcall';\n    }\n    /**\n     * Indicate if {Subscriber} has been subscribed.\n     * @type {boolean}\n     */\n    get subscribed() {\n        return !!this[_pc] && this[_pc].connectionState === 'connected';\n    }\n    setRemoteStreamWithMedium(stream) {\n        return this.setRemoteStream(stream, this[_medium]);\n    }\n    /**\n     * Start subscription.\n     * This method creates RTCPeerConnection and interchanges\n     * messages with Janus wrapper server to establish multimedia conectivity.\n     * @return {Promise} resolved on success\n     */\n    subscribe() {\n        /* sip call media is received in local publisher as remote stream */\n        if (this.hasAudio) {\n            this.setRemoteStreamWithMedium(new this.deps.MediaStream());\n            return Promise.resolve();\n        }\n        return this[_room].api.media.subscribe(this[_medium], this.feed).then((response) => {\n            const pcConfig = {\n                iceServers: this[_room].ice,\n            };\n            const pcConstraints = {\n                'optional': [\n                    { 'DtlsSrtpKeyAgreement': true },\n                ],\n            };\n            this[_pc] = new RTCPeerConnectionAdapter(pcConfig, pcConstraints, this.deps.RTCPeerConnection, this.deps);\n            this[_pc].onicecandidate = (evt) => {\n                this[_room].api.media.trickle(this[_medium], evt.candidate, this.feed);\n            };\n            this[_pc].remoteStreamHandlers(this.setRemoteStreamWithMedium.bind(this));\n            this[_pc].onconnectionstatechange = () => {\n                if (this[_pc] && this[_pc].connectionState === 'closed') {\n                    this[_pc] = null;\n                }\n            };\n            return this[_pc].setRemoteDescription(new this.deps.RTCSessionDescription(response.jsep));\n        }).then(() => {\n            return this[_pc].createAnswer();\n        }).then((answer) => {\n            return this[_pc].setLocalDescription(answer).then(() => {\n                return this[_room].api.media.answer(this[_medium], this.feed, answer.sdp);\n            });\n        }).catch((error) => {\n            log.error('subscribe: got error', error);\n            this.unsubscribe();\n            throw error;\n        });\n    }\n    /**\n     * Stop subscription\n     * @return {Promise} resolved on success\n     */\n    unsubscribe() {\n        if (this[_medium] === 'sipcall') {\n            this.setRemoteStreamWithMedium(null);\n            return Promise.resolve();\n        }\n        if (this[_pc]) {\n            this[_pc].close();\n            this[_pc] = null;\n        }\n        this.setRemoteStreamWithMedium(null);\n        return this[_room].api.media.unsubscribe(this[_medium], this.feed);\n    }\n}\n","import { ConferenceMediaList } from '../conference-media/ConferenceMediaList';\nimport { Subscriber } from './Subscriber';\nconst _room = Symbol('room');\n/**\n * Class that manage multiple remote media subscriptions.\n * The main responsability is create and subscribe required Subscriber.\n *\n * @extends ConferenceMediaList\n */\nexport class Subscribers extends ConferenceMediaList {\n    /**\n     * Creates a new Subscribers instance\n     */\n    constructor(room, deps) {\n        super();\n        /**\n         * Janus room.\n         */\n        this[_room] = room;\n        this.deps = deps;\n    }\n    unsubscribeAll() {\n        return Promise.all(this.items.map(subscriber => this._removeItem(subscriber)));\n    }\n    /**\n     * Get an existing Subscriber with provided feed and medium.\n     * If Subscriber does not exist null is returned instead.\n     * @param {string} feed subscribed user name.\n     * @param {string} medium remote medium type.\n     * @return {Subscriber} managed Subscriber.\n     */\n    get(feed, medium) {\n        return this.items.find((item) => item.provides(feed, medium));\n    }\n    /**\n     * Subscribe to given feed.\n     * @throws {Error} if already subscribed or an error during subscription.\n     * @param {string} feed subscribed user name.\n     * @param {string} medium remote medium type.\n     * @return {Promise} resolved on success.\n     */\n    subscribe(feed, medium) {\n        if (this.get(feed, medium)) {\n            return Promise.reject(new Error('already subscribed'));\n        }\n        return this._addItem(this.createSubscriber(feed, medium));\n    }\n    /**\n     * Subscribe to multiple feeds\n     * @throws {Error} if already subscribed or an error during subscription.\n     * @param {Object[]} feeds\n     * @param {string} feeds.feed subscribed user name.\n     * @param {string} feeds.medium remote medium type.\n     * @return {Promise} resolved on success.\n     */\n    subscribeMany(feeds) {\n        const subscribe = feed => this.subscribe(feed.feed, feed.medium);\n        return this.isSubscribedToSome(feeds)\n            ? Promise.reject(new Error('already subscribed'))\n            : Promise.all(feeds.map(subscribe));\n    }\n    isSubscribedToSome(feeds) {\n        return (feeds.some(feed => !!this.get(feed.feed, feed.medium)));\n    }\n    createSubscriber(feed, medium) {\n        const SubscriberIF = this.deps.Subscriber || Subscriber;\n        return new SubscriberIF(feed, this[_room], medium, this.deps);\n    }\n    /**\n     * Unsubscribe from given feed.\n     * @throws {Error} if not subscribed or an error during unsubscription.\n     * @param {string} feed subscribed user name.\n     * @param {string} medium remote medium type.\n     * @return {Promise} resolved on success.\n     */\n    unsubscribe(feed, medium) {\n        const subscriber = this.get(feed, medium);\n        if (!subscriber) {\n            return Promise.reject(new Error('not subscribed'));\n        }\n        return this._removeItem(subscriber);\n    }\n    /**\n     * @override\n     */\n    _addItem(subscriber) {\n        super._addItem(subscriber);\n        return Promise.resolve().then(() => {\n            return subscriber.subscribe();\n        }).catch((error) => {\n            return this._removeItem(subscriber).then(() => {\n                throw error;\n            }).catch(() => {\n                throw error;\n            });\n        });\n    }\n    /**\n     * @override\n     */\n    _removeItem(subscriber) {\n        return Promise.resolve().then(() => {\n            return subscriber.unsubscribe();\n        }).then(() => {\n            super._removeItem(subscriber);\n        }).catch((error) => {\n            super._removeItem(subscriber);\n            throw error;\n        });\n    }\n}\n","import { EventEmitter2 } from 'eventemitter2';\nimport * as log from 'js-logger';\nimport { HoldAPI } from './api/HoldAPI';\nimport { LoginAPI } from './api/LoginAPI';\nimport { MediaAPI } from './api/MediaAPI';\nimport { UserAPI } from './api/UserAPI';\nimport { ConferenceMediaList } from './conference-media';\nimport { Client as ClientIO } from './connection/Client';\nimport { ConnectionEvents, ParticipantEvents } from './Constants';\nimport { BaseJanusFeedEventHandler } from './janus-feeds/BaseJanusFeedEventHandler';\nimport { Publishers } from './publishers/Publishers';\nimport { Subscribers } from './subscribers/Subscribers';\nimport { bindMethods } from './utils';\nconst _ice = Symbol('ice');\nconst _loggedIn = Symbol('loggedIn');\nconst _media = Symbol('media');\nconst _publishers = Symbol('publishers');\nconst _room = Symbol('room');\nconst _server = Symbol('server');\nconst _subscribers = Symbol('subscribers');\nconst _token = Symbol('token');\nconst _username = Symbol('username');\n/**\n * Janus room.\n *\n * @fires CONNECTED\n * @fires CONNECTION_CLOSED\n * @fires PARTICIPANT_ADDED\n * @fires PARTICIPANT_REMOVED\n *\n */\nexport class Room {\n    /**\n     * Creates a new Janus Wrapper client.\n     * @param {Object} params\n     * @param {string} params.server Wrapper URL.\n     * @param {string} params.username user name to register.\n     * @param {string} params.room room identifier to enter.\n     * @param {string} params.token room's access token.\n     * @param {Array<object>} params.ice ice server list.\n     * @param {object} params.deps object with dependencies\n     */\n    constructor({ server, username, room, token, ice, deps = {} } = {}) {\n        /**\n         * Server address.\n         * @private\n         * @type {string}\n         */\n        this[_server] = server;\n        /**\n         * Registered username.\n         * @private\n         * @type {string}\n         */\n        this[_username] = username;\n        /**\n         * Room identifier.\n         * @private\n         * @type {string}\n         */\n        this[_room] = room;\n        /**\n         * Room's access token.\n         * @private\n         * @type {string}\n         */\n        this[_token] = token;\n        /**\n         * Conference ice servers\n         * @private\n         * @type {Array<object>}\n         */\n        this[_ice] = ice;\n        /**\n         * A login attempt succeded.\n         * @private\n         * @type {boolean}\n         */\n        this[_loggedIn] = false;\n        const createClient = deps.Client || ClientIO;\n        this.client = createClient(deps);\n        /**\n         * Server methods.\n         * @private\n         * @type {object}\n         * @property {LoginAPI} session login/logout methods.\n         * @property {MediaAPI} media media publish/subscription methods.\n         * @property {UserAPI} user participants-related methods.\n         * @property {HoldAPI} hold hold-related methods\n         */\n        this.api = {\n            session: new LoginAPI(this.client),\n            media: new MediaAPI(this.client),\n            user: new UserAPI(this.client),\n            hold: new HoldAPI(this.client),\n        };\n        /**\n         * Local media publishers.\n         * @private\n         * @type {Publishers}\n         */\n        const createPublishers = () => {\n            if (deps.Publishers) {\n                return new (deps.Publishers)(this, deps);\n            }\n            else {\n                return new Publishers(this, deps);\n            }\n        };\n        this[_publishers] = createPublishers();\n        /**\n         * Remote media subscribers.\n         * @private\n         * @type {Subscribers}\n         */\n        const createSubscribers = () => {\n            if (deps.Subscribers) {\n                return new (deps.Subscribers)(this, deps);\n            }\n            else {\n                return new Subscribers(this, deps);\n            }\n        };\n        this[_subscribers] = createSubscribers(this, deps);\n        const createConferenceMediaList = () => {\n            if (deps.conferenceMediaList) {\n                return deps.conferenceMediaList;\n            }\n            return new ConferenceMediaList();\n        };\n        this[_media] = createConferenceMediaList();\n        this[_media]._addItem(this[_publishers]);\n        this[_media]._addItem(this[_subscribers]);\n        const createJanusFeedHandler = () => {\n            if (deps.janusFeedHandler) {\n                return deps.janusFeedHandler;\n            }\n            return BaseJanusFeedEventHandler(this[_subscribers]);\n        };\n        this.janusFeedHandler = createJanusFeedHandler();\n        this.emitter = new EventEmitter2();\n        bindMethods(this, [\n            'onDisconnect',\n            'onJanusFeed',\n            'onJanusWebRTC',\n            'onJanusDisconnected',\n            'onJanusDestroyed',\n            'onParticipantAdded',\n            'onParticipantRemoved',\n        ]);\n    }\n    getPublishers() {\n        return this[_publishers];\n    }\n    getSubscribers() {\n        return this[_subscribers];\n    }\n    /**\n     * Configured ICE server list\n     * @type {Array<object>}\n     */\n    get ice() {\n        return this[_ice];\n    }\n    /**\n     * Initialize Janus connection and login.\n     * @throws {Error} when already connected or connection fails.\n     * @return {Promise} resolved on success.\n     */\n    init() {\n        return Promise.resolve().then(() => {\n            return this.client.init(this[_server]);\n        }).then(() => {\n            this.onConnect();\n            return this.api.session.login(this[_username], this[_room], this[_token]);\n        }).then(() => {\n            this[_loggedIn] = true;\n            return this;\n        }).catch((error) => {\n            return this.uninit().then(() => {\n                throw error;\n            });\n        });\n    }\n    /**\n     * Logout, stop any publisher and close Janus connection.\n     * @return {Promise} resolved on success\n     */\n    async uninit() {\n        if (!this[_loggedIn]) {\n            return;\n        }\n        this[_loggedIn] = false;\n        this.client.emitter.removeAllListeners();\n        await this[_publishers].unpublishAll();\n        await this[_subscribers].unsubscribeAll();\n        try {\n            await this.api.session.logout();\n        }\n        catch (error) {\n            log.error(`Wrapper stack unable to logout`);\n        }\n        await this.client.uninit();\n        this.emitter.emit(ConnectionEvents.CONNECTION_CLOSED);\n    }\n    /**\n     * Conference media\n     * @type {ConferenceMediaList}\n     */\n    get media() {\n        return this[_media];\n    }\n    /**\n     * Current mediatypes.\n     * @type {object}\n     */\n    get mediatypes() {\n        return this[_publishers].mediatypes;\n    }\n    /**\n     * Update local media types.\n     * @param {object} mediatypes required mediatypes.\n     * @return {Promise} resolved on success.\n     */\n    update(mediatypes = {}) {\n        return this[_publishers].update(mediatypes);\n    }\n    /**\n     * Retrieve the participants in the room\n     */\n    getParticipants() {\n        log.debug('getParticipants');\n        return this.api.user.getAll();\n    }\n    /**\n     * Callback called when connection with Janus server is established.\n     * @private\n     */\n    onConnect() {\n        log.debug('connection created');\n        this.client.emitter.on('disconnect', this.onDisconnect);\n        this.client.emitter.on('feed', this.onJanusFeed);\n        this.client.emitter.on('webrtc', this.onJanusWebRTC);\n        this.client.emitter.on('destroyed', this.onJanusDestroyed);\n        this.client.emitter.on('disconnected', this.onJanusDisconnected);\n        this.client.emitter.on('participantAdded', this.onParticipantAdded);\n        this.client.emitter.on('participantRemoved', this.onParticipantRemoved);\n        this.emitter.emit(ConnectionEvents.CONNECTED);\n    }\n    /**\n     * Callback called when connection with Janus server is closed.\n     * @private\n     */\n    onDisconnect() {\n        log.debug('connection closed');\n        if (this.client.isConnected()) {\n            this.client.emitter.removeAllListeners();\n            return this.client.uninit();\n        }\n    }\n    onJanusFeed(feed) {\n        this.janusFeedHandler.onJanusFeed(this, feed);\n    }\n    /**\n     * Wrapper notifies this event when a PeerConnection from this user\n     * just became active or was just closed from the Janus perspective.\n     * @private\n     * @param {object} data event payload.\n     */\n    onJanusWebRTC(data) {\n        log.info('janus webrtc >> ', data);\n    }\n    /**\n     * Wrapper notifies this event when the room has been destroyed.\n     * @private\n     * @param {object} data event payload.\n     */\n    onJanusDestroyed(data) {\n        log.info('janus destroyed >> ', data);\n        this.uninit();\n    }\n    /**\n     * Wrapper notifies this event when the janus instane was lost.\n     * @private\n     * @param {object} data event payload.\n     */\n    onJanusDisconnected(data) {\n        log.info('janus disconnected >> ', data);\n        this.uninit();\n    }\n    onParticipantAdded(data) {\n        log.info('janus participant added >> ', data);\n        this.emitter.emit(ParticipantEvents.PARTICIPANT_ADDED, data);\n    }\n    onParticipantRemoved(data) {\n        log.info('janus participant removed >> ', data);\n        this.emitter.emit(ParticipantEvents.PARTICIPANT_REMOVED, data.user);\n    }\n}\n","import { HoldableConferenceMediaList, HoldableRoom, HoldState } from './hold';\nimport { BaseJanusFeedEventHandler, HoldableJanusFeedEventHandler } from './janus-feeds';\nimport { Room } from './Room';\nexport function JanusHoldableRoom(args) {\n    const holdState = HoldState();\n    const conferenceMediaList = HoldableConferenceMediaList(holdState.heldParticipants);\n    const baseJanusFeedHandler = BaseJanusFeedEventHandler();\n    const janusFeedHandler = HoldableJanusFeedEventHandler(holdState, baseJanusFeedHandler);\n    const room = new Room(Object.assign({}, args, {\n        deps: Object.assign({}, args.deps, {\n            conferenceMediaList,\n            janusFeedHandler,\n        }),\n    }));\n    const holdeableRoom = HoldableRoom(room, holdState);\n    return holdeableRoom;\n}\n","import { HeldParticipantsState } from './HeldParticipantsState';\nimport { HeldSubscriptionsState } from './HeldSubscriptionsState';\nexport function HoldState() {\n    let isHolding = false;\n    const savedSubscriptions = HeldSubscriptionsState();\n    const heldParticipants = HeldParticipantsState();\n    return {\n        hold() {\n            isHolding = true;\n        },\n        unhold() {\n            isHolding = false;\n        },\n        isHolding() {\n            return isHolding;\n        },\n        savedSubscriptions,\n        heldParticipants,\n    };\n}\n;\n","export function HeldSubscriptionsState() {\n    let savedSubscriptions = [];\n    const isDifferentFeed = feed1 => feed2 => (feed1.feed !== feed2.feed) ||\n        (feed1.medium !== feed2.medium);\n    return {\n        saveSubscription({ feed, medium }) {\n            savedSubscriptions.push({ feed, medium });\n        },\n        getSavedSubscriptions() {\n            return savedSubscriptions;\n        },\n        removeSubscription(feed) {\n            savedSubscriptions = savedSubscriptions.filter(isDifferentFeed(feed));\n        },\n        isStored({ feed, medium }) {\n            return savedSubscriptions.some(feedStored => feedStored.feed === feed && feedStored.medium === medium);\n        }\n    };\n}\n;\n","export function HeldParticipantsState() {\n    let participants = [];\n    const isOnHold = (user) => participants.includes(user);\n    return {\n        isOnHold,\n        addParticipant(user) {\n            if (isOnHold(user)) {\n                return;\n            }\n            participants.push(user);\n        },\n        removeParticipant(user) {\n            const isDifferentUser = u1 => u2 => u1 !== u2;\n            participants = participants.filter(isDifferentUser(user));\n        },\n        participants() {\n            return participants;\n        }\n    };\n}\n","import { JANUS_EVENTS } from './JanusEvents';\nexport function HoldableJanusFeedEventHandler(holdState, baseFeed) {\n    const onJanusFeed = (room, feedEvent) => {\n        processFeed(feedEvent);\n        return holdState.isHolding()\n            ? Promise.resolve()\n            : baseFeed.onJanusFeed(room, feedEvent);\n    };\n    const processFeed = (feedEvent) => {\n        const { event } = feedEvent;\n        switch (event) {\n            case JANUS_EVENTS.JANUS_FEED_NEW:\n                holdState.savedSubscriptions.saveSubscription(feedEvent.feed);\n                break;\n            case JANUS_EVENTS.JANUS_FEED_GONE:\n                holdState.savedSubscriptions.removeSubscription(feedEvent.feed);\n                break;\n        }\n    };\n    return {\n        onJanusFeed,\n    };\n}\n","import { HOLD_MESSAGE_TYPES } from '../api/HoldAPI';\nimport { ParticipantEvents, ParticipantStatus } from '../Constants';\nimport { createRoomInterface } from '../RoomInterface';\nexport function HoldableRoom(room, holdState) {\n    const publishers = room.getPublishers();\n    const subscribers = room.getSubscribers();\n    const { hold: apiHold } = room.api;\n    const { heldParticipants, savedSubscriptions } = holdState;\n    apiHold.emitter.on(HOLD_MESSAGE_TYPES.HOLD, (eventData) => {\n        heldParticipants.addParticipant(eventData.user);\n        room.emitter.emit(ParticipantEvents.PARTICIPANT_HOLD, eventData.user);\n    });\n    apiHold.emitter.on(HOLD_MESSAGE_TYPES.UNHOLD, (eventData) => {\n        heldParticipants.removeParticipant(eventData.user);\n        room.emitter.emit(ParticipantEvents.PARTICIPANT_UNHOLD, eventData.user);\n    });\n    const isOnHold = () => holdState.isHolding();\n    const hold = async () => {\n        if (holdState.isHolding()) {\n            throw new Error('Can not hold, already held');\n        }\n        if (publishers.items.length == 0) {\n            throw new Error('Can not hold, not publishing');\n        }\n        await apiHold.hold();\n        await publishers.unpublishAll();\n        await subscribers.unsubscribeAll();\n        holdState.hold();\n    };\n    const unhold = async () => {\n        if (!holdState.isHolding()) {\n            throw new Error('Can not unhold, not holding');\n        }\n        return publishers.republishAllMediums()\n            .then(() => subscribers.subscribeMany(savedSubscriptions.getSavedSubscriptions()))\n            .then(() => apiHold.unhold())\n            .then(() => holdState.unhold());\n    };\n    const uninit = async () => {\n        if (holdState.isHolding()) {\n            await apiHold.unhold();\n            holdState.unhold();\n        }\n        return room.uninit();\n    };\n    const getParticipants = async () => {\n        const participants = await room.getParticipants();\n        const participantsOnHold = participants.filter(isParticipantInHold);\n        participantsOnHold.forEach(({ user }) => heldParticipants.addParticipant(user));\n        return participants;\n    };\n    const isParticipantInHold = ({ status }) => status === ParticipantStatus.PARTICIPANT_ON_HOLD;\n    return Object.assign(createRoomInterface(room), {\n        hold,\n        unhold,\n        uninit,\n        isOnHold,\n        getParticipants,\n    });\n}\n;\n","const RoomInterface = room => ({\n    getPublishers() {\n        return room.getPublishers();\n    },\n    getParticipants() {\n        return room.getParticipants();\n    },\n    getSubscribers() {\n        return room.getSubscribers();\n    },\n    init() {\n        return room.init();\n    },\n    uninit() {\n        return room.uninit();\n    },\n    update(mediatypes = {}) {\n        return room.update(mediatypes);\n    },\n    get media() {\n        return room.media;\n    },\n    get mediatypes() {\n        return room.mediatypes;\n    },\n    get ice() {\n        return room.ice;\n    },\n    get emitter() {\n        return room.emitter;\n    },\n    get api() {\n        return room.api;\n    }\n});\nexport const createRoomInterface = room => RoomInterface(room);\n","import ExtendableError from 'es6-error';\n\n/**\n * Error returned by signaling server.\n * Message includes the error code returned by signaling server.\n */\nexport class ErrorResponse extends ExtendableError {\n\tconstructor(message = 500) {\n\t\tsuper(message);\n\t}\n}\n","interface Constraints {\n\taudio?: MediaTrackConstraints | boolean;\n\tvideo?: MediaTrackConstraints | boolean;\n\tscreen?: MediaTrackConstraints | boolean;\n}\n\n/**\n * Stop a {MediaStream} by calling 'stop' method on every track.\n *\n * @param {MediaStream} stream stream to stop\n * @return {void}\n */\nexport function stopStream(stream: MediaStream): void {\n\tstream.getTracks().forEach(track => track.stop());\n}\n\nfunction promiseWithTimeout<T>(promise: Promise<T>, timeout: number): Promise<T> {\n\tconst timeoutPromise: Promise<any> = new Promise((resolve, reject) => {\n\t\tsetTimeout(() => {\n\t\t\treject(`${promise} timed out after ${timeout} ms`);\n\t\t}, timeout);\n\t});\n\n\t// Returns a race between our timeout and the passed in promise\n\treturn Promise.race([promise, timeoutPromise]);\n}\n\nfunction getUserMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n\treturn promiseWithTimeout(navigator.mediaDevices.getUserMedia(constraints), 60000);\n}\n\nasync function getDisplayMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n\t// @ts-ignore\n\tif (window.desktopCapturer) {\n\t\t// @ts-ignore\n\t\tconst [source] = await window.desktopCapturer.getSources({types: ['screen']});\n\t\treturn getUserMedia({video: {mandatory: {\n\t\t\tchromeMediaSource: 'desktop',\n\t\t\tchromeMediaSourceId: source.id,\n\t\t}} as unknown as MediaTrackConstraints});\n\n\t}\n\t// @ts-ignore https://github.com/microsoft/TypeScript/issues/33232\n\tif (navigator.mediaDevices && typeof navigator.mediaDevices.getDisplayMedia === 'function') {\n\t\t// @ts-ignore https://github.com/microsoft/TypeScript/issues/33232\n\t\treturn promiseWithTimeout(navigator.mediaDevices.getDisplayMedia(constraints), 10000);\n\t}\n\tthrow Error('Browser does not support screensharing');\n}\n\n\n/**\n * Method that returns a {MediaStream} based on constraints provided\n * This method is needed for screen sharing when an unique stream that\n * contains audio, video and screen tracks must be obtained. Current implementation\n * has some limitations:\n *  - Require two video tracks (camera and screen) is not supported\n *  - Screen sharing is only supported on Chrome >= 72, Firefox >= 66 and Edge >= 17\n *\n * @param {Constraints} constraints audio camera and screen constraints\n * @return {Promise<MediaStream>} media stream with desired tracks\n */\nexport async function getUserMediaWithMediatypes(constraints: Constraints = {}): Promise<MediaStream> {\n\tconst audio = constraints.audio || false;\n\tconst video = constraints.video || false;\n\tconst screen = constraints.screen || false;\n\tif (!(audio || video || screen)) {\n\t\tthrow Error('At least one of audio, video or screen must be requested');\n\t}\n\tif (video && screen) {\n\t\tthrow Error('video and screen cannot be both true at the same time');\n\t}\n\n\tif (!screen) {\n\t\treturn getUserMedia({audio, video});\n\t}\n\tif (!audio) {\n\t\treturn getDisplayMedia({video: screen});\n\t}\n\tconst audioStream = await getUserMedia({audio});\n\tconst screenStream = await getDisplayMedia({video: screen});\n\treturn new MediaStream([...screenStream.getTracks(), ...audioStream.getTracks()]);\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport nanoid from 'nanoid';\nimport {\n\tJanusRoom,\n\tConnectionEvents,\n\tParticipantEvents,\n\tConferenceMediaFeed,\n\tServerAddress,\n} from '@quobis/wrapper-stack';\n\nimport {bindMethods} from '../../../utils';\nimport {ErrorResponse} from './signaling/errors';\nimport {\n\tParticipantEvents as ConferenceParticipantEvents,\n\tStreamChangeEvents as ConferenceStreamChangeEvents,\n} from '../ConferenceEvents';\nimport Logs from '../../../Logs';\nimport {getUserMediaWithMediatypes} from '../Media';\n\nconst log = Logs.instance.getLogger('SippoJS/Janus/Conference');\n\nconst {\n\tSTREAM_ADDED,\n\tSTREAM_REMOVED,\n} = ConferenceMediaFeed;\n\n\nconst asLocalStream = ({feed, stream}) =>\n\t({stream, participant: feed});\n\nconst asRemoteStream = ({feed, stream, reason}) =>\n\t({stream, reason, participant: feed});\n\n/**\n * Updated conference event.\n * Fired when a conference where user participates is updated.\n * @event UPDATED_CONFERENCE_EVENT\n * @type {object}\n */\nexport const UPDATED_CONFERENCE_EVENT = 'conference-updated';\n\n/**\n * Destroyed conference event.\n * Fired when user leaves a conference.\n * @event DESTROYED_CONFERENCE_EVENT\n * @type {object}\n */\nexport const DESTROYED_CONFERENCE_EVENT = 'conference-destroyed';\n\n/**\n * Expel conference event.\n * Fired when conference is detroyed by other user.\n * @event EXPEL_CONFERENCE_EVENT\n * @type {object}\n */\nexport const EXPEL_CONFERENCE_EVENT = 'expelled';\n\n/**\n * Local streams changed event.\n * Fired when local streams changes.\n * @event LOCAL_STREAM_CHANGED\n * @type {object}\n * @property {Array<MediaStream>} streams current local streams.\n */\nexport const LOCAL_STREAM_CHANGED = ConferenceStreamChangeEvents.LOCAL_STREAM_CHANGED;\n\n/**\n * New local stream event.\n * Fired when a new local stream arrives\n * @event LOCAL_STREAM_ADDED\n * @type {object}\n * @property {string} participant gatewayUsername of the stream owner\n * @property {MediaStream} stream new local stream\n */\nexport const LOCAL_STREAM_ADDED = ConferenceStreamChangeEvents.LOCAL_STREAM_ADDED;\n\n/**\n * Local stream gone event\n * Fired when a local stream stops being available\n * @event LOCAL_STREAM_REMOVED\n * @type {object}\n * @property {string} participant gatewayUsername of the stream owner\n * @property {MediaStream} stream removed local stream\n */\nexport const LOCAL_STREAM_REMOVED = ConferenceStreamChangeEvents.LOCAL_STREAM_REMOVED;\n\n/**\n * Remote streams changes event.\n * Fired when streams associated with a remote peer changes.\n * @event REMOTE_STREAM_CHANGED\n * @type {object}\n * @property {string} participant user name of remote peer.\n * @property {Array<MediaStream>} streams current local streams.\n */\nexport const REMOTE_STREAM_CHANGED = ConferenceStreamChangeEvents.REMOTE_STREAM_CHANGED;\n\n/**\n * Remote streams added event\n * Fired when a new remote stream arrives\n * @event REMOTE_STREAM_ADDED\n * @type {object}\n * @property {string} participant user name of remote peer.\n * @property {MediaStream} streams new remote stream\n * @property {string} [reason='NEW'|'UNHOLD'] reason of stream addition\n */\nexport const REMOTE_STREAM_ADDED = ConferenceStreamChangeEvents.REMOTE_STREAM_ADDED;\n\n/**\n * Remote streams remove event\n * Fired when a new remote stops being available\n * @event REMOTE_STREAM_REMOVED\n * @type {object}\n * @property {string} participant user name of remote peer.\n * @property {MediaStream} streams removed stream\n * @property {string} [reason='GONE'|'HOLD'] reason of stream removal\n */\nexport const REMOTE_STREAM_REMOVED = ConferenceStreamChangeEvents.REMOTE_STREAM_REMOVED;\n\n/**\n * Fired when the user has to invite to other participant\n * to implement an unattended call transfer\n * @event TRANSFERING_CALL\n * @type {object}\n * @property {string} to username to send an invitation to\n * @property {string} callTransferID identifier of\n * an unattended call transfer.\n * @property {string} roomId identifier of a room\n * @property {string} mediatypes identifier of a room\n */\nexport const TRANSFERING_CALL = 'transferingCall';\n\nconst _ice = Symbol('ice');\nconst _id = Symbol('id');\nconst _invite = Symbol('invite');\nconst _room = Symbol('room');\nconst _ownwer = Symbol('owner');\nconst _participants = Symbol('participants');\nconst _record = Symbol('recording');\nconst _left = Symbol('left');\nconst _pendingInvites = Symbol('pendingInvites');\nconst _server = Symbol('server');\nconst _session = Symbol('session');\nconst _token = Symbol('token');\nconst _uninitedRoomPromise = Symbol('uninitedRoom');\n\n/**\n * @fires UPDATED_CONFERENCE_EVENT\n * @fires DESTROYED_CONFERENCE_EVENT\n * @fires EXPEL_CONFERENCE_EVENT\n * @fires LOCAL_STREAM_CHANGED\n * @fires REMOTE_STREAM_CHANGED\n * @fires TRANSFERING_CALL\n * @extends EventEmitter2\n */\nexport class Conference extends EventEmitter2 {\n\n\t/**\n\t * Creates a new instance and initialize with provided\n\t * data\n\t */\n\tconstructor(dependencies = {}) {\n\t\tsuper();\n\n\t\t/**\n\t\t * Server client\n\t\t * @private\n\t\t * @type {Session}\n\t\t */\n\t\tthis[_session] = dependencies.session || null;\n\n\t\t/**\n\t\t * Janus client\n\t\t * @private\n\t\t * @type {JanusRoom}\n\t\t */\n\t\tthis[_room] = null;\n\t\t/**\n\t\t * Room identifier\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis[_id] = '';\n\n\t\t/**\n\t\t * Invitation when user doesn't joined the conference.\n\t\t * Contains next properties:\n\t\t *  - id: invitation id,\n\t\t *  - from: inviter username.\n\t\t *  - mediatypes: invitation offered mediatypes\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_invite] = null;\n\n\t\t/**\n\t\t * Room owner username\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis[_ownwer] = '';\n\n\t\t/**\n\t\t * User identifiers that participate on a conference.\n\t\t * @private\n\t\t * @type {Array<string>}\n\t\t */\n\t\tthis[_participants] = [];\n\n\t\t/**\n\t\t * Indicates if conference is being recorded\n\t\t * @private\n\t\t * @type {boolean}\n\t\t */\n\t\tthis[_record] = false;\n\n\t\t/**\n\t\t * Conference server\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis[_server] = '';\n\n\t\t/**\n\t\t * Conference access token\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis[_token] = '';\n\n\t\t/**\n\t\t * Conference ice servers\n\t\t * @private\n\t\t * @type {Array<object>}\n\t\t */\n\t\tthis[_ice] = [];\n\n\t\t/**\n\t\t * Contains a list of pending invitations (still not accepted/rejected\n\t\t * by remote peer) transaction identifiers. Used to cancel a previous invitation\n\t\t * and determine if an user has been invited.\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_pendingInvites] = {};\n\n\t\t/**\n\t\t * True if leave method was called\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_left] = false;\n\n\t\tthis.parallelSipExtension = null;\n\t\tthis.sipUri = null;\n\n\t\tthis[_uninitedRoomPromise] = null;\n\n\t\tbindMethods(this, [\n\t\t\t'onRoomUpdated',\n\t\t\t'onRoomDestroyed',\n\t\t\t'onInviteCancel',\n\t\t\t'onStreamAdded',\n\t\t\t'onStreamRemoved',\n\t\t\t'onTransferingCallToPeer',\n\t\t\t'onParticipantAdded',\n\t\t\t'onParticipantRemoved',\n\t\t\t'onParticipantHold',\n\t\t\t'onParticipantUnhold',\n\t\t]);\n\n\t\tthis.dependencies = dependencies;\n\t}\n\n\t/**\n\t * Conference identifier\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this[_id];\n\t}\n\n\t/**\n\t * Conference creator username\n\t * @type {string}\n\t */\n\tget owner() {\n\t\treturn this[_ownwer];\n\t}\n\n\t/**\n\t * Indicate if invited\n\t * @type {boolean}\n\t */\n\tget invited() {\n\t\treturn !!this[_invite];\n\t}\n\n\t/**\n\t * Returns an object with the invitation (with the properties \"id\" an \"from\")\n\t * Needed to know who is inviting us in anonymous rooms\n\t */\n\tget invite() {\n\t\treturn this[_invite];\n\t}\n\n\t/**\n\t * Indicate if joined\n\t * @type {boolean}\n\t */\n\tget joined() {\n\t\treturn !!this[_room];\n\t}\n\n\t/**\n\t * Server session.\n\t * @type {Session}\n\t */\n\tset session(session) {\n\t\tif (this[_session] && this[_session].signaling) {\n\t\t\tthis[_session].signaling.removeContentListener(this.onRoomUpdated);\n\t\t\tthis[_session].signaling.removeContentListener(this.onRoomDestroyed);\n\t\t\tthis[_session].signaling.removeContentListener(this.onInviteCancel);\n\t\t\tthis[_session].signaling.removeContentListener(this.onTransferingCallToPeer);\n\t\t\tthis._uninitRoom();\n\t\t}\n\t\tthis[_session] = session;\n\t\tif (this[_session]) {\n\t\t\tthis[_session].signaling.addContentListener({\n\t\t\t\trequest: 'room-update',\n\t\t\t\tpayload: {room: this.id},\n\t\t\t}, this.onRoomUpdated);\n\t\t\tthis[_session].signaling.addContentListener({\n\t\t\t\trequest: 'room-destroyed',\n\t\t\t\tpayload: {room: this.id},\n\t\t\t}, this.onRoomDestroyed);\n\t\t\tthis[_session].signaling.addContentListener({\n\t\t\t\tcancel: 'invitation',\n\t\t\t}, this.onInviteCancel);\n\t\t\tthis[_session].signaling.addContentListener({\n\t\t\t\trequest: 'transfering-call-to-peer',\n\t\t\t\tpayload: {roomId: this.id},\n\t\t\t}, this.onTransferingCallToPeer);\n\t\t}\n\t}\n\n\t/**\n\t * Indicates if conference has been created by local user\n\t * @type {boolean}\n\t */\n\tisOwner() {\n\t\treturn this[_session] && this.owner === this[_session].username;\n\t}\n\n\t/**\n\t * Indicates if the conference has owner\n\t * @type {boolean}\n\t */\n\thasOwner() {\n\t\treturn this.owner.length !== 0;\n\t}\n\n\t/**\n\t * Conference participants, expressed as a list of\n\t * current user identifiers\n\t * @type {Array<string>}\n\t */\n\tget participants() {\n\t\treturn this[_participants];\n\t}\n\n\t/**\n\t * Current local streams.\n\t * @type {Array<ConferenceMediaStream>}\n\t */\n\tget localStreams() {\n\t\tif (!this.joined) {\n\t\t\tthrow new Error('not joined');\n\t\t}\n\t\treturn this[_room].media.localStreams;\n\t}\n\n\t/**\n\t * Current remote streams.\n\t * @type {Array<ConferenceMediaStream>}\n\t */\n\tget remoteStreams() {\n\t\tif (!this.joined) {\n\t\t\tthrow new Error('not joined');\n\t\t}\n\t\treturn this[_room].media.remoteStreams;\n\t}\n\n\t/**\n\t * Current conference streams.\n\t * @type {Array<ConferenceMediaStream>}\n\t */\n\tget streams() {\n\t\treturn this.localStreams.concat(this.remoteStreams);\n\t}\n\n\t/**\n\t * Local hold\n\t * Stop publishing and subscribing to the media in the conference\n\t * @return {Promise} resolved on success\n\t */\n\thold() {\n\t\treturn this[_room].hold();\n\t}\n\n\t/**\n\t* Stop local hold\n\t * Republishes all previously published media, subscribes\n\t * to previously subscribed media and notifies new status to\n\t * other participants.\ns \t * @return {Promise} resolved on success\n\t */\n\tunhold() {\n\t\treturn this[_room].unhold();\n\t}\n\n\t/**\n\t * Check if conference is on hold state.\n\t * @type {boolean}\n\t */\n\tget isOnHold() {\n\t\treturn this[_room].isOnHold();\n\t}\n\n\t/**\n\t * Suspend conference:\n\t *  - cancel any pending invitation sent.\n\t *  - decline invitation if we was invited to this conference.\n\t * @return {Promise} resolved on success.\n\t */\n\tsuspend() {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tObject.keys(this[_pendingInvites]).forEach(participant => this.cancelInvitation(participant));\n\t\t\tif (this.invited) {\n\t\t\t\tthis.onRoomDestroyed();\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Resume conference\n\t * @return {Promise} resolved on success.\n\t */\n\tresume() {\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Join this conference and start sending local media defined by mediatypes\n\t * parameter.\n\t * @throws {Error} when already joined.\n\t * @param {object} mediatypes local media used after joining the conference.\n\t * @return {Promise} resolved on success.\n\t */\n\tjoin(mediatypes) {\n\t\tif (this.joined) {\n\t\t\treturn Promise.reject(new Error('already joined'));\n\t\t}\n\t\treturn Promise.resolve().then(() => {\n\t\t\tif (this.invited) {\n\t\t\t\tthis[_session].signaling.invites.accept(this[_invite].id, this[_invite].from);\n\t\t\t\tthis[_invite] = null;\n\t\t\t}\n\t\t\treturn this._initRoom();\n\t\t}).then(() => {\n\t\t\treturn this.update(mediatypes);\n\t\t});\n\t}\n\n\t/**\n\t * Add participant to this conference.\n\t * Only conference owner can do this.\n\t * @throws {Error} if participant is already present on conference or a pending\n\t * invitation exists.\n\t * @param {string} participant user name to add.\n\t * @param {object} mediatypes the mediatypes requested to the new participant.\n\t * @param {string} [requestId] the ID of the request that generated this invitation.\n\t * @param {object} [context] arbitrary context that can be sent to invites\n\t * @return {Promise<boolean>} resolved with a boolean value that indicates if\n\t * remote accepts the invitation.\n\t */\n\tasync inviteParticipant(participant, mediatypes, requestId, context) {\n\t\tlog.debug('inviteParticipant', participant);\n\t\tif (this[_pendingInvites][participant]) {\n\t\t\tlog.debug('inviteParticipant/pendintInvites');\n\t\t\tthrow new Error(`participant ${participant} has a pending invitation`);\n\t\t}\n\t\tconst id = nanoid();\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tthis[_pendingInvites][participant] = {id, resolve, reject};\n\t\t\t\tlog.debug('inviteParticipant/Promise<>/pendingInvites saved, id=', id);\n\t\t\t\tlog.debug(id, this[_session].username, participant, this.id, mediatypes, requestId);\n\t\t\t\tconst response = await this[_session].signaling.invites.invite(\n\t\t\t\t\tid,\n\t\t\t\t\tthis[_session].username,\n\t\t\t\t\tparticipant,\n\t\t\t\t\tthis.id,\n\t\t\t\t\tmediatypes,\n\t\t\t\t\trequestId,\n\t\t\t\t\tcontext,\n\t\t\t\t);\n\t\t\t\tlog.debug('inviteParticipant/Promise<>/invite request sent');\n\t\t\t\tresolve({\n\t\t\t\t\tcode: 200,\n\t\t\t\t\twhoAccepted: response ? response.whoAccepted : undefined,\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tlog.error('inviteParticipant/Promise<>/error invite request', error);\n\t\t\t\tif (error instanceof ErrorResponse) {\n\t\t\t\t\tresolve({code: error.message});\n\t\t\t\t} else {\n\t\t\t\t\treject({code: error});\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tdelete this[_pendingInvites][participant];\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Cancel an invite\n\t * @param {string} participant user name to decline.\n\t */\n\tcancelInvitation(participant) {\n\t\ttry {\n\t\t\tthis.cancelPendingInvite(participant);\n\t\t} catch (error) {\n\t\t\tlog.error(error);\n\t\t}\n\t}\n\n\tcancelPendingInvite(participant) {\n\t\tlet pending = this[_pendingInvites][participant];\n\t\tif (!pending) {\n\t\t\tthrow new Error(`participant ${participant} has no pending invitation`);\n\t\t}\n\t\tdelete this[_pendingInvites][participant];\n\t\tthis[_session].signaling.invites.cancelInvitation(pending.id, this[_session].username);\n\t\tpending.reject(new Error('invite canceled'));\n\t}\n\n\t/**\n\t * Removes a participant from this conference.\n\t * Only conference owner can do this.\n\t * @param {string} participant user name to remove.\n\t * @return {Promise} resolved when remote user leaves conference.\n\t */\n\texpelParticipant(participant) {\n\t\treturn this[_session].signaling.rooms.removeRoomParticipants(this.id, [participant])\n\t\t\t.then(response => this._updateWithServerData(response));\n\t}\n\n\t/**\n\t * Leaves this conference or rejects a previous invitation.\n\t * @param {number} errorCode the rejection cause when an invitation is received\n\t * and the conference has not been joined.\n\t * @throws {Error} when already joined or a previous invitation was not received.\n\t * @return {Promise<Conference>} resolved on success with self reference.\n\t */\n\tasync leave(errorCode) {\n\t\t// TODO(antonio) remove this hack to maintain async call\n\t\tawait Promise.resolve();\n\t\tthis[_left] = true;\n\t\tthis._declineInviteIfNeeded(errorCode);\n\t\tif (this.joined || this.isOwner()) {\n\t\t\tawait this._tryToLeaveSignalingRoom();\n\t\t}\n\t\treturn this;\n\t}\n\n\t_declineInviteIfNeeded(errorCode) {\n\t\tif (this.invited) {\n\t\t\tthis._sendDeclineMessage(errorCode);\n\t\t\tthis[_invite] = null;\n\t\t}\n\t}\n\n\t_sendDeclineMessage(errorCode) {\n\t\tthis[_session].signaling.invites.decline(\n\t\t\tthis[_invite].id,\n\t\t\tthis[_invite].from,\n\t\t\terrorCode,\n\t\t);\n\t}\n\n\tasync _tryToLeaveSignalingRoom() {\n\t\ttry {\n\t\t\tawait this[_session].signaling.rooms.leaveRoom(this.id);\n\t\t} catch (ignored) {\n\t\t\tawait this._uninitRoom();\n\t\t}\n\t}\n\n\t/**\n\t * Update local media types.\n\t * @param {object} mediatypes required mediatypes.\n\t * @return {Promise} resolved on success.\n\t */\n\tupdate(mediatypes = {}) {\n\t\tif (!this.joined) {\n\t\t\treturn Promise.reject(new Error('not joined'));\n\t\t}\n\t\tif (this._mediaUpdateInProgress) {\n\t\t\treturn Promise.reject(new Error('media update already in progress'));\n\t\t}\n\t\tthis._mediaUpdateInProgress = true;\n\t\tthis[_room].api.media.setParallelSipExtension(this.parallelSipExtension);\n\t\treturn this[_room].update(mediatypes).finally(() => {\n\t\t\tthis._mediaUpdateInProgress = false;\n\t\t});\n\t}\n\n\t/**\n\t * True if conference is being recorded\n\t * @type {boolean}\n\t */\n\tget recording() {\n\t\treturn this[_record];\n\t}\n\n\t/**\n\t * Starts recording this conference\n\t * @return {Promise<Conference>} resolved on success with self reference.\n\t */\n\tstartRecording() {\n\t\treturn this[_session].signaling.rooms.startRecordingRoom(this.id)\n\t\t\t.then(response => this._updateWithServerData(response));\n\t}\n\n\t/**\n\t * Stops conference recording\n\t * @return {Promise<Conference>} resolved on success with self reference.\n\t */\n\tstopRecording() {\n\t\treturn this[_session].signaling.rooms.stopRecordingRoom(this.id)\n\t\t\t.then(response => this._updateWithServerData(response));\n\t}\n\n\t/**\n\t * Create an unattended call transfer towards a user in the system\n\t * @param {string} participant user name to call.\n\t * @param {object} mediatypes the mediatypes requested to the new participant.\n\t * @return {Promise}\n\t */\n\tunattendedCallTransfer(participant, mediatypes) {\n\t\tlet id = nanoid();\n\t\treturn this[_session].signaling.callTransfer.unattendedCallTransfer(\n\t\t\tid,\n\t\t\tparticipant,\n\t\t\tthis.id,\n\t\t\tmediatypes,\n\t\t);\n\t}\n\n\n\t/**\n\t * Accept inviting to other participant to make an unattended call transfer\n\t * @param {string} callTransferID identifier of a call transfer\n\t * @return {Promise}\n\t */\n\tacceptCallTransfer(callTransferID) {\n\t\tlet id = nanoid();\n\t\treturn this[_session].signaling.callTransfer.acceptCallTransfer(\n\t\t\tid,\n\t\t\tcallTransferID,\n\t\t);\n\t}\n\n\n\tcreateDependencies() {\n\t\tconst defaultDependencies = {\n\t\t\tRTCPeerConnection,\n\t\t\tRTCSessionDescription,\n\t\t\tgetUserMedia: getUserMediaWithMediatypes,\n\t\t\twindow,\n\t\t\tMediaStream,\n\t\t};\n\t\treturn Object.assign(defaultDependencies, this.dependencies);\n\t}\n\n\n\t/**\n\t * Initialize Janus client after joining a conference.\n\t * @private\n\t * @return {Promise} resolved on success\n\t */\n\t_initRoom() {\n\t\tthis[_room] = this.createJanusRoom();\n\t\tthis[_room].media.on(STREAM_ADDED, this.onStreamAdded);\n\t\tthis[_room].media.on(STREAM_REMOVED, this.onStreamRemoved);\n\t\tthis[_room].emitter.on(ConnectionEvents.CONNECTION_CLOSED, this.onRoomDestroyed);\n\t\tthis[_room].emitter.on(ParticipantEvents.PARTICIPANT_ADDED, this.onParticipantAdded);\n\t\tthis[_room].emitter.on(ParticipantEvents.PARTICIPANT_REMOVED, this.onParticipantRemoved);\n\t\tthis[_room].emitter.on(ParticipantEvents.PARTICIPANT_HOLD, this.onParticipantHold);\n\t\tthis[_room].emitter.on(ParticipantEvents.PARTICIPANT_UNHOLD, this.onParticipantUnhold);\n\t\treturn this[_room].init().catch((error) => {\n\t\t\treturn this._uninitRoom().then(() => {\n\t\t\t\tthrow error;\n\t\t\t});\n\t\t});\n\t}\n\n\tcreateJanusRoom() {\n\t\tconst server = this[_server].wss || this[_server].ws\n\t\t\t? ServerAddress.fromWebsocket(this[_server].wss || this[_server].ws)\n\t\t\t: ServerAddress.fromSocketIo(this[_server].https || this[_server].http);\n\t\tconst {room: injectedRoom} = this.dependencies;\n\t\treturn injectedRoom || new JanusRoom({\n\t\t\tserver,\n\t\t\tusername: this[_session].username,\n\t\t\troom: this[_id],\n\t\t\ttoken: this[_token],\n\t\t\tice: this[_ice],\n\t\t\tdeps: this.createDependencies(),\n\t\t});\n\t}\n\n\t/**\n\t * Deinitialize Janus client after leaving a conference.\n\t * @private\n\t * @return {Promise} resolved on success\n\t */\n\t_uninitRoom() {\n\t\tif (this[_uninitedRoomPromise]) {\n\t\t\treturn this[_uninitedRoomPromise];\n\t\t}\n\t\tthis[_uninitedRoomPromise] = this._uninitRoomIfExists()\n\t\t\t.finally(() => this._resetUninitedRoomPromise());\n\t\treturn this[_uninitedRoomPromise];\n\t}\n\n\t_uninitRoomIfExists() {\n\t\tif (this[_room]) {\n\t\t\tthis._removeRoomListeners();\n\t\t\treturn this[_room].uninit()\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis._removeRoomMediaListeners();\n\t\t\t\t\tthis._resetCurrentRoom();\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t_removeRoomListeners() {\n\t\tconst {emitter} = this[_room];\n\t\temitter.off(ConnectionEvents.CONNECTION_CLOSED, this.onRoomDestroyed);\n\t\temitter.off(ParticipantEvents.PARTICIPANT_ADDED, this.onParticipantAdded);\n\t\temitter.off(ParticipantEvents.PARTICIPANT_REMOVED, this.onParticipantRemoved);\n\t\temitter.off(ParticipantEvents.PARTICIPANT_HOLD, this.onParticipantHold);\n\t\temitter.off(ParticipantEvents.PARTICIPANT_UNHOLD, this.onParticipantUnhold);\n\t}\n\n\t_removeRoomMediaListeners() {\n\t\tconst {media} = this[_room];\n\t\tmedia.off(STREAM_ADDED, this.onStreamAdded);\n\t\tmedia.off(STREAM_REMOVED, this.onStreamRemoved);\n\t}\n\n\t_resetCurrentRoom() {\n\t\tthis[_room] = null;\n\t}\n\n\t_resetUninitedRoomPromise() {\n\t\tthis[_uninitedRoomPromise] = null;\n\t}\n\n\t/**\n\t * Updates instance properties with data returned by a\n\t * signaling server\n\t * @private\n\t * @param {object} data server data\n\t * @return {Conference} self reference.\n\t */\n\t_updateWithServerData(data) {\n\t\tif (data.room) {\n\t\t\tthis[_id] = data.room;\n\t\t}\n\t\tif (data.owner) {\n\t\t\tthis[_ownwer] = data.owner;\n\t\t}\n\t\tif (data.participants) {\n\t\t\tthis[_participants] = data.participants;\n\t\t}\n\t\tif (data.record) {\n\t\t\tthis[_record] = data.record;\n\t\t}\n\t\tif (data.token) {\n\t\t\tthis[_token] = data.token;\n\t\t}\n\t\tif (data.server) {\n\t\t\tthis[_server] = data.server;\n\t\t}\n\t\tif (data.ice) {\n\t\t\tthis[_ice] = data.ice;\n\t\t}\n\t\tif (data.invite) {\n\t\t\tthis[_invite] = data.invite;\n\t\t}\n\t\tif (typeof data.left !== 'undefined') {\n\t\t\tthis[_left] = data.left;\n\t\t}\n\t\tif (data.parallelSipExtension) {\n\t\t\tthis.parallelSipExtension = data.parallelSipExtension;\n\t\t}\n\t\tif (data.sipUri) {\n\t\t\tthis.sipUri = data.sipUri;\n\t\t}\n\t\treturn this;\n\t}\n\n\tsendDtmf(value) {\n\t\treturn this[_session].signaling.rooms.sendDtmf({\n\t\t\tdigit: value,\n\t\t\tsipUri: this.parallelSipExtension || this.sipUri,\n\t\t});\n\t}\n\n\t/**\n\t *\n\t */\n\tgetParticipants() {\n\t\treturn this[_room].getParticipants();\n\t}\n\n\t/**\n\t * Callback called when a room update event is received.\n\t * @private\n\t */\n\tonRoomUpdated(data) {\n\t\tthis._updateWithServerData(data.payload);\n\t\tthis.emit(UPDATED_CONFERENCE_EVENT, this);\n\t}\n\n\t/**\n\t * Callback called when a destroyed room event is received.\n\t * @private\n\t */\n\tonRoomDestroyed() {\n\t\tif (this[_session] && (this.joined || this.isOwner())) {\n\t\t\tthis[_session].signaling.rooms.leaveRoom(this.id)\n\t\t\t\t.catch((e) => {\n\t\t\t\t\tif (typeof e.message === 'string' && !e.message.match(/Session closed/) || e.message !== 403) {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t\tthis.emit(DESTROYED_CONFERENCE_EVENT);\n\t\tif (!this[_left]) {\n\t\t\tthis.emit(EXPEL_CONFERENCE_EVENT);\n\t\t}\n\t}\n\n\t/**\n\t * Callback called when an invitation is canceled\n\t * @private\n\t */\n\tonInviteCancel(evt) {\n\t\tif (!!this[_invite] && this[_invite].id === evt.requestID) {\n\t\t\tthis[_invite] = null;\n\t\t\tthis.onRoomDestroyed();\n\t\t}\n\t}\n\n\t/**\n\t * Callback called when a ConferenceMediaStream is added.\n\t * @private\n\t * @param {ConferenceMediaStream} stream\n\t */\n\tonStreamAdded(stream) {\n\t\tconst event = stream.local\n\t\t\t? {name: LOCAL_STREAM_ADDED, data: asLocalStream(stream)}\n\t\t\t: {name: REMOTE_STREAM_ADDED, data: asRemoteStream(stream)};\n\t\tthis.onStreamChanged(stream);\n\t\tthis.emit(event.name, event.data);\n\t}\n\n\t/**\n\t * Callback called when a ConferenceMediaStream is removed.\n\t * @private\n\t * @param {ConferenceMediaStream} stream\n\t */\n\tonStreamRemoved(stream) {\n\t\tconst event = stream.local\n\t\t\t? {name: LOCAL_STREAM_REMOVED, data: asLocalStream(stream)}\n\t\t\t: {name: REMOTE_STREAM_REMOVED, data: asRemoteStream(stream)};\n\t\tthis.onStreamChanged(stream);\n\t\tthis.emit(event.name, event.data);\n\t}\n\n\t/**\n\t * Callback called when a ConferenceMediaStream has changed.\n\t * @private\n\t * @param {ConferenceMediaStream} stream\n\t */\n\tonStreamChanged(stream) {\n\t\tif (stream.local) {\n\t\t\tlet streams = this.joined ? this.localStreams.map(item => item.stream) : [];\n\t\t\tthis.emit(LOCAL_STREAM_CHANGED, {\n\t\t\t\tstreams: streams,\n\t\t\t});\n\t\t} else {\n\t\t\tlet streams = this.remoteStreams\n\t\t\t\t.filter(item => item.feed === stream.feed)\n\t\t\t\t.map(item => item.stream);\n\t\t\tif (streams.length > 1) {\n\t\t\t\tstreams = streams.filter(s => !!s.getTracks().length);\n\t\t\t}\n\t\t\tthis.emit(REMOTE_STREAM_CHANGED, {\n\t\t\t\tparticipant: stream.feed,\n\t\t\t\tstreams: streams,\n\t\t\t\treason: stream.reason,\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Callback called when an invitation is canceled\n\t * @private\n\t */\n\tonTransferingCallToPeer(data) {\n\t\tthis.transferingCall = true;\n\t\tthis.emit(TRANSFERING_CALL, data);\n\t}\n\n\t/**\n\t * Callback called when a new participant joins the room\n\t * @private\n\t */\n\tonParticipantAdded(data) {\n\t\tthis.emit(ConferenceParticipantEvents.PARTICIPANT_ADDED, data);\n\t}\n\n\t/**\n\t * Callaback called when a participant leaves the room\n\t * @private\n\t */\n\tonParticipantRemoved(data) {\n\t\tthis.emit(ConferenceParticipantEvents.PARTICIPANT_REMOVED, data);\n\t}\n\n\t/**\n\t * Callback called when a remote participant does a hold\n\t * @private\n\t */\n\tonParticipantHold(data) {\n\t\tthis.emit(ConferenceParticipantEvents.PARTICIPANT_HOLD, data);\n\t}\n\n\t/**\n\t * Callback called when a remote participant stops a hold\n\t * @private\n\t */\n\tonParticipantUnhold(data) {\n\t\tthis.emit(ConferenceParticipantEvents.PARTICIPANT_UNHOLD, data);\n\t}\n}\n","import nanoid from 'nanoid';\n\nimport {bindMethods} from '../../../utils';\nimport {Conference, UPDATED_CONFERENCE_EVENT, DESTROYED_CONFERENCE_EVENT} from './Conference';\nimport {EventEmitter2} from 'eventemitter2';\nimport {ErrorResponse} from './signaling/errors';\nimport {default as Logs} from '../../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/Janus/Conferences');\n\n/**\n * Incoming conference event.\n * Fired when an invitation to a conference is received.\n * @event INCOMING_CONFERENCE_EVENT\n * @type {Conference}\n */\nexport const INCOMING_CONFERENCE_EVENT = 'incomingConference';\n\n/**\n * Invitation request event.\n * Fired when an invitation request to a conference is received.\n * @event INVITATION_REQUEST_EVENT\n * @type {object}\n * @property {string} id request identifier.\n * @property {string} user user that requested the invitation.\n * @property {boolean} video boolean value that indicates if remote user is sharing video.\n * @property {function} accept function that should be called when invitation is accepted.\n * @property {function} reject function that should be called when invitation is rejected.\n */\nexport const INVITATION_REQUEST_EVENT = 'invitationRequest';\n\n/**\n * Invitation declined event.\n * Fired when an remote peer canceled an invitation request.\n * @event INVITATION_CANCEL_EVENT\n * @type {object}\n * @property {string} id request identifier.\n */\nexport const INVITATION_CANCEL_EVENT = 'cancelInvitationRequest';\n\nconst _conferences = Symbol('conferences');\nconst _pendingRequests = Symbol('pendingRequest');\nconst _receivedRequests = Symbol('receivedRequests');\nconst _session = Symbol('session');\n\n/**\n * This class implements a Conferences module that provides access\n * to conference management methods.\n */\nexport class Conferences extends EventEmitter2 {\n\t/**\n\t * Createsa a new Conferences module.\n\t */\n\tconstructor(dependencies = {}) {\n\t\tsuper();\n\n\t\t/**\n\t\t * Server client\n\t\t * @private\n\t\t * @type {Session}\n\t\t */\n\t\tthis[_session] = null;\n\n\t\t/**\n\t\t * Conference collection, indexed by id\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_conferences] = {};\n\n\t\t/**\n\t\t * Contains a list of pending invitations requests (still not accepted/rejected\n\t\t * by remote peer) transaction identifiers. Used to cancel a previous invitation\n\t\t * and determine if an user has been requested.\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_pendingRequests] = {};\n\n\t\t/**\n\t\t * Contains a list of received and pending invitations requests (still not\n\t\t * accepted/rejected by us) transaction identifiers. Used to cancel a\n\t\t * them when session is closed.\n\t\t * @private\n\t\t * @type {object}\n\t\t */\n\t\tthis[_receivedRequests] = {};\n\n\t\tbindMethods(this, [\n\t\t\t'onRoomUpdated',\n\t\t\t'onIncomingInvite',\n\t\t\t'onIncomingInviteRequest',\n\t\t\t'onInviteCancelRequest',\n\t\t]);\n\n\t\tthis.dependencies = dependencies;\n\t}\n\n\t/**\n\t * Initialize conferences module.\n\t * Get any room where user participates from server and create Conference\n\t * elements with them.\n\t * It also listens for new rooms notified by server.\n\t * @param {Session} session associated signaling session.\n\t * @return {Promise} resolved on success\n\t */\n\tinit(session) {\n\t\tthis[_session] = session;\n\t\tthis[_session].signaling.addContentListener({request: 'room-update'}, this.onRoomUpdated);\n\t\tthis[_session].signaling.addContentListener({request: 'invitation'}, this.onIncomingInvite);\n\t\tthis[_session].signaling.addContentListener(\n\t\t\t{request: 'invitationRequest'},\n\t\t\tthis.onIncomingInviteRequest,\n\t\t);\n\t\tthis[_session].signaling.addContentListener(\n\t\t\t{cancel: 'invitationRequest'},\n\t\t\tthis.onInviteCancelRequest,\n\t\t);\n\t\treturn this[_session].signaling.rooms.getRooms().then((response) => {\n\t\t\tresponse.forEach((data) => {\n\t\t\t\tlet conference = new Conference();\n\t\t\t\tconference._updateWithServerData(data);\n\t\t\t\tthis._addConferenceToCollection(conference);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Deinitialize conferences module.\n\t * Stops listening for new rooms messages from server.\n\t * @return {void}\n\t */\n\tuninit() {\n\t\tObject.values(this[_conferences]).forEach((conference) => {\n\t\t\tthis._removeConferenceFromCollection(conference.id);\n\t\t});\n\t\tif (this[_session] && this[_session].signaling) {\n\t\t\tthis[_session].signaling.removeContentListener(this.onRoomUpdated);\n\t\t\tthis[_session].signaling.removeContentListener(this.onIncomingInvite);\n\t\t\tthis[_session].signaling.removeContentListener(this.onIncomingInviteRequest);\n\t\t\tthis[_session].signaling.removeContentListener(this.onInviteCancelRequest);\n\t\t}\n\t\tthis[_session] = null;\n\t}\n\n\t/**\n\t * Suspend conferences:\n\t *  - cancel any pending invitation request sent.\n\t *  - update internally any received invitation request to canceled.\n\t *  - suspend any managed conference.\n\t * @return {Promise} resolved on success.\n\t */\n\tsuspend() {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tObject.keys(this[_pendingRequests]).forEach(participant =>\n\t\t\t\tthis.cancelInvitationRequest(participant, 603),\n\t\t\t);\n\t\t\tObject.keys(this[_receivedRequests]).forEach((id) => {\n\t\t\t\tthis.onInviteCancelRequest({\n\t\t\t\t\trequestID: id,\n\t\t\t\t});\n\t\t\t});\n\t\t\treturn Promise.all(\n\t\t\t\tObject.keys(this[_conferences]).map(id => this[_conferences][id].suspend()),\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Resume conferences:\n\t *  - resume any managed conference.\n\t * @return {Promise} resolved on success.\n\t */\n\tresume() {\n\t\treturn Promise.all(Object.keys(this[_conferences]).map(id => this[_conferences][id].resume()));\n\t}\n\n\t/**\n\t * Get any conference where user is included as participant.\n\t * @return {Array<Conference>}\n\t */\n\tfetch() {\n\t\treturn Object.values(this[_conferences]);\n\t}\n\n\t/**\n\t * Get an existing conference by conference ID.\n\t * @param {string} conferenceId conference ID.\n\t * @return {Conference}\n\t */\n\tget(conferenceId) {\n\t\treturn this[_conferences][conferenceId];\n\t}\n\n\t/**\n\t * Creates a new conference with given identifier.\n\t * @return {Promise<Conference>} created conference on success.\n\t */\n\tcreate() {\n\t\treturn this[_session].signaling.rooms.createRoom().then((response) => {\n\t\t\tlet conference = new Conference();\n\t\t\tconference._updateWithServerData(response);\n\t\t\tthis._addConferenceToCollection(conference);\n\t\t\treturn conference;\n\t\t});\n\t}\n\n\t/**\n\t * Request an invitation to given user.\n\t * @param {string} participant requested user.\n\t * @param {object} mediaConstraints media constraints to request in the invitation, defaults to {audio: true, video: true}.\n\t * @return {Promise<Integer>} Returns a SIP code indicating the state of the call.\n\t * that indicates if invitation has been accepted.\n\t */\n\trequestInvitation(participant, mediaConstraints = {audio: true, video: true}) {\n\t\tif (this[_pendingRequests][participant]) {\n\t\t\treturn Promise.reject(new Error(`participant ${participant} has a pending request`));\n\t\t}\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet id = nanoid();\n\t\t\tthis[_pendingRequests][participant] = {\n\t\t\t\tid: id,\n\t\t\t\tresolve: resolve,\n\t\t\t\treject: reject,\n\t\t\t};\n\t\t\tlet from = `${this[_session].username}/${this[_session].peerId}`;\n\t\t\tthis[_session].signaling.inviteRequest\n\t\t\t\t.requestInvitation(id, from, participant, mediaConstraints)\n\t\t\t\t.then(() => {\n\t\t\t\t\tdelete this[_pendingRequests][participant];\n\t\t\t\t\tresolve({code: 200});\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tdelete this[_pendingRequests][participant];\n\t\t\t\t\tif (error instanceof ErrorResponse) {\n\t\t\t\t\t\tresolve({code: error.message});\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Cancel a pending requestInvitation.\n\t * @throws {Error} if no pending request exists.\n\t * @param {string} participant user name to decline.\n\t * @param {string} [error=undefined] resolution error code.\n\t */\n\tcancelInvitationRequest(participant, error) {\n\t\tlet pending = this[_pendingRequests][participant];\n\t\tif (!pending) {\n\t\t\tthrow new Error(`participant ${participant} has no pending invitation`);\n\t\t}\n\t\tdelete this[_pendingRequests][participant];\n\t\tlet from = `${this[_session].username}/${this[_session].peerId}`;\n\t\tthis[_session].signaling.inviteRequest.cancelInvitation(pending.id, from);\n\t\tpending.resolve(error);\n\t}\n\n\t/**\n\t * Retrieves current invitations\n\t *\n\t * @return {Array<Conference>} A resolved {Promise} with an array of {Conference}s if succeeds\n\t */\n\tgetCurrentInvitations() {\n\t\tlet id = nanoid();\n\t\tlet from = `${this[_session].username}/${this[_session].peerId}`;\n\t\tlog.debug('getCurrentInvitations');\n\t\treturn this[_session].signaling.invites.getCurrentInvitations(id, from).then((response) => {\n\t\t\tlog.debug('getCurrentInvitations/response', response);\n\t\t\tif (response.payload && response.payload.currentInvitations) {\n\t\t\t\tlet rooms = response.payload.currentInvitations.map((invite) => {\n\t\t\t\t\tif (invite.request === 'invitationRequest') {\n\t\t\t\t\t\treturn this.createInviteRequestFromMessage(invite);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet conf = new Conference();\n\t\t\t\t\t\tlog.debug('getCurrentInvitations/invite', invite);\n\t\t\t\t\t\tthis.updateWithServerData(conf, invite);\n\t\t\t\t\t\tthis._addConferenceToCollection(conf);\n\t\t\t\t\t\tlog.debug('getCurrentInvitations/response/conf', conf);\n\t\t\t\t\t\treturn conf;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn rooms;\n\t\t\t} else {\n\t\t\t\tthrow new Error('no valid response');\n\t\t\t}\n\t\t});\n\t}\n\n\tasync getRoomByUri(uri) {\n\t\tconst room = await this[_session].signaling.rooms.joinRoom(uri);\n\t\tconst conference = new Conference();\n\t\tconference.session = this[_session];\n\t\tconference._updateWithServerData(room);\n\t\tthis._addConferenceToCollection(conference);\n\t\treturn conference;\n\t}\n\n\t/**\n\t * Add a conference to collection.\n\t * @private\n\t * @param {Conference} conference conference to add.\n\t */\n\t_addConferenceToCollection(conference) {\n\t\tlog.info('added conference', conference);\n\t\tthis[_conferences][conference.id] = conference;\n\t\tlet onUpdatedConference = () => {\n\t\t\tlog.debug('updated conference', conference);\n\t\t};\n\t\tlet onDestroyedConference = () => {\n\t\t\tlog.debug('destroyed conference', conference);\n\t\t\tconference.off(UPDATED_CONFERENCE_EVENT, onUpdatedConference);\n\t\t\tconference.off(DESTROYED_CONFERENCE_EVENT, onDestroyedConference);\n\t\t\tthis._removeConferenceFromCollection(conference.id);\n\t\t};\n\t\tconference.session = this[_session];\n\t\tconference.on(UPDATED_CONFERENCE_EVENT, onUpdatedConference);\n\t\tconference.on(DESTROYED_CONFERENCE_EVENT, onDestroyedConference);\n\t}\n\n\t/**\n\t * Removes a conference from collection\n\t * @private\n\t * @param {string} id conference identifier\n\t */\n\t_removeConferenceFromCollection(id) {\n\t\tlog.info('removed conference', id);\n\t\tif (this[_conferences][id]) {\n\t\t\tthis[_conferences][id].session = null;\n\t\t\tdelete this[_conferences][id];\n\t\t}\n\t}\n\n\t/**\n\t * Event listener called when a room update message is received\n\t * @private\n\t * @param {object} data\n\t */\n\tonRoomUpdated(data) {\n\t\tif (this[_conferences][data.payload.room]) {\n\t\t\treturn;\n\t\t}\n\t\tlet conference = new Conference();\n\t\tconference._updateWithServerData(data.payload);\n\t\tthis._addConferenceToCollection(conference);\n\t}\n\n\t/**\n\t * Event listener called when an invite is received\n\t * @private\n\t * @param {object} data\n\t */\n\tonIncomingInvite(data) {\n\t\tconst conference = this.handleIncomingInvite(data);\n\t\tthis.emit(INCOMING_CONFERENCE_EVENT, conference, data.mediatypes);\n\t}\n\n\tupdateWithServerData(conference, data) {\n\t\tconference._updateWithServerData(\n\t\t\tObject.assign({}, data.payload, {\n\t\t\t\tinvite: {\n\t\t\t\t\tid: data.requestID,\n\t\t\t\t\tfrom: data.from,\n\t\t\t\t\tmediatypes: data.mediatypes,\n\t\t\t\t},\n\t\t\t\tparallelSipExtension: data.parallelSipExtension,\n\t\t\t\tleft: false,\n\t\t\t}),\n\t\t);\n\t}\n\n\thandleIncomingInvite(data) {\n\t\tlet conference = this.get(data.payload.room) || new Conference(this.dependencies);\n\t\tthis.updateWithServerData(conference, data);\n\t\tif (!this.get(data.payload.room)) {\n\t\t\tthis._addConferenceToCollection(conference);\n\t\t}\n\t\treturn conference;\n\t}\n\n\t_buildInvitationRequestEvent(id, from, mediatypes) {\n\t\treturn {\n\t\t\tid: id,\n\t\t\tuser: from,\n\t\t\tvideo: mediatypes && mediatypes.video,\n\t\t\tisRequest: true,\n\t\t\taccept: () => {\n\t\t\t\tdelete this[_receivedRequests][id];\n\t\t\t\treturn this[_session].signaling.inviteRequest.accept(id, from);\n\t\t\t},\n\t\t\treject: (code) => {\n\t\t\t\tdelete this[_receivedRequests][id];\n\t\t\t\tthis[_session].signaling.inviteRequest.decline(id, from, code);\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Event listener called when an invite request is received.\n\t * @private\n\t * @param {object} data.\n\t */\n\n\tcreateInviteRequestFromMessage(data) {\n\t\tlet id = data.requestID;\n\t\tlet from = data.from;\n\t\tthis[_receivedRequests][id] = from;\n\t\treturn this._buildInvitationRequestEvent(id, from, data.mediatypes);\n\t}\n\n\tonIncomingInviteRequest(data) {\n\t\tthis.emit(INVITATION_REQUEST_EVENT, this.createInviteRequestFromMessage(data));\n\t}\n\n\t/**\n\t * Event listener called when an invite is canceled.\n\t * @private\n\t * @param {object} data.\n\t */\n\tonInviteCancelRequest(data) {\n\t\tdelete this[_receivedRequests][data.requestID];\n\t\tthis.emit(INVITATION_CANCEL_EVENT, {\n\t\t\tid: data.requestID,\n\t\t});\n\t}\n}\n","\nimport {EventEmitter2} from 'eventemitter2';\n\nconst _listeners = Symbol('listeners');\n\n/**\n * Like an EventEmitter, instances of this class allow us\n * register and unregister listeners for events, but it allows listening\n * for those messages that match a pattern.\n *\n * @example\n *   let x = new Emitter();\n *   x.addContentListener({foo: 'bar'}, (data) => {\n *     console.log('received data', data);\n *   });\n *   x.emit({foo: 'bar', hello: 'world'})\n *\n *   > received data {foo: 'bar', hello: 'world'}\n *\n * @extends EventEmitter2\n */\nexport class Emitter extends EventEmitter2 {\n\n\t/**\n\t * Create a new Emitter and initialize internal properties\n\t */\n\tconstructor() {\n\t\tsuper();\n\t\tthis[_listeners] = [];\n\t}\n\n\t/**\n\t * Add an event listener that will be called when an event that matches\n\t * provided filter is received\n\t * @param {object} filter filter that should match emited events to call\n\t * provided function\n\t * @param {function} fn callback to invoke on each new match.\n\t */\n\taddContentListener(filter, fn) {\n\t\tthis[_listeners].push({\n\t\t\tfilter: filter,\n\t\t\tfn: fn,\n\t\t});\n\t}\n\n\t/**\n\t * Stop receiving events on a previously added listener.\n\t * @param {function} fn callback to remove from listeners list.\n\t */\n\tremoveContentListener(fn) {\n\t\tthis[_listeners] = this[_listeners].filter(x => x.fn !== fn);\n\t}\n\n\t/**\n\t * Emit an event\n\t * @param {string} event event name.\n\t * @param {object} data event data.\n\t */\n\temit(event, data) {\n\t\tsuper.emit(event, data);\n\t\tif (!data) {\n\t\t\treturn;\n\t\t}\n\t\tthis[_listeners].forEach((listener) => {\n\t\t\tif (!this._match(data, listener.filter)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlistener.fn(data);\n\t\t});\n\t}\n\n\t/**\n\t * Check if given data matches provided filter.\n\t * @private\n\t * @param {object} item tested element.\n\t * @param {object} filter tested filter.\n\t * @return {boolean} true if item matches filter.\n\t */\n\t_match(item, filter) {\n\t\tlet isDifferent = Object.keys(filter).find((key) => {\n\t\t\tif (typeof filter[key] === 'object') {\n\t\t\t\treturn !this._match(item[key], filter[key]);\n\t\t\t}\n\t\t\treturn filter[key] !== item[key];\n\t\t});\n\t\treturn !isDifferent;\n\t}\n}\n","\nconst _client = Symbol('client');\n\nexport class ServerAPI {\n\n\t/**\n\t * Create a new Server API client\n\t * @param {Client} client server client\n\t */\n\tconstructor(client) {\n\n\t\t/**\n\t\t * Server client\n\t\t * @private\n\t\t * @type {Client}\n\t\t */\n\t\tthis[_client] = client;\n\t}\n\n\t/**\n\t * Send a request to server with given data.\n\t * @protected\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} type request type, i.e: 'createRoom', 'invitation',...\n\t * @param {string} id request id\n\t * @param {object} body requested body.\n\t * @param {number} [retry=0] if specified and an id is provided, when an answer\n\t * is not received for this requested id, message will be send again periodically.\n\t * @return {Promise<object>} resolved with server response.\n\t */\n\trequest(type, id, body, retry) {\n\t\tlet request = Object.assign({\n\t\t\trequest: type,\n\t\t\trequestID: id,\n\t\t}, body);\n\t\treturn this[_client].send(request, id, retry);\n\t}\n\n\t/**\n\t * Cancel a previous request.\n\t * @protected\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} type response type, i.e: 'invitation',...\n\t * @param {string} id request id\n\t */\n\tcancel(type, id, payload) {\n\t\tlet response = Object.assign({\n\t\t\tcancel: type,\n\t\t\trequestID: id,\n\t\t}, payload);\n\t\tthis[_client].send(response);\n\t}\n\n\t/**\n\t * Send an answer to server with given data.\n\t * @protected\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} type response type, i.e: 'invitation',...\n\t * @param {string} id request id\n\t * @param {object} payload response data.\n\t */\n\tanswer(type, id, payload) {\n\t\tlet response = Object.assign({\n\t\t\tanswer: type,\n\t\t\trequestID: id,\n\t\t}, payload);\n\t\treturn this[_client].send(response);\n\t}\n\n\tanswerWaitingResponse(type, id, payload) {\n\t\tconst response = Object.assign({\n\t\t\tanswer: type,\n\t\t\trequestID: id,\n\t\t}, payload);\n\t\treturn this[_client].send(response, id);\n\t}\n}\n","\nimport {ServerAPI} from './ServerAPI';\n\nexport class InvitesAPI extends ServerAPI {\n\n\t/**\n\t * Send an invitation to one room to the user with given username.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id invitation request ID.\n\t * @param {string} from the user name that requested the invitation.\n\t * @param {string} username user name to request invitation.\n\t * @param {string} roomId room identifier where invited user should join.\n\t * @param {object} mediatypes default mediatypes that invited peer should use.\n\t * @param {string} [requestId] the ID of the request that generated this invitation.\n\t * @param {object} context context information for agent assignment purposes\n\t * @return {Promise} resolved with server response on success.\n\t */\n\tinvite(id, from, username, roomId, mediatypes, requestId, context) {\n\t\treturn this.request('invitation', id, {\n\t\t\tfrom: from,\n\t\t\tto: username,\n\t\t\treplyOf: requestId,\n\t\t\tpayload: {\n\t\t\t\troom: roomId,\n\t\t\t},\n\t\t\tmediatypes: mediatypes,\n\t\t\tcontext: context,\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Cancel a previous request.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id received invitation request Id.\n\t * @param {string} from user name that requested the invitation\n\t * @param {number} [error=487] rejection code to send\n\t */\n\tcancelInvitation(id, from, error = 487) {\n\t\tthis.cancel('invitation', id, {\n\t\t\tfrom: from,\n\t\t\terror: error,\n\t\t});\n\t}\n\n\t/**\n\t * Accept a received invitation to join a room.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id invitation request ID.\n\t * @param {string} from user name who send the invitation.\n\t * @return {Promise} resolved with server resoponse on success.\n\t */\n\taccept(id, from) {\n\t\treturn this.answer('invitation', id, {from});\n\t}\n\n\t/**\n\t * Decline a received/sent invitation to join a room.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id invitation request ID.\n\t * @param {string} from user name who send the invitation.\n\t * @param {number} [error=603] rejection code to send\n\t * @return {Promise} resoponse with server response on success.\n\t */\n\tdecline(id, from, error = 603) {\n\t\treturn this.answer('invitation', id, {\n\t\t\tfrom: from,\n\t\t\terror: error,\n\t\t});\n\t}\n\n\t/**\n\t * Retrieves current invitations\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id request Id.\n\t * @param {string} from user name that requests the invitations\n\t */\n\tgetCurrentInvitations(id, from) {\n\t\treturn this.request('getCurrentInvitations', id, {\n\t\t\tfrom,\n\t\t});\n\t}\n}\n","\nimport {ServerAPI} from './ServerAPI';\n\n/**\n * Request invitation methods.\n */\nexport class InviteRequestAPI extends ServerAPI {\n\n\t/**\n\t * Request an invitation to user with given username.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id invitation request ID.\n\t * @param {string} from the user name that requested the invitation.\n\t * @param {string} username user name to request invitation.\n\t * @param {object} mediaConstraints media constraints to request in the invitation, defaults to {audio: true, video: true}.\n\t * @return {Promise} resolved with server response on success.\n\t */\n\trequestInvitation(id, from, username, mediaConstraints = {audio: true, video: true}) {\n\t\treturn this.request('invitationRequest', id, {\n\t\t\tfrom: from,\n\t\t\tto: username,\n\t\t\tmediatypes: mediaConstraints,\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Cancel a previous request.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id received invitation request Id.\n\t * @param {string} from user name that requested the invitation\n\t */\n\tcancelInvitation(id, from) {\n\t\tthis.cancel('invitationRequest', id, {from: from});\n\t}\n\n\t/**\n\t * Accept an invitation request received from given username.\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} id received invitation request Id.\n\t * @param {string} from user name that requested the invitation\n\t */\n\taccept(id, from) {\n\t\treturn this.answerWaitingResponse('invitationRequest', id, {from});\n\t}\n\n\t/**\n\t * Decline a previous invitation request sent by given username.\n\t * @throws {ErrorResponse} when server retuns an error.\n\t * @param {string} id received invitation request Id.\n\t * @param {string} from user name that requested the invitation\n\t * @param {number} [error=603] rejection code to send\n\t */\n\tdecline(id, from, error = 603) {\n\t\tthis.answer('invitationRequest', id, {\n\t\t\tfrom: from,\n\t\t\terror: error,\n\t\t});\n\t}\n\n}\n","\nimport nanoid from 'nanoid';\nimport {ServerAPI} from './ServerAPI';\n\nexport class RegisterAPI extends ServerAPI {\n\n\t/**\n\t * Create a registry on server.\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} username user name to register.\n\t * @param {string} token validation token.\n\t * @param {object} options Options to pass in the login\n\t * @param {string} options.deviceId The id that identifies to a device\n\t * @return {Promise<object>} resolved with created registry.\n\t */\n\tlogin(username, token, {deviceId} = {}) {\n\t\treturn this.request('login', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\tusername: username,\n\t\t\t\ttoken: token,\n\t\t\t\tdeviceId,\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Remove registration on server\n\t * @throws {ErrorResponse} if server returns an error\n\t * @return {Promise} resolved on success.\n\t */\n\tlogout() {\n\t\treturn this.request('logout', nanoid(), {})\n\t\t\t.then(response => response.payload)\n\t\t\t.catch(() => {});\n\t}\n}\n","\nimport {ServerAPI} from './ServerAPI';\n\nexport class CallTransferAPI extends ServerAPI {\n\n\t/**\n\t * Try to perform an unattended call transfer\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} username who must be inserted in conference\n\t * @param {string} roomId room identifier where invited user should join.\n\t * @return {Promise} resolved with server response on success.\n\t */\n\tunattendedCallTransfer(id, username, roomId, mediatypes) {\n\t\treturn this.request('unattendedCallTransfer', id, {\n\t\t\tto: username,\n\t\t\troomId: roomId,\n\t\t\tmediatypes: mediatypes,\n\t\t});\n\t}\n\n\t/**\n\t * Accept performing the call transfer\n\t * @throws {ErrorResponse} when server returns an error.\n\t * @param {string} callTransferID call transfer identifier\n\t * @return {Promise} resolved with server response on success.\n\t */\n\tacceptCallTransfer(id, callTransferID) {\n\t\treturn this.request('acceptCallTransfer', id, {\n\t\t\tcallTransferID,\n\t\t});\n\t}\n}\n","\nimport nanoid from 'nanoid';\nimport {ServerAPI} from './ServerAPI';\n\nexport class RoomsAPI extends ServerAPI {\n\n\t/**\n\t * Get any room from server where user participates and return\n\t * a list of Room instances\n\t * @throws {ErrorResponse} if server returns an error\n\t * @return {Promise<Array<object>>} resolved with server response.\n\t */\n\tgetRooms() {\n\t\treturn this.request('getRooms', nanoid(), {})\n\t\t\t.then(response => response.payload);\n\t}\n\n\t/**\n\t * Request a room creation on server and returns a Room instance\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {boolean} [recording=false] indicate if room should be recorded\n\t * @return {Promise<Room>} resolved on success.\n\t */\n\tcreateRoom(recording) {\n\t\treturn this.request('createRoom', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\trecord: recording,\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Add participants to a room\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} id room identifier\n\t * @param {Array<string>} participants list of user names to add\n\t * to the room\n\t * @return {Promise<object>} resolved on success with server response.\n\t */\n\taddRoomParticipants(id, participants) {\n\t\treturn this.request('update', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\troom: id,\n\t\t\t\tparticipants: {\n\t\t\t\t\tadd: participants,\n\t\t\t\t},\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Removes participants from a room\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} id room identifier\n\t * @param {Array<string>} participants list of user names to remove\n\t * from the room\n\t * @return {Promise<object>} resolved on success with server response.\n\t */\n\tremoveRoomParticipants(id, participants) {\n\t\treturn this.request('update', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\troom: id,\n\t\t\t\tparticipants: {\n\t\t\t\t\tremove: participants,\n\t\t\t\t},\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Starts recording a room\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} id room identifier\n\t * @return {Promise<object>} resolved on success with server response.\n\t */\n\tstartRecordingRoom(id) {\n\t\treturn this.request('update', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\troom: id,\n\t\t\t\trecord: false,\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Stops recording a room\n\t * @throws {ErrorResponse} if server returns an error\n\t * @param {string} id room identifier\n\t * @return {Promise<object>} resolved on success with server response.\n\t */\n\tstopRecordingRoom(id) {\n\t\treturn this.request('update', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\troom: id,\n\t\t\t\trecord: false,\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n\n\t/**\n\t * Close a room\n\t * @throws {ErrorResponse} if server returns an error\n\t * @return {Promise<object>} resolved on success with server response.\n\t */\n\tleaveRoom(id) {\n\t\treturn this.request('leaveRoom', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\troom: id,\n\t\t\t},\n\t\t}, 60);\n\t}\n\n\tsendDtmf(payload) {\n\t\treturn this.request('dtmf', nanoid(), {\n\t\t\tpayload,\n\t\t});\n\t}\n\n\tjoinRoom(uri) {\n\t\treturn this.request('joinRoom', nanoid(), {\n\t\t\tpayload: {\n\t\t\t\turi,\n\t\t\t},\n\t\t}).then(response => response.payload);\n\t}\n}\n","import nanoid from 'nanoid';\n\nimport {bindMethods} from '../../../../utils';\nimport {default as Logs} from '../../../../Logs';\nimport {Emitter} from './Emitter';\nimport {InvitesAPI} from './InvitesAPI';\nimport {InviteRequestAPI} from './InviteRequestAPI';\nimport ReconnectingWebSocket from 'reconnecting-websocket';\nimport {RegisterAPI} from './RegisterAPI';\nimport {CallTransferAPI} from './CallTransferAPI';\nimport {RoomsAPI} from './RoomsAPI';\nimport {ErrorResponse} from './errors';\n\nconst log = Logs.instance.getLogger('SippoJS/Janus/SignalingClient');\n\nexport const MESSAGE_EVENT = 'message';\n\nexport const CONNECTED = 'connected';\n\nexport const RECONNECTED = 'reconnected';\n\nexport const RECONNECTING = 'reconnecting';\n\nexport const CONNECTION_CLOSED = 'closed';\n\nconst HEARTBEAT_INTERVAL = 35000;\n\nexport class SignalingClient extends Emitter {\n\n\tconstructor(address, dependencies = {}) {\n\t\tsuper();\n\t\tthis.dependencies = dependencies;\n\n\t\tthis.address = address;\n\n\t\tthis.socket = null;\n\n\t\tthis.pending = {};\n\n\t\tthis.invites = new InvitesAPI(this);\n\t\tthis.inviteRequest = new InviteRequestAPI(this);\n\t\tthis.register = new RegisterAPI(this);\n\t\tthis.callTransfer = new CallTransferAPI(this);\n\t\tthis.rooms = new RoomsAPI(this);\n\n\t\tthis.running = false;\n\n\t\tbindMethods(this, ['onMessage', 'onClose']);\n\n\t\tthis.pingTimer = 0;\n\t}\n\n\tget ready() {\n\t\treturn !!this.socket;\n\t}\n\n\tinit() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlog.debug(`init with address ${this.address}`);\n\t\t\tif (this.ready) {\n\t\t\t\treject(new Error('already initialized'));\n\t\t\t}\n\t\t\tthis.running = true;\n\t\t\tconst RWS = this.dependencies.ReconnectingWebSocket || ReconnectingWebSocket;\n\t\t\tlet socket = new RWS(this.address, 'jt', {\n\t\t\t\tminReconnectionDelay: 10000,\n\t\t\t\tconnectionTimeout: 4000,\n\t\t\t\tdebug: true,\n\t\t\t});\n\t\t\tsocket.onopen = () => {\n\t\t\t\tlog.debug(`socket created with ${this.address}`);\n\t\t\t\tthis.socket = socket;\n\t\t\t\tthis.socket.onclose = this.onClose.bind(this);\n\t\t\t\tthis.socket.onerror = this.onClose.bind(this);\n\t\t\t\tthis.socket.onmessage = this.onMessage.bind(this);\n\t\t\t\tthis.emit(CONNECTED);\n\t\t\t\tthis.heartbeat();\n\t\t\t\tresolve(this);\n\t\t\t};\n\t\t\tsocket.onerror = this.handlerErrorSocket.bind(this);\n\t\t\tsocket.onclose = this.handlerErrorSocket.bind(this);\n\t\t});\n\t}\n\n\thandlerErrorSocket(error) {\n\t\tlog.error(`socket error with ${this.address}`, JSON.stringify(error));\n\t\tclearTimeout(this.pingTimer);\n\t}\n\n\tuninit() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlog.debug('uninit');\n\t\t\tif (!this.ready) {\n\t\t\t\treject(new Error('not initialized'));\n\t\t\t}\n\t\t\tthis.running = false;\n\t\t\tclearTimeout(this.pingTimer);\n\t\t\tthis.closePendingMessages();\n\t\t\tthis.socket.onclose = this.socket.onerror = () => {\n\t\t\t\tthis.unbindSocketEvents();\n\t\t\t\tthis.socket = null;\n\t\t\t\tthis.emit(CONNECTION_CLOSED);\n\t\t\t\tresolve(this);\n\t\t\t};\n\t\t\tthis.socket.close(undefined, undefined, {keepClosed: true});\n\t\t});\n\t}\n\n\tclosePendingMessages() {\n\t\tObject.keys(this.pending).forEach((id) => {\n\t\t\tlog.warn('pending request exist on uninit with id', id);\n\t\t\tthis.pending[id].reject(new Error('uninit'));\n\t\t\tdelete this.pending[id];\n\t\t});\n\t}\n\n\tsend(data, id, retry) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlog.debug('send', data);\n\t\t\tif (!this.ready) {\n\t\t\t\treturn reject(new Error('not initialized'));\n\t\t\t}\n\t\t\tif (id) {\n\t\t\t\tlet pending = {\n\t\t\t\t\tresolve: resolve,\n\t\t\t\t\treject: reject,\n\t\t\t\t};\n\t\t\t\tif (typeof retry === 'number') {\n\t\t\t\t\tpending.timer = setInterval(() => {\n\t\t\t\t\t\tretry--;\n\t\t\t\t\t\tif (retry <= 0) {\n\t\t\t\t\t\t\tclearInterval(pending.timer);\n\t\t\t\t\t\t\tpending.reject(new Error('timeout'));\n\t\t\t\t\t\t\tdelete this.pending[id];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tthis.socket.send(JSON.stringify(data));\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\tthrow Error('Session closed');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 2000);\n\t\t\t\t}\n\t\t\t\tthis.pending[id] = pending;\n\t\t\t} else {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\tdata.requestID = data.requestID || nanoid();\n\t\t\tthis.socket.send(JSON.stringify(data));\n\t\t});\n\t}\n\n\tonMessage(msg) {\n\t\tlog.debug(`received ${msg.data}`);\n\t\tvar data = JSON.parse(msg.data);\n\t\tif (data.request === 'ping') {\n\t\t\tthis.heartbeat();\n\t\t\tthis.send({answer: 'ping'});\n\t\t}\n\t\tlet pending = this.pending[data.requestID];\n\t\tif (pending) {\n\t\t\tclearInterval(pending.timer);\n\t\t\tdelete this.pending[data.requestID];\n\t\t\tif (data.error) {\n\t\t\t\treturn pending.reject(new ErrorResponse(data.error));\n\t\t\t}\n\t\t\treturn pending.resolve(data);\n\t\t}\n\t\tthis.emit(MESSAGE_EVENT, data);\n\t}\n\n\theartbeat() {\n\t\tclearTimeout(this.pingTimer);\n\t\tthis.pingTimer = setTimeout(() => {\n\t\t\tthis.stopCurrentSocketAndReconnect();\n\t\t}, HEARTBEAT_INTERVAL);\n\t}\n\n\tstopCurrentSocketAndReconnect() {\n\t\tthis.closeCurrentSocket();\n\t\tthis.cleanState();\n\t\tthis.reconnect();\n\t}\n\n\tcloseCurrentSocket() {\n\t\tthis.unbindSocketEvents();\n\t\tthis.socket.close(undefined, undefined, {keepClosed: true});\n\t}\n\n\tasync reconnect() {\n\t\ttry {\n\t\t\tthis.emit(RECONNECTING);\n\t\t\tawait this.init();\n\t\t\tthis.emit(RECONNECTED);\n\t\t} catch (error) {\n\t\t\tthis.unbindSocketEvents();\n\t\t\tthis.cleanState();\n\t\t\tthis.closePendingMessages();\n\t\t\tthis.emit(CONNECTION_CLOSED);\n\t\t}\n\t}\n\n\tcleanState() {\n\t\tclearTimeout(this.pingTimer);\n\t\tthis.running = false;\n\t\tthis.socket = null;\n\t}\n\n\tunbindSocketEvents() {\n\t\tif (this.socket) {\n\t\t\tthis.socket.onmessage = this.socket.onclose = this.socket.onerror = () => {};\n\t\t}\n\t}\n\n\tasync onClose() {\n\t\tif (this.ready) {\n\t\t\tthis.stopCurrentSocketAndReconnect();\n\t\t}\n\t}\n}\n","import {bindMethods} from '../../../utils';\nimport {default as Logs} from '../../../Logs';\nimport {\n\tSignalingClient,\n\tCONNECTION_CLOSED as CLIENT_CONNECTION_CLOSED,\n\tCONNECTED as CLIENT_CONNECTED,\n\tRECONNECTING as CLIENT_RECONNECTING,\n\tRECONNECTED as CLIENT_RECONNECTED,\n} from './signaling/Client';\nimport {EventEmitter2} from 'eventemitter2';\n\nconst log = Logs.instance.getLogger('SippoJS/Janus/Session');\n\nexport const SESSION_CONNECTED = 'connected';\n\nexport const RECONNECTING = 'reconnecting';\n\nexport const RECONNECTED = 'reconnected';\n\nexport const SESSION_CLOSED = 'closed';\n\nexport class Session extends EventEmitter2 {\n\tconstructor(address, userName, token = ';', applicationToken = '', dependencies = {}) {\n\t\tsuper();\n\t\tthis.dependencies = dependencies;\n\n\t\tthis.signaling = null;\n\n\t\tthis.address = address;\n\n\t\tthis.username = userName;\n\n\t\tthis.token = token;\n\n\t\tthis.applicationToken = applicationToken;\n\n\t\tthis.session = null;\n\n\t\tbindMethods(this, ['onSessionClosed']);\n\t}\n\n\tget registered() {\n\t\treturn !!this.session;\n\t}\n\n\tget peerId() {\n\t\treturn this.session.id;\n\t}\n\n\tasync register({deviceId} = {}) {\n\t\tlet signaling = new SignalingClient(this.address, this.dependencies);\n\t\ttry {\n\t\t\tlog.debug(`register ${this.username}`);\n\t\t\tthis.deviceId = deviceId;\n\t\t\tif (this.registered) {\n\t\t\t\tthrow new Error('already registered');\n\t\t\t}\n\t\t\tthis.bindSignalingEvents(signaling);\n\t\t\tawait signaling.init();\n\t\t\tawait this.login(signaling, {deviceId: this.deviceId});\n\t\t\tthis.onSessionCreated(signaling);\n\t\t} catch (error) {\n\t\t\tlog.error('register failed with error', error);\n\t\t\tif (signaling && signaling.ready) {\n\t\t\t\tsignaling.uninit();\n\t\t\t}\n\t\t\tthrow new Error('registration failed');\n\t\t}\n\t}\n\n\tasync unregister() {\n\t\ttry {\n\t\t\tif (!this.registered) {\n\t\t\t\tthrow new Error('not registered');\n\t\t\t}\n\t\t\tawait this.signaling.register.logout();\n\t\t\tawait this.signaling.uninit();\n\t\t} catch (error) {\n\t\t\tlog.error('unregister failed with error', error);\n\t\t\tthrow new Error('unregister failed');\n\t\t}\n\t}\n\n\tasync suspend() {\n\t\tthis.unbindSignalingEvents();\n\t\tawait this.signaling.register.logout();\n\t\tawait this.signaling.uninit();\n\t\tlog.debug('session suspended');\n\t}\n\n\tasync resume() {\n\t\tawait this.signaling.init();\n\t\tawait this.login(this.signaling, {deviceId: this.deviceId});\n\t\tthis.bindSignalingEvents(this.signaling);\n\t\tlog.debug('session resumed');\n\t}\n\n\tasync login(signaling, {deviceId} = {}) {\n\t\tconst registry = await signaling.register.login(\n\t\t\tthis.username,\n\t\t\t`${this.token}${this.applicationToken}`,\n\t\t\t{\n\t\t\t\tdeviceId,\n\t\t\t},\n\t\t);\n\t\tthis.session = registry;\n\t}\n\n\tonSessionCreated(signaling) {\n\t\tlog.debug('session created');\n\t\tthis.signaling = signaling;\n\t\tthis.emit(SESSION_CONNECTED);\n\t}\n\n\tonSessionClosed() {\n\t\tlog.debug('session closed');\n\t\tthis.unbindSignalingEvents();\n\t\tthis.signaling = null;\n\t\tthis.session = null;\n\t\tthis.emit(SESSION_CLOSED);\n\t}\n\n\tbindSignalingEvents(signaling) {\n\t\tsignaling.on(CLIENT_CONNECTED, () => {\n\t\t\tsignaling.removeAllListeners(CLIENT_CONNECTED);\n\t\t\tsignaling.on(CLIENT_RECONNECTING, this.onReconnecting.bind(this));\n\t\t\tsignaling.on(CLIENT_RECONNECTED, this.onReconnected.bind(this));\n\t\t});\n\t\tsignaling.on(CLIENT_CONNECTION_CLOSED, this.onSessionClosed);\n\t}\n\n\tonReconnecting() {\n\t\tthis.emit(RECONNECTING);\n\t}\n\n\tasync onReconnected() {\n\t\ttry {\n\t\t\tawait this.login(this.signaling, {deviceId: this.deviceId});\n\t\t\tthis.emit(RECONNECTED, this);\n\t\t} catch (err) {\n\t\t\tthis.onSessionClosed();\n\t\t}\n\t}\n\n\tunbindSignalingEvents() {\n\t\tif (this.signaling) {\n\t\t\tthis.signaling.removeAllListeners(CLIENT_CONNECTED);\n\t\t\tthis.signaling.removeAllListeners(CLIENT_RECONNECTING);\n\t\t\tthis.signaling.removeAllListeners(CLIENT_RECONNECTED);\n\t\t\tthis.signaling.removeAllListeners(CLIENT_CONNECTION_CLOSED);\n\t\t}\n\t}\n}\n","import {bindMethods} from '../../../utils';\nimport {Conferences} from './Conferences';\nimport EventClass from '../EventClass';\nimport {\n\tSession,\n\tSESSION_CLOSED,\n\tRECONNECTING as SESSION_RECONNECTING,\n\tRECONNECTED as SESSION_RECONNECTED,\n} from './Session';\n\nconst CAPABILITIES = [\n\t'audio',\n\t'video',\n\t'audio-call',\n\t'video-call',\n\t'audio-video-call',\n\t'media-update',\n\t'multicall',\n\t'conferences',\n\t'conference-hold',\n];\n\nclass AlreadyRegisteredError extends Error {\n\tconstructor(message) {\n\t\tsuper(message);\n\t\tthis.name = 'Already registered';\n\t}\n}\n\nexport class Janus extends EventClass {\n\tconstructor(dependencies = {}) {\n\t\tsuper();\n\t\tthis.dependencies = dependencies;\n\n\t\t/**\n\t\t * Conference management\n\t\t * @private\n\t\t * @type {Conferences}\n\t\t */\n\t\tthis.conferences = new Conferences(dependencies);\n\n\t\t/**\n\t\t * Signaling server {Session}\n\t\t * @private\n\t\t * @type {Session}\n\t\t */\n\t\tthis.session = null;\n\n\t\tbindMethods(this, ['onSessionClosed', 'onSessionReconnected', 'onSessionReconnecting']);\n\t}\n\n\tget conference() {\n\t\treturn this.conferences;\n\t}\n\n\tgetSession() {\n\t\treturn this.session;\n\t}\n\n\tstart() {\n\t\tthis.trigger('qs-ready');\n\t\treturn Promise.resolve();\n\t}\n\n\tcapabilities() {\n\t\treturn CAPABILITIES;\n\t}\n\n\tasync register(credential, {deviceId}) {\n\t\ttry {\n\t\t\tif (this.session) {\n\t\t\t\tthrow new AlreadyRegisteredError('already registered or registering');\n\t\t\t}\n\t\t\tthis.session = new Session(\n\t\t\t\tcredential.authserver,\n\t\t\t\tcredential.username,\n\t\t\t\tcredential.token,\n\t\t\t\tcredential.applicationToken,\n\t\t\t\tthis.dependencies,\n\t\t\t);\n\t\t\tawait this.session.register({deviceId});\n\t\t\tawait this.onSessionCreated();\n\t\t\tthis.trigger('qs-register-success');\n\t\t} catch (error) {\n\t\t\tif (!(error instanceof AlreadyRegisteredError)) {\n\t\t\t\tthis.session = null;\n\t\t\t}\n\t\t\tthis.trigger('qs-register-error');\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tasync unregister() {\n\t\ttry {\n\t\t\tif (!this.session || !this.session.registered) {\n\t\t\t\tthrow new Error('not registered');\n\t\t\t}\n\t\t\tawait this.session.unregister();\n\t\t\tawait this.onSessionClosed();\n\t\t\tthis.trigger('qs-unregister-success');\n\t\t} catch (error) {\n\t\t\tthis.trigger('qs-unregister-error');\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tsuspendSession() {\n\t\treturn this.conferences.suspend().then(() => this.session.suspend());\n\t}\n\n\tresumeSession() {\n\t\treturn this.session.resume().then(() => this.conferences.resume());\n\t}\n\n\tversion() {\n\t\treturn [];\n\t}\n\n\t/**\n\t * Method called internally when session was created\n\t * @private\n\t */\n\tonSessionCreated() {\n\t\tthis.session.on(SESSION_CLOSED, this.onSessionClosed);\n\t\tthis.session.on(SESSION_RECONNECTING, this.onSessionReconnecting);\n\t\tthis.session.on(SESSION_RECONNECTED, this.onSessionReconnected);\n\t\treturn this.conferences.init(this.session).then(() => {\n\t\t\tthis.trigger('qs-registered');\n\t\t});\n\t}\n\n\t/**\n\t * Method called internally when session is reconnecting\n\t * @private\n\t */\n\tonSessionReconnecting() {\n\t\tthis.trigger('qs-reconnecting');\n\t}\n\n\t/**\n\t * Method called internally when session is reconnected\n\t * @private\n\t */\n\tonSessionReconnected() {\n\t\tthis.trigger('qs-reconnected');\n\t}\n\n\t/**\n\t * Method called internally when session is no longer available\n\t * @private\n\t */\n\tonSessionClosed() {\n\t\tthis.conferences.uninit();\n\t\tif (this.session) {\n\t\t\tthis.session.off(SESSION_CLOSED, this.onSessionClosed);\n\t\t\tthis.session.off(SESSION_RECONNECTING, this.onSessionReconnecting);\n\t\t\tthis.session.off(SESSION_RECONNECTED, this.onSessionReconnected);\n\t\t\tthis.session = null;\n\t\t\tthis.trigger('qs-unregistered');\n\t\t}\n\t}\n}\n","const apply = th => args => fun => fun.apply(th, args);\n\nexport default class EventClass {\n\tconstructor() {\n\t\tthis._callbacks = {};\n\t}\n\n\ton(evtNames, callback) {\n\t\tevtNames.split(' ').map((evtName) => {\n\t\t\tif (!this._callbacks[evtName]) {\n\t\t\t\tthis._callbacks[evtName] = [];\n\t\t\t}\n\t\t\tif (!this._callbacks[evtName].includes(callback)) {\n\t\t\t\tthis._callbacks[evtName].push(callback);\n\t\t\t}\n\t\t});\n\t\treturn this;\n\t}\n\n\toff(evtNames, callback) {\n\t\tif (callback) {\n\t\t\tevtNames.split(' ').forEach((evtName) => {\n\t\t\t\tif (this._callbacks[evtName]) {\n\t\t\t\t\tthis._callbacks[evtName] = this._callbacks[evtName].filter(cb => cb !== callback);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (evtNames) {\n\t\t\tevtNames.split(' ').forEach((evtName) => {\n\t\t\t\tthis._callbacks[evtName] = [];\n\t\t\t});\n\t\t} else {\n\t\t\tthis._callbacks = {};\n\t\t}\n\t\treturn this;\n\t}\n\n\tonce(evtNames, callback) {\n\t\tvar callbackMod = (...args) => {\n\t\t\tcallback.apply(this, args);\n\t\t\tthis.off(evtNames, callbackMod);\n\t\t};\n\t\tthis.on(evtNames, callbackMod);\n\t\treturn this;\n\t}\n\n\ttrigger(evtName, ...data) {\n\t\tif (this._callbacks[evtName] != null) {\n\t\t\tthis._callbacks[evtName].forEach(apply(this)(data));\n\t\t}\n\t\treturn this;\n\t}\n}\n","import baseDifference from './_baseDifference.js';\nimport baseFlatten from './_baseFlatten.js';\nimport baseRest from './_baseRest.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Creates an array of `array` values not included in the other given arrays\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons. The order and references of result values are\n * determined by the first array.\n *\n * **Note:** Unlike `_.pullAll`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...Array} [values] The values to exclude.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.without, _.xor\n * @example\n *\n * _.difference([2, 1], [2, 3]);\n * // => [1]\n */\nvar difference = baseRest(function(array, values) {\n  return isArrayLikeObject(array)\n    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n    : [];\n});\n\nexport default difference;\n","export var WapiState;\n(function (WapiState) {\n    WapiState[WapiState[\"CONNECTING\"] = 0] = \"CONNECTING\";\n    WapiState[WapiState[\"CONNECTED\"] = 1] = \"CONNECTED\";\n    WapiState[WapiState[\"DISCONNECTING\"] = 2] = \"DISCONNECTING\";\n    WapiState[WapiState[\"DISCONNECTED\"] = 3] = \"DISCONNECTED\";\n    WapiState[WapiState[\"SUSPENDED\"] = 4] = \"SUSPENDED\";\n    WapiState[WapiState[\"SUSPENDING\"] = 5] = \"SUSPENDING\";\n})(WapiState || (WapiState = {}));\n//# sourceMappingURL=WapiState.js.map","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport basePickBy from './_basePickBy.js';\nimport getAllKeysIn from './_getAllKeysIn.js';\n\n/**\n * Creates an object composed of the `object` properties `predicate` returns\n * truthy for. The predicate is invoked with two arguments: (value, key).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The source object.\n * @param {Function} [predicate=_.identity] The function invoked per property.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.pickBy(object, _.isNumber);\n * // => { 'a': 1, 'c': 3 }\n */\nfunction pickBy(object, predicate) {\n  if (object == null) {\n    return {};\n  }\n  var props = arrayMap(getAllKeysIn(object), function(prop) {\n    return [prop];\n  });\n  predicate = baseIteratee(predicate);\n  return basePickBy(object, props, function(value, path) {\n    return predicate(value, path[0]);\n  });\n}\n\nexport default pickBy;\n","export var WapiMessageType;\n(function (WapiMessageType) {\n    WapiMessageType[\"PING\"] = \"0\";\n    WapiMessageType[\"PONG\"] = \"1\";\n    WapiMessageType[\"REQUEST\"] = \"2\";\n    WapiMessageType[\"RESPONSE\"] = \"3\";\n    WapiMessageType[\"CONTROL\"] = \"4\";\n})(WapiMessageType || (WapiMessageType = {}));\n//# sourceMappingURL=messages.js.map","const DEFAULT_OPTIONS = {\n    connectionTimeout: 4000,\n    requestTimeout: 60000,\n    maxRetries: 10,\n    minReconnectionDelay: 1000 + Math.random() * 4000,\n    maxReconnectionDelay: 10000,\n    reconnectionDelayGrowFactor: 1.3,\n    pingInterval: 30000,\n};\nfunction getGlobalWebSocket() {\n    return WebSocket;\n}\nexport function withDefaults(options) {\n    const { WebSocket = getGlobalWebSocket(), logger = console, connectionTimeout = DEFAULT_OPTIONS.connectionTimeout, requestTimeout = DEFAULT_OPTIONS.requestTimeout, maxRetries = DEFAULT_OPTIONS.maxRetries, minReconnectionDelay = DEFAULT_OPTIONS.minReconnectionDelay, maxReconnectionDelay = DEFAULT_OPTIONS.maxReconnectionDelay, reconnectionDelayGrowFactor = DEFAULT_OPTIONS.reconnectionDelayGrowFactor, pingInterval = DEFAULT_OPTIONS.pingInterval, } = options;\n    return {\n        WebSocket,\n        logger,\n        connectionTimeout,\n        requestTimeout,\n        maxRetries,\n        minReconnectionDelay,\n        maxReconnectionDelay,\n        reconnectionDelayGrowFactor,\n        pingInterval,\n    };\n}\n//# sourceMappingURL=options.js.map","import { __awaiter } from \"tslib\";\n/** @hidden */\nexport class RequestMap {\n    constructor(timeout) {\n        this.requests = {};\n        this.timeout = timeout;\n    }\n    insert(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                const timer = setTimeout(() => {\n                    reject(new Error(`No server response received after ${this.timeout}ms`));\n                }, this.timeout);\n                this.requests[id] = { resolve, reject, timer };\n            });\n        });\n    }\n    resolve(id, res) {\n        const req = this.requests[id];\n        if (!req) {\n            throw new Error(`Received server response for a non-existent id: ${id}`);\n        }\n        clearTimeout(req.timer);\n        req.resolve(res);\n        delete this.requests[id];\n    }\n}\n//# sourceMappingURL=RequestMap.js.map","import { __awaiter, __rest } from \"tslib\";\nimport EventEmitter from 'eventemitter3';\nimport { WapiMessageType, } from './messages';\nimport { withDefaults } from './options';\nimport { RequestMap } from './RequestMap';\nimport { WapiState } from './WapiState';\nconst PROTOCOL = 'wapi';\nfunction wait(time) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise(resolve => setTimeout(resolve, time));\n    });\n}\nfunction isWebSocket(w) {\n    return typeof w === 'function' && w.CLOSING === 2;\n}\n/**\n * Instances of this class allows connecting with a WAPI server and receiving and sending messages\n * through it.\n *\n * @example Connection\n * ```typescript\n * const wapiClient = new WapiClient();\n * wapiClient.configure('wss://sippo.com', 'secret');\n * await wapiClient.connect();\n * ```\n *\n * @example Listen to connection attempts and reject them:\n * ```typescript\n * wapiServer.emitter.on('connection', (connection: Connnection) => {\n *   connection.close();\n * });\n * ```\n */\nexport class WapiClient {\n    /**\n     * @param options For defaults values see {@link DEFAULT_OPTIONS}\n     */\n    constructor(options = {}) {\n        this.emitter = new EventEmitter();\n        this.retryCount = -1;\n        this.state = WapiState.DISCONNECTED;\n        this.requestId = 0;\n        this.url = '';\n        this.token = '';\n        this.wapiId = '';\n        this.suspendedId = '';\n        if (options.WebSocket && !isWebSocket(options.WebSocket)) {\n            throw Error('Provided WebSocket is not a valid WebSocket class');\n        }\n        this.options = withDefaults(options);\n        this.requestMap = new RequestMap(this.options.requestTimeout);\n        this.onOpen = this.onOpen.bind(this);\n        this.onClose = this.onClose.bind(this);\n        this.onMessage = this.onMessage.bind(this);\n        this.bindEventListeners = this.bindEventListeners.bind(this);\n        this.unbindEventListeners = this.unbindEventListeners.bind(this);\n    }\n    /**\n     * Returns the current state of the client\n     */\n    getState() {\n        return this.state;\n    }\n    /**\n     * Configures the parameters that are needed to connect with the server\n     * @param url The address where the WAPI server is located\n     * @param token A secret token used for authenticated with the server\n     */\n    configure(url, token) {\n        if (this.state !== WapiState.DISCONNECTED) {\n            throw Error(`Invalid state: ${WapiState[this.state]}`);\n        }\n        this.url = url;\n        this.token = token;\n    }\n    /**\n     * Connects to the server with current configuration.\n     */\n    connect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.state !== WapiState.DISCONNECTED) {\n                throw Error(`Invalid state: ${WapiState[this.state]}`);\n            }\n            this.doConnect();\n            return this.waitForState(WapiState.CONNECTED, WapiState.DISCONNECTED);\n        });\n    }\n    /**\n     * Ends the connection\n     */\n    disconnect() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if ([WapiState.SUSPENDED, WapiState.SUSPENDING].includes(this.state)) {\n                return;\n            }\n            if (![WapiState.CONNECTING, WapiState.CONNECTED].includes(this.state)) {\n                throw Error('Not connected');\n            }\n            this.setState(WapiState.DISCONNECTING);\n            this.socket.close(1000);\n            yield this.waitForState(WapiState.DISCONNECTED, WapiState.CONNECTED);\n        });\n    }\n    /**\n     * Sends a new request to the server\n     * @param method\n     * @param path\n     * @param body\n     */\n    send(method, path, body) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if ([WapiState.SUSPENDING, WapiState.SUSPENDED].includes(this.state)) {\n                throw Error(\"We're suspended/-ing, you cannot send messages\");\n            }\n            if (!this.socket) {\n                throw Error('Not connected');\n            }\n            const id = this.requestId = (this.requestId + 1) % Number.MAX_SAFE_INTEGER;\n            const payload = { id, method, path, body };\n            this.socket.send(WapiMessageType.REQUEST + JSON.stringify(payload));\n            return this.requestMap.insert(id);\n        });\n    }\n    sendControl(body) {\n        if (!this.socket) {\n            throw Error('Not connected');\n        }\n        this.socket.send(WapiMessageType.CONTROL + JSON.stringify(body));\n    }\n    /**\n     * Suspends the connection\n     */\n    suspend() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.setState(WapiState.SUSPENDING);\n            this.suspendedId = this.wapiId;\n            this.sendControl({ action: 'suspend' });\n            this.options.logger.debug('Clearing timers while suspended');\n            clearTimeout(this.connectionTimer);\n            clearTimeout(this.pingTimer);\n            return this.waitForState(WapiState.SUSPENDED, WapiState.DISCONNECTED);\n        });\n    }\n    resume(wapiId) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.state !== WapiState.SUSPENDED) {\n                throw Error(`Invalid state: ${WapiState[this.state]}`);\n            }\n            this.doConnect();\n            yield this.waitForState(WapiState.CONNECTED, WapiState.DISCONNECTED);\n            this.sendControl({ action: 'resume', wapiId: wapiId || this.suspendedId });\n            this.suspendedId = '';\n        });\n    }\n    doConnect() {\n        const log = this.options.logger;\n        const { WebSocket, maxRetries, connectionTimeout } = this.options;\n        if (++this.retryCount > maxRetries) {\n            log.debug('Maximum number of retries reached');\n            this.setState(WapiState.DISCONNECTED);\n            return;\n        }\n        log.debug(`Trying to establish a connection with the server. Retry count: ${this.retryCount}`);\n        this.setState(WapiState.CONNECTING);\n        this.socket = new WebSocket(this.url, [PROTOCOL]);\n        this.bindEventListeners();\n        this.connectionTimer = setTimeout(() => {\n            log.debug('Timeout waiting for connection establishment');\n            if (this.socket) {\n                if (this.socket.readyState === WebSocket.OPEN) {\n                    this.socket.close(4408);\n                }\n                this.unbindEventListeners();\n                delete this.socket;\n            }\n            this.setState(WapiState.DISCONNECTED);\n        }, connectionTimeout);\n    }\n    onOpen() {\n        const log = this.options.logger;\n        log.debug('Socket open. Sending AUTH message');\n        this.retryCount = -1;\n        this.socket.send(`AUTH ${this.token}`);\n    }\n    onMessage(event) {\n        const log = this.options.logger;\n        if (this.state === WapiState.CONNECTING) {\n            clearTimeout(this.connectionTimer);\n            this.heartbeat();\n            let authData = {\n                status: 400,\n                wapiId: '',\n            };\n            try {\n                authData = JSON.parse(event.data);\n            }\n            catch (err) {\n                log.error(`Failed to parse auth data: ${event.data}`);\n                this.disconnect().catch(log.error);\n            }\n            if (authData.status === 200) {\n                log.debug('Success in authentication received from server');\n                this.setState(WapiState.CONNECTED);\n                this.wapiId = authData.wapiId;\n            }\n            else {\n                log.error(event.data);\n                this.disconnect().catch(log.error);\n            }\n        }\n        else if (this.state === WapiState.CONNECTED) {\n            const type = event.data[0];\n            if (type === WapiMessageType.PING) {\n                this.heartbeat();\n                this.socket.send(WapiMessageType.PONG);\n            }\n            else if (type === WapiMessageType.RESPONSE) {\n                this.processResponse(event.data.substring(1));\n            }\n            else {\n                log.warn(`Ignoring message with WapiMessageType: ${type}`);\n            }\n        }\n        else {\n            log.warn(`Ignoring message received in ${WapiState[this.state]} state`);\n        }\n    }\n    heartbeat() {\n        const log = this.options.logger;\n        const { pingInterval } = this.options;\n        clearTimeout(this.pingTimer);\n        this.pingTimer = setTimeout(() => {\n            log.warn(`No PING received from server in the last ${pingInterval * 1.5}ms. Disconnecting...`);\n            this.doConnect();\n        }, pingInterval * 1.5);\n    }\n    processResponse(data) {\n        const log = this.options.logger;\n        let payload;\n        try {\n            payload = JSON.parse(data);\n        }\n        catch (error) {\n            log.error(`Problem parsing message \"${data}\"`, error);\n            return;\n        }\n        if (typeof payload.id === 'number') {\n            const _a = payload, { id } = _a, res = __rest(_a, [\"id\"]);\n            this.requestMap.resolve(id, res);\n        }\n        else {\n            const eventData = payload;\n            this.emitter.emit('event', eventData);\n        }\n    }\n    onClose(event) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const log = this.options.logger;\n            this.unbindEventListeners();\n            clearTimeout(this.connectionTimer);\n            clearTimeout(this.pingTimer);\n            delete this.socket;\n            if (this.state === WapiState.DISCONNECTING) {\n                log.debug('Disconnected.');\n                this.setState(WapiState.DISCONNECTED);\n                return;\n            }\n            switch (event.code) {\n                case 1000:\n                case 4400:\n                case 4401:\n                case 4408:\n                    this.setState(WapiState.DISCONNECTED);\n                    log.debug('Connection closed by the server.');\n                    return;\n                case 3001:\n                    this.setState(WapiState.SUSPENDED);\n                    log.debug('Connection suspended by client.');\n                    return;\n            }\n            const delay = this.getNextDelay();\n            log.debug(`Connection unexpectedly closed (${event.code}). Waiting ${delay.toFixed(1)}ms before reconnecting`);\n            yield wait(delay);\n            this.doConnect();\n        });\n    }\n    setState(state) {\n        this.options.logger.debug(`setState(${state})`);\n        if (this.state !== state) {\n            this.state = state;\n            this.emitter.emit('state', state);\n        }\n    }\n    bindEventListeners() {\n        this.socket.addEventListener('open', this.onOpen);\n        this.socket.addEventListener('close', this.onClose);\n        this.socket.addEventListener('message', this.onMessage);\n    }\n    unbindEventListeners() {\n        this.socket.removeEventListener('open', this.onOpen);\n        this.socket.removeEventListener('close', this.onClose);\n        this.socket.removeEventListener('message', this.onMessage);\n    }\n    waitForState(successState, failureState) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                const onState = (state) => {\n                    if (state === successState) {\n                        this.emitter.off('state', onState);\n                        resolve();\n                    }\n                    else if (state === failureState) {\n                        this.emitter.off('state', onState);\n                        reject(Error(`Invalid state: ${WapiState[state]}`));\n                    }\n                };\n                this.emitter.on('state', onState);\n            });\n        });\n    }\n    getNextDelay() {\n        const { minReconnectionDelay, maxReconnectionDelay, reconnectionDelayGrowFactor } = this.options;\n        const delay = minReconnectionDelay * reconnectionDelayGrowFactor ** this.retryCount;\n        return Math.min(delay, maxReconnectionDelay);\n    }\n}\n//# sourceMappingURL=WapiClient.js.map","import {EventEmitter2} from 'eventemitter2';\nimport queryString from 'query-string';\nimport {pickBy} from 'lodash-es';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\nimport {WapiClient, WapiState} from '@quobis/wapi-client';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/WacRequest');\n\nexport class WacRequest {\n\tconstructor() {\n\t\t/** @type {EventEmitter} */\n\t\tthis.emitter = new EventEmitter2({\n\t\t\twildcard: true,\n\t\t\tdelimiter: '/',\n\t\t});\n\n\t\tthis.wapi = new WapiClient();\n\n\t\tbindMethods(this, ['onWapiEvent']);\n\n\t\tthis._urls = {};\n\t}\n\n\tinit() {\n\t\tthis.wapi.emitter.on('event', this.onWapiEvent);\n\t}\n\n\tuninit() {\n\t\tthis.wapi.emitter.off('event', this.onWapiEvent);\n\t}\n\n\t/** @private */\n\tonWapiEvent(msg) {\n\t\tlet eventName = msg.path.substring(1);\n\t\tthis.emitter.emit(eventName, {\n\t\t\tmethod: msg.method,\n\t\t\tpath: msg.path,\n\t\t\tbody: msg.body,\n\t\t});\n\t}\n\n\t/**\n\t * Assigns the well-known URLs to this WacRequest instance\n\t *\n\t * @param {Object} urls The different transports' URLs exposed by sippo-server\n\t * @param {string} urls.urn:quobis:sippo:websocket The URL for the WAPI v3 endpoint\n     */\n\tset urls(urls) {\n\t\tthis._urls = urls;\n\t}\n\n\t/**\n\t * Configures the token to use in the wapi client\n\t * @param {string} token\n\t */\n\tset token(token) {\n\t\tthis.wapi.configure(this._urls['urn:quobis:sippo:websocket'], token);\n\t}\n\n\tasync request(options = {}) {\n\t\tif (this.wapi.getState() !== WapiState.CONNECTED) {\n\t\t\tlog.debug('Dropping request while disconnected');\n\t\t\treturn;\n\t\t}\n\t\tconst method = options.method || 'GET';\n\t\tconst qs = queryString.stringify(options.qs);\n\t\tconst url = options.url + (qs ? '?' + qs : '');\n\t\tconst body = Array.isArray(options.body)\n\t\t\t? options.body\n\t\t\t: pickBy(options.body, v => typeof v !== 'undefined');\n\t\tlog.debug(`Request ${method} ${url}`, body);\n\t\tconst res = await this.wapi.send(method, url, body);\n\t\tif (res.status >= 300) {\n\t\t\tlog.error('Unexpected response', options, res);\n\t\t\tthrow new Error(res.status);\n\t\t}\n\t\tlog.debug(`Response ${method} ${url}`, res.status, res.body);\n\t\treturn res.body;\n\t}\n\n\tget(url, qs = {}) {\n\t\treturn this.request({\n\t\t\tmethod: 'GET',\n\t\t\turl: url,\n\t\t\tqs: qs,\n\t\t});\n\t}\n\n\tpost(url, qs = {}, body = {}) {\n\t\treturn this.request({\n\t\t\tmethod: 'POST',\n\t\t\turl: url,\n\t\t\tqs: qs,\n\t\t\tbody: body,\n\t\t});\n\t}\n\n\tput(url, qs = {}, body = {}) {\n\t\treturn this.request({\n\t\t\tmethod: 'PUT',\n\t\t\turl: url,\n\t\t\tqs: qs,\n\t\t\tbody: body,\n\t\t});\n\t}\n\n\tdelete(url, qs = {}) {\n\t\treturn this.request({\n\t\t\tmethod: 'DELETE',\n\t\t\turl: url,\n\t\t\tqs: qs,\n\t\t});\n\t}\n}\n","import {LoginError} from '../errors';\n\nexport class SapiClient {\n\t/**\n     * @param {Object} urls\n\t * @param {string} urls.urn:quobis:sippo:https The URL for the SAPI endpoint\n     */\n\tset urls(urls) {\n\t\tif (!urls['urn:quobis:sippo:https']) {\n\t\t\tthrow new Error('No valid URL found for SAPI');\n\t\t}\n\t\tthis._url = urls['urn:quobis:sippo:https'];\n\t}\n\n\tasync login(provider, token, deviceId) {\n\t\treturn this._request(`${this._url}/login`, {\n\t\t\t'grant_type': 'oauth2',\n\t\t\tprovider,\n\t\t\ttoken,\n\t\t\tcontext: this._getContext(deviceId),\n\t\t}).catch((err) => {\n\t\t\tthrow new LoginError('Failed to login', err.message);\n\t\t});\n\t}\n\n\tasync recover(token) {\n\t\treturn this._request(`${this._url}/login/sessionToken`, {token}).catch((err) => {\n\t\t\tthrow new LoginError('Failed to recover session', err.message);\n\t\t});\n\t}\n\n\tasync _request(url, body) {\n\t\tif (!this._url) {\n\t\t\tthrow new Error('No URL set');\n\t\t}\n\t\tconst options = {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tredirect: 'follow',\n\t\t\tbody: JSON.stringify(body),\n\t\t};\n\t\tconst response = await fetch(url, options);\n\t\tif (response.status >= 200 && response.status < 300) {\n\t\t\tconst json = await response.json();\n\t\t\treturn json;\n\t\t} else {\n\t\t\tthrow new Error('Non 200 OK response');\n\t\t}\n\t}\n\n\t/**\n\t * getContext foo\n\t *\n\t * @param {string} deviceId The Device's ID\n\t */\n\t_getContext(deviceId) {\n\t\tlet language = navigator.language || 'en';\n\t\tif (navigator.languages && navigator.languages.length) {\n\t\t\tlanguage = navigator.languages[0];\n\t\t}\n\t\tlet context = {\n\t\t\tuseragent: navigator.userAgent,\n\t\t\tlanguage: language,\n\t\t\tlocation: this._getLocationHref(),\n\t\t\tplatform: navigator.platform,\n\t\t\tvendor: navigator.vendor,\n\t\t\tdeviceId,\n\t\t};\n\t\treturn context;\n\t}\n\n\t_getLocationHref() {\n\t\treturn location.href;\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {createClient, JID, Utils} from 'stanza';\nimport Semaphore from 'semaphore-async-await';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\nconst log = Logs.instance.getLogger('SippoJS/WacStack/XmppClient');\n\nexport class XmppClient {\n\tconstructor(chatUri, token, jid) {\n\t\tthis.lock = new Semaphore(1);\n\t\tthis.throttleLock = new Semaphore(100);\n\t\tthis.mucJoinPromise = {};\n\t\tthis.messagePromise = {};\n\t\tthis.options = {\n\t\t\tjid,\n\t\t\tpassword: token,\n\t\t\ttimeout: 50,\n\t\t\ttransports: {\n\t\t\t\twebsocket: chatUri,\n\t\t\t},\n\t\t};\n\t\tthis.emitter = new EventEmitter2();\n\t\tbindMethods(this, [\n\t\t\t'onEvent',\n\t\t\t'onStanzaAcked',\n\t\t\t'onMucError',\n\t\t\t'onMucJoin',\n\t\t\t'onDisconnected',\n\t\t]);\n\t}\n\n\tasync start() {\n\t\tif (this.started) {\n\t\t\tthrow Error('already started');\n\t\t}\n\t\tthis.started = true;\n\t\tawait this.lock.acquire();\n\t\tthis.client = createClient(this.options);\n\t\tconst cachedSM = sessionStorage.getItem('cachedSM');\n\t\tif (cachedSM) {\n\t\t\tthis.client.sm.load(JSON.parse(cachedSM, Utils.reviveData));\n\t\t}\n\t\ttry {\n\t\t\tawait this.connectClient();\n\t\t} catch (error) {\n\t\t\tif (error.message === 'SESSION_ENDED') {\n\t\t\t\tsessionStorage.removeItem('cachedSM');\n\t\t\t\tawait this.disconnectClient();\n\t\t\t\tthis.client = createClient(this.options);\n\t\t\t\tawait this.connectClient();\n\t\t\t} else {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t\tthis.bindEventListeners();\n\t\tthis.client.sm.cache((state) => {\n\t\t\tsessionStorage.setItem('cachedSM', JSON.stringify(state));\n\t\t});\n\t\tawait this.client.getRoster();\n\t\tthis.client.updateCaps();\n\t\tthis.client.sendPresence({caps: this.client.disco.caps});\n\t\tthis.client.enableKeepAlive({interval: 20, timeout: 10});\n\t\tawait this.client.enableCarbons();\n\t\tthis.lock.release();\n\t}\n\n\tasync stop() {\n\t\tif (!this.started) {\n\t\t\tthrow Error('not started');\n\t\t}\n\t\tthis.started = false;\n\t\tawait this.lock.acquire();\n\t\tthis.unbindEventListeners();\n\t\tsessionStorage.removeItem('cachedSM');\n\t\tawait this.disconnectClient();\n\t\tdelete this.client;\n\t\tthis.lock.release();\n\t}\n\n\tasync suspend() {\n\t\tthis.started = false;\n\t\tawait this.lock.acquire();\n\t\tthis.unbindEventListeners();\n\t\tnew Promise((resolve, reject) => {\n\t\t\tthis.client.transport.conn.addEventListener('close', resolve);\n\t\t\tthis.client.transport.conn.addEventListener('error', reject);\n\t\t\tthis.client.transport.conn.close();\n\t\t}).catch(log.error); // Don't await here to avoid unnecessary delays if socket is not instantly closed\n\t\tdelete this.client;\n\t\tthis.lock.release();\n\t}\n\n\tasync resume() {\n\t\tawait this.start();\n\t}\n\n\tasync connectClient() {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet onSuccess, onError, onSessionEnd;\n\t\t\tconst unbind = () => {\n\t\t\t\tthis.client.off('session:started', onSuccess);\n\t\t\t\tthis.client.off('session:end', onSessionEnd);\n\t\t\t\tthis.client.off('stream:management:resumed', onSuccess);\n\t\t\t\tthis.client.off('auth:failed', onError);\n\t\t\t};\n\t\t\tonSuccess = () => {\n\t\t\t\tunbind();\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\tonError = () => {\n\t\t\t\tunbind();\n\t\t\t\treject(Error('XMPP authentication error'));\n\t\t\t};\n\t\t\tonSessionEnd = () => {\n\t\t\t\tunbind();\n\t\t\t\treject(Error('SESSION_ENDED'));\n\t\t\t};\n\t\t\tthis.client.on('auth:failed', onError);\n\t\t\tthis.client.on('session:end', onSessionEnd);\n\t\t\tthis.client.on('session:started', onSuccess);\n\t\t\tthis.client.on('stream:management:resumed', onSuccess);\n\t\t\tthis.client.connect();\n\t\t});\n\t}\n\n\tdisconnectClient() {\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.client.once('disconnected', resolve);\n\t\t\tthis.client.disconnect();\n\t\t});\n\t}\n\n\tonDisconnected() {\n\t\tif (!this.started || this.reconnectingInterval) {\n\t\t\treturn;\n\t\t}\n\t\tthis.client.once('connected', () => {\n\t\t\tclearInterval(this.reconnectingInterval);\n\t\t\tthis.reconnectingInterval = null;\n\t\t});\n\t\tthis.reconnectingInterval = setInterval(() => {\n\t\t\tthis.client.connect();\n\t\t}, 10000);\n\t}\n\n\tbindEventListeners() {\n\t\tthis.client.on('*', this.onEvent);\n\t\tthis.client.on('muc:join', this.onMucJoin);\n\t\tthis.client.on('muc:error', this.onMucError);\n\t\tthis.client.on('stanza:acked', this.onStanzaAcked);\n\t\tthis.client.on('disconnected', this.onDisconnected);\n\t}\n\n\tunbindEventListeners() {\n\t\tthis.client.off('*', this.onEvent);\n\t\tthis.client.off('muc:join', this.onMucJoin);\n\t\tthis.client.off('muc:error', this.onMucError);\n\t\tthis.client.off('stanza:acked', this.onStanzaAcked);\n\t\tthis.client.off('disconnected', this.onDisconnected);\n\t}\n\n\tsendMessage(data) {\n\t\tconst id = this.client.sendMessage(data);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.messagePromise[id] = {resolve, reject};\n\t\t});\n\t}\n\n\tmarkReceived(to, id, type) {\n\t\tconst msg = {from: to, type, id, marker: {type: 'markable'}};\n\t\treturn this.client.markReceived(msg);\n\t}\n\n\tasync markDisplayed(to, id, type) {\n\t\tconst msg = {from: to, type, id, marker: {type: 'markable'}};\n\t\tawait this.client.markDisplayed(msg);\n\t}\n\n\tasync searchHistory(data) {\n\t\tawait this.throttleLock.acquire();\n\t\tconst res = await this.client.searchHistory(data);\n\t\tthis.throttleLock.release();\n\t\treturn res;\n\t}\n\n\tgetBookmarks() {\n\t\treturn this.client.getBookmarks();\n\t}\n\n\tasync addBookmark(data) {\n\t\tawait this.lock.acquire();\n\t\ttry {\n\t\t\tawait this.client.addBookmark(data);\n\t\t} finally {\n\t\t\tthis.lock.release();\n\t\t}\n\t}\n\n\tasync removeBookmark(jid) {\n\t\tawait this.lock.acquire();\n\t\ttry {\n\t\t\tawait this.client.removeBookmark(jid);\n\t\t} finally {\n\t\t\tthis.lock.release();\n\t\t}\n\t}\n\n\tasync getDiscoInfo(jid) {\n\t\tawait this.throttleLock.acquire();\n\t\tconst res = await this.client.getDiscoInfo(jid);\n\t\tthis.throttleLock.release();\n\t\treturn res;\n\t}\n\n\tgetRoomConfig(jid) {\n\t\treturn this.client.getRoomConfig(jid);\n\t}\n\n\tconfigureRoom(room, form) {\n\t\treturn this.client.configureRoom(room, form);\n\t}\n\n\tdestroyRoom(room, options) {\n\t\treturn this.client.destroyRoom(room, options);\n\t}\n\n\tasync getRoomMembers(jid, affiliation) {\n\t\tawait this.throttleLock.acquire();\n\t\tconst res = await this.client.getRoomMembers(jid, {affiliation});\n\t\tthis.throttleLock.release();\n\t\treturn res;\n\t}\n\n\tasync joinRoom(jid, nick, options) {\n\t\tawait this.throttleLock.acquire();\n\t\tthis.client.joinRoom(jid, nick, options);\n\t\tconst res = await new Promise((resolve, reject) => {\n\t\t\tthis.mucJoinPromise[jid] = {resolve, reject};\n\t\t});\n\t\tthis.throttleLock.release();\n\t\treturn res;\n\t}\n\n\tinvite(room, options) {\n\t\treturn this.client.invite(room, options);\n\t}\n\n\tsetRoomAffiliation(room, jid, affiliation, reason) {\n\t\treturn this.client.setRoomAffiliation(room, jid, affiliation, reason);\n\t}\n\n\tsetSubject(room, subject) {\n\t\treturn this.client.setSubject(room, subject);\n\t}\n\n\tasync deleteAccount(jid) {\n\t\ttry {\n\t\t\tawait this.client.deleteAccount(jid);\n\t\t} catch (error) {\n\t\t\tif (error.type !== 'error') {\n\t\t\t\tthrow error;\n\t\t\t}\n\t\t\tif (error.error.condition !== 'gone') {\n\t\t\t\tthrow Error(error.error.text);\n\t\t\t}\n\t\t}\n\t}\n\n\tenableNotifications(jid, node, fieldList) {\n\t\treturn this.client.enableNotifications(jid, node, fieldList);\n\t}\n\n\tdisableNotifications(jid, node) {\n\t\treturn this.client.disableNotifications(jid, node);\n\t}\n\n\tonEvent(eventName, eventData) {\n\t\tlog.debug(eventName, eventData);\n\t\tthis.emitter.emit(eventName, eventData);\n\t}\n\n\tonStanzaAcked(event) {\n\t\tif (event.kind === 'message') {\n\t\t\tconst obj = this.messagePromise[event.stanza.id];\n\t\t\tif (obj) {\n\t\t\t\tobj.resolve(event.stanza.id);\n\t\t\t\tdelete this.messagePromise[event.stanza.id];\n\t\t\t}\n\t\t}\n\t}\n\n\tonMucError(event) {\n\t\tconst id = JID.toBare(event.from);\n\t\tif (this.mucJoinPromise[id]) {\n\t\t\tthis.mucJoinPromise[id].reject(new Error(event.error.text));\n\t\t\tdelete this.mucJoinPromise[id];\n\t\t}\n\t}\n\n\tonMucJoin(event) {\n\t\tconst id = JID.toBare(event.from);\n\t\tif (this.mucJoinPromise[id]) {\n\t\t\tthis.mucJoinPromise[id].resolve();\n\t\t\tdelete this.mucJoinPromise[id];\n\t\t}\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/CallAttemptService');\nconst PATH = '/callAttempts/';\n\nexport class CallAttemptService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, ['onEvent', 'onInstanceEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('callAttempts', this.onEvent);\n\t\tthis.wacRequest.emitter.on('callAttempts/*', this.onInstanceEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'post':\n\t\t\t\tthis.emitter.emit('created', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\t/** @private */\n\tonInstanceEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'delete':\n\t\t\t\tthis.emitter.emit('rejected', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\taccept(id) {\n\t\treturn this.wacRequest.put(PATH + id, {}, {accepted: true});\n\t}\n\n\treject(id) {\n\t\treturn this.wacRequest.put(PATH + id, {}, {accepted: false});\n\t}\n\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/CallService');\nconst PATH = '/calls/';\n\nexport class CallService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, ['onEvent', 'onInstanceEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('calls', this.onEvent);\n\t\tthis.wacRequest.emitter.on('calls/*', this.onInstanceEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'post':\n\t\t\t\tthis.emitter.emit('created', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\t/** @private */\n\tonInstanceEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\t\tthis.emitter.emit('updated', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\tget({after, before, limit, sortBy, caller, callee, target, queueposition} = {}) {\n\t\treturn this.wacRequest.get(PATH, {\n\t\t\tafter, before, limit, sortBy, caller, callee, target, queueposition,\n\t\t});\n\t}\n\n\tcreate({caller, callee, context, anonymousSessionId} = {}) {\n\t\treturn this.wacRequest.post(PATH, {}, {\n\t\t\tcaller, callee, context, anonymousSessionId,\n\t\t});\n\t}\n\n\tupdate(id, {caller, callee, context, anonymousSessionId, state} = {}) {\n\t\treturn this.wacRequest.put(PATH + id, {}, {\n\t\t\tcaller, callee, context, anonymousSessionId, state,\n\t\t});\n\t}\n\n}\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseFlatten from './_baseFlatten.js';\nimport baseRest from './_baseRest.js';\nimport baseUniq from './_baseUniq.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\n\n/**\n * Creates an array of unique values, in order, from all given arrays using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of combined values.\n * @example\n *\n * _.union([2], [1, 2]);\n * // => [2, 1]\n */\nvar union = baseRest(function(arrays) {\n  return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n});\n\nexport default union;\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../utils';\nimport {union} from 'lodash-es';\n\nconst PATH = '/capabilities';\n\n/** @private */\nexport class CapabilitiesService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tbindMethods(this, ['onEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on(PATH, this.onEvent);\n\t}\n\n\t/** @private */\n\tasync onEvent(event) {\n\t\tif (event.method === 'put') {\n\t\t\tawait this.process(event.body);\n\t\t\tthis.emitter.emit('change');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync populate() {\n\t\tconst res = await this.wacRequest.get(PATH);\n\t\tthis.process(res);\n\t}\n\n\t/** @private */\n\tasync process(data) {\n\t\tconst domain = data.domain;\n\t\tconst user = data.user.filter(item => item.startsWith('+')).map(item => item.slice(1));\n\t\tthis.capabilities = union(domain, user);\n\t\tthis.forbiddenCapabilities = data.user.filter(item => item.startsWith('-')).map(item => item.slice(1));\n\t}\n\n\tasync getCapabilities() {\n\t\tif (!this.capabilities) {\n\t\t\tawait this.populate();\n\t\t}\n\t\treturn this.capabilities;\n\t}\n\n\tasync getForbiddenCapabilities() {\n\t\tif (!this.forbiddenCapabilities) {\n\t\t\tawait this.populate();\n\t\t}\n\t\treturn this.forbiddenCapabilities;\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\n\nimport {bindMethods} from '../../utils';\n\nconst PATH = '/conferences';\n\n/** @protected */\nexport class ConferenceLogService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tbindMethods(this, ['onEvent']);\n\t\tthis.emitter = new EventEmitter2({wildcard: true});\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('conferences', this.onEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tthis.emitter.emit('create', event.body);\n\t}\n\n\tfetch(limit, lastEntryStartTimestamp) {\n\t\treturn this.wacRequest.get(PATH, {\n\t\t\tlimit,\n\t\t\tcreatedAt: lastEntryStartTimestamp,\n\t\t});\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../utils';\n\nconst PATH = 'datapipe';\n\n/** @private */\nexport class DatapipeService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tbindMethods(this, ['onEvent', 'onInstanceEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on(PATH, this.onEvent);\n\t\tthis.wacRequest.emitter.on([PATH, '*'], this.onInstanceEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'post':\n\t\t\t\treturn this.emitter.emit('invite', event.body);\n\t\t\t// no default\n\t\t}\n\t}\n\n\t/** @private */\n\tonInstanceEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'post':\n\t\t\t\treturn this.emitter.emit('data', event.body);\n\t\t\tcase 'put':\n\t\t\t\treturn this.emitter.emit('update', event.body);\n\t\t\tcase 'del':\n\t\t\t\treturn this.emitter.emit('delete', event.body);\n\t\t\t// no default\n\t\t}\n\t}\n\n\tget() {\n\t\treturn this.wacRequest.get(PATH);\n\t}\n\n\tcreate(label, participants) {\n\t\treturn this.wacRequest.post(PATH, {}, {label, participants});\n\t}\n\n\taccept(id, session) {\n\t\treturn this.wacRequest.put(`${PATH}/${id}`, {}, {session});\n\t}\n\n\tdelete(id) {\n\t\treturn this.wacRequest.delete(`${PATH}/${id}`);\n\t}\n\n\tsend(id, data) {\n\t\treturn this.wacRequest.post(`${PATH}/${id}`, {}, {data});\n\t}\n}\n","import io from 'socket.io-client';\nimport SocketIoFileClient from '@quobis/socket.io-file-client';\nimport {EventEmitter2} from 'eventemitter2';\n\nimport {bindMethods} from '../../utils/bindMethods';\n\nconst PATH = '/filesharing/';\n\n/** @protected */\nexport class FileSharingService {\n\tconstructor(wacRequest, fileUploadUrl, token) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.fileUploadUrl = fileUploadUrl;\n\t\tthis.token = token;\n\t\tthis.socketsPromise = null;\n\n\t\tthis.emitter = new EventEmitter2();\n\n\t\tbindMethods(this, [\n\t\t\t'onFile',\n\t\t\t'onDisconnect',\n\t\t\t'onStart',\n\t\t\t'onStream',\n\t\t\t'onComplete',\n\t\t\t'onAbort',\n\t\t\t'onError',\n\t\t]);\n\t}\n\n\tasync createSocket() {\n\t\tlet url = new URL(this.fileUploadUrl);\n\t\tconst socket = new io(`${url.protocol}//${url.hostname}:${url.port}`, {path: url.pathname});\n\t\tsocket.once('connect', () => {\n\t\t\tsocket.on('disconnect', this.onDisconnect);\n\t\t\tsocket.emit('authentication', {[this.token.token_type]: this.token.access_token});\n\t\t});\n\t\tawait new Promise(resolve => socket.once('authenticated', resolve));\n\t\tconst fileUploader = new SocketIoFileClient(socket);\n\t\tawait new Promise(resolve => fileUploader.on('ready', resolve));\n\t\tfileUploader.off('ready');\n\t\tsocket.on('file', this.onFile);\n\t\tfileUploader.on('start', this.onStart);\n\t\tfileUploader.on('stream', this.onStream);\n\t\tfileUploader.on('complete', this.onComplete);\n\t\tfileUploader.on('abort', this.onAbort);\n\t\tfileUploader.on('error', this.onError);\n\t\treturn [socket, fileUploader];\n\t}\n\n\tgetSockets() {\n\t\tif (!this.socketsPromise) {\n\t\t\tthis.socketsPromise = this.createSocket();\n\t\t}\n\t\treturn this.socketsPromise;\n\t}\n\n\tasync onDisconnect() {\n\t\tconst [socket, fileUploader] = await this.socketsPromise;\n\t\tthis.socketsPromise = null;\n\t\tsocket.off('disconnect', this.onDisconnect);\n\t\tsocket.off('file', this.onFile);\n\t\tfileUploader.off('start', this.onStart);\n\t\tfileUploader.off('stream', this.onStream);\n\t\tfileUploader.off('complete', this.onComplete);\n\t\tfileUploader.off('abort', this.onAbort);\n\t\tfileUploader.off('error', this.onError);\n\t}\n\n\tonFile(event) {\n\t\tthis.emitter.emit('file', event);\n\t}\n\n\tonStart(event) {\n\t\tthis.emitter.emit('start', event);\n\t}\n\n\tonStream(event) {\n\t\tthis.emitter.emit('stream', event);\n\t}\n\n\tonComplete(event) {\n\t\tthis.emitter.emit('complete', event);\n\t}\n\n\tonAbort(event) {\n\t\tthis.emitter.emit('abort', event);\n\t}\n\n\tonError(event) {\n\t\tthis.emitter.emit('error', event);\n\t}\n\n\tasync upload(file) {\n\t\tconst [, uploader] = await this.getSockets();\n\t\tconst [id] = uploader.upload([file]);\n\t\treturn id;\n\t}\n\n\tasync abort(id) {\n\t\tconst [, uploader] = await this.getSockets();\n\t\tuploader.abort(id);\n\t}\n\n\tcreateSharedFile(key) {\n\t\treturn this.wacRequest.post(PATH, {}, {key}).then(res => res.publicUrl);\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\n\nimport {bindMethods} from '../../utils';\n\nconst PATH = 'usersGroup';\n\nfunction getEventData(data) {\n\treturn {\n\t\tid: data.groupId,\n\t\tname: data.name,\n\t\tparticipants: data.participants,\n\t\towner: `${data.owner.username}@${data.owner.domain}`,\n\t};\n}\n\n/** @private */\nexport class GroupService {\n\tconstructor(wacRequest) {\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.wacRequest = wacRequest;\n\t\tbindMethods(this, ['onEvent', 'onParticipantEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on(PATH, this.onEvent);\n\t\tthis.wacRequest.emitter.on(`${PATH}/participant`, this.onParticipantEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\tcase 'post':\n\t\t\t\treturn this.emitter.emit('put', getEventData(event.body));\n\t\t\tcase 'delete':\n\t\t\t\treturn this.emitter.emit('delete', {id: event.body.groupId});\n\t\t\t// no default\n\t\t}\n\t}\n\n\t/** @private */\n\tonParticipantEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\t\treturn this.emitter.emit('put', getEventData(event.body));\n\t\t\tcase 'delete':\n\t\t\t\treturn this.emitter.emit('put', getEventData(event.body));\n\t\t\t// no default\n\t\t}\n\t}\n\n\tasync fetch() {\n\t\tconst res = await this.wacRequest.get(PATH, {participating: true});\n\t\treturn res.groupList.map(getEventData);\n\t}\n\n\tasync create(name, participants) {\n\t\tconst group = await this.wacRequest.post(PATH, {}, {name});\n\t\tconst id = group.groupId;\n\t\tawait Promise.all(participants.map(targetUserId =>\n\t\t\tthis.wacRequest.post(`${PATH}/${id}/participants`, {}, {targetUserId})),\n\t\t);\n\t\treturn {id, name, participants};\n\t}\n\n\tupdate(id, name, participants) {\n\t\treturn this.wacRequest.put(`${PATH}/${id}`, {}, {id, name, participants});\n\t}\n\n\tdelete(id) {\n\t\treturn this.wacRequest.delete(`${PATH}/${id}`);\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/MeetingService');\nconst PATH = '/meetings/';\n\nexport class MeetingService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, ['onEvent', 'onInstanceEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('meetings', this.onEvent);\n\t\tthis.wacRequest.emitter.on('meetings/*', this.onInstanceEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\t/** @private */\n\tonInstanceEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\t\tthis.emitter.emit('update', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled WAC event: ', event);\n\t\t}\n\t}\n\n\tget({language, phone, name, validUntil} = {}) {\n\t\treturn this.wacRequest.get(PATH, {language, phone, name, validUntil});\n\t}\n\n\tcreate({name, participants, language, validSince, validUntil} = {}) {\n\t\treturn this.wacRequest.post(PATH, {}, {name, participants, language, validSince, validUntil});\n\t}\n\n\tupdate(id, {name, participants, language, validSince, validUntil} = {}) {\n\t\treturn this.wacRequest.put(PATH + id, {sendInvites: true}, {\n\t\t\tname, participants, language, validSince, validUntil,\n\t\t});\n\t}\n\n\tdelete(id) {\n\t\treturn this.wacRequest.delete(PATH + id);\n\t}\n}\n","const PATH = '/phonebook';\n\nexport class PhonebookService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t}\n\n\tasync getPhonebooksBySubscriberId(subscriberId) {\n\t\tconst res = await this.wacRequest.get(PATH, {subscriberId});\n\t\treturn res.phonebooks;\n\t}\n}\n","const PATH = '/pushNotifications';\n\nexport class PushNotificationsService {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t}\n\n\tnotifyToken(deviceId, tokenType, token) {\n\t\treturn this.wacRequest.post(PATH, {}, {deviceId, tokenType, token});\n\t}\n\n\tdestroyToken(deviceId) {\n\t\treturn this.wacRequest.delete(PATH, {}, {deviceId});\n\t}\n}\n","import EventEmitter from 'eventemitter3';\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack/Resolver');\nconst PATH = 'resolver';\n\nexport class Resolver {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter();\n\t\tbindMethods(this, ['onEvent']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on([PATH, '**'], this.onEvent);\n\t}\n\n\t/** @private */\n\tonEvent(event) {\n\t\tswitch (event.method) {\n\t\t\tcase 'put':\n\t\t\t\tthis.emitter.emit('updated', event.body);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.warn('Unhandled event: ', event);\n\t\t}\n\t}\n\n\tgetResolvedUsers() {\n\t\treturn this.wacRequest.get(`/${PATH}/user/`);\n\t}\n\n\tresolveUsers(addresses) {\n\t\treturn this.wacRequest.post(`/${PATH}/user/`, {}, addresses);\n\t}\n\n\tupdateResolvedUsers(addresses) {\n\t\treturn this.wacRequest.put(`/${PATH}/user/`, {}, addresses);\n\t}\n\n\tgetUserByGatewayUsername(username) {\n\t\treturn this.wacRequest.post(`/${PATH}/userByGatewayUsername/`, {}, {username: username});\n\t}\n\n\tgetGatewayUsernameByUser(userId) {\n\t\treturn this.wacRequest.post(`/${PATH}/gatewayUsernameByUser/`, {}, {id: userId});\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../../utils';\n\nexport class CallStats {\n\tconstructor(wacRequest) {\n\t\tthis.pathname = '/stats/call';\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, ['onStatsEnable', 'sendStats']);\n\t\tthis.bindEventHandlers();\n\t}\n\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('/stats/call', this.onStatsEnable);\n\t}\n\n\tonStatsEnable(event) {\n\t\tthis.emitter.emit('qs-enable-stats', event.body);\n\t}\n\n\tsendStats(service, ts, message, payload) {\n\t\tconst body = {\n\t\t\tservice,\n\t\t\tts,\n\t\t\tmessage,\n\t\t\tpayload,\n\t\t};\n\t\treturn this.wacRequest.post(this.pathname, {}, body);\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nexport class Contact {\n\n\tconstructor(wacRequest) {\n\t\tthis.pathname = '/contacts';\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.wacRequest.emitter.on('contacts/', this.onContact.bind(this));\n\t\tthis.wacRequest.emitter.on('contacts/insert_many', this.onContacts.bind(this));\n\t\tthis.wacRequest.emitter.on('contacts/:id', this.onContactChanged.bind(this));\n\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\n\t\tthis.getContacts = this.getContacts.bind(this);\n\t\tthis.addContact = this.addContact.bind(this);\n\t\tthis.invalidateContacts = this.invalidateContacts.bind(this);\n\t\tthis.updateContact = this.updateContact.bind(this);\n\t\tthis.removeContact = this.removeContact.bind(this);\n\t\tthis.searchContact = this.searchContact.bind(this);\n\t\tthis.insertMany = this.insertMany.bind(this);\n\t\tthis.getContactsWacUser = this.getContactsWacUser.bind(this);\n\t}\n\n\tonContact(event) {\n\t\tthis.emitter.emit('qs-contact-add', event.body);\n\t}\n\n\tonContacts(event) {\n\t\tthis.emitter.emit('qs-contact-add-many', event.body);\n\t}\n\n\tonContactChanged(event) {\n\t\tif (event.method === 'put') {\n\t\t\tthis.emitter.emit('qs-contact-update', event.body);\n\t\t} else if (event.method === 'del') {\n\t\t\tthis.emitter.emit('qs-contact-remove', event.body);\n\t\t}\n\t}\n\n\tgetContacts(query = {}) {\n\t\treturn this.wacRequest.get(this.pathname, query);\n\t}\n\n\taddContact(data) {\n\t\treturn this.wacRequest.post(this.pathname, {}, data);\n\t}\n\n\tupdateContact(data) {\n\t\tconst fullPath = `${this.pathname}/${data.id}`;\n\t\treturn this.wacRequest.put(fullPath, {}, data);\n\t}\n\n\t/**\n\t * Delete all contacts from a source\n\t *\n\t * @param  {String} deviceId Identificator of a device\n\t * @return {Promise} Fulfilled promise if success\n\t */\n\tinvalidateContacts(deviceId) {\n\t\treturn this.wacRequest.delete(this.pathname, {deviceId});\n\t}\n\n\tremoveContact(data) {\n\t\tconst fullPath = `${this.pathname}/${data.id}`;\n\t\treturn this.wacRequest.delete(fullPath);\n\t}\n\n\tsearchContact(data) {\n\t\treturn this.getAll(true, data);\n\t}\n\n\tgetAll(ldap = false, data = {}) {\n\t\tif (ldap) {\n\t\t\treturn this.wacRequest.get('/ldap/', {query: data});\n\t\t} else {\n\t\t\treturn this.wacRequest.get(this.pathname, {});\n\t\t}\n\t}\n\n\tinsertMany(data) {\n\t\treturn this.wacRequest.post('/contacts/insert_many', {}, data);\n\t}\n\n\tgetContactsWacUser(query = {}) {\n\t\treturn this.wacRequest.get('/contacts/iswacuser/', query);\n\t}\n}\n","const priv = {\n\tcontext: Symbol('context'),\n\ttimer: Symbol('timer'),\n\tretain: Symbol('retain'),\n\trunning: Symbol('running'),\n};\n\n/**\n * Class that implements a Runnable thread\n *\n * When 'start' method is called '_thread' method will be called\n * periodically\n *\n * @example\n * let foo = 'bar';\n * let thread = new Thread(foo);\n * thread._thread = function() {\n *   console.error('this is', this);\n * }\n * thread.start(1000);\n *\n * > this is [String: 'bar']\n * > this is [String: 'bar']\n * > this is [String: 'bar']\n * > this is [String: 'bar']\n *\n * thread.stop()\n */\nexport class Thread {\n\n\t/**\n\t * Class constructor\n\t *\n\t * @param {Object} context context used in _thread method\n\t */\n\tconstructor(context) {\n\t\tthis[priv.timer] = null;\n\t\tthis[priv.context] = context;\n\t\tthis[priv.retain] = null;\n\t\tthis[priv.running] = false;\n\t}\n\n\t/**\n\t * Start thread execution with given period\n\t *\n\t * @param {Number} period time in ms between consecutive '_thread' method calls\n\t */\n\tstart(period) {\n\t\tif (!this[priv.running]) {\n\t\t\treturn;\n\t\t}\n\t\tthis._timer = setTimeout(() => {\n\t\t\tthis._timer = null;\n\t\t\tlet thread = this._thread.bind(this[priv.context]);\n\t\t\tthread().then((expires) => {\n\t\t\t\tthis.start(expires);\n\t\t\t});\n\t\t}, period / 2);\n\t}\n\n\t/**\n\t * Stop thread execution\n\t *\n\t * @return {Boolean} true if thread stoped, false if already stoped\n\t */\n\tstop() {\n\t\tthis[priv.running] = false;\n\t\tif (this._timer) {\n\t\t\tclearTimeout(this._timer);\n\t\t\tthis._timer = null;\n\t\t}\n\t}\n\n\t/**\n\t * Check if thread is running\n\t *\n\t * @return {Boolean} true if thread is running, false otherwise\n\t */\n\tisRunning() {\n\t\treturn this[priv.running];\n\t}\n\n\t/**\n\t * Retained value\n\t * @protected\n\t * @type {Object}\n\t */\n\tget retained() {\n\t\treturn this[priv.retain];\n\t}\n\n\t/**\n\t * Store an object to be retained periodically\n\t * The expiration time is the one defined by expireField.\n\t * When the retained element has such field with a value < 0, element should\n\t * be updated inmediately. Values > 0 indicate the relative time in ms when\n\t * element will expire. 0 or absence indicates that no updates are required.\n\t * @param {Object} element object to retain\n\t * @param {String} expireField field of element that indicates the expiration\n\t * time in ms.\n\t */\n\tretain(element, expireField) {\n\t\tthis.release();\n\t\tthis[priv.retain] = element;\n\t\tthis[priv.running] = true;\n\t\tlet expires = element[expireField] || 0;\n\t\tif (expires !== 0) {\n\t\t\tthis.start(Math.max(expires, 0));\n\t\t}\n\t}\n\n\t/**\n\t * Remove an object from being retained periodically\n\t */\n\trelease() {\n\t\tthis[priv.retain] = null;\n\t\tthis.stop();\n\t}\n\n\t/**\n\t * @protected\n\t * @return {Promise<Number>} next relative expiration time\n\t */\n\t_thread() {\n\t}\n\n}\n","import {Thread} from '../Thread';\n\nexport class CredentialsThread extends Thread {\n\n\t_thread() {\n\t\treturn this.update(this._thread.retained.id, this._thread.retained.lease).then((credential) => {\n\t\t\tthis._thread.retained.lease = credential.lease;\n\t\t\treturn credential.lease;\n\t\t}).catch((error) => {\n\t\t\tthis.onThreadError(error);\n\t\t});\n\t}\n}\n","import {CredentialsThread} from './CredentialsThread';\n\nexport class Credentials {\n\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\n\t\tthis._retain = {};\n\t\tthis._thread = new CredentialsThread(this);\n\t\tthis.pathname = '/credentials';\n\n\t\tthis.getCredentials = this.getCredentials.bind(this);\n\t}\n\n\tgetCredentials(query) {\n\t\treturn this.wacRequest.get(this.pathname, query);\n\t}\n\n\tupdate(id, lease) {\n\t\tconst body = {\n\t\t\tlease,\n\t\t};\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\treturn this.wacRequest.put(fullPath, {}, body);\n\t}\n\n\tretain(credential) {\n\t\treturn this._thread.retain(credential, 'lease');\n\t}\n\n\trelease() {\n\t\treturn this._thread.release();\n\t}\n\n\tget retained() {\n\t\treturn this._thread.retained;\n\t}\n\n\tonThreadError() {\n\t\tthis.release();\n\t}\n\n}\n","import EventEmitter from 'eventemitter3';\n\ntype Action = () => Promise<void>;\n\ninterface IntervalEvents {\n\terror: [Error];\n}\n\nexport type IntervalId = ReturnType<typeof setInterval>;\n\nexport interface Scheduler {\n\tsetInterval(handler: () => void, timeout: number): IntervalId;\n\tclearInterval(handlerId: IntervalId): void;\n}\n\nexport class EventInterval {\n\tpublic emitter: EventEmitter<IntervalEvents>;\n\tprivate handler?: IntervalId;\n\tprivate action: Action;\n\tprivate interval: number;\n\tprivate scheduler: Scheduler;\n\n\tpublic constructor(\n\t\taction: Action,\n\t\tinterval: number,\n\t\tscheduler: Scheduler,\n\t) {\n\t\tthis.action = action;\n\t\tthis.interval = interval;\n\t\tthis.scheduler = scheduler;\n\t\tthis.emitter = new EventEmitter();\n\t}\n\tpublic run(): void {\n\t\tthis.handler = this.scheduler.setInterval(async () => {\n\t\t\ttry {\n\t\t\t\tawait this.action();\n\t\t\t} catch (e) {\n\t\t\t\tthis.emitter.emit('error', e);\n\t\t\t}\n\t\t}, this.interval);\n\t}\n\n\tprivate clear(): void {\n\t\tif (this.handler) {\n\t\t\tthis.scheduler.clearInterval(this.handler);\n\t\t}\n\t}\n\n\tpublic stop(): void {\n\t\tthis.clear();\n\t}\n}\n","import {EventInterval, Scheduler} from '../EventInterval';\nimport {Session} from './Session';\n\ntype SessionUpdater = (id: string) => Promise<Session>;\n\nexport class SessionsThread {\n\tprivate interval: EventInterval;\n\tprivate retained!: Session;\n\tprivate updateFn: SessionUpdater;\n\tprivate updatedFn: () => void;\n\tprivate onError: () => void;\n\n\tpublic constructor(\n\t\tupdateFn: SessionUpdater,\n\t\tupdatedFn: () => void,\n\t\tonError: () => void,\n\t\tscheduler: Scheduler,\n\t) {\n\t\tthis.updateFn = updateFn;\n\t\tthis.updatedFn = updatedFn;\n\t\tthis.onError = onError;\n\t\tthis.interval = new EventInterval(\n\t\t\tthis.action.bind(this),\n\t\t\t30000,\n\t\t\t{\n\t\t\t\tsetInterval: scheduler.setInterval,\n\t\t\t\tclearInterval: scheduler.clearInterval,\n\t\t\t},\n\t\t);\n\t\tthis.interval.emitter.on('error', this.onError);\n\t}\n\n\tpublic retain(session: Session): void {\n\t\tthis.retained = session;\n\t\tthis.interval.run();\n\t}\n\n\tprivate async action(): Promise<void> {\n\t\tthis.retained = await this.updateFn(this.retained.id);\n\t\tthis.updatedFn();\n\t}\n\n\tpublic release(): void {\n\t\tthis.interval.stop();\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {SessionsThread} from './SessionsThread';\n\nexport class Sessions {\n\n\tconstructor(wacRequest, deps = {}) {\n\t\tconst scheduler = {\n\t\t\tclearInterval: deps.clearInterval ? deps.clearInterval : handler => clearInterval(handler),\n\t\t\tsetInterval: deps.setInterval ? deps.setInterval : (fn, timeout) => setInterval(fn, timeout),\n\t\t};\n\t\tthis.pathname = '/sessions';\n\t\tthis.wacRequest = wacRequest;\n\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\n\t\tthis.getSessions = this.getSessions.bind(this);\n\t\tthis.retain = this.retain.bind(this);\n\t\tthis.release = this.release.bind(this);\n\t\tthis._thread = new SessionsThread(\n\t\t\tthis.update.bind(this),\n\t\t\tthis.onThreadCompleted.bind(this),\n\t\t\tthis.onThreadError.bind(this),\n\t\t\tscheduler,\n\t\t);\n\t}\n\n\tgetSessions(query) {\n\t\treturn this.wacRequest.get(this.pathname, query);\n\t}\n\n\tupdate(id, credential) {\n\t\tconst body = credential ? {\n\t\t\texpires: credential.expires,\n\t\t\tregistered: credential,\n\t\t} : {};\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\treturn this.wacRequest.put(fullPath, {}, body);\n\t}\n\n\tdestroy(id) {\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\treturn this.wacRequest.delete(fullPath);\n\t}\n\n\tretain(session) {\n\t\treturn this._thread.retain(session, 'expires');\n\t}\n\n\trelease() {\n\t\tif (!this.retained) {\n\t\t\treturn;\n\t\t}\n\t\tlet session = this.retained;\n\t\tthis._thread.release();\n\t\tthis.destroy(session.id);\n\t}\n\n\tget retained() {\n\t\treturn this._thread.retained;\n\t}\n\n\tasync suspend() {\n\t\tthis._thread.release();\n\t\tawait this.wacRequest.wapi.suspend();\n\t}\n\n\tasync resume() {\n\t\tawait this.wacRequest.wapi.resume();\n\t\tthis._thread.retain(this.retained);\n\t}\n\n\tonThreadError() {\n\t\tthis.release();\n\t\tthis.emitter.emit('disconnected');\n\t}\n\n\tonThreadCompleted() {\n\t\tthis.emitter.emit('updated');\n\t}\n}\n","export class Login {\n\tconstructor(sapiClient) {\n\t\tthis.pathname = '/login';\n\t\tthis.sapiClient = sapiClient;\n\t}\n\n\tasync doLoginToken(provider, token, deviceId) {\n\t\treturn this.sapiClient.login(provider, token, deviceId);\n\t}\n\n\tasync recoverSession(token) {\n\t\treturn this.sapiClient.recover(token);\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../../../utils';\n\nconst PATH = '/presence';\n\nimport Logs from '../../../Logs';\nconst log = Logs.instance.getLogger('SippoJS/WacStack/Presence');\n\n/**\n * Provides access to WAC presence service.\n *\n * Presences are accessed with an address identifier that determines the user\n * associated with {Presence} object.\n *\n * WAC provices two ways to access user's presence:\n * - Querying current state\n * - Subscribing to presence updates\n *\n * When we are subscribed to presence updates, if user associated with such\n * address updates it's presence we will receive a message that notifies the\n * update\n */\nexport class Presence {\n\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\t\tbindMethods(this, ['onPresencesReceived', 'onContactPresenceUpdated']);\n\t\tthis.bindEventHandlers();\n\t\tlog.warn('PresenceService started');\n\t}\n\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tthis.wacRequest.emitter.on('presence/*', this.onContactPresenceUpdated);\n\t\tthis.wacRequest.emitter.on('batch/presence', this.onPresencesReceived);\n\t}\n\n\tonPresencesReceived(event) {\n\t\tlog.debug(`subscriptions response ${event.body}`);\n\t}\n\n\t/** @private */\n\tonContactPresenceUpdated(event) {\n\t\tconst {path, method} = event;\n\t\tlog.debug(`presence:onContactPresenceUpdated:${method} ${path}`);\n\t\tthis.emitter.emit('presence-updated', event.body);\n\t}\n\n\t/**\n\t * Return a list of presences that we are subscribed to\n\t *\n\t * @return {Promise<Array<Presence>>}\n\t */\n\tgetAll(withoutAvatar = false) {\n\t\ttry {\n\t\t\treturn this.wacRequest.get(PATH, {withoutAvatar});\n\t\t} catch (err) {\n\t\t\tif (err !== 404) {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t\tlog.warn('presence not found (404)');\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Get a presence associated with given address\n\t *\n\t * @param {String} address user address to retrieve presence\n\t *\n\t * @return {Promise<Presence>} resolved with user's presence\n\t */\n\tget(address) {\n\t\treturn this.wacRequest.get(`${PATH}/${address}`);\n\t}\n\n\t/**\n\t * Updates a Presence associated with given address\n\t *\n\t * @param {String} address user address to update presence\n\t * @param {Presence} presence presence to update\n\t *\n\t * @return {Promise<Presence>} resolved with full presence object\n\t */\n\tupdate(address, presence) {\n\t\treturn this.wacRequest.put(`${PATH}/${address}`, {}, presence);\n\t}\n\n\t/**\n\t * Subscribe to user's presence updates\n\t *\n\t * @param {String} address user associated address\n\t *\n\t * @return {Promise<Presence>} resolved with current user presence\n\t */\n\tcreate(address) {\n\t\treturn this.wacRequest.post(PATH, {}, {address});\n\t}\n\n\t/**\n\t * Unsubscribe from user's presence updates\n\t *\n\t * @param {String} address user associated address\n\t *\n\t * @return {Promise}\n\t */\n\tdestroy(address) {\n\t\treturn this.wacRequest.delete(`${PATH}/${address}`);\n\t}\n\n\tunsubscribeFromPresence(address) {\n\t\treturn this.destroy(address);\n\t}\n\n\tsubscribeToPresences(addresses) {\n\t\treturn this.wacRequest.post(`/batch${PATH}`, {}, addresses);\n\t}\n}\n","import * as qs from 'query-string';\n\nexport class Recording {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.pathname = '/recordings';\n\n\t\tthis.getRecordings = this.getRecordings.bind(this);\n\t\tthis.startRecording = this.startRecording.bind(this);\n\t\tthis.stopRecording = this.stopRecording.bind(this);\n\t}\n\n\tgetRecordings(filter) {\n\t\tlet params = '';\n\t\tif (!!Object.keys(filter).length && typeof filter === 'object') {\n\t\t\tparams = qs.stringify(filter);\n\t\t}\n\t\treturn this.wacRequest.get(this.pathame, params);\n\t}\n\n\tstartRecording(id, filename, source) {\n\t\tconst fullPath = `${this.pathname}/start/${id}`;\n\t\tlet body = {};\n\t\tif (filename) {\n\t\t\tbody.filename = filename;\n\t\t}\n\t\tif (source) {\n\t\t\tbody.source = source;\n\t\t}\n\t\treturn this.wacRequest.put(`${fullPath}`, {}, body);\n\t}\n\n\tstopRecording(id) {\n\t\tconst fullPath = `${this.pathname}/stop/${id}`;\n\t\treturn this.wacRequest.put(`${fullPath}`, {}, {});\n\t}\n}\n","import {default as Logs} from '../../../Logs';\n\nexport class RemoteLog {\n\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.pathname = '/remotelog';\n\t\tthis._enabled = false;\n\n\t\tthis._logHandler = this._logHandler.bind(this);\n\t}\n\n\tenable() {\n\t\tif (this._enabled) {\n\t\t\treturn;\n\t\t}\n\t\tLogs.instance.addHandler(this._logHandler);\n\t\tthis._enabled = true;\n\t}\n\n\tdisable() {\n\t\tif (!this._enabled) {\n\t\t\treturn;\n\t\t}\n\t\tLogs.instance.removeHandler(this._logHandler);\n\t\tthis._enabled = false;\n\t}\n\n\tcreate(level, file, text) {\n\t\tconst body = {\n\t\t\tlevel,\n\t\t\tfile,\n\t\t\ttext,\n\t\t};\n\t\treturn this.wacRequest.post(this.pathname, {}, body);\n\t}\n\n\t_logHandler(messages, context) {\n\t\treturn this.create(\n\t\t\tcontext.level.name.toUpperCase(),\n\t\t\tcontext.name, JSON.stringify(messages, null, 2),\n\t\t);\n\t}\n}\n","export class Settings {\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.pathname = '/usersettings';\n\n\t\tthis.getSettings = this.getSettings.bind(this);\n\t\tthis.setSetting = this.setSetting.bind(this);\n\t}\n\n\tgetSettings() {\n\t\treturn this._getAllSettings().then((settings) => {\n\t\t\treturn this._parseSettings(settings);\n\t\t});\n\t}\n\n\tsetSetting(key, value) {\n\t\treturn this._getAllSettings().then((settings) => {\n\t\t\tlet setting = settings.find(item => item.key === key);\n\t\t\tif (setting) {\n\t\t\t\treturn this._updateSettings(setting.id, key, value);\n\t\t\t} else {\n\t\t\t\treturn this._createSettings('wac', key, value);\n\t\t\t}\n\t\t});\n\t}\n\n\t_getAllSettings() {\n\t\treturn this.wacRequest.get(this.pathname);\n\t}\n\n\t_updateSettings(id, key, value) {\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\tconst body = {\n\t\t\t[key]: value,\n\t\t};\n\t\treturn this.wacRequest.put(fullPath, {}, body);\n\t}\n\n\t_createSettings(source, key, value) {\n\t\tconst body = {\n\t\t\tsource,\n\t\t\t[key]: value,\n\t\t};\n\t\treturn this.wacRequest.post(this.pathname, {}, body);\n\t}\n\n\t_parseSettings(settings) {\n\t\tif (!Array.isArray(settings)) {\n\t\t\tsettings = [settings];\n\t\t}\n\t\tconst body = {\n\t\t\tsettings,\n\t\t};\n\t\treturn this.wacRequest.post('/usersettingsparser', {}, body);\n\t}\n}\n","export class User {\n\n\tconstructor(wacRequest) {\n\t\tthis.wacRequest = wacRequest;\n\t\tthis.pathname = '/users';\n\n\t\tthis.updateUser = this.updateUser.bind(this);\n\t\tthis.validatePhone = this.validatePhone.bind(this);\n\t\tthis.getUser = this.getUser.bind(this);\n\t}\n\n\tupdateUser(id, objToUpdate) {\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\treturn this.wacRequest.put(fullPath, {}, objToUpdate);\n\t}\n\n\tgetUser(id) {\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\treturn this.wacRequest.get(fullPath);\n\t}\n\n\tvalidatePhone(id, code, phone) {\n\t\tconst fullPath = `${this.pathname}/${id}`;\n\t\tconst body = {\n\t\t\tcode,\n\t\t\tphone,\n\t\t};\n\t\treturn this.wacRequest.post(fullPath, {}, body);\n\t}\n}\n","import {difference} from 'lodash-es';\nimport {EventEmitter2 as EventEmitter} from 'eventemitter2';\nimport {WapiState} from '@quobis/wapi-client';\n\nimport {bindMethods} from '../../utils';\nimport Logs from '../../Logs';\nimport {LoginError, WacInternalError, AlreadyLoggedError} from '../errors';\n\nimport {WacRequest} from './WacRequest';\nimport {SapiClient} from './SapiClient';\nimport {XmppClient} from './XmppClient';\nimport {CallAttemptService} from './CallAttemptService';\nimport {CallService} from './CallService';\nimport {CapabilitiesService} from './CapabilitiesService';\nimport {ChatService} from './ChatService';\nimport {ConferenceLogService} from './ConferenceLogService';\nimport {DatapipeService} from './DatapipeService';\nimport {FileSharingService} from './FileSharingService';\nimport {GroupService} from './GroupService';\nimport {MeetingService} from './MeetingService';\nimport {PhonebookService} from './PhonebookService';\nimport {PushNotificationsService} from './PushNotificationsService';\nimport {Resolver} from './Resolver';\n\nimport {CallStats as CallStatsService} from './call-stats/CallStats';\nimport {Contact as ContactService} from './contact/Contact';\nimport {Credentials as CredentialsService} from './credentials/Credentials';\nimport {Sessions as SessionsService} from './sessions/Sessions';\nimport {Login as LoginService} from './login/Login';\nimport {Presence as PresenceService} from './presence/Presence';\nimport {Recording as RecordingService} from './recording/Recording';\nimport {RemoteLog as RemoteLogService} from './remote-log/RemoteLog';\nimport {Settings as SettingsService} from './settings/Settings';\nimport {User as UserService} from './user/User';\n\nconst log = Logs.instance.getLogger('SippoJS/WacStack');\nconst events = Logs.instance.getLogger('SippoJS/WacStack events');\n\nexport class WacStack extends EventEmitter {\n\tconstructor(wacUri, wacRequest, sapiClient) {\n\t\tsuper();\n\t\t// TODO: Specify a correct number here\n\t\tthis.setMaxListeners(0);\n\t\tthis.WACVersion = '';\n\t\tthis.wacUri = wacUri;\n\t\tthis.urls = {};\n\t\tthis._reconnecting = false;\n\t\tthis.wacRequest = wacRequest || new WacRequest();\n\t\tthis.sapiClient = sapiClient || new SapiClient();\n\t\tbindMethods(this, [\n\t\t\t'onCapabilitiesChange',\n\t\t\t'onClose',\n\t\t\t'onConnection',\n\t\t\t'onWapiStateChange',\n\t\t]);\n\t}\n\n\t// FIXME: kept for not breaking WacStack API, but this needs some love\n\tgenerateWacProxyActions() {\n\t\t// Actions which will be managed by the services\n\t\tthis.actionProxy = {\n\t\t\t// CONTACT\n\t\t\t'getContacts': this.contactService.getContacts,\n\t\t\t'addContact': this.contactService.addContact,\n\t\t\t'updateContact': this.contactService.updateContact,\n\t\t\t'removeContact': this.contactService.removeContact,\n\t\t\t'searchContact': this.contactService.searchContact,\n\t\t\t'invalidateContacts': this.contactService.invalidateContacts,\n\t\t\t'insertMany': this.contactService.insertMany,\n\t\t\t'getContactsWacUser': this.contactService.getContactsWacUser,\n\t\t\t// SETTINGS\n\t\t\t'getSettings': this.settingsService.getSettings,\n\t\t\t'setSetting': this.settingsService.setSetting,\n\t\t\t// STATS/CALL\n\t\t\t'sendStats': this.callStatsService.sendStats,\n\t\t\t// SESSION\n\t\t\t'getSessions': this.sessionsService.getSessions,\n\t\t\t'retainSession': this.sessionsService.retain,\n\t\t\t'releaseSession': this.sessionsService.release,\n\t\t\t// CREDENTIALS\n\t\t\t'getCredentials': this.credentialsService.getCredentials,\n\t\t\t// USER\n\t\t\t'getUser': this.userService.getUser,\n\t\t\t'updateUser': this.userService.updateUser,\n\t\t\t'validatePhone': this.userService.validatePhone,\n\t\t};\n\t\tfor (const action in this.actionProxy) {\n\t\t\tthis[action] = this.actionProxy[action];\n\t\t}\n\t}\n\n\tonWapiStateChange(state) {\n\t\tlog.debug(`Wapi connection transitioned to ${state}`);\n\t\tswitch (state) {\n\t\t\tcase WapiState.CONNECTED:\n\t\t\t\tthis.onConnection();\n\t\t\t\tbreak;\n\t\t\tcase WapiState.DISCONNECTED:\n\t\t\t\t// FIXME we need more information from underlying wapi client about the reason\n\t\t\t\tthis.onClose('io server disconnect');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlog.debug('No handler for this wapi state transition');\n\t\t}\n\t}\n\n\tasync start() {\n\t\tconst res = await fetch(`${this.wacUri}/.well-known/host-meta.json`);\n\t\tconst data = await res.json();\n\t\tfor (const element of data.links) {\n\t\t\tthis.urls[element.rel] = element.href;\n\t\t}\n\t\tthis.wacRequest.urls = this.urls;\n\t\tthis.sapiClient.urls = this.urls;\n\t\tthis.generateWacProxyActions();\n\t}\n\n\tasync stop() {\n\t\tif (this.getCurrentCredential()) {\n\t\t\tthis.releaseCredential();\n\t\t}\n\t\tif (this.getCurrentSession()) {\n\t\t\tthis.releaseSession();\n\t\t}\n\t\tif (this.wacRequest) {\n\t\t\tthis.wacRequest.uninit();\n\t\t}\n\t\tif (this.wacRequest.wapi.getState() === WapiState.DISCONNECTED) {\n\t\t\treturn this;\n\t\t}\n\t\tthis.wacRequest.wapi.emitter.off('state', this.onWapiStateChange);\n\t\tconst xmpp = this._chatService ? this._chatService.stop() : Promise.resolve();\n\t\tawait Promise.all([this.wacRequest.wapi.disconnect(), xmpp]);\n\t}\n\n\tloginToken(provider, token, deviceId) {\n\t\treturn this.processLogin(this.loginService.doLoginToken(provider, token, deviceId));\n\t}\n\n\tasync processLogin(loginPromise) {\n\t\ttry {\n\t\t\tconst wapiToken = await loginPromise;\n\t\t\tthis._wapiToken = wapiToken;\n\t\t\tthis._username = wapiToken.session.userObj.username;\n\t\t\tthis._domain = wapiToken.session.userObj.domain;\n\t\t\tthis.wacRequest.token = wapiToken.access_token;\n\t\t\tthis.wacRequest.init();\n\t\t\tthis.wacRequest.wapi.emitter.on('state', this.onWapiStateChange);\n\t\t\tawait this.wacRequest.wapi.connect();\n\t\t\tthis.capabilitiesService = new CapabilitiesService(this.wacRequest);\n\t\t\tthis.capabilitiesService.emitter.on('change', this.onCapabilitiesChange);\n\t\t\tawait this.onCapabilitiesChange();\n\t\t\treturn wapiToken;\n\t\t} catch (error) {\n\t\t\tswitch (error.message) {\n\t\t\t\tcase 403:\n\t\t\t\t\tthrow new LoginError();\n\t\t\t\tcase 409:\n\t\t\t\t\tthrow new AlreadyLoggedError();\n\t\t\t\tcase 500:\n\t\t\t\t\tthrow new WacInternalError();\n\t\t\t\tdefault:\n\t\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\n\t}\n\n\trecoverSession(token) {\n\t\treturn this.processLogin(this.loginService.recoverSession(token));\n\t}\n\n\tgetCurrentSession() {\n\t\treturn this.sessionsService && this.sessionsService.retained;\n\t}\n\n\tgetCurrentCredential() {\n\t\treturn this.credentialsService && this.credentialsService.retained;\n\t}\n\n\tretainCredential(credential) {\n\t\tthis.credentialsService.retain(credential);\n\t\tlet session = this.sessionsService.retained;\n\t\tif (session.registered !== credential.id) {\n\t\t\tsession.registered = credential.id;\n\t\t\tsession.expires = -1;\n\t\t\tthis.sessionsService.retain(session);\n\t\t}\n\t}\n\n\treleaseCredential() {\n\t\tlet session = this.sessionsService.retained;\n\t\tsession.registered = '';\n\t\tsession.expires = -1;\n\t\tthis.sessionsService.retain(session);\n\t\tthis.credentialsService.release();\n\t}\n\n\tasync suspendSession() {\n\t\tconst xmpp = this._chatService ? this._chatService.suspend() : Promise.resolve();\n\t\tconst session = this._sessionsService ? this._sessionsService.suspend() : Promise.resolve();\n\t\tawait Promise.all([session, xmpp]);\n\t}\n\n\tasync resumeSession() {\n\t\tconst xmpp = this._chatService ? this._chatService.resume() : Promise.resolve();\n\t\tconst session = this._sessionsService ? this._sessionsService.resume() : Promise.resolve();\n\t\tawait Promise.all([session, xmpp]);\n\t}\n\n\tgetVersion() {\n\t\treturn [\n\t\t\t{name: 'WAPI', version: 'unknown'},\n\t\t\t{name: 'WAC', version: 'unknown'},\n\t\t];\n\t}\n\n\t/**\n\t * Update our presence state\n\t * @param [Presence] presence object\n\t * @return {Promise<Object>} Submited presence or an error object.\n\t */\n\tupdatePresence(address, presence) {\n\t\treturn this.presenceService.update(address, presence);\n\t}\n\n\tisReconnecting() {\n\t\treturn this._reconnecting;\n\t}\n\n\tasync onCapabilitiesChange() {\n\t\tconst capabilities = await this.capabilitiesService.getCapabilities();\n\t\tconst forbiddenCapabilities = await this.capabilitiesService.getForbiddenCapabilities();\n\t\tif (difference(capabilities, forbiddenCapabilities).includes('log')) {\n\t\t\tthis.remoteLogService.enable();\n\t\t} else {\n\t\t\tthis.remoteLogService.disable();\n\t\t}\n\t}\n\n\tonConnection() {\n\t\tif (this._reconnecting) {\n\t\t\tthis.emit('reconnected');\n\t\t\tthis._reconnecting = false;\n\t\t\tlet session = this.sessionsService.retained;\n\t\t\tif (session) {\n\t\t\t\tsession.expires = -1;\n\t\t\t\tthis.sessionsService.retain(session);\n\t\t\t}\n\t\t}\n\t}\n\n\tonClose(reason) {\n\t\tlog.warn('WAC API closed: ' + reason);\n\t\tif (reason === 'io server disconnect') {\n\t\t\tthis.emit('disconnected');\n\t\t} else {\n\t\t\tthis._reconnecting = true;\n\t\t\tthis.emit('reconnecting');\n\t\t\tswitch (reason) {\n\t\t\t\tcase 'transport close':\n\t\t\t\t\tthis.emit('qs-transport-close');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ping timeout':\n\t\t\t\t\tthis.emit('qs-connection-lost');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.emit('qs-unknown-close');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\ttrace(method, args) {\n\t\treturn log.debug('trace: ' + method, args);\n\t}\n\n\temit(...args) {\n\t\tevents.debug(args);\n\t\tsuper.emit.apply(this, args);\n\t}\n\n\tget callAttemptService() {\n\t\tif (!this._callAttemptService) {\n\t\t\tthis._callAttemptService = new CallAttemptService(this.wacRequest);\n\t\t}\n\t\treturn this._callAttemptService;\n\t}\n\n\tget callService() {\n\t\tif (!this._callService) {\n\t\t\tthis._callService = new CallService(this.wacRequest);\n\t\t}\n\t\treturn this._callService;\n\t}\n\n\tget callStatsService() {\n\t\tif (!this._callStatsService) {\n\t\t\tthis._callStatsService = new CallStatsService(this.wacRequest);\n\t\t}\n\t\treturn this._callStatsService;\n\t}\n\n\tget chatService() {\n\t\tif (!this._chatService) {\n\t\t\tconst xmppUri = this.urls['urn:xmpp:alt-connections:websocket'];\n\t\t\tconst xmppClient = new XmppClient(xmppUri, this._wapiToken.access_token, `${this._username}@${this._domain}`.toLowerCase());\n\t\t\tconst xmppPushUri = this.urls['urn:quobis:xmpp:push'];\n\t\t\tthis._chatService = new ChatService(this.wacRequest, xmppClient, xmppPushUri);\n\t\t}\n\t\treturn this._chatService;\n\t}\n\n\tget conferenceLogService() {\n\t\tif (!this._conferenceLog) {\n\t\t\tthis._conferenceLog = new ConferenceLogService(this.wacRequest);\n\t\t}\n\t\treturn this._conferenceLog;\n\t}\n\n\tget contactService() {\n\t\tif (!this._contactService) {\n\t\t\tthis._contactService = new ContactService(this.wacRequest);\n\t\t\tthis._contactService.emitter.on('qs-contact-add', evt => this.emit('qs-contact-add', evt));\n\t\t\tthis._contactService.emitter.on('qs-contact-add-many', evt => this.emit('qs-contact-add-many', evt));\n\t\t\tthis._contactService.emitter.on('qs-contact-update', evt => this.emit('qs-contact-update', evt));\n\t\t\tthis._contactService.emitter.on('qs-contact-remove', evt => this.emit('qs-contact-remove', evt));\n\n\t\t}\n\t\treturn this._contactService;\n\t}\n\n\tget credentialsService() {\n\t\tif (!this._credentialsService) {\n\t\t\tthis._credentialsService = new CredentialsService(this.wacRequest);\n\t\t}\n\t\treturn this._credentialsService;\n\t}\n\n\tget datapipeService() {\n\t\tif (!this._datapipeService) {\n\t\t\tthis._datapipeService = new DatapipeService(this.wacRequest);\n\t\t}\n\t\treturn this._datapipeService;\n\t}\n\n\tget groupService() {\n\t\tif (!this._groupService) {\n\t\t\tthis._groupService = new GroupService(this.wacRequest);\n\t\t}\n\t\treturn this._groupService;\n\t}\n\n\tget fileSharingService() {\n\t\tif (!this._fileSharingService) {\n\t\t\tconst fileUploadUri = this.urls['urn:quobis:fileupload:websocket'];\n\t\t\tthis._fileSharingService = new FileSharingService(this.wacRequest, fileUploadUri, this._wapiToken);\n\t\t}\n\t\treturn this._fileSharingService;\n\t}\n\n\tget loginService() {\n\t\tif (!this._loginService) {\n\t\t\tthis._loginService = new LoginService(this.sapiClient);\n\t\t}\n\t\treturn this._loginService;\n\t}\n\n\tget meetingService() {\n\t\tif (!this._meetingService) {\n\t\t\tthis._meetingService = new MeetingService(this.wacRequest);\n\t\t}\n\t\treturn this._meetingService;\n\t}\n\n\tget phonebookService() {\n\t\tif (!this._phonebookService) {\n\t\t\tthis._phonebookService = new PhonebookService(this.wacRequest);\n\t\t}\n\t\treturn this._phonebookService;\n\t}\n\n\tget pushNotificationsService() {\n\t\tif (!this._pushNotifications) {\n\t\t\tthis._pushNotifications = new PushNotificationsService(this.wacRequest);\n\t\t}\n\t\treturn this._pushNotifications;\n\t}\n\n\tget resolver() {\n\t\tif (!this._resolver) {\n\t\t\tthis._resolver = new Resolver(this.wacRequest);\n\t\t}\n\t\treturn this._resolver;\n\t}\n\n\tget presenceService() {\n\t\tif (!this._presenceService) {\n\t\t\tthis._presenceService = new PresenceService(this.wacRequest);\n\t\t}\n\t\treturn this._presenceService;\n\t}\n\n\tget recordingService() {\n\t\tif (!this._recordingService) {\n\t\t\tthis._recordingService = new RecordingService(this.wacRequest);\n\t\t}\n\t\treturn this._recordingService;\n\t}\n\n\tget remoteLogService() {\n\t\tif (!this._remoteLogService) {\n\t\t\tthis._remoteLogService = new RemoteLogService(this.wacRequest);\n\t\t}\n\t\treturn this._remoteLogService;\n\t}\n\n\tget sessionsService() {\n\t\tif (!this._sessionsService) {\n\t\t\tthis._sessionsService = new SessionsService(this.wacRequest);\n\t\t\tthis._sessionsService.emitter.on('disconnected', evt => this.emit('disconnected', evt));\n\t\t}\n\t\treturn this._sessionsService;\n\t}\n\n\tget settingsService() {\n\t\tif (!this._settingsService) {\n\t\t\tthis._settingsService = new SettingsService(this.wacRequest);\n\t\t}\n\t\treturn this._settingsService;\n\t}\n\n\tget userService() {\n\t\tif (!this._userService) {\n\t\t\tthis._userService = new UserService(this.wacRequest);\n\t\t}\n\t\treturn this._userService;\n\t}\n}\n","import bowser from 'bowser';\nimport {Set} from 'immutable';\n\nexport class CapabilitiesManager {\n\tconstructor() {\n\t\tthis.gatewayCapabilities = [];\n\t\tthis.wacCapabilities = [];\n\t\tthis.forbiddenCapabilities = [];\n\t\tthis.regenerateCapabilities();\n\t\tthis.onCapabilitiesUpdated = this.onCapabilitiesUpdated.bind(this);\n\t}\n\n\tstart(capabilitiesService) {\n\t\tthis.capabilitiesService = capabilitiesService;\n\t\tthis.capabilitiesService.emitter.on('change', this.onCapabilitiesUpdated);\n\t\treturn this.onCapabilitiesUpdated();\n\t}\n\n\tsetGatewayCapabilities(capabilities) {\n\t\tthis.gatewayCapabilities = capabilities;\n\t\tthis.regenerateCapabilities();\n\t}\n\n\tgetCapabilities() {\n\t\treturn this.capabilities;\n\t}\n\n\thasWacCapability(capability) {\n\t\treturn this.wacCapabilities.includes(capability);\n\t}\n\n\thasGatewayCapability(capability) {\n\t\treturn this.gatewayCapabilities.includes(capability);\n\t}\n\n\t/** @private */\n\tasync onCapabilitiesUpdated() {\n\t\tthis.wacCapabilities = await this.capabilitiesService.getCapabilities();\n\t\tthis.forbiddenCapabilities = await this.capabilitiesService.getForbiddenCapabilities();\n\t\tthis.regenerateCapabilities();\n\t}\n\n\t/** @private */\n\tregenerateCapabilities() {\n\t\tthis.capabilities = Set.of().withMutations((capabilities) => {\n\t\t\tcapabilities.union(this.wacCapabilities);\n\t\t\tcapabilities.union(this.gatewayCapabilities);\n\t\t\tcapabilities.subtract(this.forbiddenCapabilities);\n\t\t\tif (!window.MediaRecorder) {\n\t\t\t\tcapabilities.delete('local-recording');\n\t\t\t}\n\t\t\tif (window.location.protocol !== 'https:' || bowser.android || bowser.ios) {\n\t\t\t\tcapabilities.delete('screen-sharing');\n\t\t\t}\n\t\t});\n\t}\n}\n","import EventEmitter from 'eventemitter3';\n\nimport {Stack} from './stacks/Stack';\nimport {WacStack} from './wac-stack/WacStack';\nimport {CapabilitiesManager} from './CapabilitiesManager';\nimport Logs from '../Logs';\nimport {StackRegisterError} from './errors';\nimport {bindMethods} from '../utils/bindMethods';\n\n\nconst log = Logs.instance.getLogger('SippoJS/WacProxy');\nconst isPromise = p => p && typeof p.then === 'function';\n\nconst ROUTES = [\n\t{method: 'getSessions', capability: 'sessions'},\n\t{method: 'getCurrentSession', capability: 'sessions'},\n\t{method: 'retainSession', capability: 'sessions'},\n\t{method: 'getCredentials', capability: 'credentials'},\n\t{method: 'getCurrentCredential', capability: 'credentials'},\n\t{method: 'retainCredential', capability: 'credentials'},\n\t{method: 'suspendSession', capability: null},\n\t{method: 'resumeSession', capability: null},\n\t{method: 'call', capability: null},\n\t{method: 'answer', capability: null},\n\t{method: 'hangup', capability: null},\n\t{method: 'hold', capability: 'hold'},\n\t{method: 'resume', capability: 'hold'},\n\t{method: 'transfer', capability: 'blind-transfer'},\n\t{method: 'move', capability: 'move'},\n\t{method: 'enableScreenSharing', capability: 'screen-sharing'},\n\t{method: 'getCurrentMediaTypes', capability: 'media-update'},\n\t{method: 'updateCallMedia', capability: 'media-update'},\n\t{method: 'sendDataChannel', capability: 'datachannel'},\n\t{method: 'insertDTMF', capability: null},\n\t{method: 'getSubscribedPresences', capability: 'presence'},\n\t{method: 'getPresence', capability: 'presence'},\n\t{method: 'updatePresence', capability: 'presence'},\n\t{method: 'subscribeToPresence', capability: 'presence'},\n\t{method: 'subscribeToPresences', capability: 'presence'},\n\t{method: 'unsubscribeFromPresence', capability: 'presence'},\n\t{method: 'sendIm', capability: 'im'},\n\t{method: 'updateMediaState', capability: null},\n\t{method: 'getSettings', capability: 'settings'},\n\t{method: 'setSetting', capability: 'settings'},\n\t{method: 'getContacts', capability: 'contacts'},\n\t{method: 'addContact', capability: 'contacts'},\n\t{method: 'updateContact', capability: 'contacts'},\n\t{method: 'removeContact', capability: 'contacts'},\n\t{method: 'invalidateContacts', capability: 'contacts'},\n\t{method: 'searchContact', capability: 'ldap'},\n\t{method: 'getLogger', capability: 'log'},\n\t{method: 'sendStats', capability: 'stats'},\n\t{method: 'getCallAlarms', capability: 'call-alarms'},\n\t{method: 'triggerAlarm', capability: 'call-alarms'},\n\t{method: 'startListeningAudioLevel', capability: 'audio-level-reporting'},\n\t{method: 'stopListeningAudioLevel', capability: 'audio-level-reporting'},\n\t{method: 'reportStats', capability: 'stats-reporting'},\n\t{method: 'detectNetworkErrors', capability: 'networkerror-reporting'},\n\t{method: 'startRecording', capability: 'recording'},\n\t{method: 'stopRecording', capability: 'recording'},\n\t{method: 'getRecordings', capability: 'recording'},\n\t{method: 'getUser', capability: null},\n\t{method: 'updateUser', capability: null},\n\t{method: 'validatePhone', capability: null},\n\t{method: 'insertMany', capability: null},\n\t{method: 'getContactsWacUser', capability: null},\n\t{method: 'checkConnection', capability: 'network-reporting'},\n\t{method: 'getRemoteSessions', capability: 'list-remote'},\n\t{method: 'pushCallToSession', capability: 'call-push'},\n\t{method: 'pullCallFromSession', capability: 'call-pull'},\n];\n\nconst NEW_ROUTES = {\n\tconference: {\n\t\tcapability: 'conferences',\n\t\tmethods: [\n\t\t\t'on',\n\t\t\t'off',\n\t\t\t'create',\n\t\t\t'fetch',\n\t\t\t'requestInvitation',\n\t\t\t'cancelInvitationRequest',\n\t\t\t'getCurrentInvitations',\n\t\t\t'getRoomByUri',\n\t\t],\n\t},\n};\n\nexport class WacProxy {\n\tconstructor() {\n\t\tthis.emitter = new EventEmitter();\n\t\tfor (const route of ROUTES) {\n\t\t\tthis[route.method] = function(...args) {\n\t\t\t\treturn this._routeCall(route.method, route.capability, args);\n\t\t\t}.bind(this);\n\t\t}\n\n\t\tfor (const group in NEW_ROUTES) {\n\t\t\tthis[group] = {};\n\t\t\tconst {capability} = NEW_ROUTES[group];\n\t\t\tfor (const route of NEW_ROUTES[group].methods) {\n\t\t\t\tthis[group][route] = function(...args) {\n\t\t\t\t\treturn this._newRouteCall(group, route, capability, args);\n\t\t\t\t}.bind(this);\n\t\t\t}\n\t\t}\n\t\t/** @private */\n\t\tthis.stackReconnecting = false;\n\n\t\tbindMethods(this, [\n\t\t\t'onWacStackDisconnected',\n\t\t\t'onStackDisconnected',\n\t\t\t'onWacStackReconnecting',\n\t\t\t'onStackReconnecting',\n\t\t\t'onWacStackReconnected',\n\t\t\t'onStackReconnected',\n\t\t]);\n\t}\n\n\tinitialize(wacUri) {\n\t\tthis.cStack = new Stack();\n\t\tthis.wStack = new WacStack(wacUri);\n\t\tthis.capabilitiesManager = new CapabilitiesManager();\n\t}\n\n\tstart() {\n\t\tthis.wStack.on('disconnected', this.onWacStackDisconnected);\n\t\tthis.cStack.on('qs-unregistered', this.onStackDisconnected);\n\t\tthis.wStack.on('reconnecting', this.onWacStackReconnecting);\n\t\tthis.cStack.on('qs-reconnecting', this.onStackReconnecting);\n\t\tthis.wStack.on('reconnecting', this.onWacStackReconnected);\n\t\tthis.cStack.on('qs-reconnected', this.onStackReconnected);\n\t\tasync function start(stack) {\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tstack.on('qs-ready', resolve);\n\t\t\t\tstack.start();\n\t\t\t});\n\t\t\tstack.off('qs-ready');\n\t\t}\n\t\treturn Promise.all([start(this.cStack), this.wStack.start()]);\n\t}\n\n\tasync loginToken(issuer, token, deviceId) {\n\t\tconst wapiToken = await this.wStack.loginToken(issuer, token, deviceId);\n\t\tawait this.capabilitiesManager.start(this.wStack.capabilitiesService);\n\t\treturn wapiToken;\n\t}\n\n\tasync recoverSession(token, deviceId) {\n\t\tconst wapiToken = await this.wStack.recoverSession(token, deviceId);\n\t\tawait this.capabilitiesManager.start(this.wStack.capabilitiesService);\n\t\treturn wapiToken;\n\t}\n\n\tasync register(credential, {deviceId}) {\n\t\tthis.capabilitiesManager.setGatewayCapabilities(this.cStack.capabilities());\n\t\tawait new Promise((resolve, reject) => {\n\t\t\tthis.cStack.on('qs-register-success', () => {\n\t\t\t\tthis.cStack.off('qs-register-success qs-register-error');\n\t\t\t\tresolve();\n\t\t\t});\n\t\t\tthis.cStack.on('qs-register-error', () => {\n\t\t\t\tthis.cStack.off('qs-register-success qs-register-error');\n\t\t\t\treject(new StackRegisterError());\n\t\t\t});\n\t\t\tthis.cStack.register(credential, {deviceId});\n\t\t});\n\t\tthis.registeredCredential = credential;\n\t}\n\n\tasync stop() {\n\t\tthis.wStack.off('disconnected', this.onWacStackDisconnected);\n\t\tthis.cStack.off('qs-unregistered', this.onStackDisconnected);\n\t\tthis.wStack.off('reconnecting', this.onWacStackReconnecting);\n\t\tthis.cStack.off('qs-reconnecting', this.onStackReconnecting);\n\t\tthis.wStack.off('reconnecting', this.onWacStackReconnected);\n\t\tthis.cStack.off('qs-reconnected', this.onStackReconnected);\n\t\tif (this.registeredCredential) {\n\t\t\tawait new Promise((resolve, reject) => {\n\t\t\t\tthis.cStack.on('qs-unregister-success', () => {\n\t\t\t\t\tthis.cStack.off('qs-unregister-success qs-unregister-error');\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tthis.cStack.on('qs-unregister-error', (error) => {\n\t\t\t\t\tthis.cStack.off('qs-unregister-success qs-unregister-error');\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t\t\tthis.cStack.unregister();\n\t\t\t});\n\t\t}\n\t\tawait this.wStack.stop();\n\t}\n\n\tgetCapabilities() {\n\t\treturn this.capabilitiesManager.getCapabilities();\n\t}\n\n\thasCapability(capability) {\n\t\treturn this.getCapabilities().includes(capability);\n\t}\n\n\tgetVersion() {\n\t\tthis.wStack.getVersion().concat(this.cStack.version());\n\t}\n\n\ton(eventName, callback) {\n\t\tthis.cStack.on(eventName, callback);\n\t\tthis.wStack.on(eventName, callback);\n\t}\n\n\tonce(eventName, callback) {\n\t\tthis.cStack.once(eventName, callback);\n\t\tthis.wStack.once(eventName, callback);\n\t}\n\n\toff(eventName, callback) {\n\t\tthis.cStack.off(eventName, callback);\n\t\tthis.wStack.off(eventName, callback);\n\t}\n\n\t_joinResults(a, b) {\n\t\tif (a == null && b == null) {\n\t\t\treturn;\n\t\t}\n\t\tif (a != null && b == null) {\n\t\t\treturn a;\n\t\t}\n\t\tif (b != null && a == null) {\n\t\t\treturn b;\n\t\t}\n\t\tif (typeof a !== typeof b) {\n\t\t\treturn Error(`result type mismatch: ${typeof a} != ${typeof b}`);\n\t\t}\n\t\tif (typeof a === 'boolean') {\n\t\t\treturn a && b;\n\t\t}\n\t\tif (typeof a === 'number') {\n\t\t\treturn a + b;\n\t\t}\n\t\tif (typeof a === 'string') {\n\t\t\treturn a + b;\n\t\t}\n\t\tif (a instanceof Array && b instanceof Array) {\n\t\t\treturn a.concat(b);\n\t\t}\n\t\tif (isPromise(a) && isPromise(b)) {\n\t\t\treturn Promise.all([a, b]);\n\t\t}\n\t}\n\n\t_routeCall(method, capability, args) {\n\t\tlog.info(`route ${method}, capability ${capability}`);\n\t\targs = Array.prototype.slice.call(args);\n\t\tthis.wStack.trace(method, args);\n\t\tif (this.capabilitiesManager.hasWacCapability(capability)) {\n\t\t\treturn this.wStack[method](...args);\n\t\t} else if (this.capabilitiesManager.hasGatewayCapability(capability)) {\n\t\t\treturn this.cStack[method](...args);\n\t\t} else if (capability == null) {\n\t\t\tlet a, b;\n\t\t\tif (typeof this.wStack[method] === 'function') {\n\t\t\t\ta = this.wStack[method](...args);\n\t\t\t}\n\t\t\tif (typeof this.cStack[method] === 'function') {\n\t\t\t\tb = this.cStack[method](...args);\n\t\t\t}\n\t\t\treturn this._joinResults(a, b);\n\t\t} else {\n\t\t\tthrow new Error(`stack does not support ${capability}`);\n\t\t}\n\t}\n\n\t_newRouteCall(group, method, capability, args) {\n\t\targs = Array.prototype.slice.call(args);\n\t\tif (this.capabilitiesManager.hasWacCapability(capability)) {\n\t\t\treturn this.wStack[group] != null ? this.wStack[group][method](...args) : undefined;\n\t\t}\n\t\tif (this.capabilitiesManager.hasGatewayCapability(capability)) {\n\t\t\treturn this.cStack[group] != null ? this.cStack[group][method](...args) : undefined;\n\t\t} else if (!capability) {\n\t\t\treturn this.wStack[group] != null ? this.wStack[group][method](...args) : undefined;\n\t\t}\n\t}\n\n\tgetChatService() {\n\t\treturn this.wStack.chatService;\n\t}\n\n\tgetCallAttemptService() {\n\t\treturn this.wStack.callAttemptService;\n\t}\n\n\tgetCallService() {\n\t\treturn this.wStack.callService;\n\t}\n\n\tgetConferenceLogService() {\n\t\treturn this.wStack.conferenceLogService;\n\t}\n\n\tgetDatapipeService() {\n\t\tif (this.capabilitiesManager.hasWacCapability('datapipe')) {\n\t\t\treturn this.wStack.datapipeService;\n\t\t} else if (this.capabilitiesManager.hasGatewayCapability('datapipe')) {\n\t\t\treturn this.cStack;\n\t\t}\n\t}\n\n\tgetFileSharingService() {\n\t\treturn this.wStack.fileSharingService;\n\t}\n\n\tgetGroupService() {\n\t\treturn this.wStack.groupService;\n\t}\n\n\tgetContactService() {\n\t\treturn this.wStack.contactService;\n\t}\n\n\tgetMeetingService() {\n\t\treturn this.wStack.meetingService;\n\t}\n\n\tgetPhonebookService() {\n\t\treturn this.wStack.phonebookService;\n\t}\n\n\tgetPresenceService() {\n\t\treturn this.wStack.presenceService;\n\t}\n\n\tgetPushNotificationsService() {\n\t\treturn this.wStack.pushNotificationsService;\n\t}\n\n\tgetResolver() {\n\t\treturn this.wStack.resolver;\n\t}\n\n\t/** @private */\n\tasync onWacStackDisconnected() {\n\t\ttry {\n\t\t\tawait this.stop();\n\t\t} catch (error) {\n\t\t\tlog.error(error);\n\t\t} finally {\n\t\t\tthis.emitter.emit('disconnected');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onStackDisconnected() {\n\t\ttry {\n\t\t\tawait this.stop();\n\t\t} catch (error) {\n\t\t\tlog.error(error);\n\t\t} finally {\n\t\t\tthis.emitter.emit('disconnected');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onWacStackReconnecting() {\n\t\tif (!this.stackReconnecting) {\n\t\t\tthis.emitter.emit('reconnecting');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onStackReconnecting() {\n\t\tthis.stackReconnecting = true;\n\t\tif (!this.wStack.isReconnecting()) {\n\t\t\tthis.emitter.emit('reconnecting');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onWacStackReconnected() {\n\t\tif (!this.stackReconnecting) {\n\t\t\tthis.emitter.emit('reconnected');\n\t\t}\n\t}\n\n\t/** @private */\n\tasync onStackReconnected() {\n\t\tthis.stackReconnecting = false;\n\t\tif (!this.wStack.isReconnecting()) {\n\t\t\tthis.emitter.emit('reconnected');\n\t\t}\n\t}\n}\n","\nimport {Queue} from '../utils/Queue';\n\n/**\n * Class that interacts with WacProxy to subscribe and get presences.\n * These operations are not done immediately, the consecutive calls are queued\n * to use a single call.\n * All resolutions are stored in a collection so that future calls do not require\n * a new call to WacProxy.\n * @private\n */\nexport class PresenceQueue {\n\n\t/**\n\t * Create a new presence retrieve queue.\n\t * @protected\n\t * @param {PresenceService} presenceService The wac proxy instance to interact.\n\t * @param {PresenceCollection} collection The collection where resolved elements\n\t * are stored.\n\t */\n\tconstructor(presenceService, collection) {\n\n\t\t/**\n\t\t * @private\n\t\t * @type {PresenceService}\n\t\t */\n\t\tthis.presenceService = presenceService;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {PresenceCollection}\n\t\t */\n\t\tthis._collection = collection;\n\n\t\t/**\n\t\t * List of queued request.\n\t\t * @private\n\t\t * @type {Array<ResolveQueueItem>}\n\t\t */\n\t\tthis._queue = new Queue(this);\n\t}\n\n\t/**\n\t * Add a new subscription request to subscription queue.\n\t * When commit timer exists, it is canceled. A new commit timer is created.\n\t * @param {String} address The presence address`to start receiving presence updates.\n\t * @return {Promise<object>} resolved on success with subscribed presence if subscription\n\t * success.\n\t */\n\tsubscribeToPresence(address) {\n\t\treturn this._queue.addToQueue(address);\n\t}\n\n\t/**\n\t * Remove a presence subscription.\n\t * @param {String} address The presence address to stop receiving presence updates.\n\t * @return {Promise} resolved once unsubscription success.\n\t */\n\tunsubscribeFromPresence(address) {\n\t\treturn this.presenceService.destroy(address);\n\t}\n\n\t/**\n\t * Method that subscribes to any queued subscription request.\n\t * When a response is received from WacStack local presence collection is updated.\n\t * @private\n\t */\n\tcommit(pending) {\n\t\tthis.presenceService.subscribeToPresences(pending.map(x => x.data)).then((presences) => {\n\t\t\tpresences.forEach(x => this._collection.updatePresence(x));\n\t\t\tpending.forEach(x => x.resolve(this._collection.getPresence(x.data)));\n\t\t}).catch((error) => {\n\t\t\tpending.forEach(x => x.reject(error));\n\t\t});\n\t}\n}\n","\n/**\n * A local collection of presences\n * @private\n */\nexport class PresenceCollection {\n\n\t/**\n\t * Constructs a local presence collection\n\t * @protected\n\t * @param {Array<Object>} presences initial presences to be stored.\n\t */\n\tconstructor(presences = []) {\n\n\t\t/**\n\t\t * Presence objects indexed by address.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._presenceByAddress = {};\n\n\t\tpresences.forEach((presence) => {\n\t\t\tthis._presenceByAddress[presence.address] = presence;\n\t\t});\n\t}\n\n\t/**\n\t * Store a new presence or update an existing one.\n\t * @protected\n\t * @param {Object} presence The presence to be stored.\n\t */\n\tupdatePresence(presence) {\n\t\tthis._presenceByAddress[presence.address] = presence;\n\t}\n\n\t/**\n\t * Get an stored presence.\n\t * @protected\n\t * @param {String} address The address of the requested presence.\n\t * @return {Object|undefined} found presence or undefined if such address\n\t * is not stored.\n\t */\n\tgetPresence(address) {\n\t\treturn this._presenceByAddress[address];\n\t}\n\n\t/**\n\t * Remove a presence from this collection.\n\t * @protected\n\t * @param {String} address The address of the presence to be removed.\n\t */\n\tremovePresence(address) {\n\t\tdelete this._presenceByAddress[address];\n\t}\n}\n","import {EventEmitter2} from 'eventemitter2';\nimport {bindMethods} from '../utils';\nimport {PresenceQueue} from './PresenceQueue';\nimport {PresenceCollection} from './PresenceCollection';\n\n/**\n * Element that manages presences.\n * It stores subscribed presences in a local collection that is\n * updated when WacProxy notifies a change.\n * @private\n */\nexport class PresenceManager {\n\n\tstatic of(presenceService) {\n\t\treturn new PresenceManager(presenceService);\n\t}\n\n\t/**\n\t * Constructs a Presence Manager\n\t * @param {PresenceService} presenceService\n\t * @private\n\t */\n\tconstructor(presenceService) {\n\t\tthis.presenceService = presenceService;\n\n\t\tthis.emitter = new EventEmitter2();\n\t\tthis.emitter.setMaxListeners(0);\n\n\t\t/**\n\t\t * Property used to determine if PresenceManager has been intialized\n\t\t * and wait until initialization success.\n\t\t * @private\n\t\t * @type {Promise}\n\t\t */\n\t\tthis._init = null;\n\n\t\t/**\n\t\t * Collection of subscribed presences.\n\t\t * @private\n\t\t * @type {PresenceCollection}\n\t\t */\n\t\tthis._collection = null;\n\n\t\t/**\n\t\t * Queue that subscribes to presences through WacProxy.\n\t\t * @private\n\t\t * @type {PresenceQueue}\n\t\t */\n\t\tthis._queue = null;\n\n\t\tbindMethods(this, [\n\t\t\t'onPresenceUpdated',\n\t\t]);\n\n\t\t// init() is now sync, so... gas!\n\t\tthis.init();\n\t}\n\n\t/**\n\t * Initialize PresenceManager.\n\t * It retrieves already subscribed presences from WacStack and subscribe\n\t * to presence updates.\n\t * @return {Promise} resolved after initialization.\n\t */\n\tinit() {\n\t\tthis._collection = new PresenceCollection();\n\t\tthis._queue = new PresenceQueue(this.presenceService, this._collection);\n\t\tthis.presenceService.emitter.on('presence-updated', this.onPresenceUpdated);\n\t\tthis._init = true;\n\t}\n\n\t/**\n\t * Deinitialize PresenceManager.\n\t */\n\tuninit() {\n\t\tthis.presenceService.emitter.off('presence-update', this.onPresenceUpdated);\n\t\tthis.presenceService = null;\n\t\tthis._init = null;\n\t\tthis._collection = null;\n\t\tthis._queue = null;\n\t}\n\n\t/**\n\t * Check if PresenceManager has been initialized and wait until\n\t * initialization success.\n\t * @return {Promise} resolved after initialization.\n\t */\n\tisInitialized() {\n\t\tif (!this._init) {\n\t\t\tthis.init();\n\t\t}\n\t}\n\n\t/**\n\t * Request the presence associated with given address and subscribe\n\t * to presence updates.\n\t * If such address is present into local collection, this method will return it.\n\t * Otherwise a new subscription will be created through subscription queue.\n\t * @param {String} address The address associated with requested presence.\n\t * @return {Promise<object>} resolved with presence object.\n\t */\n\tasync subscribeToPresence(address) {\n\t\treturn await this._collection.getPresence(address) || this._queue.subscribeToPresence(address);\n\t}\n\n\t/**\n\t * Unsubscribe from presence updates associated with given address.\n\t * @param {String} address The presence address to stop receiving updates.\n\t * @return {Promise} resolved when unsubscribed from presence updates.\n\t */\n\tasync unsubscribeFromPresence(address) {\n\t\tthis._collection.removePresence(address);\n\t\treturn this._queue.unsubscribeFromPresence(address);\n\t}\n\n\t/**\n\t * Callback called when WacProxy notifies a presence update.\n\t * @private\n\t * @param {object} presence The presence that has been updated.\n\t */\n\tonPresenceUpdated(presence) {\n\t\tif (this._collection) {\n\t\t\tthis._collection.updatePresence(presence);\n\t\t}\n\t\tthis.emitter.emit('updated', presence);\n\t}\n\n\tupdatePresence(address, presence) {\n\t\tconst updatedPresence = Object.assign({}, presence, {address});\n\t\tif (this._collection) {\n\t\t\tthis._collection.updatePresence(updatedPresence);\n\t\t}\n\t\treturn this.presenceService.update(address, presence);\n\t}\n\n\tgetPresence(address) {\n\t\treturn this.subscribeToPresence(address);\n\t}\n}\n","import {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport {DataPipeStatus} from '../datapipe/DataPipeStatus';\nimport {DataPipeType} from '../datapipe/DataPipeType';\n\n/**\n * Provides access to methods for controlling a selfie.\n * This class must not be directly instantiated. It can be obtained using\n * {@link session#createSelfie} or listening to {@link session#selfie-invite}\n * event.\n *\n * ## Events\n *\n * - **`cancel`** is emitted when the selfie has been finished.\n * - **`image`** is emitted when the image is received.\n *   - {@link string} `image`\n * - **`taking`** is emitted when the remote user is taking a picture.\n *\n * You can check EventEmitter2 documentation for additional information about\n * adding and removing listeners for this events events.\n *\n * @see https://github.com/asyncly/EventEmitter2#api\n *\n * @example <caption>How to create a Selfie</caption>\n * // 1. Agent side create a selfie using session object.\n * let selfie = session.createSelfie(['user@domain']);\n * // 2. Client listens to 'selfie-invite event'\n * session.on('selfie-invite', function(selfie){\n *  // ... do stuff with selfie.\n * })\n *\n * @example <caption>Notify the agent that user is taking a selfie</caption>\n * // Agent will receive 'taking' event.\n * selfie.on('taking', () => {...});\n * // Client just calls selfie method.\n * selfie.notifyTaking();\n *\n * @example <caption>Send the picture to the agent</caption>\n * // Agent will receive 'image' event.\n * selfie.on('image', (imageURL) => {...});\n * // Client just calls selfie method.\n * selfie.send(imageURL);\n *\n */\nexport default class Selfie extends EventEmitter {\n\t/**\n\t * The version of the protocol implemented.\n\t * @type {string}\n\t */\n\tstatic get PROTOCOL() {\n\t\treturn 'selfie/2.0';\n\t}\n\n\t/**\n\t * Initializes a new selfie with its default values.\n\t * @protected\n\t */\n\tconstructor() {\n\t\tsuper();\n\n\t\t/**\n\t\t * The underline datapipe used for selfie communication.\n\t\t * @type {Datapipe}\n\t\t */\n\t\tthis._pipe = null;\n\n\t\tbindMethods(this, [\n\t\t\t'_onPipeData',\n\t\t]);\n\t}\n\n\tget isConnected() {\n\t\treturn this._pipe === null ? false : this._pipe.status === DataPipeStatus.CONNECTED;\n\t}\n\n\t/**\n\t * Cancel the process at any time.\n\t * @return {Promise} A promise that is fulfilled when the selfie is canceled.\n\t */\n\tcancel() {\n\t\treturn this._pipe.when(DataPipeStatus.CONNECTED).then(() => {\n\t\t\treturn this._pipe.disconnect();\n\t\t});\n\t}\n\n\t/**\n\t * Send 'taking' event to the other side.\n\t * @return {Promise} A promise that is fulfilled when the notification has been sent.\n\t */\n\tnotifyTaking() {\n\t\treturn this._sendCommand('taking');\n\t}\n\n\t/**\n\t * Send the image to the agent.\n\t * This can be a regular URL or a dataUrl, with a base64 encoded image.\n\t * @param {imgDataUrl} imgDataUrl The image file containing the selfie.\n\t * @return {Promise} A promise that is fulfilled when the image has been sent.\n\t */\n\tsend(imgDataUrl) {\n\t\treturn this._sendCommand({action: 'image', image: imgDataUrl});\n\t}\n\n\t/**\n\t * Not implemented.\n\t * @return {undefined}\n\t */\n\t/*save() {\n\t\tthrow new Error('NOT IMPLEMENTED');\n\t}*/\n\n\t/**\n\t * Inits selfie object.\n\t *  1. Sets datapipe callbacks\n\t *  2. Connects the datapipe\n\t *  3. If datapipe is outgoing, sends a selfie-invite command to the other peer\n\t * @protected\n\t * @param {Datapipe} pipe The datapipe that will be used.\n\t * @return {Promise} A promise that is fulfilled when the pipe is connected\n\t */\n\t_initDatapipe(pipe) {\n\t\tif (pipe.status !== DataPipeStatus.UNCONNECTED) {\n\t\t\tlet expected = DataPipeStatus[DataPipeStatus.UNCONNECTED];\n\t\t\tlet received = DataPipeStatus[pipe.status];\n\t\t\treturn Promise.reject(Error(`Expected datapipe status \"${expected}\" but got \"${received}\" instead.`));\n\t\t}\n\t\tthis._pipe = pipe;\n\t\tthis._pipe.on('data', this._onPipeData);\n\t\tthis._pipe.when(DataPipeStatus.DISCONNECTED).then(() => {\n\t\t\tthis.off('data', this._onPipeData);\n\t\t\tthis.emit('cancel');\n\t\t\tthis._pipe = null;\n\t\t});\n\t\treturn this._pipe.connect().then(() => {\n\t\t\tif (this._pipe.type === DataPipeType.OUTGOING) {\n\t\t\t\treturn this._sendCommand('selfie-invite');\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Callback executed when datapipe is connected.\n\t * If we are the selfie creator, send a 'selfie-invite' to the other side.\n\t * @private\n\t * @param {string} data A string sent by the datapipe\n\t * @return {undefined}\n\t */\n\t_onPipeData(data) {\n\t\tlet command = this._parseData(data);\n\t\tswitch (command.action) {\n\t\t\tcase 'taking':\n\t\t\t\tthis.emit('taking');\n\t\t\t\tbreak;\n\t\t\tcase 'image':\n\t\t\t\tthis.emit('image', command.image);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\t/**\n\t * Gets a datapipe message and checks that protocol exists and is equal to Selfie.PROTOCOL\n\t * otherwise throw an error.\n\t * @private\n\t * @param {string} data A string sent by the datapipe.\n\t * @return {Object} An object with two fields: command and protocol.\n\t * @property {string} command\n\t * @property {string} protocol\n\t */\n\t_parseData(data) {\n\t\tlet command = JSON.parse(data);\n\t\tif (command.protocol !== Selfie.PROTOCOL) {\n\t\t\tthrow new Error(`Expected protocol \"${Selfie.PROTOCOL}\" but got \"${command.protocol}\" instead.`);\n\t\t}\n\t\treturn command;\n\t}\n\n\t/**\n\t * Send a command through the datapipe.\n\t * If command is a string it will be transformed into a object with a single command field.\n\t * If command is an object, all fields will be conserved.\n\t * In both cases a protocol field will be added.\n\t * @private\n\t * @param {string|object} command Command to send through the datapipe\n\t * @return {Promise} A promise that is fulfilled when the command was sent\n\t */\n\t_sendCommand(command) {\n\t\tif (typeof command === 'string') {\n\t\t\tcommand = {'action': command};\n\t\t}\n\t\tcommand.protocol = Selfie.PROTOCOL;\n\t\treturn this._pipe.when(DataPipeStatus.CONNECTED).then(() => {\n\t\t\treturn this._pipe.send(JSON.stringify(command));\n\t\t});\n\t}\n}\n","/**\n * Represents a user. This class must not be directly instantiated. Instead,\n * instances of this class are obtained by calling to {@link session#getUser}\n */\nexport class User {\n\t/**\n\t * @protected\n\t * @return {User}\n\t */\n\tstatic newInstance(wacProxy) {\n\t\treturn new User(wacProxy);\n\t}\n\n\t/** @private */\n\tconstructor(wacProxy) {\n\t\tthis._wacProxy = wacProxy;\n\t\tthis._initializing = null;\n\t}\n\n\t/** @protected */\n\tinit() {\n\t\tif (!this._initializing) {\n\t\t\tthis._id = this._wacProxy.getCurrentSession().userObj.id;\n\t\t\tthis._initializing = this._wacProxy.getUser(this._id).then((data) => {\n\t\t\t\tthis._update(data);\n\t\t\t});\n\t\t}\n\t\treturn this._initializing;\n\t}\n\n\t/**\n\t * The unique identifier of this user\n\t * @type {string}\n\t */\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\t/**\n\t * The domain of this user\n\t * @type {string}\n\t */\n\tget domain() {\n\t\treturn this._domain;\n\t}\n\n\t/**\n\t * The username of this user\n\t * @type {string}\n\t */\n\tget username() {\n\t\treturn this._username;\n\t}\n\n\t/**\n\t * Returns the address of this user as <user>@<domain>\n\t * @return {string} The user address\n\t */\n\tgetAddress() {\n\t\treturn `${this._username}@${this._domain}`;\n\t}\n\n\t/**\n\t * User's email\n\t * @type {string}\n\t */\n\tget email() {\n\t\treturn this._email;\n\t}\n\n\t/**\n\t * When the user was created (milliseconds)\n\t * @type {number}\n\t */\n\tget created() {\n\t\treturn this._created;\n\t}\n\n\t/**\n\t * User's lastLogin\n\t * @type {number}\n\t */\n\tget lastLogin() {\n\t\treturn this._lastLogin;\n\t}\n\n\t/**\n\t * User's role. One of them: \"anonymous\", \"user\", \"admin\"\n\t * @type {string}\n\t */\n\tget role() {\n\t\treturn this._role;\n\t}\n\n\t/**\n\t * User's capabilities\n\t * @type {Array}\n\t */\n\tget capabilities() {\n\t\treturn this._capabilities;\n\t}\n\n\t/**\n\t * User's mobile phone\n\t * @type {Array}\n\t */\n\tget mobilePhone() {\n\t\treturn this._mobilePhone;\n\t}\n\n\t/**\n\t * User's landLineNumber\n\t * @type {string}\n\t */\n\tget landLineNumber() {\n\t\treturn this._landLineNumber;\n\t}\n\n\t/**\n\t * User's alias\n\t * @type {string}\n\t */\n\tget alias() {\n\t\treturn this._alias;\n\t}\n\n\t/**\n\t * Update an user\n\t * @param {Object} objToUpdate Data that will be used to update an user\n\t * @param {String} [objToUpdate.email]\n\t * @param {Array} [objToUpdate.mobilePhone]\n\t * @param {String} [objToUpdate.landLineNumber]\n\t * @param {String} [objToUpdate.alias]\n\t * @example\n\t * // returns this\n\t * this.update({\n\t *    \"email\": \"user@demo.quobis.com\",\n\t *    \"mobilePhone\": ['phone1', 'phone2'],\n\t *    \"landLineNumber\": \"landLineNumber\"\n\t *  });\n\t *\n\t * @return {Promise<User>}\n\t */\n\tupdate(objToUpdate) {\n\t\treturn this._wacProxy.updateUser(this._id, objToUpdate).then((oUpdated) => {\n\t\t\treturn this._update(oUpdated);\n\t\t});\n\t}\n\n\t/**\n\t * Check if a code is right to update a phone\n\t *\n\t * @param  {String} code Random string introduced by the user\n\t * @param  {String} phone Phone that it wants to update\n\t * @example\n\t * // returns this\n\t * this.validatePhone('uifs8wr5', '4564879564');\n\t *\n\t * @return {Promise<User>}\n\t */\n\tvalidatePhone(code, phone) {\n\t\treturn this._wacProxy.validatePhone(this._id, code, phone).then((oUpdated) => {\n\t\t\treturn this._update(oUpdated);\n\t\t});\n\t}\n\n\t/**\n\t * Updates the contact with the new data\n\t * @protected\n\t * @param {Object} data\n\t * @param {String} data.id\n\t * @param {String} data.domain\n\t * @param {String} data.username\n\t * @param {String} data.email\n\t * @param {Number} data.created\n\t * @param {Number} data.lastLogin\n\t * @param {String} data.role\n\t * @param {Array}  data.capabilities\n\t * @param {Array}  data.mobilePhone\n\t * @param {String} data.landLineNumber\n\t * @param {String} data.alias\n\t */\n\t_update(data) {\n\t\tthis._id = data.id;\n\t\tthis._domain = data.domain;\n\t\tthis._username = data.username;\n\t\tthis._email = data.email;\n\t\tthis._created = data.created;\n\t\tthis._lastLogin = data.lastLogin;\n\t\tthis._role = data.role;\n\t\tthis._capabilities = data.capabilities;\n\t\tthis._mobilePhone = data.mobilePhone;\n\t\tthis._landLineNumber = data.landLineNumber;\n\t\tthis._alias = data.alias;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a JS object with the JSON serialization representation of this object\n\t * @return {Object}\n\t * @property {String} id\n\t * @property {String} domain\n\t * @property {String} username\n\t * @property {String} email\n\t * @property {Number} created\n\t * @property {Number} lastLogin\n\t * @property {String} role\n\t * @property {Array}  capabilities\n\t * @property {Array}  mobilePhone\n\t * @property {String} landLineNumber\n\t * @property {String} alias\n\t */\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this._id,\n\t\t\tdomain: this._domain,\n\t\t\tusername: this._username,\n\t\t\temail: this._email,\n\t\t\tcreated: this._created,\n\t\t\tlastLogin: this._lastLogin,\n\t\t\trole: this._role,\n\t\t\tcapabilities: this._capabilities,\n\t\t\tmobilePhone: this._mobilePhone,\n\t\t\tlandLineNumer: this._landLineNumer,\n\t\t\talias: this._alias,\n\t\t};\n\t}\n}\n","function none() {}\n\nexport default function(selector) {\n  return selector == null ? none : function() {\n    return this.querySelector(selector);\n  };\n}\n","function empty() {\n  return [];\n}\n\nexport default function(selector) {\n  return selector == null ? empty : function() {\n    return this.querySelectorAll(selector);\n  };\n}\n","export default function(update) {\n  return new Array(update.length);\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._enter || this._groups.map(sparse), this._parents);\n}\n\nexport function EnterNode(parent, datum) {\n  this.ownerDocument = parent.ownerDocument;\n  this.namespaceURI = parent.namespaceURI;\n  this._next = null;\n  this._parent = parent;\n  this.__data__ = datum;\n}\n\nEnterNode.prototype = {\n  constructor: EnterNode,\n  appendChild: function(child) { return this._parent.insertBefore(child, this._next); },\n  insertBefore: function(child, next) { return this._parent.insertBefore(child, next); },\n  querySelector: function(selector) { return this._parent.querySelector(selector); },\n  querySelectorAll: function(selector) { return this._parent.querySelectorAll(selector); }\n};\n","import {Selection} from \"./index\";\nimport {EnterNode} from \"./enter\";\nimport constant from \"../constant\";\n\nvar keyPrefix = \"$\"; // Protect against keys like __proto__.\n\nfunction bindIndex(parent, group, enter, update, exit, data) {\n  var i = 0,\n      node,\n      groupLength = group.length,\n      dataLength = data.length;\n\n  // Put any non-null nodes that fit into update.\n  // Put any null nodes into enter.\n  // Put any remaining data into enter.\n  for (; i < dataLength; ++i) {\n    if (node = group[i]) {\n      node.__data__ = data[i];\n      update[i] = node;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Put any non-null nodes that dont fit into exit.\n  for (; i < groupLength; ++i) {\n    if (node = group[i]) {\n      exit[i] = node;\n    }\n  }\n}\n\nfunction bindKey(parent, group, enter, update, exit, data, key) {\n  var i,\n      node,\n      nodeByKeyValue = {},\n      groupLength = group.length,\n      dataLength = data.length,\n      keyValues = new Array(groupLength),\n      keyValue;\n\n  // Compute the key for each node.\n  // If multiple nodes have the same key, the duplicates are added to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if (node = group[i]) {\n      keyValues[i] = keyValue = keyPrefix + key.call(node, node.__data__, i, group);\n      if (keyValue in nodeByKeyValue) {\n        exit[i] = node;\n      } else {\n        nodeByKeyValue[keyValue] = node;\n      }\n    }\n  }\n\n  // Compute the key for each datum.\n  // If there a node associated with this key, join and add it to update.\n  // If there is not (or the key is a duplicate), add it to enter.\n  for (i = 0; i < dataLength; ++i) {\n    keyValue = keyPrefix + key.call(parent, data[i], i, data);\n    if (node = nodeByKeyValue[keyValue]) {\n      update[i] = node;\n      node.__data__ = data[i];\n      nodeByKeyValue[keyValue] = null;\n    } else {\n      enter[i] = new EnterNode(parent, data[i]);\n    }\n  }\n\n  // Add any remaining nodes that were not bound to data to exit.\n  for (i = 0; i < groupLength; ++i) {\n    if ((node = group[i]) && (nodeByKeyValue[keyValues[i]] === node)) {\n      exit[i] = node;\n    }\n  }\n}\n\nexport default function(value, key) {\n  if (!value) {\n    data = new Array(this.size()), j = -1;\n    this.each(function(d) { data[++j] = d; });\n    return data;\n  }\n\n  var bind = key ? bindKey : bindIndex,\n      parents = this._parents,\n      groups = this._groups;\n\n  if (typeof value !== \"function\") value = constant(value);\n\n  for (var m = groups.length, update = new Array(m), enter = new Array(m), exit = new Array(m), j = 0; j < m; ++j) {\n    var parent = parents[j],\n        group = groups[j],\n        groupLength = group.length,\n        data = value.call(parent, parent && parent.__data__, j, parents),\n        dataLength = data.length,\n        enterGroup = enter[j] = new Array(dataLength),\n        updateGroup = update[j] = new Array(dataLength),\n        exitGroup = exit[j] = new Array(groupLength);\n\n    bind(parent, group, enterGroup, updateGroup, exitGroup, data, key);\n\n    // Now connect the enter nodes to their following update node, such that\n    // appendChild can insert the materialized enter node before this node,\n    // rather than at the end of the parent node.\n    for (var i0 = 0, i1 = 0, previous, next; i0 < dataLength; ++i0) {\n      if (previous = enterGroup[i0]) {\n        if (i0 >= i1) i1 = i0 + 1;\n        while (!(next = updateGroup[i1]) && ++i1 < dataLength);\n        previous._next = next || null;\n      }\n    }\n  }\n\n  update = new Selection(update, parents);\n  update._enter = enter;\n  update._exit = exit;\n  return update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(compare) {\n  if (!compare) compare = ascending;\n\n  function compareNode(a, b) {\n    return a && b ? compare(a.__data__, b.__data__) : !a - !b;\n  }\n\n  for (var groups = this._groups, m = groups.length, sortgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, sortgroup = sortgroups[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        sortgroup[i] = node;\n      }\n    }\n    sortgroup.sort(compareNode);\n  }\n\n  return new Selection(sortgroups, this._parents).order();\n}\n\nfunction ascending(a, b) {\n  return a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n}\n","export default function() {\n  var callback = arguments[0];\n  arguments[0] = this;\n  callback.apply(null, arguments);\n  return this;\n}\n","export var xhtml = \"http://www.w3.org/1999/xhtml\";\n\nexport default {\n  svg: \"http://www.w3.org/2000/svg\",\n  xhtml: xhtml,\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\",\n  xmlns: \"http://www.w3.org/2000/xmlns/\"\n};\n","import namespaces from \"./namespaces\";\n\nexport default function(name) {\n  var prefix = name += \"\", i = prefix.indexOf(\":\");\n  if (i >= 0 && (prefix = name.slice(0, i)) !== \"xmlns\") name = name.slice(i + 1);\n  return namespaces.hasOwnProperty(prefix) ? {space: namespaces[prefix], local: name} : name;\n}\n","import namespace from \"../namespace\";\n\nfunction attrRemove(name) {\n  return function() {\n    this.removeAttribute(name);\n  };\n}\n\nfunction attrRemoveNS(fullname) {\n  return function() {\n    this.removeAttributeNS(fullname.space, fullname.local);\n  };\n}\n\nfunction attrConstant(name, value) {\n  return function() {\n    this.setAttribute(name, value);\n  };\n}\n\nfunction attrConstantNS(fullname, value) {\n  return function() {\n    this.setAttributeNS(fullname.space, fullname.local, value);\n  };\n}\n\nfunction attrFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttribute(name);\n    else this.setAttribute(name, v);\n  };\n}\n\nfunction attrFunctionNS(fullname, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.removeAttributeNS(fullname.space, fullname.local);\n    else this.setAttributeNS(fullname.space, fullname.local, v);\n  };\n}\n\nexport default function(name, value) {\n  var fullname = namespace(name);\n\n  if (arguments.length < 2) {\n    var node = this.node();\n    return fullname.local\n        ? node.getAttributeNS(fullname.space, fullname.local)\n        : node.getAttribute(fullname);\n  }\n\n  return this.each((value == null\n      ? (fullname.local ? attrRemoveNS : attrRemove) : (typeof value === \"function\"\n      ? (fullname.local ? attrFunctionNS : attrFunction)\n      : (fullname.local ? attrConstantNS : attrConstant)))(fullname, value));\n}\n","export default function(node) {\n  return (node.ownerDocument && node.ownerDocument.defaultView) // node is a Node\n      || (node.document && node) // node is a Window\n      || node.defaultView; // node is a Document\n}\n","import defaultView from \"../window\";\n\nfunction styleRemove(name) {\n  return function() {\n    this.style.removeProperty(name);\n  };\n}\n\nfunction styleConstant(name, value, priority) {\n  return function() {\n    this.style.setProperty(name, value, priority);\n  };\n}\n\nfunction styleFunction(name, value, priority) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) this.style.removeProperty(name);\n    else this.style.setProperty(name, v, priority);\n  };\n}\n\nexport default function(name, value, priority) {\n  return arguments.length > 1\n      ? this.each((value == null\n            ? styleRemove : typeof value === \"function\"\n            ? styleFunction\n            : styleConstant)(name, value, priority == null ? \"\" : priority))\n      : styleValue(this.node(), name);\n}\n\nexport function styleValue(node, name) {\n  return node.style.getPropertyValue(name)\n      || defaultView(node).getComputedStyle(node, null).getPropertyValue(name);\n}\n","function propertyRemove(name) {\n  return function() {\n    delete this[name];\n  };\n}\n\nfunction propertyConstant(name, value) {\n  return function() {\n    this[name] = value;\n  };\n}\n\nfunction propertyFunction(name, value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    if (v == null) delete this[name];\n    else this[name] = v;\n  };\n}\n\nexport default function(name, value) {\n  return arguments.length > 1\n      ? this.each((value == null\n          ? propertyRemove : typeof value === \"function\"\n          ? propertyFunction\n          : propertyConstant)(name, value))\n      : this.node()[name];\n}\n","function classArray(string) {\n  return string.trim().split(/^|\\s+/);\n}\n\nfunction classList(node) {\n  return node.classList || new ClassList(node);\n}\n\nfunction ClassList(node) {\n  this._node = node;\n  this._names = classArray(node.getAttribute(\"class\") || \"\");\n}\n\nClassList.prototype = {\n  add: function(name) {\n    var i = this._names.indexOf(name);\n    if (i < 0) {\n      this._names.push(name);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  remove: function(name) {\n    var i = this._names.indexOf(name);\n    if (i >= 0) {\n      this._names.splice(i, 1);\n      this._node.setAttribute(\"class\", this._names.join(\" \"));\n    }\n  },\n  contains: function(name) {\n    return this._names.indexOf(name) >= 0;\n  }\n};\n\nfunction classedAdd(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.add(names[i]);\n}\n\nfunction classedRemove(node, names) {\n  var list = classList(node), i = -1, n = names.length;\n  while (++i < n) list.remove(names[i]);\n}\n\nfunction classedTrue(names) {\n  return function() {\n    classedAdd(this, names);\n  };\n}\n\nfunction classedFalse(names) {\n  return function() {\n    classedRemove(this, names);\n  };\n}\n\nfunction classedFunction(names, value) {\n  return function() {\n    (value.apply(this, arguments) ? classedAdd : classedRemove)(this, names);\n  };\n}\n\nexport default function(name, value) {\n  var names = classArray(name + \"\");\n\n  if (arguments.length < 2) {\n    var list = classList(this.node()), i = -1, n = names.length;\n    while (++i < n) if (!list.contains(names[i])) return false;\n    return true;\n  }\n\n  return this.each((typeof value === \"function\"\n      ? classedFunction : value\n      ? classedTrue\n      : classedFalse)(names, value));\n}\n","function textRemove() {\n  this.textContent = \"\";\n}\n\nfunction textConstant(value) {\n  return function() {\n    this.textContent = value;\n  };\n}\n\nfunction textFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.textContent = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? textRemove : (typeof value === \"function\"\n          ? textFunction\n          : textConstant)(value))\n      : this.node().textContent;\n}\n","function htmlRemove() {\n  this.innerHTML = \"\";\n}\n\nfunction htmlConstant(value) {\n  return function() {\n    this.innerHTML = value;\n  };\n}\n\nfunction htmlFunction(value) {\n  return function() {\n    var v = value.apply(this, arguments);\n    this.innerHTML = v == null ? \"\" : v;\n  };\n}\n\nexport default function(value) {\n  return arguments.length\n      ? this.each(value == null\n          ? htmlRemove : (typeof value === \"function\"\n          ? htmlFunction\n          : htmlConstant)(value))\n      : this.node().innerHTML;\n}\n","function raise() {\n  if (this.nextSibling) this.parentNode.appendChild(this);\n}\n\nexport default function() {\n  return this.each(raise);\n}\n","function lower() {\n  if (this.previousSibling) this.parentNode.insertBefore(this, this.parentNode.firstChild);\n}\n\nexport default function() {\n  return this.each(lower);\n}\n","import namespace from \"./namespace\";\nimport {xhtml} from \"./namespaces\";\n\nfunction creatorInherit(name) {\n  return function() {\n    var document = this.ownerDocument,\n        uri = this.namespaceURI;\n    return uri === xhtml && document.documentElement.namespaceURI === xhtml\n        ? document.createElement(name)\n        : document.createElementNS(uri, name);\n  };\n}\n\nfunction creatorFixed(fullname) {\n  return function() {\n    return this.ownerDocument.createElementNS(fullname.space, fullname.local);\n  };\n}\n\nexport default function(name) {\n  var fullname = namespace(name);\n  return (fullname.local\n      ? creatorFixed\n      : creatorInherit)(fullname);\n}\n","import creator from \"../creator\";\nimport selector from \"../selector\";\n\nfunction constantNull() {\n  return null;\n}\n\nexport default function(name, before) {\n  var create = typeof name === \"function\" ? name : creator(name),\n      select = before == null ? constantNull : typeof before === \"function\" ? before : selector(before);\n  return this.select(function() {\n    return this.insertBefore(create.apply(this, arguments), select.apply(this, arguments) || null);\n  });\n}\n","function remove() {\n  var parent = this.parentNode;\n  if (parent) parent.removeChild(this);\n}\n\nexport default function() {\n  return this.each(remove);\n}\n","function selection_cloneShallow() {\n  var clone = this.cloneNode(false), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nfunction selection_cloneDeep() {\n  var clone = this.cloneNode(true), parent = this.parentNode;\n  return parent ? parent.insertBefore(clone, this.nextSibling) : clone;\n}\n\nexport default function(deep) {\n  return this.select(deep ? selection_cloneDeep : selection_cloneShallow);\n}\n","var filterEvents = {};\n\nexport var event = null;\n\nif (typeof document !== \"undefined\") {\n  var element = document.documentElement;\n  if (!(\"onmouseenter\" in element)) {\n    filterEvents = {mouseenter: \"mouseover\", mouseleave: \"mouseout\"};\n  }\n}\n\nfunction filterContextListener(listener, index, group) {\n  listener = contextListener(listener, index, group);\n  return function(event) {\n    var related = event.relatedTarget;\n    if (!related || (related !== this && !(related.compareDocumentPosition(this) & 8))) {\n      listener.call(this, event);\n    }\n  };\n}\n\nfunction contextListener(listener, index, group) {\n  return function(event1) {\n    var event0 = event; // Events can be reentrant (e.g., focus).\n    event = event1;\n    try {\n      listener.call(this, this.__data__, index, group);\n    } finally {\n      event = event0;\n    }\n  };\n}\n\nfunction parseTypenames(typenames) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    return {type: t, name: name};\n  });\n}\n\nfunction onRemove(typename) {\n  return function() {\n    var on = this.__on;\n    if (!on) return;\n    for (var j = 0, i = -1, m = on.length, o; j < m; ++j) {\n      if (o = on[j], (!typename.type || o.type === typename.type) && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n      } else {\n        on[++i] = o;\n      }\n    }\n    if (++i) on.length = i;\n    else delete this.__on;\n  };\n}\n\nfunction onAdd(typename, value, capture) {\n  var wrap = filterEvents.hasOwnProperty(typename.type) ? filterContextListener : contextListener;\n  return function(d, i, group) {\n    var on = this.__on, o, listener = wrap(value, i, group);\n    if (on) for (var j = 0, m = on.length; j < m; ++j) {\n      if ((o = on[j]).type === typename.type && o.name === typename.name) {\n        this.removeEventListener(o.type, o.listener, o.capture);\n        this.addEventListener(o.type, o.listener = listener, o.capture = capture);\n        o.value = value;\n        return;\n      }\n    }\n    this.addEventListener(typename.type, listener, capture);\n    o = {type: typename.type, name: typename.name, value: value, listener: listener, capture: capture};\n    if (!on) this.__on = [o];\n    else on.push(o);\n  };\n}\n\nexport default function(typename, value, capture) {\n  var typenames = parseTypenames(typename + \"\"), i, n = typenames.length, t;\n\n  if (arguments.length < 2) {\n    var on = this.node().__on;\n    if (on) for (var j = 0, m = on.length, o; j < m; ++j) {\n      for (i = 0, o = on[j]; i < n; ++i) {\n        if ((t = typenames[i]).type === o.type && t.name === o.name) {\n          return o.value;\n        }\n      }\n    }\n    return;\n  }\n\n  on = value ? onAdd : onRemove;\n  if (capture == null) capture = false;\n  for (i = 0; i < n; ++i) this.each(on(typenames[i], value, capture));\n  return this;\n}\n\nexport function customEvent(event1, listener, that, args) {\n  var event0 = event;\n  event1.sourceEvent = event;\n  event = event1;\n  try {\n    return listener.apply(that, args);\n  } finally {\n    event = event0;\n  }\n}\n","import defaultView from \"../window\";\n\nfunction dispatchEvent(node, type, params) {\n  var window = defaultView(node),\n      event = window.CustomEvent;\n\n  if (typeof event === \"function\") {\n    event = new event(type, params);\n  } else {\n    event = window.document.createEvent(\"Event\");\n    if (params) event.initEvent(type, params.bubbles, params.cancelable), event.detail = params.detail;\n    else event.initEvent(type, false, false);\n  }\n\n  node.dispatchEvent(event);\n}\n\nfunction dispatchConstant(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params);\n  };\n}\n\nfunction dispatchFunction(type, params) {\n  return function() {\n    return dispatchEvent(this, type, params.apply(this, arguments));\n  };\n}\n\nexport default function(type, params) {\n  return this.each((typeof params === \"function\"\n      ? dispatchFunction\n      : dispatchConstant)(type, params));\n}\n","import selection_select from \"./select\";\nimport selection_selectAll from \"./selectAll\";\nimport selection_filter from \"./filter\";\nimport selection_data from \"./data\";\nimport selection_enter from \"./enter\";\nimport selection_exit from \"./exit\";\nimport selection_join from \"./join\";\nimport selection_merge from \"./merge\";\nimport selection_order from \"./order\";\nimport selection_sort from \"./sort\";\nimport selection_call from \"./call\";\nimport selection_nodes from \"./nodes\";\nimport selection_node from \"./node\";\nimport selection_size from \"./size\";\nimport selection_empty from \"./empty\";\nimport selection_each from \"./each\";\nimport selection_attr from \"./attr\";\nimport selection_style from \"./style\";\nimport selection_property from \"./property\";\nimport selection_classed from \"./classed\";\nimport selection_text from \"./text\";\nimport selection_html from \"./html\";\nimport selection_raise from \"./raise\";\nimport selection_lower from \"./lower\";\nimport selection_append from \"./append\";\nimport selection_insert from \"./insert\";\nimport selection_remove from \"./remove\";\nimport selection_clone from \"./clone\";\nimport selection_datum from \"./datum\";\nimport selection_on from \"./on\";\nimport selection_dispatch from \"./dispatch\";\n\nexport var root = [null];\n\nexport function Selection(groups, parents) {\n  this._groups = groups;\n  this._parents = parents;\n}\n\nfunction selection() {\n  return new Selection([[document.documentElement]], root);\n}\n\nSelection.prototype = selection.prototype = {\n  constructor: Selection,\n  select: selection_select,\n  selectAll: selection_selectAll,\n  filter: selection_filter,\n  data: selection_data,\n  enter: selection_enter,\n  exit: selection_exit,\n  join: selection_join,\n  merge: selection_merge,\n  order: selection_order,\n  sort: selection_sort,\n  call: selection_call,\n  nodes: selection_nodes,\n  node: selection_node,\n  size: selection_size,\n  empty: selection_empty,\n  each: selection_each,\n  attr: selection_attr,\n  style: selection_style,\n  property: selection_property,\n  classed: selection_classed,\n  text: selection_text,\n  html: selection_html,\n  raise: selection_raise,\n  lower: selection_lower,\n  append: selection_append,\n  insert: selection_insert,\n  remove: selection_remove,\n  clone: selection_clone,\n  datum: selection_datum,\n  on: selection_on,\n  dispatch: selection_dispatch\n};\n\nexport default selection;\n","import {Selection} from \"./index\";\nimport selector from \"../selector\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selector(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = new Array(n), node, subnode, i = 0; i < n; ++i) {\n      if ((node = group[i]) && (subnode = select.call(node, node.__data__, i, group))) {\n        if (\"__data__\" in node) subnode.__data__ = node.__data__;\n        subgroup[i] = subnode;\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","import {Selection} from \"./index\";\nimport selectorAll from \"../selectorAll\";\n\nexport default function(select) {\n  if (typeof select !== \"function\") select = selectorAll(select);\n\n  for (var groups = this._groups, m = groups.length, subgroups = [], parents = [], j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, node, i = 0; i < n; ++i) {\n      if (node = group[i]) {\n        subgroups.push(select.call(node, node.__data__, i, group));\n        parents.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, parents);\n}\n","import {Selection} from \"./index\";\nimport matcher from \"../matcher\";\n\nexport default function(match) {\n  if (typeof match !== \"function\") match = matcher(match);\n\n  for (var groups = this._groups, m = groups.length, subgroups = new Array(m), j = 0; j < m; ++j) {\n    for (var group = groups[j], n = group.length, subgroup = subgroups[j] = [], node, i = 0; i < n; ++i) {\n      if ((node = group[i]) && match.call(node, node.__data__, i, group)) {\n        subgroup.push(node);\n      }\n    }\n  }\n\n  return new Selection(subgroups, this._parents);\n}\n","export default function(selector) {\n  return function() {\n    return this.matches(selector);\n  };\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","import sparse from \"./sparse\";\nimport {Selection} from \"./index\";\n\nexport default function() {\n  return new Selection(this._exit || this._groups.map(sparse), this._parents);\n}\n","export default function(onenter, onupdate, onexit) {\n  var enter = this.enter(), update = this, exit = this.exit();\n  enter = typeof onenter === \"function\" ? onenter(enter) : enter.append(onenter + \"\");\n  if (onupdate != null) update = onupdate(update);\n  if (onexit == null) exit.remove(); else onexit(exit);\n  return enter && update ? enter.merge(update).order() : update;\n}\n","import {Selection} from \"./index\";\n\nexport default function(selection) {\n\n  for (var groups0 = this._groups, groups1 = selection._groups, m0 = groups0.length, m1 = groups1.length, m = Math.min(m0, m1), merges = new Array(m0), j = 0; j < m; ++j) {\n    for (var group0 = groups0[j], group1 = groups1[j], n = group0.length, merge = merges[j] = new Array(n), node, i = 0; i < n; ++i) {\n      if (node = group0[i] || group1[i]) {\n        merge[i] = node;\n      }\n    }\n  }\n\n  for (; j < m0; ++j) {\n    merges[j] = groups0[j];\n  }\n\n  return new Selection(merges, this._parents);\n}\n","export default function() {\n\n  for (var groups = this._groups, j = -1, m = groups.length; ++j < m;) {\n    for (var group = groups[j], i = group.length - 1, next = group[i], node; --i >= 0;) {\n      if (node = group[i]) {\n        if (next && node.compareDocumentPosition(next) ^ 4) next.parentNode.insertBefore(node, next);\n        next = node;\n      }\n    }\n  }\n\n  return this;\n}\n","export default function() {\n  var nodes = new Array(this.size()), i = -1;\n  this.each(function() { nodes[++i] = this; });\n  return nodes;\n}\n","export default function() {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length; i < n; ++i) {\n      var node = group[i];\n      if (node) return node;\n    }\n  }\n\n  return null;\n}\n","export default function() {\n  var size = 0;\n  this.each(function() { ++size; });\n  return size;\n}\n","export default function() {\n  return !this.node();\n}\n","export default function(callback) {\n\n  for (var groups = this._groups, j = 0, m = groups.length; j < m; ++j) {\n    for (var group = groups[j], i = 0, n = group.length, node; i < n; ++i) {\n      if (node = group[i]) callback.call(node, node.__data__, i, group);\n    }\n  }\n\n  return this;\n}\n","import creator from \"../creator\";\n\nexport default function(name) {\n  var create = typeof name === \"function\" ? name : creator(name);\n  return this.select(function() {\n    return this.appendChild(create.apply(this, arguments));\n  });\n}\n","export default function(value) {\n  return arguments.length\n      ? this.property(\"__data__\", value)\n      : this.node().__data__;\n}\n","import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([[document.querySelector(selector)]], [document.documentElement])\n      : new Selection([[selector]], root);\n}\n","import {event} from \"./selection/on\";\n\nexport default function() {\n  var current = event, source;\n  while (source = current.sourceEvent) current = source;\n  return current;\n}\n","export default function(node, event) {\n  var svg = node.ownerSVGElement || node;\n\n  if (svg.createSVGPoint) {\n    var point = svg.createSVGPoint();\n    point.x = event.clientX, point.y = event.clientY;\n    point = point.matrixTransform(node.getScreenCTM().inverse());\n    return [point.x, point.y];\n  }\n\n  var rect = node.getBoundingClientRect();\n  return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n}\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node) {\n  var event = sourceEvent();\n  if (event.changedTouches) event = event.changedTouches[0];\n  return point(node, event);\n}\n","var noop = {value: function() {}};\n\nfunction dispatch() {\n  for (var i = 0, n = arguments.length, _ = {}, t; i < n; ++i) {\n    if (!(t = arguments[i] + \"\") || (t in _) || /[\\s.]/.test(t)) throw new Error(\"illegal type: \" + t);\n    _[t] = [];\n  }\n  return new Dispatch(_);\n}\n\nfunction Dispatch(_) {\n  this._ = _;\n}\n\nfunction parseTypenames(typenames, types) {\n  return typenames.trim().split(/^|\\s+/).map(function(t) {\n    var name = \"\", i = t.indexOf(\".\");\n    if (i >= 0) name = t.slice(i + 1), t = t.slice(0, i);\n    if (t && !types.hasOwnProperty(t)) throw new Error(\"unknown type: \" + t);\n    return {type: t, name: name};\n  });\n}\n\nDispatch.prototype = dispatch.prototype = {\n  constructor: Dispatch,\n  on: function(typename, callback) {\n    var _ = this._,\n        T = parseTypenames(typename + \"\", _),\n        t,\n        i = -1,\n        n = T.length;\n\n    // If no callback was specified, return the callback of the given type and name.\n    if (arguments.length < 2) {\n      while (++i < n) if ((t = (typename = T[i]).type) && (t = get(_[t], typename.name))) return t;\n      return;\n    }\n\n    // If a type was specified, set the callback for the given type and name.\n    // Otherwise, if a null callback was specified, remove callbacks of the given name.\n    if (callback != null && typeof callback !== \"function\") throw new Error(\"invalid callback: \" + callback);\n    while (++i < n) {\n      if (t = (typename = T[i]).type) _[t] = set(_[t], typename.name, callback);\n      else if (callback == null) for (t in _) _[t] = set(_[t], typename.name, null);\n    }\n\n    return this;\n  },\n  copy: function() {\n    var copy = {}, _ = this._;\n    for (var t in _) copy[t] = _[t].slice();\n    return new Dispatch(copy);\n  },\n  call: function(type, that) {\n    if ((n = arguments.length - 2) > 0) for (var args = new Array(n), i = 0, n, t; i < n; ++i) args[i] = arguments[i + 2];\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  },\n  apply: function(type, that, args) {\n    if (!this._.hasOwnProperty(type)) throw new Error(\"unknown type: \" + type);\n    for (var t = this._[type], i = 0, n = t.length; i < n; ++i) t[i].value.apply(that, args);\n  }\n};\n\nfunction get(type, name) {\n  for (var i = 0, n = type.length, c; i < n; ++i) {\n    if ((c = type[i]).name === name) {\n      return c.value;\n    }\n  }\n}\n\nfunction set(type, name, callback) {\n  for (var i = 0, n = type.length; i < n; ++i) {\n    if (type[i].name === name) {\n      type[i] = noop, type = type.slice(0, i).concat(type.slice(i + 1));\n      break;\n    }\n  }\n  if (callback != null) type.push({name: name, value: callback});\n  return type;\n}\n\nexport default dispatch;\n","import sourceEvent from \"./sourceEvent\";\nimport point from \"./point\";\n\nexport default function(node, touches, identifier) {\n  if (arguments.length < 3) identifier = touches, touches = sourceEvent().changedTouches;\n\n  for (var i = 0, n = touches ? touches.length : 0, touch; i < n; ++i) {\n    if ((touch = touches[i]).identifier === identifier) {\n      return point(node, touch);\n    }\n  }\n\n  return null;\n}\n","import {event} from \"d3-selection\";\n\nexport function nopropagation() {\n  event.stopImmediatePropagation();\n}\n\nexport default function() {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, true);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, true);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, true);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default function(x) {\n  return function() {\n    return x;\n  };\n}\n","export default function DragEvent(target, type, subject, id, active, x, y, dx, dy, dispatch) {\n  this.target = target;\n  this.type = type;\n  this.subject = subject;\n  this.identifier = id;\n  this.active = active;\n  this.x = x;\n  this.y = y;\n  this.dx = dx;\n  this.dy = dy;\n  this._ = dispatch;\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {event, customEvent, select, mouse, touch} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\nimport constant from \"./constant.js\";\nimport DragEvent from \"./event.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter() {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned() {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var gesture = beforestart(\"mouse\", container.apply(this, arguments), mouse, this, arguments);\n    if (!gesture) return;\n    select(event.view).on(\"mousemove.drag\", mousemoved, true).on(\"mouseup.drag\", mouseupped, true);\n    nodrag(event.view);\n    nopropagation();\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\");\n  }\n\n  function mousemoved() {\n    noevent();\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\");\n  }\n\n  function mouseupped() {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent();\n    gestures.mouse(\"end\");\n  }\n\n  function touchstarted() {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.changedTouches,\n        c = container.apply(this, arguments),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(touches[i].identifier, c, touch, this, arguments)) {\n        nopropagation();\n        gesture(\"start\");\n      }\n    }\n  }\n\n  function touchmoved() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent();\n        gesture(\"drag\");\n      }\n    }\n  }\n\n  function touchended() {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation();\n        gesture(\"end\");\n      }\n    }\n  }\n\n  function beforestart(id, container, point, that, args) {\n    var p = point(container, id), s, dx, dy,\n        sublisteners = listeners.copy();\n\n    if (!customEvent(new DragEvent(drag, \"beforestart\", s, id, active, p[0], p[1], 0, 0, sublisteners), function() {\n      if ((event.subject = s = subject.apply(that, args)) == null) return false;\n      dx = s.x - p[0] || 0;\n      dy = s.y - p[1] || 0;\n      return true;\n    })) return;\n\n    return function gesture(type) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[id] = gesture, n = active++; break;\n        case \"end\": delete gestures[id], --active; // nobreak\n        case \"drag\": p = point(container, id), n = active; break;\n      }\n      customEvent(new DragEvent(drag, type, s, id, n, p[0] + dx, p[1] + dy, p[0] - p0[0], p[1] - p0[1], sublisteners), sublisteners.apply, sublisteners, [type, that, args]);\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","var pi = Math.PI,\n    tau = 2 * pi,\n    epsilon = 1e-6,\n    tauEpsilon = tau - epsilon;\n\nfunction Path() {\n  this._x0 = this._y0 = // start of current subpath\n  this._x1 = this._y1 = null; // end of current subpath\n  this._ = \"\";\n}\n\nfunction path() {\n  return new Path;\n}\n\nPath.prototype = path.prototype = {\n  constructor: Path,\n  moveTo: function(x, y) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y);\n  },\n  closePath: function() {\n    if (this._x1 !== null) {\n      this._x1 = this._x0, this._y1 = this._y0;\n      this._ += \"Z\";\n    }\n  },\n  lineTo: function(x, y) {\n    this._ += \"L\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  quadraticCurveTo: function(x1, y1, x, y) {\n    this._ += \"Q\" + (+x1) + \",\" + (+y1) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  bezierCurveTo: function(x1, y1, x2, y2, x, y) {\n    this._ += \"C\" + (+x1) + \",\" + (+y1) + \",\" + (+x2) + \",\" + (+y2) + \",\" + (this._x1 = +x) + \",\" + (this._y1 = +y);\n  },\n  arcTo: function(x1, y1, x2, y2, r) {\n    x1 = +x1, y1 = +y1, x2 = +x2, y2 = +y2, r = +r;\n    var x0 = this._x1,\n        y0 = this._y1,\n        x21 = x2 - x1,\n        y21 = y2 - y1,\n        x01 = x0 - x1,\n        y01 = y0 - y1,\n        l01_2 = x01 * x01 + y01 * y01;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x1,y1).\n    if (this._x1 === null) {\n      this._ += \"M\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Or, is (x1,y1) coincident with (x0,y0)? Do nothing.\n    else if (!(l01_2 > epsilon));\n\n    // Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?\n    // Equivalently, is (x1,y1) coincident with (x2,y2)?\n    // Or, is the radius zero? Line to (x1,y1).\n    else if (!(Math.abs(y01 * x21 - y21 * x01) > epsilon) || !r) {\n      this._ += \"L\" + (this._x1 = x1) + \",\" + (this._y1 = y1);\n    }\n\n    // Otherwise, draw an arc!\n    else {\n      var x20 = x2 - x0,\n          y20 = y2 - y0,\n          l21_2 = x21 * x21 + y21 * y21,\n          l20_2 = x20 * x20 + y20 * y20,\n          l21 = Math.sqrt(l21_2),\n          l01 = Math.sqrt(l01_2),\n          l = r * Math.tan((pi - Math.acos((l21_2 + l01_2 - l20_2) / (2 * l21 * l01))) / 2),\n          t01 = l / l01,\n          t21 = l / l21;\n\n      // If the start tangent is not coincident with (x0,y0), line to.\n      if (Math.abs(t01 - 1) > epsilon) {\n        this._ += \"L\" + (x1 + t01 * x01) + \",\" + (y1 + t01 * y01);\n      }\n\n      this._ += \"A\" + r + \",\" + r + \",0,0,\" + (+(y01 * x20 > x01 * y20)) + \",\" + (this._x1 = x1 + t21 * x21) + \",\" + (this._y1 = y1 + t21 * y21);\n    }\n  },\n  arc: function(x, y, r, a0, a1, ccw) {\n    x = +x, y = +y, r = +r, ccw = !!ccw;\n    var dx = r * Math.cos(a0),\n        dy = r * Math.sin(a0),\n        x0 = x + dx,\n        y0 = y + dy,\n        cw = 1 ^ ccw,\n        da = ccw ? a0 - a1 : a1 - a0;\n\n    // Is the radius negative? Error.\n    if (r < 0) throw new Error(\"negative radius: \" + r);\n\n    // Is this path empty? Move to (x0,y0).\n    if (this._x1 === null) {\n      this._ += \"M\" + x0 + \",\" + y0;\n    }\n\n    // Or, is (x0,y0) not coincident with the previous point? Line to (x0,y0).\n    else if (Math.abs(this._x1 - x0) > epsilon || Math.abs(this._y1 - y0) > epsilon) {\n      this._ += \"L\" + x0 + \",\" + y0;\n    }\n\n    // Is this arc empty? Were done.\n    if (!r) return;\n\n    // Does the angle go the wrong way? Flip the direction.\n    if (da < 0) da = da % tau + tau;\n\n    // Is this a complete circle? Draw two arcs to complete the circle.\n    if (da > tauEpsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (x - dx) + \",\" + (y - dy) + \"A\" + r + \",\" + r + \",0,1,\" + cw + \",\" + (this._x1 = x0) + \",\" + (this._y1 = y0);\n    }\n\n    // Is this arc non-empty? Draw an arc!\n    else if (da > epsilon) {\n      this._ += \"A\" + r + \",\" + r + \",0,\" + (+(da >= pi)) + \",\" + cw + \",\" + (this._x1 = x + r * Math.cos(a1)) + \",\" + (this._y1 = y + r * Math.sin(a1));\n    }\n  },\n  rect: function(x, y, w, h) {\n    this._ += \"M\" + (this._x0 = this._x1 = +x) + \",\" + (this._y0 = this._y1 = +y) + \"h\" + (+w) + \"v\" + (+h) + \"h\" + (-w) + \"Z\";\n  },\n  toString: function() {\n    return this._;\n  }\n};\n\nexport default path;\n","export default function(x) {\n  return function constant() {\n    return x;\n  };\n}\n","function Linear(context) {\n  this._context = context;\n}\n\nLinear.prototype = {\n  areaStart: function() {\n    this._line = 0;\n  },\n  areaEnd: function() {\n    this._line = NaN;\n  },\n  lineStart: function() {\n    this._point = 0;\n  },\n  lineEnd: function() {\n    if (this._line || (this._line !== 0 && this._point === 1)) this._context.closePath();\n    this._line = 1 - this._line;\n  },\n  point: function(x, y) {\n    x = +x, y = +y;\n    switch (this._point) {\n      case 0: this._point = 1; this._line ? this._context.lineTo(x, y) : this._context.moveTo(x, y); break;\n      case 1: this._point = 2; // proceed\n      default: this._context.lineTo(x, y); break;\n    }\n  }\n};\n\nexport default function(context) {\n  return new Linear(context);\n}\n","export function x(p) {\n  return p[0];\n}\n\nexport function y(p) {\n  return p[1];\n}\n","/**\n * @typedef {Object} WhiteboardHistoryItem\n * @property {string} id the identifier of the stored shape.\n * @property {string} previous previous shape state in stringified format.\n * @property {string} current new shape state in stringified format.\n */\n\nconst MAX_HISTORY_LENGTH = 20;\n\n/**\n * Class that stores the changes made in the whiteboard and allows you to get the\n * shapes that undo the changes introduced in the whiteboard. As long as no new\n * changes are introduced this class also allows to obtain the shapes that reverts\n * the changes made (redo action).\n */\nexport default class WhiteboardHistory {\n\n\tconstructor() {\n\n\t\t/**\n\t\t * History pointer.\n\t\t * @private\n\t\t * @type {number}\n\t\t */\n\t\tthis._index = 0;\n\n\t\t/**\n\t\t * Changes introduced into history.\n\t\t * @private\n\t\t * @type {Array<WhiteboardHistoryItem>}\n\t\t */\n\t\tthis._history = [];\n\t}\n\n\t/**\n\t * Reset the history.\n\t */\n\tclear() {\n\t\tthis._index = 0;\n\t\tthis._history = [];\n\t}\n\n\t/**\n\t * Get the previous state of a given shape.\n\t * @private\n\t * @param {string} id shape identifier.\n\t * @return {Object} previous state of shape .\n\t */\n\t_getPreviousShape(id) {\n\t\tlet item = this._history.slice(0, this._index)\n\t\t\t.filter(x => x.id === id)\n\t\t\t.pop();\n\t\treturn item ? item.current : JSON.stringify({id: id});\n\t}\n\n\t/**\n\t * Add a new shape state to the history.\n\t * @param {Object} shape the new state of the shape.\n\t */\n\tadd(shape) {\n\t\tlet id = shape.id;\n\t\tlet previous = this._getPreviousShape(id);\n\t\tshape = JSON.stringify(shape);\n\t\tif (previous === shape) {\n\t\t\treturn;\n\t\t}\n\t\tthis._history.length = this._index;\n\t\tthis._history.push({\n\t\t\tid: id,\n\t\t\tprevious: previous,\n\t\t\tcurrent: shape,\n\t\t});\n\t\tif (this._index >= MAX_HISTORY_LENGTH) {\n\t\t\tthis._history.shift();\n\t\t} else {\n\t\t\tthis._index++;\n\t\t}\n\t}\n\n\t/**\n\t * Check if there are items stored in the history can be used to undo an action.\n\t * @return {boolean} true if there is at least one item stored in the history.\n\t */\n\tcanUndo() {\n\t\treturn this._index > 0;\n\t}\n\n\t/**\n\t * Check if there are items stored in the history that can be used to redo an action.\n\t * @return {boolean} true if there is at least one item stored in the history.\n\t */\n\tcanRedo() {\n\t\treturn this._index < this._history.length;\n\t}\n\n\t/**\n\t * Get a shape that can be used to undo last added shape.\n\t * @return {Object} shape that reverts last change.\n\t */\n\tundo() {\n\t\tif (!this.canUndo()) {\n\t\t\treturn null;\n\t\t}\n\t\tlet shape = JSON.parse(this._history[this._index - 1].previous);\n\t\tthis._index--;\n\t\treturn shape;\n\t}\n\n\t/**\n\t * Get a shape that can be used to revert last undo action.\n\t * @return {Object} shape that reverts last undo action.\n\t */\n\tredo() {\n\t\tif (!this.canRedo()) {\n\t\t\treturn null;\n\t\t}\n\t\tlet shape = JSON.parse(this._history[this._index].current);\n\t\tthis._index++;\n\t\treturn shape;\n\t}\n}\n\n\n","import {select as d3Select, event as d3Event, mouse as d3Mouse} from 'd3-selection';\nimport {drag as d3Drag} from 'd3-drag';\nimport {line as d3Line} from 'd3-shape';\nimport nanoid from 'nanoid';\n\nimport {EventEmitter} from '../eventemitter';\nimport {bindMethods} from '../utils';\nimport {DataPipeStatus} from '../datapipe/DataPipeStatus';\nimport {DataPipeType} from '../datapipe/DataPipeType';\nimport WhiteboardHistory from './WhiteboardHistory';\n\nfunction blob2Base64(blob) {\n\treturn new Promise((resolve) => {\n\t\tlet reader = new window.FileReader();\n\t\treader.readAsDataURL(blob);\n\t\treader.onloadend = function() {\n\t\t\tresolve(reader.result);\n\t\t};\n\t});\n}\n\n// Minimum time in ms for sending shapes using the data pipe\nconst SHAPE_SEND_INTERVAL = 500;\n\n/**\n * Provides access to methods for creating whiteboards.\n * This class must not be directly instantiated. It can be obtained using\n * {@link session#createWhiteboard} or listening to {@link session#incommingWhiteBoard}\n * event.\n *\n * ## Events\n *\n * - **`shape`** is emitted every time a new shape is added.\n * - **`clear`** is emitted every time the other end clears every shape from the whiteboard.\n * - **`closed`** is emitted when the whiteboard session has finished.\n *\n * You can check EventEmitter2 documentation for additional information about\n * adding and removing listeners for this events events.\n *\n * @see https://github.com/asyncly/EventEmitter2#api\n *\n * @example <caption>How to create a Whiteboard</caption>\n * session.createWhiteboard(participants).then(function(whiteboard));\n *     whiteboard.setArea('body');\n *     whiteboard.tool = 'add-line';\n *     whiteboard.on('closed', function() {\n *         board.setArea(null);\n *     });\n *     ...\n *     board.close();\n * });\n *\n * @example <caption>How to handle incoming Whiteboards</caption>\n * session.on('incomingWhiteBoard', function(board) {\n *     board.setArea('body');\n *     board.on('closed', function() {\n *        board.setArea(null);\n *     });\n * });\n */\nexport default class Whiteboard extends EventEmitter {\n\n\t/**\n\t * Gets the version of the protocol implemented.\n\t * @type {string}\n\t */\n\tstatic get PROTOCOL() {\n\t\treturn 'whiteboard/2.0';\n\t}\n\n\t/**\n\t * Gets the valid values for the tool field.\n\t * @type {Array<tool>}\n\t */\n\tstatic get TOOL() {\n\t\treturn [null, 'select', 'add-line', 'freedraw', 'add-rect', 'add-circle', 'remove'];\n\t}\n\n\t/**\n\t * Initializes a new whiteboard with its default values.\n\t * @param {Datapipe} pipe The datapipe that will be used.\n\t * @protected\n\t */\n\tconstructor(pipe) {\n\t\tsuper();\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Datapipe}\n\t\t */\n\t\tthis._pipe = pipe;\n\n\t\t/**\n\t\t * Keeps the width of the whiteboard\n\t\t * @private\n\t\t * @type {number}\n\t\t */\n\t\tthis._width = 1920;\n\n\t\t/**\n\t\t * Keeps the height of the whiteboard\n\t\t * @private\n\t\t * @type {number}\n\t\t */\n\t\tthis._height = 1080;\n\n\t\t/**\n\t\t * Keeps the active tool.\n\t\t * @private\n\t\t * @type {tool}\n\t\t */\n\t\tthis._tool = null;\n\n\t\t/**\n\t\t * Keeps the current chosen color.\n\t\t * @private\n\t\t * @type {color}\n\t\t */\n\t\tthis._color = 'black';\n\n\t\t/**\n\t\t * Keeps the current background image URL.\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis._backgroundImage = '';\n\n\t\t/**\n\t\t * Keeps the current background video.\n\t\t * @private\n\t\t * @type {string}\n\t\t */\n\t\tthis._backgroundVideo = '';\n\n\t\t/**\n\t\t * Keeps the d3 single element selector of the DOM element\n\t\t * where the whiteboard was inserted.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._element = null;\n\n\t\t/**\n\t\t * Keeps the d3 single element selector of the svg element\n\t\t * where the whiteboard is painted.\n\t\t * @private\n\t\t * @type {Object}\n\t\t */\n\t\tthis._svg = this._createCanvas();\n\n\t\t/**\n\t\t * A value used to check if the Whiteboard is already initialized.\n\t\t * @private\n\t\t * @type {Promise}\n\t\t */\n\t\tthis._initializing = null;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {number}\n\t\t */\n\t\tthis._lastShapeSendTimestamp = 0;\n\n\t\t/** @private */\n\t\tthis._pendingShapes = new Map();\n\n\t\t/** @private */\n\t\tthis._pendingShapesTimer = 0;\n\n\t\t/**\n\t\t * @private\n\t\t * @type {Whiteboard}\n\t\t */\n\t\tthis._history = new WhiteboardHistory();\n\n\t\t/**\n\t\t * Keeps the current line width.\n\t\t * @private\n\t\t */\n\t\tthis._lineWidth = 1;\n\n\t\tbindMethods(this, [\n\t\t\t'_onPointerDown',\n\t\t]);\n\t}\n\n\t/**\n\t * Creates the svg element\n\t * @private\n\t * @return {Selection} A SVGElement wrapped in a d3 selector\n\t */\n\t_createCanvas() {\n\t\tlet svg = d3Select(document.createElementNS('http://www.w3.org/2000/svg', 'svg'))\n\t\t\t.attr('height', '100%')\n\t\t\t.attr('width', '100%')\n\t\t\t.attr('viewBox', '0 0 1920 1440')\n\t\t\t.attr('preserveAspectRatio', 'xMidYMid meet')\n\t\t\t.attr('clip-path', 'url(#clip)');\n\t\tsvg.append('rect')\n\t\t\t.attr('width', '1920')\n\t\t\t.attr('height', '1440')\n\t\t\t.attr('x', '0')\n\t\t\t.attr('y', '0')\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('stroke', 'gray')\n\t\t\t.attr('stroke-width', 1);\n\t\treturn svg;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_onPointerDown() {\n\t\tif (d3Event.type === 'mousedown' && d3Event.button !== 0) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (this.tool) {\n\t\t\tcase 'select':\n\t\t\t\tthis._selectPointedElement(this, d3Event.target);\n\t\t\t\tbreak;\n\t\t\tcase 'remove': {\n\t\t\t\tconst shape = d3Select(d3Event.target).data()[0];\n\t\t\t\tif (typeof shape === 'object' && typeof shape.id === 'string') {\n\t\t\t\t\td3Select(d3Event.target).data([]).exit().remove();\n\t\t\t\t\tthis._send({id: shape.id}, true);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'add-line':\n\t\t\t\treturn this._createLine();\n\t\t\tcase 'freedraw':\n\t\t\t\treturn this._createFreedraw();\n\t\t\tcase 'add-rect':\n\t\t\t\treturn this._createRect();\n\t\t\tcase 'add-circle':\n\t\t\t\treturn this._createCircle();\n\t\t\tdefault:\n\t\t\t\tthis._unselectAllElements();\n\t\t}\n\t}\n\n\t/**\n\t * Selects or unselects a DOMElement\n\t *\n\t * @param that a reference to the class's this\n\t * @param element the DOMElement\n\t * @private\n\t */\n\t_selectPointedElement(that, element) {\n\t\tswitch (element.tagName.toLowerCase()) {\n\t\t\tcase 'svg':\n\t\t\t\tthat._svg.selectAll('.shape.selected').classList.remove('selected');\n\t\t\t\tbreak;\n\t\t\tcase 'path':\n\t\t\tcase 'circle':\n\t\t\tcase 'rect':\n\t\t\t\tif (d3Event.ctrlKey) {\n\t\t\t\t\tif (element.classList.contains('selected')) {\n\t\t\t\t\t\telement.classList.add('selected');\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.classList.remove('selected');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthat._unselectAllElements();\n\t\t\t\t\telement.classList.add('selected');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\t/**\n\t * Unselects all previously selected objects\n\t */\n\t_unselectAllElements() {\n\t\tthis._svg.selectAll('.selected').classed('selected', false);\n\t}\n\n\t/**\n\t * Removes every shape from the whiteboard\n\t * @return {undefined}\n\t */\n\tclear() {\n\t\tthis._svg.selectAll('.shape').data([], d => d.id).exit().remove();\n\t\tthis._pipe.send(JSON.stringify({cmd: 'clear'}));\n\t\tthis._history.clear();\n\t}\n\n\t/**\n\t * Update a shape stored in history, updating it locally and remotely.\n\t * @param {Object} shape the shape to update.\n\t */\n\t_updateShape(shape) {\n\t\tif (!shape) {\n\t\t\treturn;\n\t\t}\n\t\tthis._renderShape(shape);\n\t\tthis.emit('shape', shape);\n\t\tthis._pipe.send(JSON.stringify({\n\t\t\tcmd: 'shape',\n\t\t\tshape: shape,\n\t\t}));\n\t}\n\n\t/**\n\t * Check if last action can be reverted.\n\t * @return {boolean} true if there are actions that can be reverted.\n\t */\n\tcanUndo() {\n\t\treturn this._history.canUndo();\n\t}\n\n\t/**\n\t * Revert last change.\n\t */\n\tundo() {\n\t\tthis._updateShape(this._history.undo());\n\t}\n\n\t/**\n\t * Check if last undo call can be reverted.\n\t * @return {boolean} true if a previous undo can be reverted.\n\t */\n\tcanRedo() {\n\t\treturn this._history.canRedo();\n\t}\n\n\t/**\n\t * Revert last undo call.\n\t */\n\tredo() {\n\t\tthis._updateShape(this._history.redo());\n\t}\n\n\t/**\n\t * Allows to set the area that will be used as the canvas for the whiteboard.\n\t * @param {string|HTMLElement|null} selector Selector of the DOM element where the svg canvas\n\t * will be included. It also works if the HTMLElement itself is provided.\n\t * @returns {Whiteboard} The whiteboard object.\n\t */\n\tsetArea(selector) {\n\t\tif (this._element !== null) {\n\t\t\tthis._element.node().removeChild(this._svg.node());\n\t\t\tthis._element.html('');\n\t\t\tthis._element = null;\n\t\t}\n\t\tif (selector === null) {\n\t\t\treturn this;\n\t\t}\n\t\tthis._element = d3Select(selector);\n\t\tif (this._element.empty()) {\n\t\t\tthrow Error('No elements exist for selector ' + selector);\n\t\t}\n\t\tthis._element.html('');\n\t\tthis._element.node().appendChild(this._svg.node());\n\n\t\tthis._svg.on('mousedown', this._onPointerDown);\n\t\tthis._svg.on('touchstart', this._onPointerDown);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Closes this whiteboard session.\n\t * @returns {Whiteboard} The whiteboard object.\n\t */\n\tclose() {\n\t\tthis._pipe.disconnect();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns the current width of the whiteboard\n\t * @type {number}\n\t */\n\tget width() {\n\t\treturn this._width;\n\t}\n\n\t/**\n\t * Returns the current height of the whiteboard\n\t * @type {number}\n\t */\n\tget height() {\n\t\treturn this._height;\n\t}\n\n\t/**\n\t * Returns the current aspect ratio of the whiteboard\n\t * @type {number}\n\t */\n\tget aspectRatio() {\n\t\treturn this._width / this._height;\n\t}\n\n\t/**\n\t * Updates the aspect ratio of the whiteboard\n\t * @type {number}\n\t */\n\tset aspectRatio(aspectRatio) {\n\t\tthis._height = this._width / aspectRatio;\n\t\tthis._svg.attr('viewBox', `0 0 ${this._width} ${this._height}`)\n\t\t\t.select('rect').attr('height', this._height);\n\t}\n\n\t/**\n\t * Gets the identities of the remote peers attached to this Whiteboard.\n\t * @type {Array<String>}\n\t */\n\tget remoteParticipants() {\n\t\treturn this._pipe.remoteParticipants;\n\t}\n\n\t/**\n\t * @typedef {string} color\n\t * @desc The color used for the shapes. It is represented in a string\n\t * (e.g.: 'green', 'red') or RGB (e.g.: '#00FF00', '#FF0000').\n\t */\n\n\t/**\n\t * Gets the color used for the shapes.\n\t * @type {color}\n\t */\n\tget color() {\n\t\treturn this._color;\n\t}\n\n\t/**\n\t * Sets the color used for the shapes.\n\t * @type {color}\n\t */\n\tset color(color) {\n\t\tthis._color = color;\n\t\tthis._svg.selectAll('.selected').each((d) => {\n\t\t\td.fill = d.fill === 'none' ? 'none' : color;\n\t\t\td.stroke = d.stroke === 'none' ? 'none' : color;\n\t\t\tthis._send(d, true);\n\t\t\tthis._renderShape(d);\n\t\t});\n\t}\n\n\n\t/**\n\t * @typedef {string} tool\n\t * @desc The tool to use on user interaction. It is represented in a string.\n\t * Valid values: null, 'select', 'add-line', 'freedraw', 'add-rect', 'add-circle', 'remove'\n\t * (null means no tool is selected)\n\t */\n\n\t/**\n\t * Gets the current tool to use on user interaction.\n\t * @type {tool}\n\t */\n\tget tool() {\n\t\treturn this._tool;\n\t}\n\n\t/**\n\t * Sets the current tool to use on user interaction.\n\t * @type {tool}\n\t */\n\tset tool(tool) {\n\t\tif (this._element === null) {\n\t\t\tthrow Error('No area selected. Method setArea must be called before.');\n\t\t}\n\t\tif (!Whiteboard.TOOL.some(value => tool === value)) {\n\t\t\tthrow Error('Invalid tool: ' + tool);\n\t\t}\n\t\tif (tool !== 'select') {\n\t\t\tthis._unselectAllElements();\n\t\t}\n\t\tthis._tool = tool;\n\t}\n\n\t/**\n\t * @typedef {string|Blob} backgroundImage\n\t * @desc The URL of the image that is set in the background or a Blob\n\t * containing an image.\n\t */\n\n\t/**\n\t * Gets the current background image shown.\n\t * @type {backgroundImage}\n\t */\n\tget backgroundImage() {\n\t\treturn this._backgroundImage;\n\t}\n\n\t/**\n\t * Sets the current background image shown.\n\t * @type {backgroundImage}\n\t */\n\tset backgroundImage(image) {\n\t\tPromise.resolve(image instanceof Blob ? blob2Base64(image) : image).then((imageUrl) => {\n\t\t\tthis._backgroundImage = imageUrl;\n\t\t\tlet shape = {\n\t\t\t\ttype: 'background',\n\t\t\t\turl: imageUrl,\n\t\t\t};\n\t\t\tthis._send(shape, true);\n\t\t\tthis._renderBackground(shape);\n\t\t});\n\t}\n\n\t/**\n\t * Gets the current background video shown.\n\t * @type {string}\n\t */\n\tget backgroundVideo() {\n\t\treturn this._backgroundVideo;\n\t}\n\n\t/**\n\t * Sets the current background video shown. Valid values are \"local\", \"remote\" and \"\"\n\t * @type {string}\n\t */\n\tset backgroundVideo(video) {\n\t\tif (video !== 'local' && video !== 'remote' && video !== '') {\n\t\t\tthrow new TypeError(`${video} is not a valid value. Valid values are \"local\" \"remote\" and \"\"`);\n\t\t}\n\t\tthis._backgroundVideo = video;\n\t\tswitch (video) {\n\t\t\tcase 'local':\n\t\t\t\tvideo = 'remote';\n\t\t\t\tbreak;\n\t\t\tcase 'remote':\n\t\t\t\tvideo = 'local';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t\tlet shape = {\n\t\t\ttype: 'backgroundVideo',\n\t\t\tsource: video,\n\t\t};\n\t\tthis._send(shape, true);\n\t}\n\n\n\tget lineWidth() {\n\t\treturn this._lineWidth;\n\t}\n\n\tset lineWidth(lineWidth) {\n\t\tthis._lineWidth = lineWidth;\n\t}\n\n\t/**\n\t * Initializes the Whiteboard\n\t * Sets the datapipe object that will be used for receiving and transmiting data.\n\t * @protected\n\t * @return {Promise<Whiteboard>} The whiteboard object.\n\t */\n\tinit() {\n\t\tif (this._initializing) {\n\t\t\treturn this._initializing;\n\t\t}\n\t\tthis._initializing = new Promise(async (resolve) => {\n\t\t\tthis._pipe.on('data', (data) => {\n\t\t\t\tlet msg = JSON.parse(data);\n\t\t\t\tswitch (msg.cmd) {\n\t\t\t\t\tcase 'shape':\n\t\t\t\t\t\tthis._renderShape(msg.shape);\n\t\t\t\t\t\tthis.emit('shape', msg.shape);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'clear':\n\t\t\t\t\t\tthis._svg.selectAll('.shape').data([], d => d.id).exit().remove();\n\t\t\t\t\t\tthis.emit('clear');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ready':\n\t\t\t\t\t\tresolve(this);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._pipe.when(DataPipeStatus.DISCONNECTED).then(() => {\n\t\t\t\tthis._pipe.removeAllListeners();\n\t\t\t\tthis._pipe = null;\n\t\t\t\tthis.emit('closed');\n\t\t\t});\n\t\t\tawait this._pipe.connect();\n\t\t\tif (this._pipe.type === DataPipeType.OUTGOING) {\n\t\t\t\tawait this._pipe.send(JSON.stringify({cmd: 'ready'}));\n\t\t\t}\n\t\t\tresolve(this);\n\t\t});\n\t\treturn this._initializing;\n\t}\n\n\t/**\n\t * Sends a shape\n\t * @private\n\t * @param {object} shape The shape being sent\n\t * @param {boolean} [force=false] If true the shape will be inmediately sent\n\t * ignoring the shape send interval timer.\n\t * @return {Promise} A promise that is fulfilled after the shape has been sent\n\t */\n\t_send(shape, force = false) {\n\t\tthis.emit('shape', shape);\n\t\tif (!force && this._lastShapeSendTimestamp + SHAPE_SEND_INTERVAL > Date.now()) {\n\t\t\tthis._pendingShapes.set(shape.id, shape);\n\t\t\tif (!this._pendingShapesTimer) {\n\t\t\t\tthis._pendingShapesTimer = setTimeout(() => {\n\t\t\t\t\tthis._pendingShapes.forEach(s => this._sendShape(s));\n\t\t\t\t\tthis._lastShapeSendTimestamp = Date.now();\n\t\t\t\t\tthis._pendingShapesTimer = 0;\n\t\t\t\t\tthis._pendingShapes.clear();\n\t\t\t\t}, this._lastShapeSendTimestamp + SHAPE_SEND_INTERVAL - Date.now());\n\t\t\t}\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis._pendingShapes.delete(shape.id);\n\t\tthis._lastShapeSendTimestamp = Date.now();\n\t\treturn this._sendShape(shape);\n\t}\n\n\t/**\n\t * Sends a shape using the data pipe.\n\t * @private\n\t * @param {object} shape The shape being sent\n\t * @return {Promise} A promise that is fulfilled after the shape has been sent\n\t */\n\t_sendShape(shape) {\n\t\tthis._history.add(shape);\n\t\treturn this._pipe.send(JSON.stringify({\n\t\t\tcmd: 'shape',\n\t\t\tshape: shape,\n\t\t}));\n\t}\n\n\t_updateOrAppend(shapes, shape) {\n\t\tlet oldIndex = shapes.findIndex(s => s.id === shape.id);\n\t\tif (oldIndex < 0) {\n\t\t\tshapes.push(shape);\n\t\t} else {\n\t\t\tshapes[oldIndex] = shape;\n\t\t}\n\t\treturn shapes;\n\t}\n\n\t_addDragBehaviour(that, graph, callback) {\n\t\tlet dragBehaviour = d3Drag();\n\t\tdragBehaviour.on('start', () => {\n\t\t\tthat._selectPointedElement(this, d3Event.sourceEvent.target);\n\t\t});\n\t\tdragBehaviour.on('drag', (d) => {\n\t\t\tcallback(d);\n\t\t});\n\t\t// Ignore the drag event if the tool is not select\n\t\tdragBehaviour.filter(function() {\n\t\t\treturn that._tool === 'select';\n\t\t});\n\t\tgraph.call(dragBehaviour);\n\t}\n\n\t/**\n\t * Renders a shape of type line.\n\t * @private\n\t * @param {object} shape The shape being sent\n\t * @return {undefined}\n\t */\n\t_renderLine(shape) {\n\t\tlet element = this._svg.selectAll('path');\n\t\tlet data = this._updateOrAppend(element.data(), shape);\n\t\tlet line = d3Line().x(d => d.x).y(d => d.y);\n\n\t\tlet graph = element.data(data, d => d.id);\n\t\tgraph.exit().remove();\n\t\tgraph.enter().append('path')\n\t\t\t.attr('id', d => d.id)\n\t\t\t.attr('stroke-width', this._lineWidth)\n\t\t\t.classed('shape', true);\n\t\tgraph\n\t\t\t.attr('d', d => line(d.path))\n\t\t\t.attr('stroke', d => d.stroke)\n\t\t\t.attr('fill', d => d.fill);\n\n\t\tthis._addDragBehaviour(this, graph, (d) => {\n\t\t\td.path.forEach((point) => {\n\t\t\t\tpoint.x += d3Event.dx;\n\t\t\t\tpoint.y += d3Event.dy;\n\t\t\t});\n\t\t\tgraph.attr('d', datum => line(datum.path));\n\t\t\tthis._send(d);\n\t\t});\n\t}\n\n\t/**\n\t * Renders a shape of type circle.\n\t * @param {object} shape The shape being sent\n\t * @private\n\t */\n\t_renderCircle(shape) {\n\t\tlet element = this._svg.selectAll('circle');\n\t\tlet data = this._updateOrAppend(element.data(), shape);\n\n\t\tlet graph = element.data(data, d => d.id);\n\t\tgraph.exit().remove();\n\t\tgraph.enter().append('circle')\n\t\t\t.attr('id', d => d.id)\n\t\t\t.classed('shape', true);\n\t\tgraph\n\t\t\t.attr('cx', d => d.cx)\n\t\t\t.attr('cy', d => d.cy)\n\t\t\t.attr('r', d => d.r)\n\t\t\t.attr('stroke', d => d.stroke)\n\t\t\t.attr('fill', d => d.fill);\n\n\t\tthis._addDragBehaviour(this, graph, (d) => {\n\t\t\td.cx += d3Event.dx;\n\t\t\td.cy += d3Event.dy;\n\t\t\tgraph.attr('cx', datum => datum.cx).attr('cy', datum => datum.cy);\n\t\t\tthis._send(d);\n\t\t});\n\t}\n\n\t/**\n\t * Renders a shape of type rect.\n\t * @private\n\t */\n\t_renderRect(shape) {\n\t\tlet element = this._svg.selectAll('rect.shape');\n\t\tlet data = this._updateOrAppend(element.data(), shape);\n\n\t\tlet graph = element.data(data, d => d.id);\n\t\tgraph.exit().remove();\n\t\tgraph.enter().append('rect')\n\t\t\t.attr('id', d => d.id)\n\t\t\t.classed('shape', true);\n\t\tgraph.attr('x', d => d.x)\n\t\t\t.attr('y', d => d.y)\n\t\t\t.attr('width', d => d.width)\n\t\t\t.attr('height', d => d.height)\n\t\t\t.attr('stroke', d => d.stroke)\n\t\t\t.attr('fill', d => d.fill);\n\n\t\tthis._addDragBehaviour(this, graph, (d) => {\n\t\t\td.x += d3Event.dx;\n\t\t\td.y += d3Event.dy;\n\t\t\tgraph.attr('x', datum => datum.x).attr('y', datum => datum.y);\n\t\t\tthis._send(d);\n\t\t});\n\t}\n\n\t/**\n\t * Removes a shape of the specified id\n\t * @private\n\t */\n\t_renderRemoveShape(shape) {\n\t\tlet element = this._svg.selectAll('.shape');\n\t\tlet newData = element.data().filter(datum => datum.id !== shape.id);\n\t\telement.data(newData, d => d.id).exit().remove();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_bindEndActionEvents(callback) {\n\t\tthis._svg.on('mouseup', () => {\n\t\t\tthis._svg.on('mousemove', null);\n\t\t\tthis._svg.on('mouseup', null);\n\t\t\tcallback();\n\t\t});\n\n\t\tthis._svg.on('touchend', () => {\n\t\t\tthis._svg.on('touchmove', null);\n\t\t\tthis._svg.on('touchend', null);\n\t\t\tcallback();\n\t\t});\n\t}\n\n\t/**\n\t * Creates and renders a shape of type line\n\t * @private\n\t */\n\t_createLine() {\n\t\tlet coordinates = d3Mouse(this._svg.node());\n\t\tlet shape = {\n\t\t\tid: nanoid(),\n\t\t\ttype: 'line',\n\t\t\tpath: [{\n\t\t\t\tx: coordinates[0],\n\t\t\t\ty: coordinates[1],\n\t\t\t}, {\n\t\t\t\tx: coordinates[0],\n\t\t\t\ty: coordinates[1],\n\t\t\t}],\n\t\t\tstroke: this.color,\n\t\t\tfill: this.color,\n\t\t};\n\t\tthis._renderLine(shape);\n\n\t\tlet onMove = () => {\n\t\t\tcoordinates = d3Mouse(this._svg.node());\n\t\t\tshape.path[1].x = coordinates[0];\n\t\t\tshape.path[1].y = coordinates[1];\n\t\t\tthis._renderLine(shape);\n\t\t\tthis._send(shape);\n\t\t};\n\n\t\tthis._svg.on('mousemove', onMove);\n\t\tthis._svg.on('touchmove', onMove);\n\t\tthis._bindEndActionEvents(() => this._send(shape, true));\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_createFreedraw() {\n\t\tlet coordinates = d3Mouse(this._svg.node());\n\t\tlet shape = {\n\t\t\tid: nanoid(),\n\t\t\ttype: 'freedraw',\n\t\t\tpath: [{\n\t\t\t\tx: coordinates[0],\n\t\t\t\ty: coordinates[1],\n\t\t\t}],\n\t\t\tstroke: this.color,\n\t\t\tfill: 'none',\n\t\t};\n\t\tthis._renderLine(shape);\n\n\t\tlet onMove = () => {\n\t\t\tcoordinates = d3Mouse(this._svg.node());\n\t\t\tshape.path.push({\n\t\t\t\tx: coordinates[0],\n\t\t\t\ty: coordinates[1],\n\t\t\t});\n\t\t\tthis._renderLine(shape);\n\t\t\tthis._send(shape);\n\t\t};\n\n\t\tthis._svg.on('mousemove', onMove);\n\t\tthis._svg.on('touchmove', onMove);\n\t\tthis._bindEndActionEvents(() => this._send(shape, true));\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_createCircle() {\n\t\tlet startPoint = d3Mouse(this._svg.node());\n\t\tlet shape = {\n\t\t\tid: nanoid(),\n\t\t\ttype: 'circle',\n\t\t\tcx: startPoint[0],\n\t\t\tcy: startPoint[1],\n\t\t\tr: 0,\n\t\t\tstroke: this.color,\n\t\t\tfill: this.color,\n\t\t};\n\t\tthis._renderCircle(shape);\n\n\t\tlet onMove = () => {\n\t\t\tlet coordinates = d3Mouse(this._svg.node());\n\t\t\tshape.cx = (coordinates[0] + startPoint[0]) / 2;\n\t\t\tshape.cy = (coordinates[1] + startPoint[1]) / 2;\n\t\t\tshape.r = Math.sqrt(Math.pow(coordinates[0] - startPoint[0], 2) + Math.pow(coordinates[1] - startPoint[1], 2)) / 2;\n\t\t\tthis._renderCircle(shape);\n\t\t\tthis._send(shape);\n\t\t};\n\n\t\tthis._svg.on('mousemove', onMove);\n\t\tthis._svg.on('touchmove', onMove);\n\t\tthis._bindEndActionEvents(() => this._send(shape, true));\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_createRect() {\n\t\tlet coordinates = d3Mouse(this._svg.node());\n\t\tlet shape = {\n\t\t\tid: nanoid(),\n\t\t\ttype: 'rect',\n\t\t\tx: coordinates[0],\n\t\t\ty: coordinates[1],\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tstroke: this.color,\n\t\t\tfill: this.color,\n\t\t};\n\t\tthis._renderRect(shape);\n\n\t\tlet onMove = () => {\n\t\t\tlet newCoordinates = d3Mouse(this._svg.node());\n\t\t\tlet w = newCoordinates[0] - coordinates[0];\n\t\t\tlet h = newCoordinates[1] - coordinates[1];\n\t\t\tif (w < 0) {\n\t\t\t\tshape.x = newCoordinates[0];\n\t\t\t\tshape.width = -w;\n\t\t\t} else {\n\t\t\t\tshape.x = coordinates[0];\n\t\t\t\tshape.width = w;\n\t\t\t}\n\t\t\tif (h < 0) {\n\t\t\t\tshape.y = newCoordinates[1];\n\t\t\t\tshape.height = -h;\n\t\t\t} else {\n\t\t\t\tshape.y = coordinates[1];\n\t\t\t\tshape.height = h;\n\t\t\t}\n\t\t\tthis._renderRect(shape);\n\t\t\tthis._send(shape);\n\t\t};\n\n\t\tthis._svg.on('mousemove', onMove);\n\t\tthis._svg.on('touchmove', onMove);\n\t\tthis._bindEndActionEvents(() => this._send(shape, true));\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_renderBackground(shape) {\n\t\tlet image = this._svg.select('#background');\n\t\tif (image.empty()) {\n\t\t\timage = this._svg.insert('svg:image', ':first-child')\n\t\t\t\t.attr('id', 'background')\n\t\t\t\t.attr('width', '100%')\n\t\t\t\t.attr('height', '100%')\n\t\t\t\t.attr('x', 0)\n\t\t\t\t.attr('y', 0);\n\t\t}\n\t\timage.attr('xlink:href', shape.url);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_renderShape(shape) {\n\t\tswitch (shape.type) {\n\t\t\tcase 'background':\n\t\t\t\tthis._backgroundImage = shape.url;\n\t\t\t\tthis._renderBackground(shape);\n\t\t\t\tbreak;\n\t\t\tcase 'backgroundVideo':\n\t\t\t\tthis._backgroundVideo = shape.source;\n\t\t\t\tbreak;\n\t\t\tcase 'line':\n\t\t\t\tthis._renderLine(shape);\n\t\t\t\tbreak;\n\t\t\tcase 'freedraw':\n\t\t\t\tthis._renderLine(shape);\n\t\t\t\tbreak;\n\t\t\tcase 'rect':\n\t\t\t\tthis._renderRect(shape);\n\t\t\t\tbreak;\n\t\t\tcase 'circle':\n\t\t\t\tthis._renderCircle(shape);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis._renderRemoveShape(shape);\n\t\t}\n\t}\n}\n","import {path} from \"d3-path\";\nimport constant from \"./constant.js\";\nimport curveLinear from \"./curve/linear.js\";\nimport {x as pointX, y as pointY} from \"./point.js\";\n\nexport default function() {\n  var x = pointX,\n      y = pointY,\n      defined = constant(true),\n      context = null,\n      curve = curveLinear,\n      output = null;\n\n  function line(data) {\n    var i,\n        n = data.length,\n        d,\n        defined0 = false,\n        buffer;\n\n    if (context == null) output = curve(buffer = path());\n\n    for (i = 0; i <= n; ++i) {\n      if (!(i < n && defined(d = data[i], i, data)) === defined0) {\n        if (defined0 = !defined0) output.lineStart();\n        else output.lineEnd();\n      }\n      if (defined0) output.point(+x(d, i, data), +y(d, i, data));\n    }\n\n    if (buffer) return output = null, buffer + \"\" || null;\n  }\n\n  line.x = function(_) {\n    return arguments.length ? (x = typeof _ === \"function\" ? _ : constant(+_), line) : x;\n  };\n\n  line.y = function(_) {\n    return arguments.length ? (y = typeof _ === \"function\" ? _ : constant(+_), line) : y;\n  };\n\n  line.defined = function(_) {\n    return arguments.length ? (defined = typeof _ === \"function\" ? _ : constant(!!_), line) : defined;\n  };\n\n  line.curve = function(_) {\n    return arguments.length ? (curve = _, context != null && (output = curve(context)), line) : curve;\n  };\n\n  line.context = function(_) {\n    return arguments.length ? (_ == null ? context = output = null : output = curve(context = _), line) : context;\n  };\n\n  return line;\n}\n","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nexport default function rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}","/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nexport default bytesToUuid;","import rng from './rng.js';\nimport bytesToUuid from './bytesToUuid.js';\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nexport default v4;","import {ContextInfo} from '..';\nimport {ConferenceManager} from '../conferences/ConferenceManager';\nimport {MediaTypes} from '../types';\nimport {Conference} from '../conferences/Conference';\nimport {v4 as uuid} from 'uuid';\n/**\n * This class provides a wrapper over the ConferenceManager class that allows to\n * call an agent.\n */\nexport class SupportService {\n\t/** @private */\n\tprivate conferenceManager: ConferenceManager;\n\n\t/**\n\t * @private\n\t */\n\tprivate constructor(conferenceManager: ConferenceManager) {\n\t\t/** @private */\n\t\tthis.conferenceManager = conferenceManager;\n\t}\n\n\t/** @private */\n\tpublic static of(conferenceManager: ConferenceManager): SupportService {\n\t\treturn new SupportService(conferenceManager);\n\t}\n\n\t/**\n\t * @desc Invites an agent to a conference\n\t * @param {MediaTypes} mediaTypes the media types that will be used to call an agent\n\t * @param {Object} [contextInfo={}] arbitrary context that can be sent to an agent\n\t * @return {Promise<Conference>}\n\t */\n\tpublic async callAgent(mediaTypes: MediaTypes, contextInfo?: ContextInfo): Promise<Conference> {\n\t\tconst conference = await this.conferenceManager.createConference();\n\t\tawait conference.join();\n\t\tconst agent = this.generateWacAgentUri();\n\t\tconst response = await conference.inviteParticipant(\n\t\t\tagent,\n\t\t\tundefined,\n\t\t\tmediaTypes,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\tcontextInfo,\n\t\t);\n\t\tif (response.code < 200 || response.code >= 300) {\n\t\t\tthrow new Error('Error calling an agent');\n\t\t}\n\t\treturn conference;\n\t}\n\n\tprivate generateWacAgentUri(): string {\n\t\treturn `wac-agent:${uuid()}`;\n\t}\n}\n","import {version} from '../../version';\nimport {PromiseQueue} from '../utils/PromiseQueue';\nimport {SessionStatus} from './SessionStatus';\nimport {SessionError} from './SessionError';\nimport {bindMethods} from '../utils';\nimport {\n\tLoginError,\n\tStackUnregisterError,\n\tStackRegisterError,\n\tWacInternalError,\n\tAlreadyLoggedError,\n} from '../wac-proxy/errors';\nimport {ChatManager} from '../chat/ChatManager';\nimport {ContactManager} from '../contacts/ContactManager';\nimport {FileManager} from '../file-sharing/FileManager';\nimport {EventEmitter} from '../eventemitter';\nimport {CallManager} from '../calls/CallManager';\nimport {ConferenceManager} from '../conferences/ConferenceManager';\nimport {GroupManager} from '../groups/GroupManager';\nimport {InstantMessage} from '../instant-messages/InstantMessage';\nimport {InstantMessageType} from '../instant-messages/InstantMessageType';\nimport Logs from '../Logs';\nimport {MeetingManager} from '../meetings/MeetingManager';\nimport {DataPipeFactory} from '../datapipe/DataPipeFactory';\nimport {DataPipeType} from '../datapipe/DataPipeType';\nimport {DataChannelDataPipe} from '../datapipe/DataChannelDataPipe';\nimport {WacDataPipe} from '../datapipe/WacDataPipe';\nimport {WacProxy} from '../wac-proxy/WacProxy';\nimport {PresenceManager} from '../contacts/PresenceManager';\nimport {RemoteSession} from './RemoteSession';\nimport Selfie from '../misc/Selfie';\nimport {User} from './User';\nimport {UserManager} from '../users/UserManager';\nimport Whiteboard from '../whiteboard/Whiteboard';\nimport {SupportService} from '../support/SupportService';\n\nlet log = Logs.instance.getLogger('SippoJS/Session');\n\n/**\n * @typedef {Object} StatusEvent\n * @property {SessionStatus} status The new status of the session\n * @property {Session} target The session object\n */\n\n/**\n * Session objects manage communications for a given user identity.\n * They are obtained by calling the {@link Sippo#createSession} method of the\n * {@link Sippo} object.\n *\n * # Events\n *\n * - `status` {@link StatusEvent} - Triggered every time the status of the session changes.\n * - `incomingInstantMessage` {@link InstatMessage} -\n *     Triggered when an incoming instant message is received during an active session\n * - `incomingDataPipe` {@link Datapipe} -\n *     Triggered when an incoming data pipe is received during an active session\n * - `incomingWhiteboard` {@link Whiteboard} -\n * - `incomingSelfie` {@link Selfie} - Triggered when an Selfie request is received\n * - `qs-connection-lost` - Triggered when the socket.io ping times out (deprecated)\n * - `qs-transport-close` - Triggered when the socket is terminated (deprecated)\n * - `qs-unknown-close` - Triggered when some other reason closed the socket (deprecated)\n */\nexport class Session extends EventEmitter {\n\t/**\n\t * Creates a new Session\n\t * @param {string} issuer The authorization token issuer identifier\n\t * @param {string} token The authorization token from the given issuer\n\t * @param {Object} config Session configuration\n\t * @param {string} config.wacUri WAC URI\n\t * @param {string} config.applicationToken A token for the application\n\t * @param {string} config.deviceId string which identifies the device this session belongs to\n\t * @protected\n\t */\n\tstatic withOAuth2(issuer, token, config) {\n\t\tconst sessionEstablisher = (wacProxy, deviceId) => wacProxy.loginToken(issuer, token, deviceId);\n\t\treturn new Session(sessionEstablisher, config);\n\t}\n\n\t/**\n\t * Creates a new Session\n\t * @param {string} token The authorization token from the given issuer\n\t * @param {Object} config Session configuration\n\t * @param {string} config.wacUri WAC URI\n\t * @param {string} config.applicationToken A token for the application\n\t * @param {string} config.deviceId string which identifies the device this session belongs to\n\t * @protected\n\t */\n\tstatic withSessionToken(token, config) {\n\t\tconst sessionEstablisher = (wacProxy, deviceId) => wacProxy.recoverSession(token, deviceId);\n\t\treturn new Session(sessionEstablisher, config);\n\t}\n\n\t/** @private */\n\tconstructor(sessionEstablisher, config) {\n\t\tsuper();\n\t\t/** @private */\n\t\tthis.status = SessionStatus.DISCONNECTED;\n\t\t/** @private */\n\t\tthis.meetingManager = null;\n\t\t/** @private */\n\t\tthis.session = null;\n\t\t/** @private */\n\t\tthis.credential = null;\n\n\t\t/** @private */\n\t\tthis.wacUri = config.wacUri;\n\t\t/** @private */\n\t\tthis.applicationToken = config.applicationToken;\n\t\t/** @private */\n\t\tthis.deviceId = config.deviceId;\n\t\t/** @private */\n\t\tthis.sessionEstablisher = sessionEstablisher;\n\n\t\tthis._promiseQueue = new PromiseQueue();\n\n\t\tthis._boundEvents = false;\n\t\t/** @private */\n\t\tthis.wacProxy = new WacProxy();\n\t\tthis.wacProxy.initialize(this.wacUri);\n\t\t/** @private */\n\t\tthis.userManager = new UserManager(this.wacProxy);\n\t\t/** @private */\n\t\tthis.setStatus(SessionStatus.UNCONNECTED);\n\t\tbindMethods(this, [\n\t\t\t'onSessionDisconnected',\n\t\t\t'onSessionReconnecting',\n\t\t\t'onSessionReconnected',\n\t\t\t'onDataPipeInvite',\n\t\t\t'onRinging',\n\t\t\t'onInstantMessage',\n\t\t\t'onTransportClose',\n\t\t\t'onConnectionLost',\n\t\t\t'onUnknownClose',\n\t\t]);\n\t}\n\n\t/**\n\t * Sets the new status on the session\n\t *\n\t * @private\n\t * @param {SessionStatus} status New status\n\t * @return {Session} The session object\n\t */\n\tsetStatus(status) {\n\t\tif (this.status === status) {\n\t\t\treturn this;\n\t\t}\n\t\tlog.info(`session status changed from ${SessionStatus[this.status]} to ${SessionStatus[status]}`);\n\t\tthis.status = status;\n\t\tthis.emit('status', {\n\t\t\tstatus: this.status,\n\t\t\ttarget: this,\n\t\t});\n\t\treturn this;\n\t}\n\n\t/**\n\t * Handles an incoming data pipe and emits the corresponding events\n\t *\n\t * @private\n\t * @param {DataPipe} dataPipe A data pipe\n\t * @return {undefined}\n\t */\n\thandleDataPipe(dataPipe) {\n\t\tswitch (dataPipe.label) {\n\t\t\tcase Whiteboard.PROTOCOL:\n\t\t\t\tnew Whiteboard(dataPipe).init()\n\t\t\t\t\t.then(whiteboard => this.emit('incomingWhiteboard', whiteboard))\n\t\t\t\t\t.catch(log.error);\n\t\t\t\tbreak;\n\t\t\tcase Selfie.PROTOCOL: {\n\t\t\t\tconst selfie = new Selfie();\n\t\t\t\tselfie._initDatapipe(dataPipe).then(() => {\n\t\t\t\t\tthis.emit('incomingSelfie', selfie);\n\t\t\t\t}).catch(log.error);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tdataPipe.connect().then(() =>\n\t\t\t\t\tthis.emit('incomingDataPipe', dataPipe),\n\t\t\t\t).catch(log.error);\n\t\t}\n\t}\n\n\t/** @private */\n\tonDataPipeInvite(event) {\n\t\tlet dataPipe = new WacDataPipe(event.id, DataPipeType.INCOMING, this.wacProxy, event.participants, event.label);\n\t\tthis.handleDataPipe(dataPipe);\n\t}\n\n\t/** @private */\n\tonRinging(event) {\n\t\tif (event.media && event.media.data) {\n\t\t\tlet pipe = new DataChannelDataPipe(event.callid, DataPipeType.INCOMING, this.wacProxy, [this.getGatewayUsername(), event.userid]);\n\t\t\treturn this.handleDataPipe(pipe);\n\t\t}\n\t}\n\n\t/** @private */\n\tonInstantMessage(event) {\n\t\tthis.emit('incomingInstantMessage', new InstantMessage(\n\t\t\tInstantMessageType.INCOMING,\n\t\t\tthis.wacProxy,\n\t\t\tevent.userid,\n\t\t\tthis.getGatewayUsername(),\n\t\t\tevent.text,\n\t\t));\n\t}\n\n\t/** @private */\n\tbindEventHandlers() {\n\t\tif (this._boundEvents) {\n\t\t\treturn;\n\t\t}\n\t\tthis.wacProxy.on('disconnected', this.onSessionDisconnected);\n\t\tthis.wacProxy.on('qs-reconnecting', this.onSessionReconnecting);\n\t\tthis.wacProxy.on('qs-reconnected', this.onSessionReconnected);\n\t\tthis.wacProxy.getDatapipeService().emitter.on('invite', this.onDataPipeInvite);\n\t\tthis.wacProxy.on('qs-ringing', this.onRinging);\n\t\tthis.wacProxy.on('qs-instant-message', this.onInstantMessage);\n\t\tthis.wacProxy.on('qs-transport-close', this.onTransportClose);\n\t\tthis.wacProxy.on('qs-connection-lost', this.onConnectionLost);\n\t\tthis.wacProxy.on('qs-unknown-close', this.onUnknownClose);\n\t\tthis._boundEvents = true;\n\t}\n\n\t/** @private */\n\tunbindEventHandlers() {\n\t\tif (!this._boundEvents) {\n\t\t\treturn;\n\t\t}\n\t\tthis.wacProxy.off('disconnected', this.onSessionDisconnected);\n\t\tthis.wacProxy.off('qs-reconnecting', this.onSessionReconnecting);\n\t\tthis.wacProxy.off('qs-reconnected', this.onSessionReconnected);\n\t\tthis.wacProxy.getDatapipeService().emitter.off('invite', this.onDataPipeInvite);\n\t\tthis.wacProxy.off('qs-ringing', this.onRinging);\n\t\tthis.wacProxy.off('qs-instant-message', this.onInstantMessage);\n\t\tthis.wacProxy.off('qs-transport-close', this.onTransportClose);\n\t\tthis.wacProxy.off('qs-connection-lost', this.onConnectionLost);\n\t\tthis.wacProxy.off('qs-unknown-close', this.onUnknownClose);\n\t\tthis._boundEvents = false;\n\t}\n\n\t/** @private */\n\tonSessionDisconnected() {\n\t\tlog.warn('[SippoJS] Session disconnected');\n\t\tthis.setStatus(SessionStatus.DISCONNECTED);\n\t}\n\n\t/** @private */\n\tonSessionReconnecting() {\n\t\tthis.setStatus(SessionStatus.CONNECTING);\n\t}\n\n\t/** @private */\n\tonSessionReconnected() {\n\t\tthis.setStatus(SessionStatus.CONNECTED);\n\t}\n\n\t/** @private */\n\tonTransportClose() {\n\t\tlog.warn('WAPI transport closed');\n\t\tthis.emit('qs-transport-close');\n\t}\n\n\t/** @private */\n\tonUnknownClose() {\n\t\tlog.warn('WAPI closed with unknown reason');\n\t\tthis.emit('qs-unknown-close');\n\t}\n\n\t/** @private */\n\tonConnectionLost() {\n\t\tlog.warn('WAPI connection lost');\n\t\tthis.emit('qs-connection-lost');\n\t}\n\n\t/**\n\t * Activates the communications session with a gateway server.\n\t *\n\t * @return {Promise<Session>} Resolved after the session is connected or rejected if an error\n\t * occurs during connection\n\t */\n\tasync connect() {\n\t\tthis.setStatus(SessionStatus.CONNECTING);\n\t\ttry {\n\t\t\tawait this.wacProxy.start();\n\t\t\tconst res = await this.sessionEstablisher(this.wacProxy, this.deviceId);\n\t\t\tthis.userManager.init();\n\t\t\tthis.session = res.session;\n\t\t\tif (!this.deviceId) {\n\t\t\t\tthis.deviceId = this.session.context.deviceId;\n\t\t\t}\n\t\t\tthis.wacProxy.retainSession(this.session);\n\t\t\tconst credentials = res.credential ? [res.credential] : await this.wacProxy.getCredentials({type: 'ims', user: this.session.user});\n\t\t\tif (!credentials.length || !credentials[0].data) {\n\t\t\t\tlog.warn('No credentials for this user. No stack will be used. Only wac');\n\t\t\t} else {\n\t\t\t\tthis.wacProxy.retainCredential(credentials[0]);\n\t\t\t\tlet credential = credentials[0].data;\n\t\t\t\tcredential.wacUri = this.wacUri;\n\t\t\t\tcredential.token = this.session.token;\n\t\t\t\tcredential.applicationToken = this.applicationToken;\n\t\t\t\tawait this.wacProxy.register(credential, {deviceId: this.deviceId});\n\t\t\t\tthis.credential = credential;\n\t\t\t}\n\t\t\tthis.bindEventHandlers();\n\t\t\t/** @private */\n\t\t\tthis.user = User.newInstance(this.wacProxy);\n\t\t\tawait this.user.init();\n\t\t\tthis.setStatus(SessionStatus.CONNECTED);\n\t\t\treturn this;\n\t\t} catch (error) {\n\t\t\ttry {\n\t\t\t\tawait this.disconnect();\n\t\t\t} catch (e) {\n\t\t\t\tlog.error('Error disconnecting', e);\n\t\t\t}\n\t\t\tif (error instanceof LoginError) {\n\t\t\t\tthrow new SessionError('UNAUTHORIZED');\n\t\t\t}\n\t\t\tif (error instanceof WacInternalError) {\n\t\t\t\tthrow new SessionError('WAC_INTERNAL_ERROR');\n\t\t\t}\n\t\t\tif (error instanceof StackRegisterError) {\n\t\t\t\tthrow new SessionError('STACK_REGISTER_ERROR');\n\t\t\t}\n\t\t\tif (error instanceof AlreadyLoggedError) {\n\t\t\t\tthrow new SessionError('ALREADY_LOGGED');\n\t\t\t}\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\t/**\n\t * Returns the username in the gateway of the user owning this session\n\t * @return {String} The users's gateway username\n\t */\n\tgetGatewayUsername() {\n\t\treturn this.credential.username;\n\t}\n\n\t/**\n\t * Get user's alias\n\t * @return {String} User's alias\n\t */\n\tgetAlias() {\n\t\treturn this.credential.alias;\n\t}\n\n\t/**\n\t * Get session token\n\t * @return {String}\n\t */\n\tgetSessionToken() {\n\t\treturn this.session.token;\n\t}\n\n\t/**\n\t * Creates a new instance of a Whiteboard\n\t * @param {String[]} participants gateway usernames of the desired participants\n\t * @return {Promise{Whiteboard}}\n\t */\n\tcreateWhiteboard(participants) {\n\t\treturn new Whiteboard(this.createDataPipe(participants, Whiteboard.PROTOCOL)).init();\n\t}\n\n\t/**\n\t * Creates a new instance of a Selfie\n\t * @param {String} to gateway username of the selfie recipient.\n\t * @return {Promise}\n\t */\n\tcreateSelfie(to) {\n\t\tlet selfie = new Selfie();\n\t\treturn selfie._initDatapipe(this.createDataPipe([to], Selfie.PROTOCOL)).then(() => selfie);\n\t}\n\n\t/**\n\t * Creates a new data pipe instance for data exchange with the specified recipient.\n\t * @throws {TypeError}\n\t * @param {String[]} participants gateway usernames of the desired participants\n\t * @param {String} label a shared pipe identifier.\n\t * @return {DataPipe}\n\t */\n\tcreateDataPipe(participants, label) {\n\t\tif (!(participants instanceof Array)) {\n\t\t\tthrow new TypeError(`${participants} is not an Array`);\n\t\t}\n\t\tif (!participants.includes(this.getGatewayUsername())) {\n\t\t\tparticipants.push(this.getGatewayUsername());\n\t\t}\n\t\treturn DataPipeFactory.create(undefined, DataPipeType.OUTGOING, this.wacProxy, participants, label);\n\t}\n\n\t/**\n\t * Create a standalone message to the given recipient\n\t * @param {String} to User identifier of the recipient\n\t * @param {String} text Message's body\n\t * @return {InstantMessage}\n\t */\n\tcreateInstantMessage(to, text) {\n\t\treturn new InstantMessage(this.wacProxy, InstantMessageType.OUTGOING, this.getGatewayUsername(), to, text);\n\t}\n\n\t/**\n\t * Retrieves a call manager instance\n\t * @return {CallManager}\n\t */\n\tgetCallManager() {\n\t\tif (!this.callManager) {\n\t\t\t/** @private */\n\t\t\tthis.callManager = CallManager.newInstance(this.wacProxy, this.userManager, this.credential.username);\n\t\t}\n\t\treturn this.callManager;\n\t}\n\n\t/**\n\t * Retrieves a conference manager instance\n\t * @return {ConferenceManager}\n\t */\n\tgetConferenceManager() {\n\t\tif (!this.conferenceManager) {\n\t\t\t/** @private */\n\t\t\tthis.conferenceManager = ConferenceManager.newInstance(this.wacProxy, this.userManager);\n\t\t}\n\t\treturn this.conferenceManager;\n\t}\n\n\t/**\n\t * Retrieve a UserManager object\n\t * @return {UserManager}\n\t */\n\tgetUserManager() {\n\t\treturn this.userManager;\n\t}\n\n\t/**\n\t * Retrieves the chat manager\n\t * @return {Promise<ChatManager>}\n\t */\n\tasync getChatManager() {\n\t\tif (!this.chatManager) {\n\t\t\tconst chatService = this.wacProxy.getChatService();\n\t\t\tconst fileManager = await this.getFileManager();\n\t\t\tconst user = this.getUser();\n\t\t\t/** @private */\n\t\t\tthis.chatManager = ChatManager.newInstance(chatService, fileManager, user, this.getSessionToken());\n\t\t}\n\t\treturn this.chatManager;\n\t}\n\n\t/**\n\t * Retrieves the file manager\n\t * @return {Promise<FileManager>}\n\t */\n\tasync getFileManager() {\n\t\tif (!this.fileManager) {\n\t\t\tconst fileSharingService = this.wacProxy.getFileSharingService();\n\t\t\t/** @private */\n\t\t\tthis.fileManager = FileManager.newInstance(fileSharingService);\n\t\t}\n\t\treturn this.fileManager;\n\t}\n\n\t/**\n\t * Retrieve the contact manager.\n\t * @return {ContactManager}\n\t */\n\tgetContactManager() {\n\t\tif (this.contactManager === undefined) {\n\t\t\t/** @private */\n\t\t\tthis.contactManager = new ContactManager(this.wacProxy, this.userManager, this.getPresenceManager());\n\t\t}\n\t\treturn this.contactManager;\n\t}\n\n\t/**\n\t * Get a list of remote sessions where user is currently logged in\n\t * @return {Promise<Array<RemoteSession>>}\n\t */\n\tgetRemoteSessions() {\n\t\treturn Promise.resolve().then(() => {\n\t\t\tif (this.getCapabilities().includes('list-remote')) {\n\t\t\t\treturn this.wacProxy.getRemoteSessions();\n\t\t\t}\n\t\t\treturn this.wacProxy.getSessions({to: -1}).then((sessions) => {\n\t\t\t\treturn sessions.filter(x => x.id !== this.session.id).map((x) => {\n\t\t\t\t\tx.name = 'wac';\n\t\t\t\t\treturn x;\n\t\t\t\t});\n\t\t\t});\n\n\t\t}).then((sessions) => {\n\t\t\treturn sessions.map((session) => {\n\t\t\t\treturn new RemoteSession(session.id, session.name);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Retrieve the User\n\t * @return {User}\n\t */\n\tgetUser() {\n\t\treturn this.user;\n\t}\n\n\t/**\n\t * Retrieves a {Logger} instance to log events in the WAC.\n\t * @param {string} name The name of the logger\n\t * @return {Logger}\n\t */\n\tgetLogger(name) {\n\t\treturn Logs.instance.getLogger(name);\n\t}\n\n\t/**\n\t * Retrieves the meeting manager.\n\t * @return {MeetingManager}\n\t * @deprecated\n\t */\n\tgetMeetingList() {\n\t\treturn this.getMeetingManager();\n\t}\n\n\t/**\n\t * Retrieves the meeting manager.\n\t * @return {MeetingManager}\n\t */\n\tgetMeetingManager() {\n\t\tif (this.meetingManager === null) {\n\t\t\tthis.meetingManager = new MeetingManager(this.wacProxy.getMeetingService());\n\t\t}\n\t\treturn this.meetingManager;\n\t}\n\n\t/**\n\t * Retrieves the group manager.\n\t * @return {Promise<GroupManager>}\n\t */\n\tgetGroupManager() {\n\t\tif (this.groupManager === undefined && this.getCapabilities().includes('user-group')) {\n\t\t\tconst groupService = this.wacProxy.getGroupService();\n\t\t\tconst phonebookService = this.wacProxy.getPhonebookService();\n\t\t\tconst userManager = this.getUserManager();\n\t\t\t/** @private */\n\t\t\tthis.groupManager = GroupManager.newInstance(groupService, phonebookService, userManager);\n\t\t}\n\t\treturn this.groupManager;\n\t}\n\n\t/**\n\t * Retrieves the presence manager.\n\t * @return {PresenceManager}\n\t */\n\tgetPresenceManager() {\n\t\tif (!this.presenceManager) {\n\t\t\tconst presenceService = this.wacProxy.getPresenceService();\n\t\t\tthis.presenceManager = PresenceManager.of(presenceService);\n\t\t}\n\t\treturn this.presenceManager;\n\t}\n\n\t/**\n\t * Retrieves a support service instance\n\t * @return {SupportService}\n\t */\n\tgetSupportService() {\n\t\tif (!this.supportService) {\n\t\t\t/** @private */\n\t\t\tthis.supportService = SupportService.of(this.getConferenceManager());\n\t\t}\n\t\treturn this.supportService;\n\t}\n\n\t/**\n\t * Return stack-reported network connectivity tests results\n\t * @param {String} [proto='udp'] - The transport protocol to test connectivity for, one of 'udp', 'tcp'.\n\t * @return {Promise}\n\t */\n\tcheckConnection(proto = 'udp') {\n\t\tif (!this.getCapabilities().includes('network-reporting')) {\n\t\t\tthrow Error('Network reporting is not supported');\n\t\t}\n\t\treturn this.wacProxy.checkConnection(proto);\n\t}\n\n\t/**\n\t * Retrieves and array with version information.\n\t * @return {Object[]}\n\t */\n\tgetVersion() {\n\t\treturn [{name: 'SippoJS', version}].concat(this.wacProxy.getVersion());\n\t}\n\n\t/**\n\t * Retrieves an array with the underlying capabilities\n\t * @return {ImmutableSet<string>}\n\t */\n\tgetCapabilities() {\n\t\treturn this.wacProxy.getCapabilities();\n\t}\n\n\t/**\n\t * Retrieves a promise which is resolved with the settings array.\n\t * @return {Promise} This promise is resolved with a settings array\n\t */\n\tsettings() {\n\t\treturn this.wacProxy.getSettings();\n\t}\n\n\t/**\n\t * @param {String} key Key to modified\n\t * @param {String} value New value\n\t * @return {Session}\n\t */\n\tsetSetting(key, value) {\n\t\tthis.wacProxy.setSetting(key, value);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Ends a connected session.\n\t * @return {Promise} A promise that is fulfilled when the session is disconnected\n\t */\n\tasync disconnect() {\n\t\tif (this.status === SessionStatus.DISCONNECTED) {\n\t\t\treturn Promise.reject(Error('Session is already disconnected'));\n\t\t}\n\t\tthis.unbindEventHandlers();\n\t\ttry {\n\t\t\tif (this.groupManager) {\n\t\t\t\t(await this.groupManager).uninit();\n\t\t\t}\n\t\t\tif (this.chatManager) {\n\t\t\t\t(await this.chatManager).uninit();\n\t\t\t}\n\t\t\tawait this.wacProxy.stop();\n\t\t} catch (error) {\n\t\t\tif (error instanceof StackUnregisterError) {\n\t\t\t\tthrow new SessionError('STACK_UNREGISTER_ERROR');\n\t\t\t}\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tthis.setStatus(SessionStatus.DISCONNECTED);\n\t\t}\n\t}\n\n\tasync _suspend() {\n\t\tif (this.status !== SessionStatus.CONNECTED) {\n\t\t\treturn false;\n\t\t}\n\t\tawait this.wacProxy.suspendSession();\n\t\tthis.setStatus(SessionStatus.SUSPENDED);\n\t\treturn true;\n\t}\n\n\tasync _resume() {\n\t\tif (this.status !== SessionStatus.SUSPENDED) {\n\t\t\treturn false;\n\t\t}\n\t\tawait this.wacProxy.resumeSession();\n\t\tthis.setStatus(SessionStatus.CONNECTED);\n\t\treturn true;\n\t}\n\n\t/**\n\t * Suspend current session: WAC will not send or receive any message\n\t * @return {Promise} Resolved when the session is suspended\n\t */\n\tsuspend() {\n\t\treturn this._promiseQueue.queue(this._suspend.bind(this), 'suspend');\n\t}\n\n\t/**\n\t * Resume current session, restoring WAC communication\n\t * @return {Promise} Resolved when the session is resumed\n\t */\n\tresume() {\n\t\treturn this._promiseQueue.queue(this._resume.bind(this), 'resume');\n\t}\n\n\t/**\n\t * Retrieves the current status of this session.\n\t * @return {SessionStatus}\n\t */\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\t/**\n\t * Notifies a push token to the WAC\n\t * @param {string} tokenType type of the token. Supported values are \"apn\" and \"firebase\"\n\t * @param {string} token token intended to be used to send notifications\n\t * @return {Promise}\n\t */\n\tnotifyPushToken(tokenType, token, ...rest) {\n\t\tif (rest.length === 1) {\n\t\t\tlog.warn('Only two arguments expected: Current method signature is \"session.notifyPushToken(tokenType, token)\"');\n\t\t\ttokenType = token;\n\t\t\ttoken = rest[0];\n\t\t}\n\t\treturn this.wacProxy.getPushNotificationsService().notifyToken(this.deviceId, tokenType, token);\n\t}\n\n\t/**\n\t * Destroy every existent token for the deviceId of this session\n\t * @return {Promise}\n\t */\n\tdestroyPushToken() {\n\t\treturn this.wacProxy.getPushNotificationsService().destroyToken(this.deviceId);\n\t}\n}\n","import {WacDataPipe} from './WacDataPipe';\nimport {DataChannelDataPipe} from './DataChannelDataPipe';\n\n/**\n * DataPipe factory\n */\nexport class DataPipeFactory {\n\n\t/**\n\t * Create a {DataPipe} instance with given parameters.\n\t *\n\t * @throws {TypeError} invalid participants.\n\t *\n\t * @param {String} id pipe identifier. Optional. Default is a random value.\n\t * @param {DataPipe.TYPE} type pipe type.\n\t * @param {WacStack} stack stack instance.\n\t * @param {Array<String>} participants pipe participants.\n\t * @param {String} label pipe label. Optional. Default is 'generic'\n\t */\n\tstatic create(id, type, stack, participants, label) {\n\t\tif (stack.getCapabilities().includes('datapipe')) {\n\t\t\treturn new WacDataPipe(id, type, stack, participants, label);\n\t\t} else {\n\t\t\treturn new DataChannelDataPipe(id, type, stack, participants, label);\n\t\t}\n\t}\n}\n","import {Session} from './session/Session';\n\n/**\n * Factory method for session creation\n * @param {string} issuer The authorization token issuer identifier\n * @param {string} token The authorization token from the given issuer\n * @param {Object} config Session configuration\n * @param {string} config.wacUri The address where the WAC is available\n * @param {string} config.applicationToken A token for the application\n * @param {string} config.deviceId string which identifies the device this session belongs to\n * @return {Promise<Session>} A promise of a new SippoJS session\n */\nexport function createSession(issuer, token, config) {\n\tconst session = Session.withOAuth2(issuer, token, config);\n\treturn Promise.resolve(session);\n}\n\n/**\n * Factory method for session creation\n * @param {string} token The authorization token\n * @param {Object} config Session configuration\n * @param {string} config.wacUri The address where the WAC is available\n * @param {string} config.applicationToken A token for the application\n * @param {string} config.deviceId string which identifies the device this session belongs to\n * @return {Promise<Session>} A promise of a new SippoJS session\n */\nexport function recoverSession(token, config) {\n\tconst session = Session.withSessionToken(token, config);\n\treturn Promise.resolve(session);\n}\n\n/**\n * Allows obtaining the available providers enabled in the specified WAC instance\n * @param {string} wacUri The address where the WAC is available\n * @return {Promise<ProviderInfo[]>} A promise with an array with information for each provider\n */\nexport function getAuthProviders(wacUri) {\n\treturn window.fetch(`${wacUri}/sapi/oauth2/providers`).then(response => response.json());\n}\n\nexport {StreamRecorder} from './media/StreamRecorder';\nexport {StreamRecorderStatus} from './media/StreamRecorderStatus';\nexport {InstantMessageType} from './instant-messages/InstantMessageType';\nexport {DataPipeStatus} from './datapipe/DataPipeStatus';\nexport {DataPipeType} from './datapipe/DataPipeType';\n\nexport {CallStatus} from './calls/CallStatus';\nexport {CallDirection} from './calls/CallDirection';\nexport {CallEndReason} from './calls/CallEndReason';\n\nexport {Conference} from './conferences/Conference';\nexport {ConferenceManager} from './conferences/ConferenceManager';\nexport {ConferenceStatus} from './conferences/ConferenceStatus';\nexport {ConferenceEndReason} from './conferences/ConferenceEndReason';\n\nexport {ChatType} from './chat/ChatType';\nexport {ChatParticipantState} from './chat/ChatParticipantState';\nexport {ChatParticipantRole} from './chat/ChatParticipantRole';\nexport {ChatMessageDirection} from './chat/ChatMessageDirection';\nexport {ChatMessageStatus} from './chat/ChatMessageStatus';\nexport {ChatMessageType} from './chat/ChatMessageType';\nexport {FileUploadStatus} from './file-sharing/FileUploadStatus';\n\nexport {PresenceActivity} from './contacts/PresenceActivity';\nexport {PresenceMood} from './contacts/PresenceMood';\n\nexport {SessionError} from './session/SessionError';\nexport {SessionStatus} from './session/SessionStatus';\n\nexport {ManagedStream} from './media/ManagedStream';\nexport {LocalMediaHandler} from './media/LocalMediaHandler';\n"],"sourceRoot":""}